2025-09-20T16:04:28: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T16:04:28: ğŸ“ Loaded 11 template types
2025-09-20T16:04:28: ğŸ”§ WhatsApp Bot initialized
2025-09-20T16:04:28: ğŸ“Š Configuration status: undefined
2025-09-20T16:04:28: âœ… Atomic State Manager initialized
2025-09-20T16:04:28: ğŸ“ Enhanced Logger initialized
2025-09-20T16:04:28: âœ… Google credentials loaded from service-account.json file
2025-09-20T16:04:28: ğŸ“± WhatsApp auth status: âœ… credentials, 5 session files
2025-09-20T16:04:28: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-20T16:04:28:    Auth Mode: both
2025-09-20T16:04:28:    QR Enabled: true
2025-09-20T16:04:28:    Phone Enabled: true
2025-09-20T16:04:28:    Session Persistence: true
2025-09-20T16:04:28:    Max Reconnect Attempts: 10
2025-09-20T16:04:28:    Default Phone: None
2025-09-20T16:04:28: ğŸ”’ Session validation enabled (check every 300s)
2025-09-20T16:04:28: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-20T16:04:28: ğŸ”§ Developer Configuration initialized
2025-09-20T16:04:28: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T16:04:28: â„¹ï¸ [4:04:28 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:04:28:   startupTime: 1758364468462,
2025-09-20T16:04:28:   gracePeriodMs: 240000,
2025-09-20T16:04:28:   dataDir: './safety-data',
2025-09-20T16:04:28:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:04:28:   processId: 15920,
2025-09-20T16:04:28:   nodeVersion: 'v22.19.0'
2025-09-20T16:04:28: }
2025-09-20T16:04:28: ğŸ”§ Developer Configuration initialized
2025-09-20T16:04:28: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T16:04:28: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-20T16:04:28: â° 4-minute startup delay active
2025-09-20T16:04:28: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-20T16:04:28: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-20T16:04:28: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:04:28: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:04:28: âœ… Google Sheets API initialized
2025-09-20T16:04:28: âœ… Google Sheets API initialized
2025-09-20T16:04:28: â„¹ï¸ [4:04:28 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:04:28:   startupTime: 1758364468462,
2025-09-20T16:04:28:   gracePeriodMs: 240000,
2025-09-20T16:04:28:   dataDir: './safety-data',
2025-09-20T16:04:28:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:04:28:   processId: 15920,
2025-09-20T16:04:28:   nodeVersion: 'v22.19.0'
2025-09-20T16:04:28: }
2025-09-20T16:04:28: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:04:28: â„¹ï¸ [4:04:28 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:04:28: â„¹ï¸ [4:04:28 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:04:28: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:04:28: â„¹ï¸ [4:04:28 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:04:28: â„¹ï¸ [4:04:28 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:04:28: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:04:28: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T08-58-14-065Z.log
2025-09-20T16:04:28: ğŸ“ Enhanced Logger initialized
2025-09-20T16:04:28: ğŸ§¹ Removed stale process lock
2025-09-20T16:04:28: ğŸ§¹ Lock file already cleaned up
2025-09-20T16:04:28: ğŸ“ Loaded statistics from file
2025-09-20T16:04:28: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:04:28: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:04:28: ğŸ”’ Process lock acquired (PID: 15920)
2025-09-20T16:04:28: ğŸ”’ Process lock acquired (PID: 15920)
2025-09-20T16:04:28: â„¹ï¸ [4:04:28 pm] INFO: Process isolation enforced {
2025-09-20T16:04:28:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:04:28:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:04:28:   processId: 15920
2025-09-20T16:04:28: }
2025-09-20T16:04:28: â° Starting 240 second startup grace period...
2025-09-20T16:04:28: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:04:28: â„¹ï¸ [4:04:28 pm] INFO: Process isolation enforced {
2025-09-20T16:04:28:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:04:28:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:04:28:   processId: 15920
2025-09-20T16:04:28: }
2025-09-20T16:04:28: â° Starting 240 second startup grace period...
2025-09-20T16:04:28: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:04:28: â„¹ï¸ [4:04:28 pm] INFO: Grace Period: STARTED {
2025-09-20T16:04:28:   action: 'STARTED',
2025-09-20T16:04:28:   remainingMs: 240000,
2025-09-20T16:04:28:   remainingSeconds: 240,
2025-09-20T16:04:28:   details: { startupTime: 1758364468462, processId: 15920 },
2025-09-20T16:04:28:   timestamp: 1758364468641
2025-09-20T16:04:28: }
2025-09-20T16:04:28: â„¹ï¸ [4:04:28 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:04:28:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:04:28:   remainingMs: 240000,
2025-09-20T16:04:28:   remainingSeconds: 240,
2025-09-20T16:04:28:   details: { startupTime: 1758364468462, willExpireAt: 1758364708462 },
2025-09-20T16:04:28:   timestamp: 1758364468642
2025-09-20T16:04:28: }
2025-09-20T16:04:28: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:04:28: â° Startup grace period: 240 seconds
2025-09-20T16:04:28: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:04:28: â„¹ï¸ [4:04:28 pm] INFO: Grace Period: STARTED {
2025-09-20T16:04:28:   action: 'STARTED',
2025-09-20T16:04:28:   remainingMs: 240000,
2025-09-20T16:04:28:   remainingSeconds: 240,
2025-09-20T16:04:28:   details: { startupTime: 1758364468462, processId: 15920 },
2025-09-20T16:04:28:   timestamp: 1758364468646
2025-09-20T16:04:28: }
2025-09-20T16:04:28: â„¹ï¸ [4:04:28 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:04:28:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:04:28:   remainingMs: 240000,
2025-09-20T16:04:28:   remainingSeconds: 240,
2025-09-20T16:04:28:   details: { startupTime: 1758364468462, willExpireAt: 1758364708462 },
2025-09-20T16:04:28:   timestamp: 1758364468649
2025-09-20T16:04:28: }
2025-09-20T16:04:28: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:04:28: â° Startup grace period: 240 seconds
2025-09-20T16:04:28: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:04:28: â„¹ï¸ [4:04:28 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:04:28:   initializationDuration: 191,
2025-09-20T16:04:28:   gracePeriodActive: true,
2025-09-20T16:04:28:   messageRulesCount: 8,
2025-09-20T16:04:28:   messageTypes: [
2025-09-20T16:04:28:     'welcome',
2025-09-20T16:04:28:     'confirmation',
2025-09-20T16:04:28:     'ready',
2025-09-20T16:04:28:     'delivery',
2025-09-20T16:04:28:     'pickup_reminder',
2025-09-20T16:04:28:     'payment_reminder',
2025-09-20T16:04:28:     'fabric_welcome',
2025-09-20T16:04:28:     'fabric_purchase'
2025-09-20T16:04:28:   ],
2025-09-20T16:04:28:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:04:28:   databaseReady: true,
2025-09-20T16:04:28:   loggerReady: true,
2025-09-20T16:04:28:   processIsolationActive: true
2025-09-20T16:04:28: }
2025-09-20T16:04:28: âœ… Safety Manager initialized
2025-09-20T16:04:28: â„¹ï¸ [4:04:28 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:04:28:   initializationDuration: 194,
2025-09-20T16:04:28:   gracePeriodActive: true,
2025-09-20T16:04:28:   messageRulesCount: 8,
2025-09-20T16:04:28:   messageTypes: [
2025-09-20T16:04:28:     'welcome',
2025-09-20T16:04:28:     'confirmation',
2025-09-20T16:04:28:     'ready',
2025-09-20T16:04:28:     'delivery',
2025-09-20T16:04:28:     'pickup_reminder',
2025-09-20T16:04:28:     'payment_reminder',
2025-09-20T16:04:28:     'fabric_welcome',
2025-09-20T16:04:28:     'fabric_purchase'
2025-09-20T16:04:28:   ],
2025-09-20T16:04:28:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:04:28:   databaseReady: true,
2025-09-20T16:04:28:   loggerReady: true,
2025-09-20T16:04:28:   processIsolationActive: true
2025-09-20T16:04:28: }
2025-09-20T16:04:28: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:04:28: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:04:28: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:04:28: ğŸ“ Loaded statistics from file
2025-09-20T16:04:28: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:04:28: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:04:28: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:04:28: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:04:28: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:04:28: âœ… WhatsApp connection started
2025-09-20T16:04:28: ğŸ”§ Initializing admin commands...
2025-09-20T16:04:28: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:04:28: âœ… Admin commands system initialized
2025-09-20T16:04:28: ğŸ”„ Initializing polling functionality...
2025-09-20T16:04:28: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:04:28: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:04:28: ğŸ“ Attempting to request pairing code...
2025-09-20T16:04:28: ğŸ’¡ To use phone authentication:
2025-09-20T16:04:28:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:04:28:    2. Select "Phone Number Authentication"
2025-09-20T16:04:28:    3. Enter your phone number
2025-09-20T16:04:28:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:04:28: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:04:31: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:04:31: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:04:31: ğŸ”„ Reconnecting in 1s... (Attempt 1/10)
2025-09-20T16:04:32: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:04:32: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:04:32: âœ… Google Sheets API initialized
2025-09-20T16:04:32: âœ… Google Sheets API initialized
2025-09-20T16:04:32: â„¹ï¸ [4:04:32 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:04:32:   startupTime: 1758364468462,
2025-09-20T16:04:32:   gracePeriodMs: 240000,
2025-09-20T16:04:32:   dataDir: './safety-data',
2025-09-20T16:04:32:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:04:32:   processId: 15920,
2025-09-20T16:04:32:   nodeVersion: 'v22.19.0'
2025-09-20T16:04:32: }
2025-09-20T16:04:32: â„¹ï¸ [4:04:32 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:04:32: â„¹ï¸ [4:04:32 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:04:32: ğŸ§¹ Removed stale process lock
2025-09-20T16:04:32: ğŸ”’ Process lock acquired (PID: 15920)
2025-09-20T16:04:32: â„¹ï¸ [4:04:32 pm] INFO: Process isolation enforced {
2025-09-20T16:04:32:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:04:32:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:04:32:   processId: 15920
2025-09-20T16:04:32: }
2025-09-20T16:04:32: â° Starting 240 second startup grace period...
2025-09-20T16:04:32: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:04:32: â„¹ï¸ [4:04:32 pm] INFO: Grace Period: STARTED {
2025-09-20T16:04:32:   action: 'STARTED',
2025-09-20T16:04:32:   remainingMs: 240000,
2025-09-20T16:04:32:   remainingSeconds: 240,
2025-09-20T16:04:32:   details: { startupTime: 1758364468462, processId: 15920 },
2025-09-20T16:04:32:   timestamp: 1758364472068
2025-09-20T16:04:32: }
2025-09-20T16:04:32: â„¹ï¸ [4:04:32 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:04:32:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:04:32:   remainingMs: 240000,
2025-09-20T16:04:32:   remainingSeconds: 240,
2025-09-20T16:04:32:   details: { startupTime: 1758364468462, willExpireAt: 1758364708462 },
2025-09-20T16:04:32:   timestamp: 1758364472069
2025-09-20T16:04:32: }
2025-09-20T16:04:32: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:04:32: â° Startup grace period: 240 seconds
2025-09-20T16:04:32: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:04:32: â„¹ï¸ [4:04:32 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:04:32:   initializationDuration: 3614,
2025-09-20T16:04:32:   gracePeriodActive: true,
2025-09-20T16:04:32:   messageRulesCount: 8,
2025-09-20T16:04:32:   messageTypes: [
2025-09-20T16:04:32:     'welcome',
2025-09-20T16:04:32:     'confirmation',
2025-09-20T16:04:32:     'ready',
2025-09-20T16:04:32:     'delivery',
2025-09-20T16:04:32:     'pickup_reminder',
2025-09-20T16:04:32:     'payment_reminder',
2025-09-20T16:04:32:     'fabric_welcome',
2025-09-20T16:04:32:     'fabric_purchase'
2025-09-20T16:04:32:   ],
2025-09-20T16:04:32:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:04:32:   databaseReady: true,
2025-09-20T16:04:32:   loggerReady: true,
2025-09-20T16:04:32:   processIsolationActive: true
2025-09-20T16:04:32: }
2025-09-20T16:04:32: âœ… Safety Manager initialized
2025-09-20T16:04:32: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:04:32: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:04:32: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:04:32: ğŸ“ Loaded statistics from file
2025-09-20T16:04:32: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:04:32: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:04:32: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:04:32: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:04:32: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:04:32: âœ… WhatsApp connection started
2025-09-20T16:04:32: ğŸ”§ Initializing admin commands...
2025-09-20T16:04:32: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:04:32: âœ… Admin commands system initialized
2025-09-20T16:04:32: ğŸ”„ Initializing polling functionality...
2025-09-20T16:04:32: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:04:32: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:04:32: ğŸ“ Attempting to request pairing code...
2025-09-20T16:04:32: ğŸ’¡ To use phone authentication:
2025-09-20T16:04:32:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:04:32:    2. Select "Phone Number Authentication"
2025-09-20T16:04:32:    3. Enter your phone number
2025-09-20T16:04:32:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:04:32: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:04:35: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:04:35: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:04:35: ğŸ”„ Reconnecting in 2s... (Attempt 2/10)
2025-09-20T16:04:37: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:04:37: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:04:37: âœ… Google Sheets API initialized
2025-09-20T16:04:37: âœ… Google Sheets API initialized
2025-09-20T16:04:37: â„¹ï¸ [4:04:37 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:04:37:   startupTime: 1758364468462,
2025-09-20T16:04:37:   gracePeriodMs: 240000,
2025-09-20T16:04:37:   dataDir: './safety-data',
2025-09-20T16:04:37:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:04:37:   processId: 15920,
2025-09-20T16:04:37:   nodeVersion: 'v22.19.0'
2025-09-20T16:04:37: }
2025-09-20T16:04:37: â„¹ï¸ [4:04:37 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:04:37: â„¹ï¸ [4:04:37 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:04:37: ğŸ§¹ Removed stale process lock
2025-09-20T16:04:37: ğŸ”’ Process lock acquired (PID: 15920)
2025-09-20T16:04:37: â„¹ï¸ [4:04:37 pm] INFO: Process isolation enforced {
2025-09-20T16:04:37:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:04:37:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:04:37:   processId: 15920
2025-09-20T16:04:37: }
2025-09-20T16:04:37: â° Starting 240 second startup grace period...
2025-09-20T16:04:37: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:04:37: â„¹ï¸ [4:04:37 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:04:37:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:04:37:   remainingMs: 240000,
2025-09-20T16:04:37:   remainingSeconds: 240,
2025-09-20T16:04:37:   details: { startupTime: 1758364468462, willExpireAt: 1758364708462 },
2025-09-20T16:04:37:   timestamp: 1758364477207
2025-09-20T16:04:37: }
2025-09-20T16:04:37: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:04:37: â° Startup grace period: 240 seconds
2025-09-20T16:04:37: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:04:37: â„¹ï¸ [4:04:37 pm] INFO: Grace Period: STARTED {
2025-09-20T16:04:37:   action: 'STARTED',
2025-09-20T16:04:37:   remainingMs: 240000,
2025-09-20T16:04:37:   remainingSeconds: 240,
2025-09-20T16:04:37:   details: { startupTime: 1758364468462, processId: 15920 },
2025-09-20T16:04:37:   timestamp: 1758364477206
2025-09-20T16:04:37: }
2025-09-20T16:04:37: â„¹ï¸ [4:04:37 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:04:37:   initializationDuration: 8749,
2025-09-20T16:04:37:   gracePeriodActive: true,
2025-09-20T16:04:37:   messageRulesCount: 8,
2025-09-20T16:04:37:   messageTypes: [
2025-09-20T16:04:37:     'welcome',
2025-09-20T16:04:37:     'confirmation',
2025-09-20T16:04:37:     'ready',
2025-09-20T16:04:37:     'delivery',
2025-09-20T16:04:37:     'pickup_reminder',
2025-09-20T16:04:37:     'payment_reminder',
2025-09-20T16:04:37:     'fabric_welcome',
2025-09-20T16:04:37:     'fabric_purchase'
2025-09-20T16:04:37:   ],
2025-09-20T16:04:37:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:04:37:   databaseReady: true,
2025-09-20T16:04:37:   loggerReady: true,
2025-09-20T16:04:37:   processIsolationActive: true
2025-09-20T16:04:37: }
2025-09-20T16:04:37: âœ… Safety Manager initialized
2025-09-20T16:04:37: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:04:37: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:04:37: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:04:37: ğŸ“ Loaded statistics from file
2025-09-20T16:04:37: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:04:37: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:04:37: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:04:37: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:04:37: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:04:37: âœ… WhatsApp connection started
2025-09-20T16:04:37: ğŸ”§ Initializing admin commands...
2025-09-20T16:04:37: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:04:37: âœ… Admin commands system initialized
2025-09-20T16:04:37: ğŸ”„ Initializing polling functionality...
2025-09-20T16:04:37: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:04:37: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:04:37: ğŸ“ Attempting to request pairing code...
2025-09-20T16:04:37: ğŸ’¡ To use phone authentication:
2025-09-20T16:04:37:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:04:37:    2. Select "Phone Number Authentication"
2025-09-20T16:04:37:    3. Enter your phone number
2025-09-20T16:04:37:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:04:37: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:04:40: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:04:40: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:04:40: ğŸ”„ Reconnecting in 4s... (Attempt 3/10)
2025-09-20T16:04:44: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:04:44: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:04:44: âœ… Google Sheets API initialized
2025-09-20T16:04:44: âœ… Google Sheets API initialized
2025-09-20T16:04:44: â„¹ï¸ [4:04:44 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:04:44:   startupTime: 1758364468462,
2025-09-20T16:04:44:   gracePeriodMs: 240000,
2025-09-20T16:04:44:   dataDir: './safety-data',
2025-09-20T16:04:44:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:04:44:   processId: 15920,
2025-09-20T16:04:44:   nodeVersion: 'v22.19.0'
2025-09-20T16:04:44: }
2025-09-20T16:04:44: â„¹ï¸ [4:04:44 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:04:44: â„¹ï¸ [4:04:44 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:04:44: ğŸ§¹ Removed stale process lock
2025-09-20T16:04:44: ğŸ”’ Process lock acquired (PID: 15920)
2025-09-20T16:04:44: â„¹ï¸ [4:04:44 pm] INFO: Process isolation enforced {
2025-09-20T16:04:44:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:04:44:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:04:44:   processId: 15920
2025-09-20T16:04:44: }
2025-09-20T16:04:44: â° Starting 240 second startup grace period...
2025-09-20T16:04:44: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:04:44: â„¹ï¸ [4:04:44 pm] INFO: Grace Period: STARTED {
2025-09-20T16:04:44:   action: 'STARTED',
2025-09-20T16:04:44:   remainingMs: 240000,
2025-09-20T16:04:44:   remainingSeconds: 240,
2025-09-20T16:04:44:   details: { startupTime: 1758364468462, processId: 15920 },
2025-09-20T16:04:44:   timestamp: 1758364484755
2025-09-20T16:04:44: }
2025-09-20T16:04:44: â„¹ï¸ [4:04:44 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:04:44:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:04:44:   remainingMs: 240000,
2025-09-20T16:04:44:   remainingSeconds: 240,
2025-09-20T16:04:44:   details: { startupTime: 1758364468462, willExpireAt: 1758364708462 },
2025-09-20T16:04:44:   timestamp: 1758364484757
2025-09-20T16:04:44: }
2025-09-20T16:04:44: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:04:44: â° Startup grace period: 240 seconds
2025-09-20T16:04:44: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:04:44: â„¹ï¸ [4:04:44 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:04:44:   initializationDuration: 16300,
2025-09-20T16:04:44:   gracePeriodActive: true,
2025-09-20T16:04:44:   messageRulesCount: 8,
2025-09-20T16:04:44:   messageTypes: [
2025-09-20T16:04:44:     'welcome',
2025-09-20T16:04:44:     'confirmation',
2025-09-20T16:04:44:     'ready',
2025-09-20T16:04:44:     'delivery',
2025-09-20T16:04:44:     'pickup_reminder',
2025-09-20T16:04:44:     'payment_reminder',
2025-09-20T16:04:44:     'fabric_welcome',
2025-09-20T16:04:44:     'fabric_purchase'
2025-09-20T16:04:44:   ],
2025-09-20T16:04:44:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:04:44:   databaseReady: true,
2025-09-20T16:04:44:   loggerReady: true,
2025-09-20T16:04:44:   processIsolationActive: true
2025-09-20T16:04:44: }
2025-09-20T16:04:44: âœ… Safety Manager initialized
2025-09-20T16:04:44: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:04:44: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:04:44: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:04:44: ğŸ“ Loaded statistics from file
2025-09-20T16:04:44: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:04:44: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:04:44: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:04:44: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:04:44: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:04:44: âœ… WhatsApp connection started
2025-09-20T16:04:44: ğŸ”§ Initializing admin commands...
2025-09-20T16:04:44: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:04:44: âœ… Admin commands system initialized
2025-09-20T16:04:44: ğŸ”„ Initializing polling functionality...
2025-09-20T16:04:44: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:04:44: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:04:44: ğŸ“ Attempting to request pairing code...
2025-09-20T16:04:44: ğŸ’¡ To use phone authentication:
2025-09-20T16:04:44:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:04:44:    2. Select "Phone Number Authentication"
2025-09-20T16:04:44:    3. Enter your phone number
2025-09-20T16:04:44:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:04:44: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:04:46: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:04:46: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:04:46: ğŸ”„ Reconnecting in 8s... (Attempt 4/10)
2025-09-20T16:04:54: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:04:54: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:04:54: âœ… Google Sheets API initialized
2025-09-20T16:04:54: âœ… Google Sheets API initialized
2025-09-20T16:04:54: â„¹ï¸ [4:04:54 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:04:54:   startupTime: 1758364468462,
2025-09-20T16:04:54:   gracePeriodMs: 240000,
2025-09-20T16:04:54:   dataDir: './safety-data',
2025-09-20T16:04:54:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:04:54:   processId: 15920,
2025-09-20T16:04:54:   nodeVersion: 'v22.19.0'
2025-09-20T16:04:54: }
2025-09-20T16:04:54: â„¹ï¸ [4:04:54 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:04:54: â„¹ï¸ [4:04:54 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:04:54: ğŸ§¹ Removed stale process lock
2025-09-20T16:04:54: ğŸ”’ Process lock acquired (PID: 15920)
2025-09-20T16:04:54: â„¹ï¸ [4:04:54 pm] INFO: Process isolation enforced {
2025-09-20T16:04:54:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:04:54:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:04:54:   processId: 15920
2025-09-20T16:04:54: }
2025-09-20T16:04:54: â° Starting 240 second startup grace period...
2025-09-20T16:04:54: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:04:54: â„¹ï¸ [4:04:54 pm] INFO: Grace Period: STARTED {
2025-09-20T16:04:54:   action: 'STARTED',
2025-09-20T16:04:54:   remainingMs: 240000,
2025-09-20T16:04:54:   remainingSeconds: 240,
2025-09-20T16:04:54:   details: { startupTime: 1758364468462, processId: 15920 },
2025-09-20T16:04:54:   timestamp: 1758364494873
2025-09-20T16:04:54: }
2025-09-20T16:04:54: â„¹ï¸ [4:04:54 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:04:54:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:04:54:   remainingMs: 240000,
2025-09-20T16:04:54:   remainingSeconds: 240,
2025-09-20T16:04:54:   details: { startupTime: 1758364468462, willExpireAt: 1758364708462 },
2025-09-20T16:04:54:   timestamp: 1758364494874
2025-09-20T16:04:54: }
2025-09-20T16:04:54: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:04:54: â° Startup grace period: 240 seconds
2025-09-20T16:04:54: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:04:54: â„¹ï¸ [4:04:54 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:04:54:   initializationDuration: 26414,
2025-09-20T16:04:54:   gracePeriodActive: true,
2025-09-20T16:04:54:   messageRulesCount: 8,
2025-09-20T16:04:54:   messageTypes: [
2025-09-20T16:04:54:     'welcome',
2025-09-20T16:04:54:     'confirmation',
2025-09-20T16:04:54:     'ready',
2025-09-20T16:04:54:     'delivery',
2025-09-20T16:04:54:     'pickup_reminder',
2025-09-20T16:04:54:     'payment_reminder',
2025-09-20T16:04:54:     'fabric_welcome',
2025-09-20T16:04:54:     'fabric_purchase'
2025-09-20T16:04:54:   ],
2025-09-20T16:04:54:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:04:54:   databaseReady: true,
2025-09-20T16:04:54:   loggerReady: true,
2025-09-20T16:04:54:   processIsolationActive: true
2025-09-20T16:04:54: }
2025-09-20T16:04:54: âœ… Safety Manager initialized
2025-09-20T16:04:54: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:04:54: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:04:54: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:04:54: ğŸ“ Loaded statistics from file
2025-09-20T16:04:54: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:04:54: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:04:54: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:04:54: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:04:54: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:04:54: âœ… WhatsApp connection started
2025-09-20T16:04:54: ğŸ”§ Initializing admin commands...
2025-09-20T16:04:54: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:04:54: âœ… Admin commands system initialized
2025-09-20T16:04:54: ğŸ”„ Initializing polling functionality...
2025-09-20T16:04:54: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:04:54: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:04:54: ğŸ“ Attempting to request pairing code...
2025-09-20T16:04:54: ğŸ’¡ To use phone authentication:
2025-09-20T16:04:54:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:04:54:    2. Select "Phone Number Authentication"
2025-09-20T16:04:54:    3. Enter your phone number
2025-09-20T16:04:54:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:04:54: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:04:58: ğŸ’¾ Data synced to files successfully
2025-09-20T16:05:00: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:05:00: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:05:00: ğŸ”„ Reconnecting in 16s... (Attempt 5/10)
2025-09-20T16:05:16: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:05:16: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:05:16: âœ… Google Sheets API initialized
2025-09-20T16:05:16: âœ… Google Sheets API initialized
2025-09-20T16:05:16: â„¹ï¸ [4:05:16 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:05:16:   startupTime: 1758364468462,
2025-09-20T16:05:16:   gracePeriodMs: 240000,
2025-09-20T16:05:16:   dataDir: './safety-data',
2025-09-20T16:05:16:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:05:16:   processId: 15920,
2025-09-20T16:05:16:   nodeVersion: 'v22.19.0'
2025-09-20T16:05:16: }
2025-09-20T16:05:16: â„¹ï¸ [4:05:16 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:05:16: â„¹ï¸ [4:05:16 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:05:16: ğŸ§¹ Removed stale process lock
2025-09-20T16:05:16: ğŸ”’ Process lock acquired (PID: 15920)
2025-09-20T16:05:16: â„¹ï¸ [4:05:16 pm] INFO: Process isolation enforced {
2025-09-20T16:05:16:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:05:16:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:05:16:   processId: 15920
2025-09-20T16:05:16: }
2025-09-20T16:05:16: â° Starting 240 second startup grace period...
2025-09-20T16:05:16: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:05:16: â„¹ï¸ [4:05:16 pm] INFO: Grace Period: STARTED {
2025-09-20T16:05:16:   action: 'STARTED',
2025-09-20T16:05:16:   remainingMs: 240000,
2025-09-20T16:05:16:   remainingSeconds: 240,
2025-09-20T16:05:16:   details: { startupTime: 1758364468462, processId: 15920 },
2025-09-20T16:05:16:   timestamp: 1758364516944
2025-09-20T16:05:16: }
2025-09-20T16:05:16: â„¹ï¸ [4:05:16 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:05:16:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:05:16:   remainingMs: 240000,
2025-09-20T16:05:16:   remainingSeconds: 240,
2025-09-20T16:05:16:   details: { startupTime: 1758364468462, willExpireAt: 1758364708462 },
2025-09-20T16:05:16:   timestamp: 1758364516944
2025-09-20T16:05:16: }
2025-09-20T16:05:16: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:05:16: â° Startup grace period: 240 seconds
2025-09-20T16:05:16: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:05:16: â„¹ï¸ [4:05:16 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:05:16:   initializationDuration: 48485,
2025-09-20T16:05:16:   gracePeriodActive: true,
2025-09-20T16:05:16:   messageRulesCount: 8,
2025-09-20T16:05:16:   messageTypes: [
2025-09-20T16:05:16:     'welcome',
2025-09-20T16:05:16:     'confirmation',
2025-09-20T16:05:16:     'ready',
2025-09-20T16:05:16:     'delivery',
2025-09-20T16:05:16:     'pickup_reminder',
2025-09-20T16:05:16:     'payment_reminder',
2025-09-20T16:05:16:     'fabric_welcome',
2025-09-20T16:05:16:     'fabric_purchase'
2025-09-20T16:05:16:   ],
2025-09-20T16:05:16:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:05:16:   databaseReady: true,
2025-09-20T16:05:16:   loggerReady: true,
2025-09-20T16:05:16:   processIsolationActive: true
2025-09-20T16:05:16: }
2025-09-20T16:05:16: âœ… Safety Manager initialized
2025-09-20T16:05:16: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:05:16: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:05:16: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:05:16: ğŸ“ Loaded statistics from file
2025-09-20T16:05:16: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:05:16: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:05:16: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:05:16: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:05:16: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:05:16: âœ… WhatsApp connection started
2025-09-20T16:05:16: ğŸ”§ Initializing admin commands...
2025-09-20T16:05:16: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:05:16: âœ… Admin commands system initialized
2025-09-20T16:05:16: ğŸ”„ Initializing polling functionality...
2025-09-20T16:05:16: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:05:16: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:05:16: ğŸ“ Attempting to request pairing code...
2025-09-20T16:05:16: ğŸ’¡ To use phone authentication:
2025-09-20T16:05:16:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:05:16:    2. Select "Phone Number Authentication"
2025-09-20T16:05:16:    3. Enter your phone number
2025-09-20T16:05:16:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:05:16: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:05:18: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:05:18: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:05:18: ğŸ”„ Reconnecting in 30s... (Attempt 6/10)
2025-09-20T16:05:28: ğŸ’¾ Data synced to files successfully
2025-09-20T16:05:48: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:05:48: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:05:48: âœ… Google Sheets API initialized
2025-09-20T16:05:48: âœ… Google Sheets API initialized
2025-09-20T16:05:48: â„¹ï¸ [4:05:48 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:05:48:   startupTime: 1758364468462,
2025-09-20T16:05:48:   gracePeriodMs: 240000,
2025-09-20T16:05:48:   dataDir: './safety-data',
2025-09-20T16:05:48:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:05:48:   processId: 15920,
2025-09-20T16:05:48:   nodeVersion: 'v22.19.0'
2025-09-20T16:05:48: }
2025-09-20T16:05:48: â„¹ï¸ [4:05:48 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:05:48: â„¹ï¸ [4:05:48 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:05:48: ğŸ§¹ Removed stale process lock
2025-09-20T16:05:48: ğŸ”’ Process lock acquired (PID: 15920)
2025-09-20T16:05:48: â„¹ï¸ [4:05:48 pm] INFO: Process isolation enforced {
2025-09-20T16:05:48:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:05:48:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:05:48:   processId: 15920
2025-09-20T16:05:48: }
2025-09-20T16:05:48: â° Starting 240 second startup grace period...
2025-09-20T16:05:48: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:05:48: â„¹ï¸ [4:05:48 pm] INFO: Grace Period: STARTED {
2025-09-20T16:05:48:   action: 'STARTED',
2025-09-20T16:05:48:   remainingMs: 240000,
2025-09-20T16:05:48:   remainingSeconds: 240,
2025-09-20T16:05:48:   details: { startupTime: 1758364468462, processId: 15920 },
2025-09-20T16:05:48:   timestamp: 1758364548698
2025-09-20T16:05:48: }
2025-09-20T16:05:48: â„¹ï¸ [4:05:48 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:05:48:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:05:48:   remainingMs: 240000,
2025-09-20T16:05:48:   remainingSeconds: 240,
2025-09-20T16:05:48:   details: { startupTime: 1758364468462, willExpireAt: 1758364708462 },
2025-09-20T16:05:48:   timestamp: 1758364548698
2025-09-20T16:05:48: }
2025-09-20T16:05:48: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:05:48: â° Startup grace period: 240 seconds
2025-09-20T16:05:48: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:05:48: â„¹ï¸ [4:05:48 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:05:48:   initializationDuration: 80239,
2025-09-20T16:05:48:   gracePeriodActive: true,
2025-09-20T16:05:48:   messageRulesCount: 8,
2025-09-20T16:05:48:   messageTypes: [
2025-09-20T16:05:48:     'welcome',
2025-09-20T16:05:48:     'confirmation',
2025-09-20T16:05:48:     'ready',
2025-09-20T16:05:48:     'delivery',
2025-09-20T16:05:48:     'pickup_reminder',
2025-09-20T16:05:48:     'payment_reminder',
2025-09-20T16:05:48:     'fabric_welcome',
2025-09-20T16:05:48:     'fabric_purchase'
2025-09-20T16:05:48:   ],
2025-09-20T16:05:48:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:05:48:   databaseReady: true,
2025-09-20T16:05:48:   loggerReady: true,
2025-09-20T16:05:48:   processIsolationActive: true
2025-09-20T16:05:48: }
2025-09-20T16:05:48: âœ… Safety Manager initialized
2025-09-20T16:05:48: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:05:48: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:05:48: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:05:48: ğŸ“ Loaded statistics from file
2025-09-20T16:05:48: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:05:48: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:05:48: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:05:48: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:05:48: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:05:48: âœ… WhatsApp connection started
2025-09-20T16:05:48: ğŸ”§ Initializing admin commands...
2025-09-20T16:05:48: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:05:48: âœ… Admin commands system initialized
2025-09-20T16:05:48: ğŸ”„ Initializing polling functionality...
2025-09-20T16:05:48: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:05:48: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:05:48: ğŸ“ Attempting to request pairing code...
2025-09-20T16:05:48: ğŸ’¡ To use phone authentication:
2025-09-20T16:05:48:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:05:48:    2. Select "Phone Number Authentication"
2025-09-20T16:05:48:    3. Enter your phone number
2025-09-20T16:05:48:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:05:48: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:05:53: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:05:53: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:05:53: ğŸ”„ Reconnecting in 30s... (Attempt 7/10)
2025-09-20T16:05:58: ğŸ’¾ Data synced to files successfully
2025-09-20T16:06:23: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:06:23: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:06:23: âœ… Google Sheets API initialized
2025-09-20T16:06:23: âœ… Google Sheets API initialized
2025-09-20T16:06:23: â„¹ï¸ [4:06:23 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:06:23:   startupTime: 1758364468462,
2025-09-20T16:06:23:   gracePeriodMs: 240000,
2025-09-20T16:06:23:   dataDir: './safety-data',
2025-09-20T16:06:23:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:06:23:   processId: 15920,
2025-09-20T16:06:23:   nodeVersion: 'v22.19.0'
2025-09-20T16:06:23: }
2025-09-20T16:06:23: â„¹ï¸ [4:06:23 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:06:23: â„¹ï¸ [4:06:23 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:06:23: ğŸ§¹ Removed stale process lock
2025-09-20T16:06:23: ğŸ”’ Process lock acquired (PID: 15920)
2025-09-20T16:06:23: â„¹ï¸ [4:06:23 pm] INFO: Process isolation enforced {
2025-09-20T16:06:23:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:06:23:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:06:23:   processId: 15920
2025-09-20T16:06:23: }
2025-09-20T16:06:23: â° Starting 240 second startup grace period...
2025-09-20T16:06:23: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:06:23: â„¹ï¸ [4:06:23 pm] INFO: Grace Period: STARTED {
2025-09-20T16:06:23:   action: 'STARTED',
2025-09-20T16:06:23:   remainingMs: 240000,
2025-09-20T16:06:23:   remainingSeconds: 240,
2025-09-20T16:06:23:   details: { startupTime: 1758364468462, processId: 15920 },
2025-09-20T16:06:23:   timestamp: 1758364583639
2025-09-20T16:06:23: }
2025-09-20T16:06:23: â„¹ï¸ [4:06:23 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:06:23:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:06:23:   remainingMs: 240000,
2025-09-20T16:06:23:   remainingSeconds: 240,
2025-09-20T16:06:23:   details: { startupTime: 1758364468462, willExpireAt: 1758364708462 },
2025-09-20T16:06:23:   timestamp: 1758364583640
2025-09-20T16:06:23: }
2025-09-20T16:06:23: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:06:23: â° Startup grace period: 240 seconds
2025-09-20T16:06:23: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:06:23: â„¹ï¸ [4:06:23 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:06:23:   initializationDuration: 115180,
2025-09-20T16:06:23:   gracePeriodActive: true,
2025-09-20T16:06:23:   messageRulesCount: 8,
2025-09-20T16:06:23:   messageTypes: [
2025-09-20T16:06:23:     'welcome',
2025-09-20T16:06:23:     'confirmation',
2025-09-20T16:06:23:     'ready',
2025-09-20T16:06:23:     'delivery',
2025-09-20T16:06:23:     'pickup_reminder',
2025-09-20T16:06:23:     'payment_reminder',
2025-09-20T16:06:23:     'fabric_welcome',
2025-09-20T16:06:23:     'fabric_purchase'
2025-09-20T16:06:23:   ],
2025-09-20T16:06:23:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:06:23:   databaseReady: true,
2025-09-20T16:06:23:   loggerReady: true,
2025-09-20T16:06:23:   processIsolationActive: true
2025-09-20T16:06:23: }
2025-09-20T16:06:23: âœ… Safety Manager initialized
2025-09-20T16:06:23: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:06:23: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:06:23: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:06:23: ğŸ“ Loaded statistics from file
2025-09-20T16:06:23: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:06:23: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:06:23: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:06:23: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:06:23: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:06:23: âœ… WhatsApp connection started
2025-09-20T16:06:23: ğŸ”§ Initializing admin commands...
2025-09-20T16:06:23: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:06:23: âœ… Admin commands system initialized
2025-09-20T16:06:23: ğŸ”„ Initializing polling functionality...
2025-09-20T16:06:23: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:06:23: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:06:23: ğŸ“ Attempting to request pairing code...
2025-09-20T16:06:23: ğŸ’¡ To use phone authentication:
2025-09-20T16:06:23:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:06:23:    2. Select "Phone Number Authentication"
2025-09-20T16:06:23:    3. Enter your phone number
2025-09-20T16:06:23:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:06:23: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:06:28: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:06:28: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:06:28: ğŸ”„ Reconnecting in 30s... (Attempt 8/10)
2025-09-20T16:06:28: ğŸ’¾ Data synced to files successfully
2025-09-20T16:06:58: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:06:58: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:06:58: âœ… Google Sheets API initialized
2025-09-20T16:06:58: âœ… Google Sheets API initialized
2025-09-20T16:06:58: â„¹ï¸ [4:06:58 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:06:58:   startupTime: 1758364468462,
2025-09-20T16:06:58:   gracePeriodMs: 240000,
2025-09-20T16:06:58:   dataDir: './safety-data',
2025-09-20T16:06:58:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:06:58:   processId: 15920,
2025-09-20T16:06:58:   nodeVersion: 'v22.19.0'
2025-09-20T16:06:58: }
2025-09-20T16:06:58: â„¹ï¸ [4:06:58 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:06:58: â„¹ï¸ [4:06:58 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:06:58: ğŸ§¹ Removed stale process lock
2025-09-20T16:06:58: ğŸ”’ Process lock acquired (PID: 15920)
2025-09-20T16:06:58: â„¹ï¸ [4:06:58 pm] INFO: Process isolation enforced {
2025-09-20T16:06:58:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:06:58:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:06:58:   processId: 15920
2025-09-20T16:06:58: }
2025-09-20T16:06:58: â° Starting 240 second startup grace period...
2025-09-20T16:06:58: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:06:58: â„¹ï¸ [4:06:58 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:06:58:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:06:58:   remainingMs: 240000,
2025-09-20T16:06:58:   remainingSeconds: 240,
2025-09-20T16:06:58:   details: { startupTime: 1758364468462, willExpireAt: 1758364708462 },
2025-09-20T16:06:58:   timestamp: 1758364618474
2025-09-20T16:06:58: }
2025-09-20T16:06:58: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:06:58: â° Startup grace period: 240 seconds
2025-09-20T16:06:58: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:06:58: â„¹ï¸ [4:06:58 pm] INFO: Grace Period: STARTED {
2025-09-20T16:06:58:   action: 'STARTED',
2025-09-20T16:06:58:   remainingMs: 240000,
2025-09-20T16:06:58:   remainingSeconds: 240,
2025-09-20T16:06:58:   details: { startupTime: 1758364468462, processId: 15920 },
2025-09-20T16:06:58:   timestamp: 1758364618474
2025-09-20T16:06:58: }
2025-09-20T16:06:58: â„¹ï¸ [4:06:58 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:06:58:   initializationDuration: 150014,
2025-09-20T16:06:58:   gracePeriodActive: true,
2025-09-20T16:06:58:   messageRulesCount: 8,
2025-09-20T16:06:58:   messageTypes: [
2025-09-20T16:06:58:     'welcome',
2025-09-20T16:06:58:     'confirmation',
2025-09-20T16:06:58:     'ready',
2025-09-20T16:06:58:     'delivery',
2025-09-20T16:06:58:     'pickup_reminder',
2025-09-20T16:06:58:     'payment_reminder',
2025-09-20T16:06:58:     'fabric_welcome',
2025-09-20T16:06:58:     'fabric_purchase'
2025-09-20T16:06:58:   ],
2025-09-20T16:06:58:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:06:58:   databaseReady: true,
2025-09-20T16:06:58:   loggerReady: true,
2025-09-20T16:06:58:   processIsolationActive: true
2025-09-20T16:06:58: }
2025-09-20T16:06:58: âœ… Safety Manager initialized
2025-09-20T16:06:58: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:06:58: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:06:58: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:06:58: ğŸ“ Loaded statistics from file
2025-09-20T16:06:58: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:06:58: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:06:58: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:06:58: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:06:58: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:06:58: âœ… WhatsApp connection started
2025-09-20T16:06:58: ğŸ”§ Initializing admin commands...
2025-09-20T16:06:58: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:06:58: âœ… Admin commands system initialized
2025-09-20T16:06:58: ğŸ”„ Initializing polling functionality...
2025-09-20T16:06:58: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:06:58: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:06:58: ğŸ“ Attempting to request pairing code...
2025-09-20T16:06:58: ğŸ’¡ To use phone authentication:
2025-09-20T16:06:58:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:06:58:    2. Select "Phone Number Authentication"
2025-09-20T16:06:58:    3. Enter your phone number
2025-09-20T16:06:58:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:06:58: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:06:58: ğŸ’¾ Data synced to files successfully
2025-09-20T16:06:59: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:06:59: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:06:59: ğŸ”„ Reconnecting in 30s... (Attempt 9/10)
2025-09-20T16:07:28: ğŸ’¾ Data synced to files successfully
2025-09-20T16:07:29: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:07:29: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:07:29: âœ… Google Sheets API initialized
2025-09-20T16:07:29: âœ… Google Sheets API initialized
2025-09-20T16:07:29: â„¹ï¸ [4:07:29 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:07:29:   startupTime: 1758364468462,
2025-09-20T16:07:29:   gracePeriodMs: 240000,
2025-09-20T16:07:29:   dataDir: './safety-data',
2025-09-20T16:07:29:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:07:29:   processId: 15920,
2025-09-20T16:07:29:   nodeVersion: 'v22.19.0'
2025-09-20T16:07:29: }
2025-09-20T16:07:29: â„¹ï¸ [4:07:29 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:07:29: â„¹ï¸ [4:07:29 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:07:29: ğŸ§¹ Removed stale process lock
2025-09-20T16:07:29: ğŸ”’ Process lock acquired (PID: 15920)
2025-09-20T16:07:29: â„¹ï¸ [4:07:29 pm] INFO: Process isolation enforced {
2025-09-20T16:07:29:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:07:29:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:07:29:   processId: 15920
2025-09-20T16:07:29: }
2025-09-20T16:07:29: â° Starting 240 second startup grace period...
2025-09-20T16:07:29: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:07:29: â„¹ï¸ [4:07:29 pm] INFO: Grace Period: STARTED {
2025-09-20T16:07:29:   action: 'STARTED',
2025-09-20T16:07:29:   remainingMs: 240000,
2025-09-20T16:07:29:   remainingSeconds: 240,
2025-09-20T16:07:29:   details: { startupTime: 1758364468462, processId: 15920 },
2025-09-20T16:07:29:   timestamp: 1758364649987
2025-09-20T16:07:29: }
2025-09-20T16:07:29: â„¹ï¸ [4:07:29 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:07:29:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:07:29:   remainingMs: 240000,
2025-09-20T16:07:29:   remainingSeconds: 240,
2025-09-20T16:07:29:   details: { startupTime: 1758364468462, willExpireAt: 1758364708462 },
2025-09-20T16:07:29:   timestamp: 1758364649987
2025-09-20T16:07:29: }
2025-09-20T16:07:29: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:07:29: â° Startup grace period: 240 seconds
2025-09-20T16:07:29: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:07:29: â„¹ï¸ [4:07:29 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:07:29:   initializationDuration: 181529,
2025-09-20T16:07:29:   gracePeriodActive: true,
2025-09-20T16:07:29:   messageRulesCount: 8,
2025-09-20T16:07:29:   messageTypes: [
2025-09-20T16:07:29:     'welcome',
2025-09-20T16:07:29:     'confirmation',
2025-09-20T16:07:29:     'ready',
2025-09-20T16:07:29:     'delivery',
2025-09-20T16:07:29:     'pickup_reminder',
2025-09-20T16:07:29:     'payment_reminder',
2025-09-20T16:07:29:     'fabric_welcome',
2025-09-20T16:07:29:     'fabric_purchase'
2025-09-20T16:07:29:   ],
2025-09-20T16:07:29:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:07:29:   databaseReady: true,
2025-09-20T16:07:29:   loggerReady: true,
2025-09-20T16:07:29:   processIsolationActive: true
2025-09-20T16:07:29: }
2025-09-20T16:07:29: âœ… Safety Manager initialized
2025-09-20T16:07:29: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:07:30: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:07:30: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:07:30: ğŸ“ Loaded statistics from file
2025-09-20T16:07:30: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:07:30: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:07:30: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:07:30: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:07:30: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:07:30: âœ… WhatsApp connection started
2025-09-20T16:07:30: ğŸ”§ Initializing admin commands...
2025-09-20T16:07:30: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:07:30: âœ… Admin commands system initialized
2025-09-20T16:07:30: ğŸ”„ Initializing polling functionality...
2025-09-20T16:07:30: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:07:30: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:07:30: ğŸ“ Attempting to request pairing code...
2025-09-20T16:07:30: ğŸ’¡ To use phone authentication:
2025-09-20T16:07:30:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:07:30:    2. Select "Phone Number Authentication"
2025-09-20T16:07:30:    3. Enter your phone number
2025-09-20T16:07:30:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:07:30: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:07:34: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:07:34: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:07:34: ğŸ”„ Reconnecting in 30s... (Attempt 10/10)
2025-09-20T16:07:58: ğŸ’¾ Data synced to files successfully
2025-09-20T16:08:04: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:08:04: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:08:04: âœ… Google Sheets API initialized
2025-09-20T16:08:04: âœ… Google Sheets API initialized
2025-09-20T16:08:04: â„¹ï¸ [4:08:04 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:08:04:   startupTime: 1758364468462,
2025-09-20T16:08:04:   gracePeriodMs: 240000,
2025-09-20T16:08:04:   dataDir: './safety-data',
2025-09-20T16:08:04:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:08:04:   processId: 15920,
2025-09-20T16:08:04:   nodeVersion: 'v22.19.0'
2025-09-20T16:08:04: }
2025-09-20T16:08:04: â„¹ï¸ [4:08:04 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:08:04: â„¹ï¸ [4:08:04 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:08:04: ğŸ§¹ Removed stale process lock
2025-09-20T16:08:04: ğŸ”’ Process lock acquired (PID: 15920)
2025-09-20T16:08:04: â„¹ï¸ [4:08:04 pm] INFO: Process isolation enforced {
2025-09-20T16:08:04:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:08:04:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:08:04:   processId: 15920
2025-09-20T16:08:04: }
2025-09-20T16:08:04: â° Starting 240 second startup grace period...
2025-09-20T16:08:04: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:08:04: â„¹ï¸ [4:08:04 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:08:04:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:08:04:   remainingMs: 240000,
2025-09-20T16:08:04:   remainingSeconds: 240,
2025-09-20T16:08:04:   details: { startupTime: 1758364468462, willExpireAt: 1758364708462 },
2025-09-20T16:08:04:   timestamp: 1758364684388
2025-09-20T16:08:04: }
2025-09-20T16:08:04: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:08:04: â° Startup grace period: 240 seconds
2025-09-20T16:08:04: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:08:04: â„¹ï¸ [4:08:04 pm] INFO: Grace Period: STARTED {
2025-09-20T16:08:04:   action: 'STARTED',
2025-09-20T16:08:04:   remainingMs: 240000,
2025-09-20T16:08:04:   remainingSeconds: 240,
2025-09-20T16:08:04:   details: { startupTime: 1758364468462, processId: 15920 },
2025-09-20T16:08:04:   timestamp: 1758364684387
2025-09-20T16:08:04: }
2025-09-20T16:08:04: â„¹ï¸ [4:08:04 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:08:04:   initializationDuration: 215932,
2025-09-20T16:08:04:   gracePeriodActive: true,
2025-09-20T16:08:04:   messageRulesCount: 8,
2025-09-20T16:08:04:   messageTypes: [
2025-09-20T16:08:04:     'welcome',
2025-09-20T16:08:04:     'confirmation',
2025-09-20T16:08:04:     'ready',
2025-09-20T16:08:04:     'delivery',
2025-09-20T16:08:04:     'pickup_reminder',
2025-09-20T16:08:04:     'payment_reminder',
2025-09-20T16:08:04:     'fabric_welcome',
2025-09-20T16:08:04:     'fabric_purchase'
2025-09-20T16:08:04:   ],
2025-09-20T16:08:04:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:08:04:   databaseReady: true,
2025-09-20T16:08:04:   loggerReady: true,
2025-09-20T16:08:04:   processIsolationActive: true
2025-09-20T16:08:04: }
2025-09-20T16:08:04: âœ… Safety Manager initialized
2025-09-20T16:08:04: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:08:04: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:08:04: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:08:04: ğŸ“ Loaded statistics from file
2025-09-20T16:08:04: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:08:04: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:08:04: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:08:04: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:08:04: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:08:04: âœ… WhatsApp connection started
2025-09-20T16:08:04: ğŸ”§ Initializing admin commands...
2025-09-20T16:08:04: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:08:04: âœ… Admin commands system initialized
2025-09-20T16:08:04: ğŸ”„ Initializing polling functionality...
2025-09-20T16:08:04: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:08:04: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:08:04: ğŸ“ Attempting to request pairing code...
2025-09-20T16:08:04: ğŸ’¡ To use phone authentication:
2025-09-20T16:08:04:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:08:04:    2. Select "Phone Number Authentication"
2025-09-20T16:08:04:    3. Enter your phone number
2025-09-20T16:08:04:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:08:04: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:08:06: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:08:06: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:08:06: âŒ Max reconnection attempts reached. Please restart the bot or check your internet connection.
2025-09-20T16:08:06: ğŸ’¡ You can visit http://localhost:3001 to see the status and authenticate again.
2025-09-20T16:08:29: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T16:08:29: ğŸ“ Loaded 11 template types
2025-09-20T16:08:29: ğŸ”§ WhatsApp Bot initialized
2025-09-20T16:08:29: ğŸ“Š Configuration status: undefined
2025-09-20T16:08:29: âœ… Atomic State Manager initialized
2025-09-20T16:08:29: ğŸ“ Enhanced Logger initialized
2025-09-20T16:08:29: âœ… Google credentials loaded from service-account.json file
2025-09-20T16:08:29: ğŸ“± WhatsApp auth status: âœ… credentials, 5 session files
2025-09-20T16:08:29: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-20T16:08:29:    Auth Mode: both
2025-09-20T16:08:29:    QR Enabled: true
2025-09-20T16:08:29:    Phone Enabled: true
2025-09-20T16:08:29:    Session Persistence: true
2025-09-20T16:08:29:    Max Reconnect Attempts: 10
2025-09-20T16:08:29:    Default Phone: None
2025-09-20T16:08:29: ğŸ”’ Session validation enabled (check every 300s)
2025-09-20T16:08:29: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-20T16:08:29: ğŸ”§ Developer Configuration initialized
2025-09-20T16:08:29: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T16:08:29: â„¹ï¸ [4:08:29 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:08:29:   startupTime: 1758364709074,
2025-09-20T16:08:29:   gracePeriodMs: 240000,
2025-09-20T16:08:29:   dataDir: './safety-data',
2025-09-20T16:08:29:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:08:29:   processId: 13172,
2025-09-20T16:08:29:   nodeVersion: 'v22.19.0'
2025-09-20T16:08:29: }
2025-09-20T16:08:29: ğŸ”§ Developer Configuration initialized
2025-09-20T16:08:29: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T16:08:29: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-20T16:08:29: â° 4-minute startup delay active
2025-09-20T16:08:29: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-20T16:08:29: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-20T16:08:29: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:08:29: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:08:29: âœ… Google Sheets API initialized
2025-09-20T16:08:29: âœ… Google Sheets API initialized
2025-09-20T16:08:29: â„¹ï¸ [4:08:29 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:08:29:   startupTime: 1758364709074,
2025-09-20T16:08:29:   gracePeriodMs: 240000,
2025-09-20T16:08:29:   dataDir: './safety-data',
2025-09-20T16:08:29:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:08:29:   processId: 13172,
2025-09-20T16:08:29:   nodeVersion: 'v22.19.0'
2025-09-20T16:08:29: }
2025-09-20T16:08:29: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:08:29: â„¹ï¸ [4:08:29 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:08:29: â„¹ï¸ [4:08:29 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:08:29: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:08:29: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:08:29: â„¹ï¸ [4:08:29 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:08:29: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T09-11-54-589Z.log
2025-09-20T16:08:29: ğŸ“ Enhanced Logger initialized
2025-09-20T16:08:29: â„¹ï¸ [4:08:29 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:08:29: ğŸ“ Loaded statistics from file
2025-09-20T16:08:29: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:08:29: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:08:29: ğŸ§¹ Removed stale process lock
2025-09-20T16:08:29: ğŸ§¹ Lock file already cleaned up
2025-09-20T16:08:29: ğŸ”’ Process lock acquired (PID: 13172)
2025-09-20T16:08:29: ğŸ”’ Process lock acquired (PID: 13172)
2025-09-20T16:08:29: â„¹ï¸ [4:08:29 pm] INFO: Process isolation enforced {
2025-09-20T16:08:29:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:08:29:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:08:29:   processId: 13172
2025-09-20T16:08:29: }
2025-09-20T16:08:29: â° Starting 240 second startup grace period...
2025-09-20T16:08:29: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:08:29: â„¹ï¸ [4:08:29 pm] INFO: Process isolation enforced {
2025-09-20T16:08:29:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:08:29:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:08:29:   processId: 13172
2025-09-20T16:08:29: }
2025-09-20T16:08:29: â° Starting 240 second startup grace period...
2025-09-20T16:08:29: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:08:29: â„¹ï¸ [4:08:29 pm] INFO: Grace Period: STARTED {
2025-09-20T16:08:29:   action: 'STARTED',
2025-09-20T16:08:29:   remainingMs: 240000,
2025-09-20T16:08:29:   remainingSeconds: 240,
2025-09-20T16:08:29:   details: { startupTime: 1758364709074, processId: 13172 },
2025-09-20T16:08:29:   timestamp: 1758364709165
2025-09-20T16:08:29: }
2025-09-20T16:08:29: â„¹ï¸ [4:08:29 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:08:29:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:08:29:   remainingMs: 240000,
2025-09-20T16:08:29:   remainingSeconds: 240,
2025-09-20T16:08:29:   details: { startupTime: 1758364709074, willExpireAt: 1758364949074 },
2025-09-20T16:08:29:   timestamp: 1758364709166
2025-09-20T16:08:29: }
2025-09-20T16:08:29: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:08:29: â° Startup grace period: 240 seconds
2025-09-20T16:08:29: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:08:29: â„¹ï¸ [4:08:29 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:08:29:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:08:29:   remainingMs: 240000,
2025-09-20T16:08:29:   remainingSeconds: 240,
2025-09-20T16:08:29:   details: { startupTime: 1758364709074, willExpireAt: 1758364949074 },
2025-09-20T16:08:29:   timestamp: 1758364709170
2025-09-20T16:08:29: }
2025-09-20T16:08:29: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:08:29: â° Startup grace period: 240 seconds
2025-09-20T16:08:29: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:08:29: â„¹ï¸ [4:08:29 pm] INFO: Grace Period: STARTED {
2025-09-20T16:08:29:   action: 'STARTED',
2025-09-20T16:08:29:   remainingMs: 240000,
2025-09-20T16:08:29:   remainingSeconds: 240,
2025-09-20T16:08:29:   details: { startupTime: 1758364709074, processId: 13172 },
2025-09-20T16:08:29:   timestamp: 1758364709169
2025-09-20T16:08:29: }
2025-09-20T16:08:29: â„¹ï¸ [4:08:29 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:08:29:   initializationDuration: 100,
2025-09-20T16:08:29:   gracePeriodActive: true,
2025-09-20T16:08:29:   messageRulesCount: 8,
2025-09-20T16:08:29:   messageTypes: [
2025-09-20T16:08:29:     'welcome',
2025-09-20T16:08:29:     'confirmation',
2025-09-20T16:08:29:     'ready',
2025-09-20T16:08:29:     'delivery',
2025-09-20T16:08:29:     'pickup_reminder',
2025-09-20T16:08:29:     'payment_reminder',
2025-09-20T16:08:29:     'fabric_welcome',
2025-09-20T16:08:29:     'fabric_purchase'
2025-09-20T16:08:29:   ],
2025-09-20T16:08:29:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:08:29:   databaseReady: true,
2025-09-20T16:08:29:   loggerReady: true,
2025-09-20T16:08:29:   processIsolationActive: true
2025-09-20T16:08:29: }
2025-09-20T16:08:29: â„¹ï¸ [4:08:29 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:08:29:   initializationDuration: 102,
2025-09-20T16:08:29:   gracePeriodActive: true,
2025-09-20T16:08:29:   messageRulesCount: 8,
2025-09-20T16:08:29:   messageTypes: [
2025-09-20T16:08:29:     'welcome',
2025-09-20T16:08:29:     'confirmation',
2025-09-20T16:08:29:     'ready',
2025-09-20T16:08:29:     'delivery',
2025-09-20T16:08:29:     'pickup_reminder',
2025-09-20T16:08:29:     'payment_reminder',
2025-09-20T16:08:29:     'fabric_welcome',
2025-09-20T16:08:29:     'fabric_purchase'
2025-09-20T16:08:29:   ],
2025-09-20T16:08:29:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:08:29:   databaseReady: true,
2025-09-20T16:08:29:   loggerReady: true,
2025-09-20T16:08:29:   processIsolationActive: true
2025-09-20T16:08:29: }
2025-09-20T16:08:29: âœ… Safety Manager initialized
2025-09-20T16:08:29: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:08:29: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:08:29: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:08:29: ğŸ“ Loaded statistics from file
2025-09-20T16:08:29: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:08:29: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:08:29: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:08:29: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:08:29: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:08:29: âœ… WhatsApp connection started
2025-09-20T16:08:29: ğŸ”§ Initializing admin commands...
2025-09-20T16:08:29: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:08:29: âœ… Admin commands system initialized
2025-09-20T16:08:29: ğŸ”„ Initializing polling functionality...
2025-09-20T16:08:29: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:08:29: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:08:29: ğŸ“ Attempting to request pairing code...
2025-09-20T16:08:29: ğŸ’¡ To use phone authentication:
2025-09-20T16:08:29:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:08:29:    2. Select "Phone Number Authentication"
2025-09-20T16:08:29:    3. Enter your phone number
2025-09-20T16:08:29:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:08:29: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:08:31: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:08:31: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:08:31: ğŸ”„ Reconnecting in 1s... (Attempt 1/10)
2025-09-20T16:08:32: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:08:32: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:08:32: âœ… Google Sheets API initialized
2025-09-20T16:08:32: âœ… Google Sheets API initialized
2025-09-20T16:08:32: â„¹ï¸ [4:08:32 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:08:32:   startupTime: 1758364709074,
2025-09-20T16:08:32:   gracePeriodMs: 240000,
2025-09-20T16:08:32:   dataDir: './safety-data',
2025-09-20T16:08:32:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:08:32:   processId: 13172,
2025-09-20T16:08:32:   nodeVersion: 'v22.19.0'
2025-09-20T16:08:32: }
2025-09-20T16:08:32: â„¹ï¸ [4:08:32 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:08:32: â„¹ï¸ [4:08:32 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:08:32: ğŸ§¹ Removed stale process lock
2025-09-20T16:08:32: ğŸ”’ Process lock acquired (PID: 13172)
2025-09-20T16:08:32: â„¹ï¸ [4:08:32 pm] INFO: Process isolation enforced {
2025-09-20T16:08:32:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:08:32:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:08:32:   processId: 13172
2025-09-20T16:08:32: }
2025-09-20T16:08:32: â° Starting 240 second startup grace period...
2025-09-20T16:08:32: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:08:32: â„¹ï¸ [4:08:32 pm] INFO: Grace Period: STARTED {
2025-09-20T16:08:32:   action: 'STARTED',
2025-09-20T16:08:32:   remainingMs: 240000,
2025-09-20T16:08:32:   remainingSeconds: 240,
2025-09-20T16:08:32:   details: { startupTime: 1758364709074, processId: 13172 },
2025-09-20T16:08:32:   timestamp: 1758364712554
2025-09-20T16:08:32: }
2025-09-20T16:08:32: â„¹ï¸ [4:08:32 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:08:32:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:08:32:   remainingMs: 240000,
2025-09-20T16:08:32:   remainingSeconds: 240,
2025-09-20T16:08:32:   details: { startupTime: 1758364709074, willExpireAt: 1758364949074 },
2025-09-20T16:08:32:   timestamp: 1758364712554
2025-09-20T16:08:32: }
2025-09-20T16:08:32: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:08:32: â° Startup grace period: 240 seconds
2025-09-20T16:08:32: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:08:32: â„¹ï¸ [4:08:32 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:08:32:   initializationDuration: 3483,
2025-09-20T16:08:32:   gracePeriodActive: true,
2025-09-20T16:08:32:   messageRulesCount: 8,
2025-09-20T16:08:32:   messageTypes: [
2025-09-20T16:08:32:     'welcome',
2025-09-20T16:08:32:     'confirmation',
2025-09-20T16:08:32:     'ready',
2025-09-20T16:08:32:     'delivery',
2025-09-20T16:08:32:     'pickup_reminder',
2025-09-20T16:08:32:     'payment_reminder',
2025-09-20T16:08:32:     'fabric_welcome',
2025-09-20T16:08:32:     'fabric_purchase'
2025-09-20T16:08:32:   ],
2025-09-20T16:08:32:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:08:32:   databaseReady: true,
2025-09-20T16:08:32:   loggerReady: true,
2025-09-20T16:08:32:   processIsolationActive: true
2025-09-20T16:08:32: }
2025-09-20T16:08:32: âœ… Safety Manager initialized
2025-09-20T16:08:32: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:08:32: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:08:32: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:08:32: ğŸ“ Loaded statistics from file
2025-09-20T16:08:32: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:08:32: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:08:32: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:08:32: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:08:32: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:08:32: âœ… WhatsApp connection started
2025-09-20T16:08:32: ğŸ”§ Initializing admin commands...
2025-09-20T16:08:32: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:08:32: âœ… Admin commands system initialized
2025-09-20T16:08:32: ğŸ”„ Initializing polling functionality...
2025-09-20T16:08:32: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:08:32: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:08:32: ğŸ“ Attempting to request pairing code...
2025-09-20T16:08:32: ğŸ’¡ To use phone authentication:
2025-09-20T16:08:32:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:08:32:    2. Select "Phone Number Authentication"
2025-09-20T16:08:32:    3. Enter your phone number
2025-09-20T16:08:32:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:08:32: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:08:35: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:08:35: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:08:35: ğŸ”„ Reconnecting in 2s... (Attempt 2/10)
2025-09-20T16:08:37: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:08:37: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:08:37: âœ… Google Sheets API initialized
2025-09-20T16:08:37: âœ… Google Sheets API initialized
2025-09-20T16:08:37: â„¹ï¸ [4:08:37 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:08:37:   startupTime: 1758364709074,
2025-09-20T16:08:37:   gracePeriodMs: 240000,
2025-09-20T16:08:37:   dataDir: './safety-data',
2025-09-20T16:08:37:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:08:37:   processId: 13172,
2025-09-20T16:08:37:   nodeVersion: 'v22.19.0'
2025-09-20T16:08:37: }
2025-09-20T16:08:37: â„¹ï¸ [4:08:37 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:08:37: â„¹ï¸ [4:08:37 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:08:37: ğŸ§¹ Removed stale process lock
2025-09-20T16:08:37: ğŸ”’ Process lock acquired (PID: 13172)
2025-09-20T16:08:37: â„¹ï¸ [4:08:37 pm] INFO: Process isolation enforced {
2025-09-20T16:08:37:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:08:37:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:08:37:   processId: 13172
2025-09-20T16:08:37: }
2025-09-20T16:08:37: â° Starting 240 second startup grace period...
2025-09-20T16:08:37: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:08:37: â„¹ï¸ [4:08:37 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:08:37:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:08:37:   remainingMs: 240000,
2025-09-20T16:08:37:   remainingSeconds: 240,
2025-09-20T16:08:37:   details: { startupTime: 1758364709074, willExpireAt: 1758364949074 },
2025-09-20T16:08:37:   timestamp: 1758364717963
2025-09-20T16:08:37: }
2025-09-20T16:08:37: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:08:37: â° Startup grace period: 240 seconds
2025-09-20T16:08:37: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:08:37: â„¹ï¸ [4:08:37 pm] INFO: Grace Period: STARTED {
2025-09-20T16:08:37:   action: 'STARTED',
2025-09-20T16:08:37:   remainingMs: 240000,
2025-09-20T16:08:37:   remainingSeconds: 240,
2025-09-20T16:08:37:   details: { startupTime: 1758364709074, processId: 13172 },
2025-09-20T16:08:37:   timestamp: 1758364717962
2025-09-20T16:08:37: }
2025-09-20T16:08:37: â„¹ï¸ [4:08:37 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:08:37:   initializationDuration: 8891,
2025-09-20T16:08:37:   gracePeriodActive: true,
2025-09-20T16:08:37:   messageRulesCount: 8,
2025-09-20T16:08:37:   messageTypes: [
2025-09-20T16:08:37:     'welcome',
2025-09-20T16:08:37:     'confirmation',
2025-09-20T16:08:37:     'ready',
2025-09-20T16:08:37:     'delivery',
2025-09-20T16:08:37:     'pickup_reminder',
2025-09-20T16:08:37:     'payment_reminder',
2025-09-20T16:08:37:     'fabric_welcome',
2025-09-20T16:08:37:     'fabric_purchase'
2025-09-20T16:08:37:   ],
2025-09-20T16:08:37:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:08:37:   databaseReady: true,
2025-09-20T16:08:37:   loggerReady: true,
2025-09-20T16:08:37:   processIsolationActive: true
2025-09-20T16:08:37: }
2025-09-20T16:08:37: âœ… Safety Manager initialized
2025-09-20T16:08:37: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:08:37: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:08:37: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:08:37: ğŸ“ Loaded statistics from file
2025-09-20T16:08:37: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:08:37: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:08:37: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:08:37: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:08:37: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:08:37: âœ… WhatsApp connection started
2025-09-20T16:08:37: ğŸ”§ Initializing admin commands...
2025-09-20T16:08:37: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:08:37: âœ… Admin commands system initialized
2025-09-20T16:08:37: ğŸ”„ Initializing polling functionality...
2025-09-20T16:08:37: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:08:37: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:08:37: ğŸ“ Attempting to request pairing code...
2025-09-20T16:08:37: ğŸ’¡ To use phone authentication:
2025-09-20T16:08:37:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:08:37:    2. Select "Phone Number Authentication"
2025-09-20T16:08:37:    3. Enter your phone number
2025-09-20T16:08:37:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:08:37: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:08:39: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:08:39: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:08:39: ğŸ”„ Reconnecting in 4s... (Attempt 3/10)
2025-09-20T16:08:43: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:08:43: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:08:43: âœ… Google Sheets API initialized
2025-09-20T16:08:43: âœ… Google Sheets API initialized
2025-09-20T16:08:43: â„¹ï¸ [4:08:43 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:08:43:   startupTime: 1758364709074,
2025-09-20T16:08:43:   gracePeriodMs: 240000,
2025-09-20T16:08:43:   dataDir: './safety-data',
2025-09-20T16:08:43:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:08:43:   processId: 13172,
2025-09-20T16:08:43:   nodeVersion: 'v22.19.0'
2025-09-20T16:08:43: }
2025-09-20T16:08:43: â„¹ï¸ [4:08:43 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:08:43: â„¹ï¸ [4:08:43 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:08:43: ğŸ§¹ Removed stale process lock
2025-09-20T16:08:43: ğŸ”’ Process lock acquired (PID: 13172)
2025-09-20T16:08:43: â„¹ï¸ [4:08:43 pm] INFO: Process isolation enforced {
2025-09-20T16:08:43:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:08:43:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:08:43:   processId: 13172
2025-09-20T16:08:43: }
2025-09-20T16:08:43: â° Starting 240 second startup grace period...
2025-09-20T16:08:43: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:08:43: â„¹ï¸ [4:08:43 pm] INFO: Grace Period: STARTED {
2025-09-20T16:08:43:   action: 'STARTED',
2025-09-20T16:08:43:   remainingMs: 240000,
2025-09-20T16:08:43:   remainingSeconds: 240,
2025-09-20T16:08:43:   details: { startupTime: 1758364709074, processId: 13172 },
2025-09-20T16:08:43:   timestamp: 1758364723521
2025-09-20T16:08:43: }
2025-09-20T16:08:43: â„¹ï¸ [4:08:43 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:08:43:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:08:43:   remainingMs: 240000,
2025-09-20T16:08:43:   remainingSeconds: 240,
2025-09-20T16:08:43:   details: { startupTime: 1758364709074, willExpireAt: 1758364949074 },
2025-09-20T16:08:43:   timestamp: 1758364723521
2025-09-20T16:08:43: }
2025-09-20T16:08:43: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:08:43: â° Startup grace period: 240 seconds
2025-09-20T16:08:43: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:08:43: â„¹ï¸ [4:08:43 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:08:43:   initializationDuration: 14450,
2025-09-20T16:08:43:   gracePeriodActive: true,
2025-09-20T16:08:43:   messageRulesCount: 8,
2025-09-20T16:08:43:   messageTypes: [
2025-09-20T16:08:43:     'welcome',
2025-09-20T16:08:43:     'confirmation',
2025-09-20T16:08:43:     'ready',
2025-09-20T16:08:43:     'delivery',
2025-09-20T16:08:43:     'pickup_reminder',
2025-09-20T16:08:43:     'payment_reminder',
2025-09-20T16:08:43:     'fabric_welcome',
2025-09-20T16:08:43:     'fabric_purchase'
2025-09-20T16:08:43:   ],
2025-09-20T16:08:43:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:08:43:   databaseReady: true,
2025-09-20T16:08:43:   loggerReady: true,
2025-09-20T16:08:43:   processIsolationActive: true
2025-09-20T16:08:43: }
2025-09-20T16:08:43: âœ… Safety Manager initialized
2025-09-20T16:08:43: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:08:43: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:08:43: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:08:43: ğŸ“ Loaded statistics from file
2025-09-20T16:08:43: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:08:43: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:08:43: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:08:43: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:08:43: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:08:43: âœ… WhatsApp connection started
2025-09-20T16:08:43: ğŸ”§ Initializing admin commands...
2025-09-20T16:08:43: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:08:43: âœ… Admin commands system initialized
2025-09-20T16:08:43: ğŸ”„ Initializing polling functionality...
2025-09-20T16:08:43: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:08:43: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:08:43: ğŸ“ Attempting to request pairing code...
2025-09-20T16:08:43: ğŸ’¡ To use phone authentication:
2025-09-20T16:08:43:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:08:43:    2. Select "Phone Number Authentication"
2025-09-20T16:08:43:    3. Enter your phone number
2025-09-20T16:08:43:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:08:43: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:08:48: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:08:48: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:08:48: ğŸ”„ Reconnecting in 8s... (Attempt 4/10)
2025-09-20T16:08:56: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:08:56: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:08:56: âœ… Google Sheets API initialized
2025-09-20T16:08:56: âœ… Google Sheets API initialized
2025-09-20T16:08:56: â„¹ï¸ [4:08:56 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:08:56:   startupTime: 1758364709074,
2025-09-20T16:08:56:   gracePeriodMs: 240000,
2025-09-20T16:08:56:   dataDir: './safety-data',
2025-09-20T16:08:56:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:08:56:   processId: 13172,
2025-09-20T16:08:56:   nodeVersion: 'v22.19.0'
2025-09-20T16:08:56: }
2025-09-20T16:08:56: â„¹ï¸ [4:08:56 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:08:56: â„¹ï¸ [4:08:56 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:08:56: ğŸ§¹ Removed stale process lock
2025-09-20T16:08:56: ğŸ”’ Process lock acquired (PID: 13172)
2025-09-20T16:08:56: â„¹ï¸ [4:08:56 pm] INFO: Process isolation enforced {
2025-09-20T16:08:56:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:08:56:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:08:56:   processId: 13172
2025-09-20T16:08:56: }
2025-09-20T16:08:56: â° Starting 240 second startup grace period...
2025-09-20T16:08:56: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:08:56: â„¹ï¸ [4:08:56 pm] INFO: Grace Period: STARTED {
2025-09-20T16:08:56:   action: 'STARTED',
2025-09-20T16:08:56:   remainingMs: 240000,
2025-09-20T16:08:56:   remainingSeconds: 240,
2025-09-20T16:08:56:   details: { startupTime: 1758364709074, processId: 13172 },
2025-09-20T16:08:56:   timestamp: 1758364736096
2025-09-20T16:08:56: }
2025-09-20T16:08:56: â„¹ï¸ [4:08:56 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:08:56:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:08:56:   remainingMs: 240000,
2025-09-20T16:08:56:   remainingSeconds: 240,
2025-09-20T16:08:56:   details: { startupTime: 1758364709074, willExpireAt: 1758364949074 },
2025-09-20T16:08:56:   timestamp: 1758364736097
2025-09-20T16:08:56: }
2025-09-20T16:08:56: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:08:56: â° Startup grace period: 240 seconds
2025-09-20T16:08:56: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:08:56: â„¹ï¸ [4:08:56 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:08:56:   initializationDuration: 27026,
2025-09-20T16:08:56:   gracePeriodActive: true,
2025-09-20T16:08:56:   messageRulesCount: 8,
2025-09-20T16:08:56:   messageTypes: [
2025-09-20T16:08:56:     'welcome',
2025-09-20T16:08:56:     'confirmation',
2025-09-20T16:08:56:     'ready',
2025-09-20T16:08:56:     'delivery',
2025-09-20T16:08:56:     'pickup_reminder',
2025-09-20T16:08:56:     'payment_reminder',
2025-09-20T16:08:56:     'fabric_welcome',
2025-09-20T16:08:56:     'fabric_purchase'
2025-09-20T16:08:56:   ],
2025-09-20T16:08:56:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:08:56:   databaseReady: true,
2025-09-20T16:08:56:   loggerReady: true,
2025-09-20T16:08:56:   processIsolationActive: true
2025-09-20T16:08:56: }
2025-09-20T16:08:56: âœ… Safety Manager initialized
2025-09-20T16:08:56: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:08:56: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:08:56: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:08:56: ğŸ“ Loaded statistics from file
2025-09-20T16:08:56: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:08:56: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:08:56: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:08:56: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:08:56: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:08:56: âœ… WhatsApp connection started
2025-09-20T16:08:56: ğŸ”§ Initializing admin commands...
2025-09-20T16:08:56: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:08:56: âœ… Admin commands system initialized
2025-09-20T16:08:56: ğŸ”„ Initializing polling functionality...
2025-09-20T16:08:56: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:08:56: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:08:56: ğŸ“ Attempting to request pairing code...
2025-09-20T16:08:56: ğŸ’¡ To use phone authentication:
2025-09-20T16:08:56:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:08:56:    2. Select "Phone Number Authentication"
2025-09-20T16:08:56:    3. Enter your phone number
2025-09-20T16:08:56:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:08:56: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:08:59: ğŸ’¾ Data synced to files successfully
2025-09-20T16:09:00: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:09:00: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:09:00: ğŸ”„ Reconnecting in 16s... (Attempt 5/10)
2025-09-20T16:09:16: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:09:16: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:09:16: âœ… Google Sheets API initialized
2025-09-20T16:09:16: âœ… Google Sheets API initialized
2025-09-20T16:09:16: â„¹ï¸ [4:09:16 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:09:16:   startupTime: 1758364709074,
2025-09-20T16:09:16:   gracePeriodMs: 240000,
2025-09-20T16:09:16:   dataDir: './safety-data',
2025-09-20T16:09:16:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:09:16:   processId: 13172,
2025-09-20T16:09:16:   nodeVersion: 'v22.19.0'
2025-09-20T16:09:16: }
2025-09-20T16:09:16: â„¹ï¸ [4:09:16 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:09:16: â„¹ï¸ [4:09:16 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:09:16: ğŸ§¹ Removed stale process lock
2025-09-20T16:09:16: ğŸ”’ Process lock acquired (PID: 13172)
2025-09-20T16:09:16: â„¹ï¸ [4:09:16 pm] INFO: Process isolation enforced {
2025-09-20T16:09:16:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:09:16:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:09:16:   processId: 13172
2025-09-20T16:09:16: }
2025-09-20T16:09:16: â° Starting 240 second startup grace period...
2025-09-20T16:09:16: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:09:16: â„¹ï¸ [4:09:16 pm] INFO: Grace Period: STARTED {
2025-09-20T16:09:16:   action: 'STARTED',
2025-09-20T16:09:16:   remainingMs: 240000,
2025-09-20T16:09:16:   remainingSeconds: 240,
2025-09-20T16:09:16:   details: { startupTime: 1758364709074, processId: 13172 },
2025-09-20T16:09:16:   timestamp: 1758364756309
2025-09-20T16:09:16: }
2025-09-20T16:09:16: â„¹ï¸ [4:09:16 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:09:16:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:09:16:   remainingMs: 240000,
2025-09-20T16:09:16:   remainingSeconds: 240,
2025-09-20T16:09:16:   details: { startupTime: 1758364709074, willExpireAt: 1758364949074 },
2025-09-20T16:09:16:   timestamp: 1758364756309
2025-09-20T16:09:16: }
2025-09-20T16:09:16: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:09:16: â° Startup grace period: 240 seconds
2025-09-20T16:09:16: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:09:16: â„¹ï¸ [4:09:16 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:09:16:   initializationDuration: 47241,
2025-09-20T16:09:16:   gracePeriodActive: true,
2025-09-20T16:09:16:   messageRulesCount: 8,
2025-09-20T16:09:16:   messageTypes: [
2025-09-20T16:09:16:     'welcome',
2025-09-20T16:09:16:     'confirmation',
2025-09-20T16:09:16:     'ready',
2025-09-20T16:09:16:     'delivery',
2025-09-20T16:09:16:     'pickup_reminder',
2025-09-20T16:09:16:     'payment_reminder',
2025-09-20T16:09:16:     'fabric_welcome',
2025-09-20T16:09:16:     'fabric_purchase'
2025-09-20T16:09:16:   ],
2025-09-20T16:09:16:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:09:16:   databaseReady: true,
2025-09-20T16:09:16:   loggerReady: true,
2025-09-20T16:09:16:   processIsolationActive: true
2025-09-20T16:09:16: }
2025-09-20T16:09:16: âœ… Safety Manager initialized
2025-09-20T16:09:16: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:09:16: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:09:16: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:09:16: ğŸ“ Loaded statistics from file
2025-09-20T16:09:16: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:09:16: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:09:16: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:09:16: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:09:16: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:09:16: âœ… WhatsApp connection started
2025-09-20T16:09:16: ğŸ”§ Initializing admin commands...
2025-09-20T16:09:16: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:09:16: âœ… Admin commands system initialized
2025-09-20T16:09:16: ğŸ”„ Initializing polling functionality...
2025-09-20T16:09:16: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:09:16: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:09:16: ğŸ“ Attempting to request pairing code...
2025-09-20T16:09:16: ğŸ’¡ To use phone authentication:
2025-09-20T16:09:16:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:09:16:    2. Select "Phone Number Authentication"
2025-09-20T16:09:16:    3. Enter your phone number
2025-09-20T16:09:16:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:09:16: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:09:18: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:09:18: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:09:18: ğŸ”„ Reconnecting in 30s... (Attempt 6/10)
2025-09-20T16:09:29: ğŸ’¾ Data synced to files successfully
2025-09-20T16:09:48: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:09:48: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:09:48: âœ… Google Sheets API initialized
2025-09-20T16:09:48: âœ… Google Sheets API initialized
2025-09-20T16:09:48: â„¹ï¸ [4:09:48 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:09:48:   startupTime: 1758364709074,
2025-09-20T16:09:48:   gracePeriodMs: 240000,
2025-09-20T16:09:48:   dataDir: './safety-data',
2025-09-20T16:09:48:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:09:48:   processId: 13172,
2025-09-20T16:09:48:   nodeVersion: 'v22.19.0'
2025-09-20T16:09:48: }
2025-09-20T16:09:48: â„¹ï¸ [4:09:48 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:09:48: â„¹ï¸ [4:09:48 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:09:48: ğŸ§¹ Removed stale process lock
2025-09-20T16:09:48: ğŸ”’ Process lock acquired (PID: 13172)
2025-09-20T16:09:48: â„¹ï¸ [4:09:48 pm] INFO: Process isolation enforced {
2025-09-20T16:09:48:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:09:48:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:09:48:   processId: 13172
2025-09-20T16:09:48: }
2025-09-20T16:09:48: â° Starting 240 second startup grace period...
2025-09-20T16:09:48: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:09:48: â„¹ï¸ [4:09:48 pm] INFO: Grace Period: STARTED {
2025-09-20T16:09:48:   action: 'STARTED',
2025-09-20T16:09:48:   remainingMs: 240000,
2025-09-20T16:09:48:   remainingSeconds: 240,
2025-09-20T16:09:48:   details: { startupTime: 1758364709074, processId: 13172 },
2025-09-20T16:09:48:   timestamp: 1758364788495
2025-09-20T16:09:48: }
2025-09-20T16:09:48: â„¹ï¸ [4:09:48 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:09:48:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:09:48:   remainingMs: 240000,
2025-09-20T16:09:48:   remainingSeconds: 240,
2025-09-20T16:09:48:   details: { startupTime: 1758364709074, willExpireAt: 1758364949074 },
2025-09-20T16:09:48:   timestamp: 1758364788496
2025-09-20T16:09:48: }
2025-09-20T16:09:48: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:09:48: â° Startup grace period: 240 seconds
2025-09-20T16:09:48: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:09:48: â„¹ï¸ [4:09:48 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:09:48:   initializationDuration: 79424,
2025-09-20T16:09:48:   gracePeriodActive: true,
2025-09-20T16:09:48:   messageRulesCount: 8,
2025-09-20T16:09:48:   messageTypes: [
2025-09-20T16:09:48:     'welcome',
2025-09-20T16:09:48:     'confirmation',
2025-09-20T16:09:48:     'ready',
2025-09-20T16:09:48:     'delivery',
2025-09-20T16:09:48:     'pickup_reminder',
2025-09-20T16:09:48:     'payment_reminder',
2025-09-20T16:09:48:     'fabric_welcome',
2025-09-20T16:09:48:     'fabric_purchase'
2025-09-20T16:09:48:   ],
2025-09-20T16:09:48:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:09:48:   databaseReady: true,
2025-09-20T16:09:48:   loggerReady: true,
2025-09-20T16:09:48:   processIsolationActive: true
2025-09-20T16:09:48: }
2025-09-20T16:09:48: âœ… Safety Manager initialized
2025-09-20T16:09:48: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:09:48: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:09:48: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:09:48: ğŸ“ Loaded statistics from file
2025-09-20T16:09:48: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:09:48: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:09:48: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:09:48: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:09:48: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:09:48: âœ… WhatsApp connection started
2025-09-20T16:09:48: ğŸ”§ Initializing admin commands...
2025-09-20T16:09:48: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:09:48: âœ… Admin commands system initialized
2025-09-20T16:09:48: ğŸ”„ Initializing polling functionality...
2025-09-20T16:09:48: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:09:48: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:09:48: ğŸ“ Attempting to request pairing code...
2025-09-20T16:09:48: ğŸ’¡ To use phone authentication:
2025-09-20T16:09:48:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:09:48:    2. Select "Phone Number Authentication"
2025-09-20T16:09:48:    3. Enter your phone number
2025-09-20T16:09:48:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:09:48: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:09:55: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:09:55: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:09:55: ğŸ”„ Reconnecting in 30s... (Attempt 7/10)
2025-09-20T16:09:59: ğŸ’¾ Data synced to files successfully
2025-09-20T16:10:16: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T16:10:16: ğŸ“ Loaded 11 template types
2025-09-20T16:10:16: ğŸ”§ WhatsApp Bot initialized
2025-09-20T16:10:16: ğŸ“Š Configuration status: undefined
2025-09-20T16:10:16: âœ… Atomic State Manager initialized
2025-09-20T16:10:16: ğŸ“ Enhanced Logger initialized
2025-09-20T16:10:16: âœ… Google credentials loaded from service-account.json file
2025-09-20T16:10:16: ğŸ“± WhatsApp auth status: âœ… credentials, 5 session files
2025-09-20T16:10:16: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-20T16:10:16:    Auth Mode: both
2025-09-20T16:10:16:    QR Enabled: true
2025-09-20T16:10:16:    Phone Enabled: true
2025-09-20T16:10:16:    Session Persistence: true
2025-09-20T16:10:16:    Max Reconnect Attempts: 10
2025-09-20T16:10:16:    Default Phone: None
2025-09-20T16:10:16: ğŸ”’ Session validation enabled (check every 300s)
2025-09-20T16:10:16: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-20T16:10:16: ğŸ”§ Developer Configuration initialized
2025-09-20T16:10:16: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T16:10:16: â„¹ï¸ [4:10:16 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:10:16:   startupTime: 1758364816827,
2025-09-20T16:10:16:   gracePeriodMs: 240000,
2025-09-20T16:10:16:   dataDir: './safety-data',
2025-09-20T16:10:16:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:10:16:   processId: 10252,
2025-09-20T16:10:16:   nodeVersion: 'v22.19.0'
2025-09-20T16:10:16: }
2025-09-20T16:10:16: ğŸ”§ Developer Configuration initialized
2025-09-20T16:10:16: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T16:10:16: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-20T16:10:16: â° 4-minute startup delay active
2025-09-20T16:10:16: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-20T16:10:16: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-20T16:10:16: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:10:16: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:10:16: âœ… Google Sheets API initialized
2025-09-20T16:10:16: âœ… Google Sheets API initialized
2025-09-20T16:10:16: â„¹ï¸ [4:10:16 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:10:16:   startupTime: 1758364816827,
2025-09-20T16:10:16:   gracePeriodMs: 240000,
2025-09-20T16:10:16:   dataDir: './safety-data',
2025-09-20T16:10:16:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:10:16:   processId: 10252,
2025-09-20T16:10:16:   nodeVersion: 'v22.19.0'
2025-09-20T16:10:16: }
2025-09-20T16:10:16: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:10:16: â„¹ï¸ [4:10:16 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:10:16: â„¹ï¸ [4:10:16 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:10:16: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:10:16: â„¹ï¸ [4:10:16 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:10:16: â„¹ï¸ [4:10:16 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:10:16: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:10:16: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T09-32-21-256Z.log
2025-09-20T16:10:16: ğŸ“ Enhanced Logger initialized
2025-09-20T16:10:16: ğŸ“ Loaded statistics from file
2025-09-20T16:10:16: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:10:16: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:10:16: ğŸ§¹ Lock file already cleaned up
2025-09-20T16:10:16: ğŸ§¹ Removed stale process lock
2025-09-20T16:10:16: ğŸ”’ Process lock acquired (PID: 10252)
2025-09-20T16:10:16: ğŸ”’ Process lock acquired (PID: 10252)
2025-09-20T16:10:16: â„¹ï¸ [4:10:16 pm] INFO: Process isolation enforced {
2025-09-20T16:10:16:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:10:16:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:10:16:   processId: 10252
2025-09-20T16:10:16: }
2025-09-20T16:10:16: â° Starting 240 second startup grace period...
2025-09-20T16:10:16: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:10:16: â„¹ï¸ [4:10:16 pm] INFO: Process isolation enforced {
2025-09-20T16:10:16:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:10:16:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:10:16:   processId: 10252
2025-09-20T16:10:16: }
2025-09-20T16:10:16: â° Starting 240 second startup grace period...
2025-09-20T16:10:16: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:10:16: â„¹ï¸ [4:10:16 pm] INFO: Grace Period: STARTED {
2025-09-20T16:10:16:   action: 'STARTED',
2025-09-20T16:10:16:   remainingMs: 240000,
2025-09-20T16:10:16:   remainingSeconds: 240,
2025-09-20T16:10:16:   details: { startupTime: 1758364816827, processId: 10252 },
2025-09-20T16:10:16:   timestamp: 1758364816934
2025-09-20T16:10:16: }
2025-09-20T16:10:16: â„¹ï¸ [4:10:16 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:10:16:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:10:16:   remainingMs: 240000,
2025-09-20T16:10:16:   remainingSeconds: 240,
2025-09-20T16:10:16:   details: { startupTime: 1758364816827, willExpireAt: 1758365056827 },
2025-09-20T16:10:16:   timestamp: 1758364816936
2025-09-20T16:10:16: }
2025-09-20T16:10:16: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:10:16: â° Startup grace period: 240 seconds
2025-09-20T16:10:16: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:10:16: â„¹ï¸ [4:10:16 pm] INFO: Grace Period: STARTED {
2025-09-20T16:10:16:   action: 'STARTED',
2025-09-20T16:10:16:   remainingMs: 240000,
2025-09-20T16:10:16:   remainingSeconds: 240,
2025-09-20T16:10:16:   details: { startupTime: 1758364816827, processId: 10252 },
2025-09-20T16:10:16:   timestamp: 1758364816942
2025-09-20T16:10:16: }
2025-09-20T16:10:16: â„¹ï¸ [4:10:16 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:10:16:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:10:16:   remainingMs: 240000,
2025-09-20T16:10:16:   remainingSeconds: 240,
2025-09-20T16:10:16:   details: { startupTime: 1758364816827, willExpireAt: 1758365056827 },
2025-09-20T16:10:16:   timestamp: 1758364816943
2025-09-20T16:10:16: }
2025-09-20T16:10:16: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:10:16: â° Startup grace period: 240 seconds
2025-09-20T16:10:16: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:10:16: â„¹ï¸ [4:10:16 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:10:16:   initializationDuration: 120,
2025-09-20T16:10:16:   gracePeriodActive: true,
2025-09-20T16:10:16:   messageRulesCount: 8,
2025-09-20T16:10:16:   messageTypes: [
2025-09-20T16:10:16:     'welcome',
2025-09-20T16:10:16:     'confirmation',
2025-09-20T16:10:16:     'ready',
2025-09-20T16:10:16:     'delivery',
2025-09-20T16:10:16:     'pickup_reminder',
2025-09-20T16:10:16:     'payment_reminder',
2025-09-20T16:10:16:     'fabric_welcome',
2025-09-20T16:10:16:     'fabric_purchase'
2025-09-20T16:10:16:   ],
2025-09-20T16:10:16:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:10:16:   databaseReady: true,
2025-09-20T16:10:16:   loggerReady: true,
2025-09-20T16:10:16:   processIsolationActive: true
2025-09-20T16:10:16: }
2025-09-20T16:10:16: âœ… Safety Manager initialized
2025-09-20T16:10:16: â„¹ï¸ [4:10:16 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:10:16:   initializationDuration: 125,
2025-09-20T16:10:16:   gracePeriodActive: true,
2025-09-20T16:10:16:   messageRulesCount: 8,
2025-09-20T16:10:16:   messageTypes: [
2025-09-20T16:10:16:     'welcome',
2025-09-20T16:10:16:     'confirmation',
2025-09-20T16:10:16:     'ready',
2025-09-20T16:10:16:     'delivery',
2025-09-20T16:10:16:     'pickup_reminder',
2025-09-20T16:10:16:     'payment_reminder',
2025-09-20T16:10:16:     'fabric_welcome',
2025-09-20T16:10:16:     'fabric_purchase'
2025-09-20T16:10:16:   ],
2025-09-20T16:10:16:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:10:16:   databaseReady: true,
2025-09-20T16:10:16:   loggerReady: true,
2025-09-20T16:10:16:   processIsolationActive: true
2025-09-20T16:10:16: }
2025-09-20T16:10:16: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:10:16: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:10:16: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:10:16: ğŸ“ Loaded statistics from file
2025-09-20T16:10:16: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:10:16: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:10:16: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:10:16: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:10:16: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:10:17: âœ… WhatsApp connection started
2025-09-20T16:10:17: ğŸ”§ Initializing admin commands...
2025-09-20T16:10:17: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:10:17: âœ… Admin commands system initialized
2025-09-20T16:10:17: ğŸ”„ Initializing polling functionality...
2025-09-20T16:10:17: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:10:17: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:10:17: ğŸ“ Attempting to request pairing code...
2025-09-20T16:10:17: ğŸ’¡ To use phone authentication:
2025-09-20T16:10:17:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:10:17:    2. Select "Phone Number Authentication"
2025-09-20T16:10:17:    3. Enter your phone number
2025-09-20T16:10:17:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:10:17: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:10:19: âœ… Valid API key from ::1
2025-09-20T16:10:19: ğŸ”„ Shutting down Enhanced WhatsApp Client...
2025-09-20T16:10:19: ğŸ”„ Shutting down Enhanced Safety Manager...
2025-09-20T16:10:19: âœ… Enhanced Safety Manager shutdown complete
2025-09-20T16:10:19: ğŸ”„ Duplicate Prevention Manager destroyed
2025-09-20T16:10:19: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:10:19: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:10:19: ğŸ›‘ Manual disconnect; suppressing auto-reconnect
2025-09-20T16:10:19: ğŸ”Œ WhatsApp client disconnected (session preserved)
2025-09-20T16:10:19: âœ… Enhanced WhatsApp Client shutdown complete
2025-09-20T16:10:21: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:10:21: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:10:21: âœ… Google Sheets API initialized
2025-09-20T16:10:21: âœ… Google Sheets API initialized
2025-09-20T16:10:21: â„¹ï¸ [4:10:21 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:10:21:   startupTime: 1758364816827,
2025-09-20T16:10:21:   gracePeriodMs: 240000,
2025-09-20T16:10:21:   dataDir: './safety-data',
2025-09-20T16:10:21:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:10:21:   processId: 10252,
2025-09-20T16:10:21:   nodeVersion: 'v22.19.0'
2025-09-20T16:10:21: }
2025-09-20T16:10:21: â„¹ï¸ [4:10:21 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:10:21: â„¹ï¸ [4:10:21 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:10:21: ğŸ”’ Process lock acquired (PID: 10252)
2025-09-20T16:10:21: â„¹ï¸ [4:10:21 pm] INFO: Process isolation enforced {
2025-09-20T16:10:21:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:10:21:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:10:21:   processId: 10252
2025-09-20T16:10:21: }
2025-09-20T16:10:21: â° Starting 240 second startup grace period...
2025-09-20T16:10:21: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:10:21: â„¹ï¸ [4:10:21 pm] INFO: Grace Period: STARTED {
2025-09-20T16:10:21:   action: 'STARTED',
2025-09-20T16:10:21:   remainingMs: 240000,
2025-09-20T16:10:21:   remainingSeconds: 240,
2025-09-20T16:10:21:   details: { startupTime: 1758364816827, processId: 10252 },
2025-09-20T16:10:21:   timestamp: 1758364821201
2025-09-20T16:10:21: }
2025-09-20T16:10:21: â„¹ï¸ [4:10:21 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:10:21:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:10:21:   remainingMs: 240000,
2025-09-20T16:10:21:   remainingSeconds: 240,
2025-09-20T16:10:21:   details: { startupTime: 1758364816827, willExpireAt: 1758365056827 },
2025-09-20T16:10:21:   timestamp: 1758364821202
2025-09-20T16:10:21: }
2025-09-20T16:10:21: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:10:21: â° Startup grace period: 240 seconds
2025-09-20T16:10:21: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:10:21: â„¹ï¸ [4:10:21 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:10:21:   initializationDuration: 4379,
2025-09-20T16:10:21:   gracePeriodActive: true,
2025-09-20T16:10:21:   messageRulesCount: 8,
2025-09-20T16:10:21:   messageTypes: [
2025-09-20T16:10:21:     'welcome',
2025-09-20T16:10:21:     'confirmation',
2025-09-20T16:10:21:     'ready',
2025-09-20T16:10:21:     'delivery',
2025-09-20T16:10:21:     'pickup_reminder',
2025-09-20T16:10:21:     'payment_reminder',
2025-09-20T16:10:21:     'fabric_welcome',
2025-09-20T16:10:21:     'fabric_purchase'
2025-09-20T16:10:21:   ],
2025-09-20T16:10:21:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:10:21:   databaseReady: true,
2025-09-20T16:10:21:   loggerReady: true,
2025-09-20T16:10:21:   processIsolationActive: true
2025-09-20T16:10:21: }
2025-09-20T16:10:21: âœ… Safety Manager initialized
2025-09-20T16:10:21: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:10:21: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:10:21: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:10:21: ğŸ“ Loaded statistics from file
2025-09-20T16:10:21: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:10:21: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:10:21: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:10:21: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:10:21: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:10:21: âœ… WhatsApp connection started
2025-09-20T16:10:21: ğŸ”§ Initializing admin commands...
2025-09-20T16:10:21: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:10:21: âœ… Admin commands system initialized
2025-09-20T16:10:21: ğŸ”„ Initializing polling functionality...
2025-09-20T16:10:21: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:10:21: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:10:21: ğŸ“ Attempting to request pairing code...
2025-09-20T16:10:21: ğŸ’¡ To use phone authentication:
2025-09-20T16:10:21:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:10:21:    2. Select "Phone Number Authentication"
2025-09-20T16:10:21:    3. Enter your phone number
2025-09-20T16:10:21:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:10:21: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:10:23: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:10:23: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:10:23: ğŸ”„ Reconnecting in 1s... (Attempt 1/10)
2025-09-20T16:10:24: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:10:24: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:10:24: âœ… Google Sheets API initialized
2025-09-20T16:10:24: âœ… Google Sheets API initialized
2025-09-20T16:10:24: â„¹ï¸ [4:10:24 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:10:24:   startupTime: 1758364816827,
2025-09-20T16:10:24:   gracePeriodMs: 240000,
2025-09-20T16:10:24:   dataDir: './safety-data',
2025-09-20T16:10:24:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:10:24:   processId: 10252,
2025-09-20T16:10:24:   nodeVersion: 'v22.19.0'
2025-09-20T16:10:24: }
2025-09-20T16:10:24: â„¹ï¸ [4:10:24 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:10:24: â„¹ï¸ [4:10:24 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:10:24: ğŸ§¹ Removed stale process lock
2025-09-20T16:10:24: ğŸ”’ Process lock acquired (PID: 10252)
2025-09-20T16:10:24: â„¹ï¸ [4:10:24 pm] INFO: Process isolation enforced {
2025-09-20T16:10:24:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:10:24:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:10:24:   processId: 10252
2025-09-20T16:10:24: }
2025-09-20T16:10:24: â° Starting 240 second startup grace period...
2025-09-20T16:10:24: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:10:24: â„¹ï¸ [4:10:24 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:10:24:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:10:24:   remainingMs: 240000,
2025-09-20T16:10:24:   remainingSeconds: 240,
2025-09-20T16:10:24:   details: { startupTime: 1758364816827, willExpireAt: 1758365056827 },
2025-09-20T16:10:24:   timestamp: 1758364824963
2025-09-20T16:10:24: }
2025-09-20T16:10:24: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:10:24: â° Startup grace period: 240 seconds
2025-09-20T16:10:24: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:10:24: â„¹ï¸ [4:10:24 pm] INFO: Grace Period: STARTED {
2025-09-20T16:10:24:   action: 'STARTED',
2025-09-20T16:10:24:   remainingMs: 240000,
2025-09-20T16:10:24:   remainingSeconds: 240,
2025-09-20T16:10:24:   details: { startupTime: 1758364816827, processId: 10252 },
2025-09-20T16:10:24:   timestamp: 1758364824963
2025-09-20T16:10:24: }
2025-09-20T16:10:24: â„¹ï¸ [4:10:24 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:10:24:   initializationDuration: 8138,
2025-09-20T16:10:24:   gracePeriodActive: true,
2025-09-20T16:10:24:   messageRulesCount: 8,
2025-09-20T16:10:24:   messageTypes: [
2025-09-20T16:10:24:     'welcome',
2025-09-20T16:10:24:     'confirmation',
2025-09-20T16:10:24:     'ready',
2025-09-20T16:10:24:     'delivery',
2025-09-20T16:10:24:     'pickup_reminder',
2025-09-20T16:10:24:     'payment_reminder',
2025-09-20T16:10:24:     'fabric_welcome',
2025-09-20T16:10:24:     'fabric_purchase'
2025-09-20T16:10:24:   ],
2025-09-20T16:10:24:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:10:24:   databaseReady: true,
2025-09-20T16:10:24:   loggerReady: true,
2025-09-20T16:10:24:   processIsolationActive: true
2025-09-20T16:10:24: }
2025-09-20T16:10:24: âœ… Safety Manager initialized
2025-09-20T16:10:24: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:10:24: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:10:24: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:10:24: ğŸ“ Loaded statistics from file
2025-09-20T16:10:24: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:10:24: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:10:24: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:10:24: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:10:24: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:10:24: âœ… WhatsApp connection started
2025-09-20T16:10:24: ğŸ”§ Initializing admin commands...
2025-09-20T16:10:24: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:10:24: âœ… Admin commands system initialized
2025-09-20T16:10:24: ğŸ”„ Initializing polling functionality...
2025-09-20T16:10:24: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:10:24: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:10:24: ğŸ“ Attempting to request pairing code...
2025-09-20T16:10:24: ğŸ’¡ To use phone authentication:
2025-09-20T16:10:24:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:10:24:    2. Select "Phone Number Authentication"
2025-09-20T16:10:24:    3. Enter your phone number
2025-09-20T16:10:24:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:10:24: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:10:30: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:10:30: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:10:30: ğŸ”„ Reconnecting in 2s... (Attempt 2/10)
2025-09-20T16:10:32: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:10:32: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:10:32: âœ… Google Sheets API initialized
2025-09-20T16:10:32: âœ… Google Sheets API initialized
2025-09-20T16:10:32: â„¹ï¸ [4:10:32 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:10:32:   startupTime: 1758364816827,
2025-09-20T16:10:32:   gracePeriodMs: 240000,
2025-09-20T16:10:32:   dataDir: './safety-data',
2025-09-20T16:10:32:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:10:32:   processId: 10252,
2025-09-20T16:10:32:   nodeVersion: 'v22.19.0'
2025-09-20T16:10:32: }
2025-09-20T16:10:32: â„¹ï¸ [4:10:32 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:10:32: â„¹ï¸ [4:10:32 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:10:32: ğŸ§¹ Removed stale process lock
2025-09-20T16:10:32: ğŸ”’ Process lock acquired (PID: 10252)
2025-09-20T16:10:32: â„¹ï¸ [4:10:32 pm] INFO: Process isolation enforced {
2025-09-20T16:10:32:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:10:32:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:10:32:   processId: 10252
2025-09-20T16:10:32: }
2025-09-20T16:10:32: â° Starting 240 second startup grace period...
2025-09-20T16:10:32: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:10:32: â„¹ï¸ [4:10:32 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:10:32:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:10:32:   remainingMs: 240000,
2025-09-20T16:10:32:   remainingSeconds: 240,
2025-09-20T16:10:32:   details: { startupTime: 1758364816827, willExpireAt: 1758365056827 },
2025-09-20T16:10:32:   timestamp: 1758364832831
2025-09-20T16:10:32: }
2025-09-20T16:10:32: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:10:32: â° Startup grace period: 240 seconds
2025-09-20T16:10:32: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:10:32: â„¹ï¸ [4:10:32 pm] INFO: Grace Period: STARTED {
2025-09-20T16:10:32:   action: 'STARTED',
2025-09-20T16:10:32:   remainingMs: 240000,
2025-09-20T16:10:32:   remainingSeconds: 240,
2025-09-20T16:10:32:   details: { startupTime: 1758364816827, processId: 10252 },
2025-09-20T16:10:32:   timestamp: 1758364832830
2025-09-20T16:10:32: }
2025-09-20T16:10:32: â„¹ï¸ [4:10:32 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:10:32:   initializationDuration: 16010,
2025-09-20T16:10:32:   gracePeriodActive: true,
2025-09-20T16:10:32:   messageRulesCount: 8,
2025-09-20T16:10:32:   messageTypes: [
2025-09-20T16:10:32:     'welcome',
2025-09-20T16:10:32:     'confirmation',
2025-09-20T16:10:32:     'ready',
2025-09-20T16:10:32:     'delivery',
2025-09-20T16:10:32:     'pickup_reminder',
2025-09-20T16:10:32:     'payment_reminder',
2025-09-20T16:10:32:     'fabric_welcome',
2025-09-20T16:10:32:     'fabric_purchase'
2025-09-20T16:10:32:   ],
2025-09-20T16:10:32:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:10:32:   databaseReady: true,
2025-09-20T16:10:32:   loggerReady: true,
2025-09-20T16:10:32:   processIsolationActive: true
2025-09-20T16:10:32: }
2025-09-20T16:10:32: âœ… Safety Manager initialized
2025-09-20T16:10:32: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:10:32: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:10:32: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:10:32: ğŸ“ Loaded statistics from file
2025-09-20T16:10:32: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:10:32: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:10:32: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:10:32: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:10:32: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:10:32: âœ… WhatsApp connection started
2025-09-20T16:10:32: ğŸ”§ Initializing admin commands...
2025-09-20T16:10:32: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:10:32: âœ… Admin commands system initialized
2025-09-20T16:10:32: ğŸ”„ Initializing polling functionality...
2025-09-20T16:10:32: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:10:32: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:10:32: ğŸ“ Attempting to request pairing code...
2025-09-20T16:10:32: ğŸ’¡ To use phone authentication:
2025-09-20T16:10:32:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:10:32:    2. Select "Phone Number Authentication"
2025-09-20T16:10:32:    3. Enter your phone number
2025-09-20T16:10:32:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:10:32: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:10:35: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:10:35: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:10:35: ğŸ”„ Reconnecting in 4s... (Attempt 3/10)
2025-09-20T16:10:39: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:10:39: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:10:39: âœ… Google Sheets API initialized
2025-09-20T16:10:39: âœ… Google Sheets API initialized
2025-09-20T16:10:39: â„¹ï¸ [4:10:39 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:10:39:   startupTime: 1758364816827,
2025-09-20T16:10:39:   gracePeriodMs: 240000,
2025-09-20T16:10:39:   dataDir: './safety-data',
2025-09-20T16:10:39:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:10:39:   processId: 10252,
2025-09-20T16:10:39:   nodeVersion: 'v22.19.0'
2025-09-20T16:10:39: }
2025-09-20T16:10:39: â„¹ï¸ [4:10:39 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:10:39: â„¹ï¸ [4:10:39 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:10:39: ğŸ§¹ Removed stale process lock
2025-09-20T16:10:39: ğŸ”’ Process lock acquired (PID: 10252)
2025-09-20T16:10:39: â„¹ï¸ [4:10:39 pm] INFO: Process isolation enforced {
2025-09-20T16:10:39:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:10:39:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:10:39:   processId: 10252
2025-09-20T16:10:39: }
2025-09-20T16:10:39: â° Starting 240 second startup grace period...
2025-09-20T16:10:39: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:10:39: â„¹ï¸ [4:10:39 pm] INFO: Grace Period: STARTED {
2025-09-20T16:10:39:   action: 'STARTED',
2025-09-20T16:10:39:   remainingMs: 240000,
2025-09-20T16:10:39:   remainingSeconds: 240,
2025-09-20T16:10:39:   details: { startupTime: 1758364816827, processId: 10252 },
2025-09-20T16:10:39:   timestamp: 1758364839567
2025-09-20T16:10:39: }
2025-09-20T16:10:39: â„¹ï¸ [4:10:39 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:10:39:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:10:39:   remainingMs: 240000,
2025-09-20T16:10:39:   remainingSeconds: 240,
2025-09-20T16:10:39:   details: { startupTime: 1758364816827, willExpireAt: 1758365056827 },
2025-09-20T16:10:39:   timestamp: 1758364839567
2025-09-20T16:10:39: }
2025-09-20T16:10:39: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:10:39: â° Startup grace period: 240 seconds
2025-09-20T16:10:39: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:10:39: â„¹ï¸ [4:10:39 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:10:39:   initializationDuration: 22742,
2025-09-20T16:10:39:   gracePeriodActive: true,
2025-09-20T16:10:39:   messageRulesCount: 8,
2025-09-20T16:10:39:   messageTypes: [
2025-09-20T16:10:39:     'welcome',
2025-09-20T16:10:39:     'confirmation',
2025-09-20T16:10:39:     'ready',
2025-09-20T16:10:39:     'delivery',
2025-09-20T16:10:39:     'pickup_reminder',
2025-09-20T16:10:39:     'payment_reminder',
2025-09-20T16:10:39:     'fabric_welcome',
2025-09-20T16:10:39:     'fabric_purchase'
2025-09-20T16:10:39:   ],
2025-09-20T16:10:39:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:10:39:   databaseReady: true,
2025-09-20T16:10:39:   loggerReady: true,
2025-09-20T16:10:39:   processIsolationActive: true
2025-09-20T16:10:39: }
2025-09-20T16:10:39: âœ… Safety Manager initialized
2025-09-20T16:10:39: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:10:39: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:10:39: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:10:39: ğŸ“ Loaded statistics from file
2025-09-20T16:10:39: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:10:39: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:10:39: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:10:39: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:10:39: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:10:39: âœ… WhatsApp connection started
2025-09-20T16:10:39: ğŸ”§ Initializing admin commands...
2025-09-20T16:10:39: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:10:39: âœ… Admin commands system initialized
2025-09-20T16:10:39: ğŸ”„ Initializing polling functionality...
2025-09-20T16:10:39: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:10:39: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:10:39: ğŸ“ Attempting to request pairing code...
2025-09-20T16:10:39: ğŸ’¡ To use phone authentication:
2025-09-20T16:10:39:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:10:39:    2. Select "Phone Number Authentication"
2025-09-20T16:10:39:    3. Enter your phone number
2025-09-20T16:10:39:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:10:39: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:10:40: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:10:40: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:10:40: ğŸ”„ Reconnecting in 8s... (Attempt 4/10)
2025-09-20T16:10:48: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:10:48: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:10:48: âœ… Google Sheets API initialized
2025-09-20T16:10:48: âœ… Google Sheets API initialized
2025-09-20T16:10:48: â„¹ï¸ [4:10:48 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:10:48:   startupTime: 1758364816827,
2025-09-20T16:10:48:   gracePeriodMs: 240000,
2025-09-20T16:10:48:   dataDir: './safety-data',
2025-09-20T16:10:48:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:10:48:   processId: 10252,
2025-09-20T16:10:48:   nodeVersion: 'v22.19.0'
2025-09-20T16:10:48: }
2025-09-20T16:10:48: â„¹ï¸ [4:10:48 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:10:48: â„¹ï¸ [4:10:48 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:10:48: ğŸ§¹ Removed stale process lock
2025-09-20T16:10:48: ğŸ”’ Process lock acquired (PID: 10252)
2025-09-20T16:10:48: â„¹ï¸ [4:10:48 pm] INFO: Process isolation enforced {
2025-09-20T16:10:48:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:10:48:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:10:48:   processId: 10252
2025-09-20T16:10:48: }
2025-09-20T16:10:48: â° Starting 240 second startup grace period...
2025-09-20T16:10:48: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:10:48: â„¹ï¸ [4:10:48 pm] INFO: Grace Period: STARTED {
2025-09-20T16:10:48:   action: 'STARTED',
2025-09-20T16:10:48:   remainingMs: 240000,
2025-09-20T16:10:48:   remainingSeconds: 240,
2025-09-20T16:10:48:   details: { startupTime: 1758364816827, processId: 10252 },
2025-09-20T16:10:48:   timestamp: 1758364848717
2025-09-20T16:10:48: }
2025-09-20T16:10:48: â„¹ï¸ [4:10:48 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:10:48:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:10:48:   remainingMs: 240000,
2025-09-20T16:10:48:   remainingSeconds: 240,
2025-09-20T16:10:48:   details: { startupTime: 1758364816827, willExpireAt: 1758365056827 },
2025-09-20T16:10:48:   timestamp: 1758364848717
2025-09-20T16:10:48: }
2025-09-20T16:10:48: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:10:48: â° Startup grace period: 240 seconds
2025-09-20T16:10:48: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:10:48: â„¹ï¸ [4:10:48 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:10:48:   initializationDuration: 31893,
2025-09-20T16:10:48:   gracePeriodActive: true,
2025-09-20T16:10:48:   messageRulesCount: 8,
2025-09-20T16:10:48:   messageTypes: [
2025-09-20T16:10:48:     'welcome',
2025-09-20T16:10:48:     'confirmation',
2025-09-20T16:10:48:     'ready',
2025-09-20T16:10:48:     'delivery',
2025-09-20T16:10:48:     'pickup_reminder',
2025-09-20T16:10:48:     'payment_reminder',
2025-09-20T16:10:48:     'fabric_welcome',
2025-09-20T16:10:48:     'fabric_purchase'
2025-09-20T16:10:48:   ],
2025-09-20T16:10:48:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:10:48:   databaseReady: true,
2025-09-20T16:10:48:   loggerReady: true,
2025-09-20T16:10:48:   processIsolationActive: true
2025-09-20T16:10:48: }
2025-09-20T16:10:48: âœ… Safety Manager initialized
2025-09-20T16:10:48: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:10:48: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:10:48: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:10:48: ğŸ“ Loaded statistics from file
2025-09-20T16:10:48: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:10:48: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:10:48: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:10:48: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:10:48: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:10:48: âœ… WhatsApp connection started
2025-09-20T16:10:48: ğŸ”§ Initializing admin commands...
2025-09-20T16:10:48: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:10:48: âœ… Admin commands system initialized
2025-09-20T16:10:48: ğŸ”„ Initializing polling functionality...
2025-09-20T16:10:48: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:10:48: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:10:48: ğŸ“ Attempting to request pairing code...
2025-09-20T16:10:48: ğŸ’¡ To use phone authentication:
2025-09-20T16:10:48:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:10:48:    2. Select "Phone Number Authentication"
2025-09-20T16:10:48:    3. Enter your phone number
2025-09-20T16:10:48:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:10:48: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:10:55: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:10:55: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:10:55: ğŸ”„ Reconnecting in 16s... (Attempt 5/10)
2025-09-20T16:11:11: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:11:11: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:11:11: âœ… Google Sheets API initialized
2025-09-20T16:11:11: âœ… Google Sheets API initialized
2025-09-20T16:11:11: â„¹ï¸ [4:11:11 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:11:11:   startupTime: 1758364816827,
2025-09-20T16:11:11:   gracePeriodMs: 240000,
2025-09-20T16:11:11:   dataDir: './safety-data',
2025-09-20T16:11:11:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:11:11:   processId: 10252,
2025-09-20T16:11:11:   nodeVersion: 'v22.19.0'
2025-09-20T16:11:11: }
2025-09-20T16:11:11: â„¹ï¸ [4:11:11 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:11:11: â„¹ï¸ [4:11:11 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:11:11: ğŸ§¹ Removed stale process lock
2025-09-20T16:11:11: ğŸ”’ Process lock acquired (PID: 10252)
2025-09-20T16:11:11: â„¹ï¸ [4:11:11 pm] INFO: Process isolation enforced {
2025-09-20T16:11:11:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:11:11:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:11:11:   processId: 10252
2025-09-20T16:11:11: }
2025-09-20T16:11:11: â° Starting 240 second startup grace period...
2025-09-20T16:11:11: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:11:11: â„¹ï¸ [4:11:11 pm] INFO: Grace Period: STARTED {
2025-09-20T16:11:11:   action: 'STARTED',
2025-09-20T16:11:11:   remainingMs: 240000,
2025-09-20T16:11:11:   remainingSeconds: 240,
2025-09-20T16:11:11:   details: { startupTime: 1758364816827, processId: 10252 },
2025-09-20T16:11:11:   timestamp: 1758364871091
2025-09-20T16:11:11: }
2025-09-20T16:11:11: â„¹ï¸ [4:11:11 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:11:11:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:11:11:   remainingMs: 240000,
2025-09-20T16:11:11:   remainingSeconds: 240,
2025-09-20T16:11:11:   details: { startupTime: 1758364816827, willExpireAt: 1758365056827 },
2025-09-20T16:11:11:   timestamp: 1758364871092
2025-09-20T16:11:11: }
2025-09-20T16:11:11: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:11:11: â° Startup grace period: 240 seconds
2025-09-20T16:11:11: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:11:11: â„¹ï¸ [4:11:11 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:11:11:   initializationDuration: 54267,
2025-09-20T16:11:11:   gracePeriodActive: true,
2025-09-20T16:11:11:   messageRulesCount: 8,
2025-09-20T16:11:11:   messageTypes: [
2025-09-20T16:11:11:     'welcome',
2025-09-20T16:11:11:     'confirmation',
2025-09-20T16:11:11:     'ready',
2025-09-20T16:11:11:     'delivery',
2025-09-20T16:11:11:     'pickup_reminder',
2025-09-20T16:11:11:     'payment_reminder',
2025-09-20T16:11:11:     'fabric_welcome',
2025-09-20T16:11:11:     'fabric_purchase'
2025-09-20T16:11:11:   ],
2025-09-20T16:11:11:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:11:11:   databaseReady: true,
2025-09-20T16:11:11:   loggerReady: true,
2025-09-20T16:11:11:   processIsolationActive: true
2025-09-20T16:11:11: }
2025-09-20T16:11:11: âœ… Safety Manager initialized
2025-09-20T16:11:11: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:11:11: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:11:11: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:11:11: ğŸ“ Loaded statistics from file
2025-09-20T16:11:11: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:11:11: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:11:11: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:11:11: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:11:11: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:11:11: âœ… WhatsApp connection started
2025-09-20T16:11:11: ğŸ”§ Initializing admin commands...
2025-09-20T16:11:11: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:11:11: âœ… Admin commands system initialized
2025-09-20T16:11:11: ğŸ”„ Initializing polling functionality...
2025-09-20T16:11:11: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:11:11: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:11:11: ğŸ“ Attempting to request pairing code...
2025-09-20T16:11:11: ğŸ’¡ To use phone authentication:
2025-09-20T16:11:11:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:11:11:    2. Select "Phone Number Authentication"
2025-09-20T16:11:11:    3. Enter your phone number
2025-09-20T16:11:11:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:11:11: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:11:16: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:11:16: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:11:16: ğŸ”„ Reconnecting in 30s... (Attempt 6/10)
2025-09-20T16:11:47: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:11:47: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:11:47: âœ… Google Sheets API initialized
2025-09-20T16:11:47: âœ… Google Sheets API initialized
2025-09-20T16:11:47: â„¹ï¸ [4:11:47 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:11:47:   startupTime: 1758364816827,
2025-09-20T16:11:47:   gracePeriodMs: 240000,
2025-09-20T16:11:47:   dataDir: './safety-data',
2025-09-20T16:11:47:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:11:47:   processId: 10252,
2025-09-20T16:11:47:   nodeVersion: 'v22.19.0'
2025-09-20T16:11:47: }
2025-09-20T16:11:47: â„¹ï¸ [4:11:47 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:11:47: â„¹ï¸ [4:11:47 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:11:47: ğŸ§¹ Removed stale process lock
2025-09-20T16:11:47: ğŸ”’ Process lock acquired (PID: 10252)
2025-09-20T16:11:47: â„¹ï¸ [4:11:47 pm] INFO: Process isolation enforced {
2025-09-20T16:11:47:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:11:47:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:11:47:   processId: 10252
2025-09-20T16:11:47: }
2025-09-20T16:11:47: â° Starting 240 second startup grace period...
2025-09-20T16:11:47: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:11:47: â„¹ï¸ [4:11:47 pm] INFO: Grace Period: STARTED {
2025-09-20T16:11:47:   action: 'STARTED',
2025-09-20T16:11:47:   remainingMs: 240000,
2025-09-20T16:11:47:   remainingSeconds: 240,
2025-09-20T16:11:47:   details: { startupTime: 1758364816827, processId: 10252 },
2025-09-20T16:11:47:   timestamp: 1758364907026
2025-09-20T16:11:47: }
2025-09-20T16:11:47: â„¹ï¸ [4:11:47 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:11:47:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:11:47:   remainingMs: 240000,
2025-09-20T16:11:47:   remainingSeconds: 240,
2025-09-20T16:11:47:   details: { startupTime: 1758364816827, willExpireAt: 1758365056827 },
2025-09-20T16:11:47:   timestamp: 1758364907026
2025-09-20T16:11:47: }
2025-09-20T16:11:47: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:11:47: â° Startup grace period: 240 seconds
2025-09-20T16:11:47: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:11:47: â„¹ï¸ [4:11:47 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:11:47:   initializationDuration: 90205,
2025-09-20T16:11:47:   gracePeriodActive: true,
2025-09-20T16:11:47:   messageRulesCount: 8,
2025-09-20T16:11:47:   messageTypes: [
2025-09-20T16:11:47:     'welcome',
2025-09-20T16:11:47:     'confirmation',
2025-09-20T16:11:47:     'ready',
2025-09-20T16:11:47:     'delivery',
2025-09-20T16:11:47:     'pickup_reminder',
2025-09-20T16:11:47:     'payment_reminder',
2025-09-20T16:11:47:     'fabric_welcome',
2025-09-20T16:11:47:     'fabric_purchase'
2025-09-20T16:11:47:   ],
2025-09-20T16:11:47:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:11:47:   databaseReady: true,
2025-09-20T16:11:47:   loggerReady: true,
2025-09-20T16:11:47:   processIsolationActive: true
2025-09-20T16:11:47: }
2025-09-20T16:11:47: âœ… Safety Manager initialized
2025-09-20T16:11:47: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:11:47: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:11:47: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:11:47: ğŸ“ Loaded statistics from file
2025-09-20T16:11:47: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:11:47: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:11:47: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:11:47: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:11:47: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:11:47: âœ… WhatsApp connection started
2025-09-20T16:11:47: ğŸ”§ Initializing admin commands...
2025-09-20T16:11:47: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:11:47: âœ… Admin commands system initialized
2025-09-20T16:11:47: ğŸ”„ Initializing polling functionality...
2025-09-20T16:11:47: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:11:47: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:11:47: ğŸ“ Attempting to request pairing code...
2025-09-20T16:11:47: ğŸ’¡ To use phone authentication:
2025-09-20T16:11:47:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:11:47:    2. Select "Phone Number Authentication"
2025-09-20T16:11:47:    3. Enter your phone number
2025-09-20T16:11:47:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:11:47: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:11:52: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:11:52: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:11:52: ğŸ”„ Reconnecting in 30s... (Attempt 7/10)
2025-09-20T16:12:22: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:12:22: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:12:22: âœ… Google Sheets API initialized
2025-09-20T16:12:22: âœ… Google Sheets API initialized
2025-09-20T16:12:22: â„¹ï¸ [4:12:22 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:12:22:   startupTime: 1758364816827,
2025-09-20T16:12:22:   gracePeriodMs: 240000,
2025-09-20T16:12:22:   dataDir: './safety-data',
2025-09-20T16:12:22:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:12:22:   processId: 10252,
2025-09-20T16:12:22:   nodeVersion: 'v22.19.0'
2025-09-20T16:12:22: }
2025-09-20T16:12:22: â„¹ï¸ [4:12:22 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:12:22: â„¹ï¸ [4:12:22 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:12:22: ğŸ§¹ Removed stale process lock
2025-09-20T16:12:22: ğŸ”’ Process lock acquired (PID: 10252)
2025-09-20T16:12:22: â„¹ï¸ [4:12:22 pm] INFO: Process isolation enforced {
2025-09-20T16:12:22:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:12:22:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:12:22:   processId: 10252
2025-09-20T16:12:22: }
2025-09-20T16:12:22: â° Starting 240 second startup grace period...
2025-09-20T16:12:22: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:12:22: â„¹ï¸ [4:12:22 pm] INFO: Grace Period: STARTED {
2025-09-20T16:12:22:   action: 'STARTED',
2025-09-20T16:12:22:   remainingMs: 240000,
2025-09-20T16:12:22:   remainingSeconds: 240,
2025-09-20T16:12:22:   details: { startupTime: 1758364816827, processId: 10252 },
2025-09-20T16:12:22:   timestamp: 1758364942324
2025-09-20T16:12:22: }
2025-09-20T16:12:22: â„¹ï¸ [4:12:22 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:12:22:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:12:22:   remainingMs: 240000,
2025-09-20T16:12:22:   remainingSeconds: 240,
2025-09-20T16:12:22:   details: { startupTime: 1758364816827, willExpireAt: 1758365056827 },
2025-09-20T16:12:22:   timestamp: 1758364942324
2025-09-20T16:12:22: }
2025-09-20T16:12:22: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:12:22: â° Startup grace period: 240 seconds
2025-09-20T16:12:22: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:12:22: â„¹ï¸ [4:12:22 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:12:22:   initializationDuration: 125499,
2025-09-20T16:12:22:   gracePeriodActive: true,
2025-09-20T16:12:22:   messageRulesCount: 8,
2025-09-20T16:12:22:   messageTypes: [
2025-09-20T16:12:22:     'welcome',
2025-09-20T16:12:22:     'confirmation',
2025-09-20T16:12:22:     'ready',
2025-09-20T16:12:22:     'delivery',
2025-09-20T16:12:22:     'pickup_reminder',
2025-09-20T16:12:22:     'payment_reminder',
2025-09-20T16:12:22:     'fabric_welcome',
2025-09-20T16:12:22:     'fabric_purchase'
2025-09-20T16:12:22:   ],
2025-09-20T16:12:22:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:12:22:   databaseReady: true,
2025-09-20T16:12:22:   loggerReady: true,
2025-09-20T16:12:22:   processIsolationActive: true
2025-09-20T16:12:22: }
2025-09-20T16:12:22: âœ… Safety Manager initialized
2025-09-20T16:12:22: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:12:22: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:12:22: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:12:22: ğŸ“ Loaded statistics from file
2025-09-20T16:12:22: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:12:22: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:12:22: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:12:22: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:12:22: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:12:22: âœ… WhatsApp connection started
2025-09-20T16:12:22: ğŸ”§ Initializing admin commands...
2025-09-20T16:12:22: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:12:22: âœ… Admin commands system initialized
2025-09-20T16:12:22: ğŸ”„ Initializing polling functionality...
2025-09-20T16:12:22: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:12:22: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:12:22: ğŸ“ Attempting to request pairing code...
2025-09-20T16:12:22: ğŸ’¡ To use phone authentication:
2025-09-20T16:12:22:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:12:22:    2. Select "Phone Number Authentication"
2025-09-20T16:12:22:    3. Enter your phone number
2025-09-20T16:12:22:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:12:22: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:12:25: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:12:25: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:12:25: ğŸ”„ Reconnecting in 30s... (Attempt 8/10)
2025-09-20T16:12:55: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:12:55: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:12:55: âœ… Google Sheets API initialized
2025-09-20T16:12:55: âœ… Google Sheets API initialized
2025-09-20T16:12:55: â„¹ï¸ [4:12:55 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:12:55:   startupTime: 1758364816827,
2025-09-20T16:12:55:   gracePeriodMs: 240000,
2025-09-20T16:12:55:   dataDir: './safety-data',
2025-09-20T16:12:55:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:12:55:   processId: 10252,
2025-09-20T16:12:55:   nodeVersion: 'v22.19.0'
2025-09-20T16:12:55: }
2025-09-20T16:12:55: â„¹ï¸ [4:12:55 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:12:55: â„¹ï¸ [4:12:55 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:12:55: ğŸ§¹ Removed stale process lock
2025-09-20T16:12:55: ğŸ”’ Process lock acquired (PID: 10252)
2025-09-20T16:12:55: â„¹ï¸ [4:12:55 pm] INFO: Process isolation enforced {
2025-09-20T16:12:55:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:12:55:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:12:55:   processId: 10252
2025-09-20T16:12:55: }
2025-09-20T16:12:55: â° Starting 240 second startup grace period...
2025-09-20T16:12:55: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:12:55: â„¹ï¸ [4:12:55 pm] INFO: Grace Period: STARTED {
2025-09-20T16:12:55:   action: 'STARTED',
2025-09-20T16:12:55:   remainingMs: 240000,
2025-09-20T16:12:55:   remainingSeconds: 240,
2025-09-20T16:12:55:   details: { startupTime: 1758364816827, processId: 10252 },
2025-09-20T16:12:55:   timestamp: 1758364975752
2025-09-20T16:12:55: }
2025-09-20T16:12:55: â„¹ï¸ [4:12:55 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:12:55:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:12:55:   remainingMs: 240000,
2025-09-20T16:12:55:   remainingSeconds: 240,
2025-09-20T16:12:55:   details: { startupTime: 1758364816827, willExpireAt: 1758365056827 },
2025-09-20T16:12:55:   timestamp: 1758364975753
2025-09-20T16:12:55: }
2025-09-20T16:12:55: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:12:55: â° Startup grace period: 240 seconds
2025-09-20T16:12:55: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:12:55: â„¹ï¸ [4:12:55 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:12:55:   initializationDuration: 158931,
2025-09-20T16:12:55:   gracePeriodActive: true,
2025-09-20T16:12:55:   messageRulesCount: 8,
2025-09-20T16:12:55:   messageTypes: [
2025-09-20T16:12:55:     'welcome',
2025-09-20T16:12:55:     'confirmation',
2025-09-20T16:12:55:     'ready',
2025-09-20T16:12:55:     'delivery',
2025-09-20T16:12:55:     'pickup_reminder',
2025-09-20T16:12:55:     'payment_reminder',
2025-09-20T16:12:55:     'fabric_welcome',
2025-09-20T16:12:55:     'fabric_purchase'
2025-09-20T16:12:55:   ],
2025-09-20T16:12:55:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:12:55:   databaseReady: true,
2025-09-20T16:12:55:   loggerReady: true,
2025-09-20T16:12:55:   processIsolationActive: true
2025-09-20T16:12:55: }
2025-09-20T16:12:55: âœ… Safety Manager initialized
2025-09-20T16:12:55: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:12:55: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:12:55: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:12:55: ğŸ“ Loaded statistics from file
2025-09-20T16:12:55: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:12:55: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:12:55: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:12:55: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:12:55: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:12:55: âœ… WhatsApp connection started
2025-09-20T16:12:55: ğŸ”§ Initializing admin commands...
2025-09-20T16:12:55: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:12:55: âœ… Admin commands system initialized
2025-09-20T16:12:55: ğŸ”„ Initializing polling functionality...
2025-09-20T16:12:55: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:12:55: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:12:55: ğŸ“ Attempting to request pairing code...
2025-09-20T16:12:55: ğŸ’¡ To use phone authentication:
2025-09-20T16:12:55:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:12:55:    2. Select "Phone Number Authentication"
2025-09-20T16:12:55:    3. Enter your phone number
2025-09-20T16:12:55:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:12:55: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:12:59: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:12:59: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:12:59: ğŸ”„ Reconnecting in 30s... (Attempt 9/10)
2025-09-20T16:13:29: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:13:29: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:13:29: âœ… Google Sheets API initialized
2025-09-20T16:13:29: âœ… Google Sheets API initialized
2025-09-20T16:13:29: â„¹ï¸ [4:13:29 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:13:29:   startupTime: 1758364816827,
2025-09-20T16:13:29:   gracePeriodMs: 240000,
2025-09-20T16:13:29:   dataDir: './safety-data',
2025-09-20T16:13:29:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:13:29:   processId: 10252,
2025-09-20T16:13:29:   nodeVersion: 'v22.19.0'
2025-09-20T16:13:29: }
2025-09-20T16:13:29: â„¹ï¸ [4:13:29 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:13:29: â„¹ï¸ [4:13:29 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:13:29: ğŸ§¹ Removed stale process lock
2025-09-20T16:13:29: ğŸ”’ Process lock acquired (PID: 10252)
2025-09-20T16:13:29: â„¹ï¸ [4:13:29 pm] INFO: Process isolation enforced {
2025-09-20T16:13:29:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:13:29:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:13:29:   processId: 10252
2025-09-20T16:13:29: }
2025-09-20T16:13:29: â° Starting 240 second startup grace period...
2025-09-20T16:13:29: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:13:29: â„¹ï¸ [4:13:29 pm] INFO: Grace Period: STARTED {
2025-09-20T16:13:29:   action: 'STARTED',
2025-09-20T16:13:29:   remainingMs: 240000,
2025-09-20T16:13:29:   remainingSeconds: 240,
2025-09-20T16:13:29:   details: { startupTime: 1758364816827, processId: 10252 },
2025-09-20T16:13:29:   timestamp: 1758365009583
2025-09-20T16:13:29: }
2025-09-20T16:13:29: â„¹ï¸ [4:13:29 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:13:29:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:13:29:   remainingMs: 240000,
2025-09-20T16:13:29:   remainingSeconds: 240,
2025-09-20T16:13:29:   details: { startupTime: 1758364816827, willExpireAt: 1758365056827 },
2025-09-20T16:13:29:   timestamp: 1758365009584
2025-09-20T16:13:29: }
2025-09-20T16:13:29: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:13:29: â° Startup grace period: 240 seconds
2025-09-20T16:13:29: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:13:29: â„¹ï¸ [4:13:29 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:13:29:   initializationDuration: 192759,
2025-09-20T16:13:29:   gracePeriodActive: true,
2025-09-20T16:13:29:   messageRulesCount: 8,
2025-09-20T16:13:29:   messageTypes: [
2025-09-20T16:13:29:     'welcome',
2025-09-20T16:13:29:     'confirmation',
2025-09-20T16:13:29:     'ready',
2025-09-20T16:13:29:     'delivery',
2025-09-20T16:13:29:     'pickup_reminder',
2025-09-20T16:13:29:     'payment_reminder',
2025-09-20T16:13:29:     'fabric_welcome',
2025-09-20T16:13:29:     'fabric_purchase'
2025-09-20T16:13:29:   ],
2025-09-20T16:13:29:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:13:29:   databaseReady: true,
2025-09-20T16:13:29:   loggerReady: true,
2025-09-20T16:13:29:   processIsolationActive: true
2025-09-20T16:13:29: }
2025-09-20T16:13:29: âœ… Safety Manager initialized
2025-09-20T16:13:29: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:13:29: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:13:29: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:13:29: ğŸ“ Loaded statistics from file
2025-09-20T16:13:29: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:13:29: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:13:29: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:13:29: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:13:29: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:13:29: âœ… WhatsApp connection started
2025-09-20T16:13:29: ğŸ”§ Initializing admin commands...
2025-09-20T16:13:29: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:13:29: âœ… Admin commands system initialized
2025-09-20T16:13:29: ğŸ”„ Initializing polling functionality...
2025-09-20T16:13:29: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:13:29: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:13:29: ğŸ“ Attempting to request pairing code...
2025-09-20T16:13:29: ğŸ’¡ To use phone authentication:
2025-09-20T16:13:29:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:13:29:    2. Select "Phone Number Authentication"
2025-09-20T16:13:29:    3. Enter your phone number
2025-09-20T16:13:29:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:13:29: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:13:30: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:13:30: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:13:30: ğŸ”„ Reconnecting in 30s... (Attempt 10/10)
2025-09-20T16:14:00: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:14:00: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:14:00: âœ… Google Sheets API initialized
2025-09-20T16:14:00: âœ… Google Sheets API initialized
2025-09-20T16:14:00: â„¹ï¸ [4:14:00 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:14:00:   startupTime: 1758364816827,
2025-09-20T16:14:00:   gracePeriodMs: 240000,
2025-09-20T16:14:00:   dataDir: './safety-data',
2025-09-20T16:14:00:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:14:00:   processId: 10252,
2025-09-20T16:14:00:   nodeVersion: 'v22.19.0'
2025-09-20T16:14:00: }
2025-09-20T16:14:00: â„¹ï¸ [4:14:00 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:14:00: â„¹ï¸ [4:14:00 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:14:00: ğŸ§¹ Removed stale process lock
2025-09-20T16:14:00: ğŸ”’ Process lock acquired (PID: 10252)
2025-09-20T16:14:00: â„¹ï¸ [4:14:00 pm] INFO: Process isolation enforced {
2025-09-20T16:14:00:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:14:00:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:14:00:   processId: 10252
2025-09-20T16:14:00: }
2025-09-20T16:14:00: â° Starting 240 second startup grace period...
2025-09-20T16:14:00: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:14:00: â„¹ï¸ [4:14:00 pm] INFO: Grace Period: STARTED {
2025-09-20T16:14:00:   action: 'STARTED',
2025-09-20T16:14:00:   remainingMs: 240000,
2025-09-20T16:14:00:   remainingSeconds: 240,
2025-09-20T16:14:00:   details: { startupTime: 1758364816827, processId: 10252 },
2025-09-20T16:14:00:   timestamp: 1758365040614
2025-09-20T16:14:00: }
2025-09-20T16:14:00: â„¹ï¸ [4:14:00 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:14:00:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:14:00:   remainingMs: 240000,
2025-09-20T16:14:00:   remainingSeconds: 240,
2025-09-20T16:14:00:   details: { startupTime: 1758364816827, willExpireAt: 1758365056827 },
2025-09-20T16:14:00:   timestamp: 1758365040614
2025-09-20T16:14:00: }
2025-09-20T16:14:00: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:14:00: â° Startup grace period: 240 seconds
2025-09-20T16:14:00: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:14:00: â„¹ï¸ [4:14:00 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:14:00:   initializationDuration: 223789,
2025-09-20T16:14:00:   gracePeriodActive: true,
2025-09-20T16:14:00:   messageRulesCount: 8,
2025-09-20T16:14:00:   messageTypes: [
2025-09-20T16:14:00:     'welcome',
2025-09-20T16:14:00:     'confirmation',
2025-09-20T16:14:00:     'ready',
2025-09-20T16:14:00:     'delivery',
2025-09-20T16:14:00:     'pickup_reminder',
2025-09-20T16:14:00:     'payment_reminder',
2025-09-20T16:14:00:     'fabric_welcome',
2025-09-20T16:14:00:     'fabric_purchase'
2025-09-20T16:14:00:   ],
2025-09-20T16:14:00:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:14:00:   databaseReady: true,
2025-09-20T16:14:00:   loggerReady: true,
2025-09-20T16:14:00:   processIsolationActive: true
2025-09-20T16:14:00: }
2025-09-20T16:14:00: âœ… Safety Manager initialized
2025-09-20T16:14:00: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:14:00: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:14:00: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:14:00: ğŸ“ Loaded statistics from file
2025-09-20T16:14:00: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:14:00: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:14:00: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:14:00: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:14:00: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:14:00: âœ… WhatsApp connection started
2025-09-20T16:14:00: ğŸ”§ Initializing admin commands...
2025-09-20T16:14:00: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:14:00: âœ… Admin commands system initialized
2025-09-20T16:14:00: ğŸ”„ Initializing polling functionality...
2025-09-20T16:14:00: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:14:00: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:14:00: ğŸ“ Attempting to request pairing code...
2025-09-20T16:14:00: ğŸ’¡ To use phone authentication:
2025-09-20T16:14:00:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:14:00:    2. Select "Phone Number Authentication"
2025-09-20T16:14:00:    3. Enter your phone number
2025-09-20T16:14:00:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:14:00: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:14:05: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:14:05: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:14:05: âŒ Max reconnection attempts reached. Please restart the bot or check your internet connection.
2025-09-20T16:14:05: ğŸ’¡ You can visit http://localhost:3001 to see the status and authenticate again.
2025-09-20T16:14:16: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:14:16: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:14:16: â„¹ï¸ [4:14:16 pm] INFO: Grace Period: ENDED {
2025-09-20T16:14:16:   action: 'ENDED',
2025-09-20T16:14:16:   remainingMs: 0,
2025-09-20T16:14:16:   remainingSeconds: 0,
2025-09-20T16:14:16:   details: { totalDuration: 240000, processId: 10252 },
2025-09-20T16:14:16:   timestamp: 1758365056951
2025-09-20T16:14:16: }
2025-09-20T16:14:16: â„¹ï¸ [4:14:16 pm] INFO: Grace Period: ENDED {
2025-09-20T16:14:16:   action: 'ENDED',
2025-09-20T16:14:16:   remainingMs: 0,
2025-09-20T16:14:16:   remainingSeconds: 0,
2025-09-20T16:14:16:   details: { totalDuration: 240000, processId: 10252 },
2025-09-20T16:14:16:   timestamp: 1758365056960
2025-09-20T16:14:16: }
2025-09-20T16:14:16: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:14:16: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:14:21: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:14:21: â„¹ï¸ [4:14:21 pm] INFO: Grace Period: ENDED {
2025-09-20T16:14:21:   action: 'ENDED',
2025-09-20T16:14:21:   remainingMs: 0,
2025-09-20T16:14:21:   remainingSeconds: 0,
2025-09-20T16:14:21:   details: { totalDuration: 240000, processId: 10252 },
2025-09-20T16:14:21:   timestamp: 1758365061218
2025-09-20T16:14:21: }
2025-09-20T16:14:21: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:14:24: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:14:24: â„¹ï¸ [4:14:24 pm] INFO: Grace Period: ENDED {
2025-09-20T16:14:24:   action: 'ENDED',
2025-09-20T16:14:24:   remainingMs: 0,
2025-09-20T16:14:24:   remainingSeconds: 0,
2025-09-20T16:14:24:   details: { totalDuration: 240000, processId: 10252 },
2025-09-20T16:14:24:   timestamp: 1758365064973
2025-09-20T16:14:24: }
2025-09-20T16:14:24: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:14:32: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:14:32: â„¹ï¸ [4:14:32 pm] INFO: Grace Period: ENDED {
2025-09-20T16:14:32:   action: 'ENDED',
2025-09-20T16:14:32:   remainingMs: 0,
2025-09-20T16:14:32:   remainingSeconds: 0,
2025-09-20T16:14:32:   details: { totalDuration: 240000, processId: 10252 },
2025-09-20T16:14:32:   timestamp: 1758365072834
2025-09-20T16:14:32: }
2025-09-20T16:14:32: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:14:39: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:14:39: â„¹ï¸ [4:14:39 pm] INFO: Grace Period: ENDED {
2025-09-20T16:14:39:   action: 'ENDED',
2025-09-20T16:14:39:   remainingMs: 0,
2025-09-20T16:14:39:   remainingSeconds: 0,
2025-09-20T16:14:39:   details: { totalDuration: 240000, processId: 10252 },
2025-09-20T16:14:39:   timestamp: 1758365079572
2025-09-20T16:14:39: }
2025-09-20T16:14:39: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:14:48: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:14:48: â„¹ï¸ [4:14:48 pm] INFO: Grace Period: ENDED {
2025-09-20T16:14:48:   action: 'ENDED',
2025-09-20T16:14:48:   remainingMs: 0,
2025-09-20T16:14:48:   remainingSeconds: 0,
2025-09-20T16:14:48:   details: { totalDuration: 240000, processId: 10252 },
2025-09-20T16:14:48:   timestamp: 1758365088718
2025-09-20T16:14:48: }
2025-09-20T16:14:48: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:15:11: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:15:11: â„¹ï¸ [4:15:11 pm] INFO: Grace Period: ENDED {
2025-09-20T16:15:11:   action: 'ENDED',
2025-09-20T16:15:11:   remainingMs: 0,
2025-09-20T16:15:11:   remainingSeconds: 0,
2025-09-20T16:15:11:   details: { totalDuration: 240000, processId: 10252 },
2025-09-20T16:15:11:   timestamp: 1758365111099
2025-09-20T16:15:11: }
2025-09-20T16:15:11: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:15:47: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:15:47: â„¹ï¸ [4:15:47 pm] INFO: Grace Period: ENDED {
2025-09-20T16:15:47:   action: 'ENDED',
2025-09-20T16:15:47:   remainingMs: 0,
2025-09-20T16:15:47:   remainingSeconds: 0,
2025-09-20T16:15:47:   details: { totalDuration: 240000, processId: 10252 },
2025-09-20T16:15:47:   timestamp: 1758365147042
2025-09-20T16:15:47: }
2025-09-20T16:15:47: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:16:22: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:16:22: â„¹ï¸ [4:16:22 pm] INFO: Grace Period: ENDED {
2025-09-20T16:16:22:   action: 'ENDED',
2025-09-20T16:16:22:   remainingMs: 0,
2025-09-20T16:16:22:   remainingSeconds: 0,
2025-09-20T16:16:22:   details: { totalDuration: 240000, processId: 10252 },
2025-09-20T16:16:22:   timestamp: 1758365182329
2025-09-20T16:16:22: }
2025-09-20T16:16:22: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:16:55: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:16:55: â„¹ï¸ [4:16:55 pm] INFO: Grace Period: ENDED {
2025-09-20T16:16:55:   action: 'ENDED',
2025-09-20T16:16:55:   remainingMs: 0,
2025-09-20T16:16:55:   remainingSeconds: 0,
2025-09-20T16:16:55:   details: { totalDuration: 240000, processId: 10252 },
2025-09-20T16:16:55:   timestamp: 1758365215757
2025-09-20T16:16:55: }
2025-09-20T16:16:55: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:17:09: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T16:17:09: ğŸ“ Loaded 11 template types
2025-09-20T16:17:09: ğŸ”§ WhatsApp Bot initialized
2025-09-20T16:17:09: ğŸ“Š Configuration status: undefined
2025-09-20T16:17:09: âœ… Atomic State Manager initialized
2025-09-20T16:17:09: ğŸ“ Enhanced Logger initialized
2025-09-20T16:17:09: âœ… Google credentials loaded from service-account.json file
2025-09-20T16:17:09: ğŸ“± WhatsApp auth status: âœ… credentials, 5 session files
2025-09-20T16:17:09: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-20T16:17:09:    Auth Mode: both
2025-09-20T16:17:09:    QR Enabled: true
2025-09-20T16:17:09:    Phone Enabled: true
2025-09-20T16:17:09:    Session Persistence: true
2025-09-20T16:17:09:    Max Reconnect Attempts: 10
2025-09-20T16:17:09:    Default Phone: None
2025-09-20T16:17:09: ğŸ”’ Session validation enabled (check every 300s)
2025-09-20T16:17:09: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-20T16:17:09: ğŸ”§ Developer Configuration initialized
2025-09-20T16:17:09: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T16:17:09: â„¹ï¸ [4:17:09 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:17:09:   startupTime: 1758365229286,
2025-09-20T16:17:09:   gracePeriodMs: 240000,
2025-09-20T16:17:09:   dataDir: './safety-data',
2025-09-20T16:17:09:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:17:09:   processId: 13956,
2025-09-20T16:17:09:   nodeVersion: 'v22.19.0'
2025-09-20T16:17:09: }
2025-09-20T16:17:09: ğŸ”§ Developer Configuration initialized
2025-09-20T16:17:09: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T16:17:09: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-20T16:17:09: â° 4-minute startup delay active
2025-09-20T16:17:09: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-20T16:17:09: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-20T16:17:09: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:17:09: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:17:09: âœ… Google Sheets API initialized
2025-09-20T16:17:09: âœ… Google Sheets API initialized
2025-09-20T16:17:09: â„¹ï¸ [4:17:09 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:17:09:   startupTime: 1758365229286,
2025-09-20T16:17:09:   gracePeriodMs: 240000,
2025-09-20T16:17:09:   dataDir: './safety-data',
2025-09-20T16:17:09:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:17:09:   processId: 13956,
2025-09-20T16:17:09:   nodeVersion: 'v22.19.0'
2025-09-20T16:17:09: }
2025-09-20T16:17:09: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:17:09: â„¹ï¸ [4:17:09 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:17:09: â„¹ï¸ [4:17:09 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:17:09: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:17:09: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:17:09: â„¹ï¸ [4:17:09 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:17:09: â„¹ï¸ [4:17:09 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:17:09: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T09-35-22-749Z.log
2025-09-20T16:17:09: ğŸ“ Enhanced Logger initialized
2025-09-20T16:17:09: ğŸ“ Loaded statistics from file
2025-09-20T16:17:09: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:17:09: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:17:09: ğŸ§¹ Removed stale process lock
2025-09-20T16:17:09: ğŸ§¹ Lock file already cleaned up
2025-09-20T16:17:09: ğŸ”’ Process lock acquired (PID: 13956)
2025-09-20T16:17:09: ğŸ”’ Process lock acquired (PID: 13956)
2025-09-20T16:17:09: â„¹ï¸ [4:17:09 pm] INFO: Process isolation enforced {
2025-09-20T16:17:09:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:17:09:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:17:09:   processId: 13956
2025-09-20T16:17:09: }
2025-09-20T16:17:09: â° Starting 240 second startup grace period...
2025-09-20T16:17:09: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:17:09: â„¹ï¸ [4:17:09 pm] INFO: Process isolation enforced {
2025-09-20T16:17:09:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:17:09:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:17:09:   processId: 13956
2025-09-20T16:17:09: }
2025-09-20T16:17:09: â° Starting 240 second startup grace period...
2025-09-20T16:17:09: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:17:09: â„¹ï¸ [4:17:09 pm] INFO: Grace Period: STARTED {
2025-09-20T16:17:09:   action: 'STARTED',
2025-09-20T16:17:09:   remainingMs: 240000,
2025-09-20T16:17:09:   remainingSeconds: 240,
2025-09-20T16:17:09:   details: { startupTime: 1758365229286, processId: 13956 },
2025-09-20T16:17:09:   timestamp: 1758365229350
2025-09-20T16:17:09: }
2025-09-20T16:17:09: â„¹ï¸ [4:17:09 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:17:09:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:17:09:   remainingMs: 240000,
2025-09-20T16:17:09:   remainingSeconds: 240,
2025-09-20T16:17:09:   details: { startupTime: 1758365229286, willExpireAt: 1758365469286 },
2025-09-20T16:17:09:   timestamp: 1758365229352
2025-09-20T16:17:09: }
2025-09-20T16:17:09: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:17:09: â° Startup grace period: 240 seconds
2025-09-20T16:17:09: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:17:09: â„¹ï¸ [4:17:09 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:17:09:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:17:09:   remainingMs: 240000,
2025-09-20T16:17:09:   remainingSeconds: 240,
2025-09-20T16:17:09:   details: { startupTime: 1758365229286, willExpireAt: 1758365469286 },
2025-09-20T16:17:09:   timestamp: 1758365229357
2025-09-20T16:17:09: }
2025-09-20T16:17:09: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:17:09: â° Startup grace period: 240 seconds
2025-09-20T16:17:09: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:17:09: â„¹ï¸ [4:17:09 pm] INFO: Grace Period: STARTED {
2025-09-20T16:17:09:   action: 'STARTED',
2025-09-20T16:17:09:   remainingMs: 240000,
2025-09-20T16:17:09:   remainingSeconds: 240,
2025-09-20T16:17:09:   details: { startupTime: 1758365229286, processId: 13956 },
2025-09-20T16:17:09:   timestamp: 1758365229356
2025-09-20T16:17:09: }
2025-09-20T16:17:09: â„¹ï¸ [4:17:09 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:17:09:   initializationDuration: 81,
2025-09-20T16:17:09:   gracePeriodActive: true,
2025-09-20T16:17:09:   messageRulesCount: 8,
2025-09-20T16:17:09:   messageTypes: [
2025-09-20T16:17:09:     'welcome',
2025-09-20T16:17:09:     'confirmation',
2025-09-20T16:17:09:     'ready',
2025-09-20T16:17:09:     'delivery',
2025-09-20T16:17:09:     'pickup_reminder',
2025-09-20T16:17:09:     'payment_reminder',
2025-09-20T16:17:09:     'fabric_welcome',
2025-09-20T16:17:09:     'fabric_purchase'
2025-09-20T16:17:09:   ],
2025-09-20T16:17:09:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:17:09:   databaseReady: true,
2025-09-20T16:17:09:   loggerReady: true,
2025-09-20T16:17:09:   processIsolationActive: true
2025-09-20T16:17:09: }
2025-09-20T16:17:09: â„¹ï¸ [4:17:09 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:17:09:   initializationDuration: 76,
2025-09-20T16:17:09:   gracePeriodActive: true,
2025-09-20T16:17:09:   messageRulesCount: 8,
2025-09-20T16:17:09:   messageTypes: [
2025-09-20T16:17:09:     'welcome',
2025-09-20T16:17:09:     'confirmation',
2025-09-20T16:17:09:     'ready',
2025-09-20T16:17:09:     'delivery',
2025-09-20T16:17:09:     'pickup_reminder',
2025-09-20T16:17:09:     'payment_reminder',
2025-09-20T16:17:09:     'fabric_welcome',
2025-09-20T16:17:09:     'fabric_purchase'
2025-09-20T16:17:09:   ],
2025-09-20T16:17:09:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:17:09:   databaseReady: true,
2025-09-20T16:17:09:   loggerReady: true,
2025-09-20T16:17:09:   processIsolationActive: true
2025-09-20T16:17:09: }
2025-09-20T16:17:09: âœ… Safety Manager initialized
2025-09-20T16:17:09: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:17:09: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:17:09: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:17:09: ğŸ“ Loaded statistics from file
2025-09-20T16:17:09: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:17:09: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:17:09: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:17:09: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:17:09: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:17:09: âœ… WhatsApp connection started
2025-09-20T16:17:09: ğŸ”§ Initializing admin commands...
2025-09-20T16:17:09: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:17:09: âœ… Admin commands system initialized
2025-09-20T16:17:09: ğŸ”„ Initializing polling functionality...
2025-09-20T16:17:09: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:17:09: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:17:09: ğŸ“ Attempting to request pairing code...
2025-09-20T16:17:09: ğŸ’¡ To use phone authentication:
2025-09-20T16:17:09:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:17:09:    2. Select "Phone Number Authentication"
2025-09-20T16:17:09:    3. Enter your phone number
2025-09-20T16:17:09:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:17:09: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:17:14: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:17:14: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:17:14: ğŸ”„ Reconnecting in 1s... (Attempt 1/10)
2025-09-20T16:17:15: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:17:15: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:17:15: âœ… Google Sheets API initialized
2025-09-20T16:17:15: âœ… Google Sheets API initialized
2025-09-20T16:17:15: â„¹ï¸ [4:17:15 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:17:15:   startupTime: 1758365229286,
2025-09-20T16:17:15:   gracePeriodMs: 240000,
2025-09-20T16:17:15:   dataDir: './safety-data',
2025-09-20T16:17:15:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:17:15:   processId: 13956,
2025-09-20T16:17:15:   nodeVersion: 'v22.19.0'
2025-09-20T16:17:15: }
2025-09-20T16:17:15: â„¹ï¸ [4:17:15 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:17:15: â„¹ï¸ [4:17:15 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:17:15: ğŸ§¹ Removed stale process lock
2025-09-20T16:17:15: ğŸ”’ Process lock acquired (PID: 13956)
2025-09-20T16:17:15: â„¹ï¸ [4:17:15 pm] INFO: Process isolation enforced {
2025-09-20T16:17:15:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:17:15:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:17:15:   processId: 13956
2025-09-20T16:17:15: }
2025-09-20T16:17:15: â° Starting 240 second startup grace period...
2025-09-20T16:17:15: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:17:15: â„¹ï¸ [4:17:15 pm] INFO: Grace Period: STARTED {
2025-09-20T16:17:15:   action: 'STARTED',
2025-09-20T16:17:15:   remainingMs: 240000,
2025-09-20T16:17:15:   remainingSeconds: 240,
2025-09-20T16:17:15:   details: { startupTime: 1758365229286, processId: 13956 },
2025-09-20T16:17:15:   timestamp: 1758365235474
2025-09-20T16:17:15: }
2025-09-20T16:17:15: â„¹ï¸ [4:17:15 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:17:15:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:17:15:   remainingMs: 240000,
2025-09-20T16:17:15:   remainingSeconds: 240,
2025-09-20T16:17:15:   details: { startupTime: 1758365229286, willExpireAt: 1758365469286 },
2025-09-20T16:17:15:   timestamp: 1758365235475
2025-09-20T16:17:15: }
2025-09-20T16:17:15: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:17:15: â° Startup grace period: 240 seconds
2025-09-20T16:17:15: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:17:15: â„¹ï¸ [4:17:15 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:17:15:   initializationDuration: 6193,
2025-09-20T16:17:15:   gracePeriodActive: true,
2025-09-20T16:17:15:   messageRulesCount: 8,
2025-09-20T16:17:15:   messageTypes: [
2025-09-20T16:17:15:     'welcome',
2025-09-20T16:17:15:     'confirmation',
2025-09-20T16:17:15:     'ready',
2025-09-20T16:17:15:     'delivery',
2025-09-20T16:17:15:     'pickup_reminder',
2025-09-20T16:17:15:     'payment_reminder',
2025-09-20T16:17:15:     'fabric_welcome',
2025-09-20T16:17:15:     'fabric_purchase'
2025-09-20T16:17:15:   ],
2025-09-20T16:17:15:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:17:15:   databaseReady: true,
2025-09-20T16:17:15:   loggerReady: true,
2025-09-20T16:17:15:   processIsolationActive: true
2025-09-20T16:17:15: }
2025-09-20T16:17:15: âœ… Safety Manager initialized
2025-09-20T16:17:15: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:17:15: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:17:15: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:17:15: ğŸ“ Loaded statistics from file
2025-09-20T16:17:15: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:17:15: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:17:15: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:17:15: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:17:15: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:17:15: âœ… WhatsApp connection started
2025-09-20T16:17:15: ğŸ”§ Initializing admin commands...
2025-09-20T16:17:15: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:17:15: âœ… Admin commands system initialized
2025-09-20T16:17:15: ğŸ”„ Initializing polling functionality...
2025-09-20T16:17:15: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:17:15: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:17:15: ğŸ“ Attempting to request pairing code...
2025-09-20T16:17:15: ğŸ’¡ To use phone authentication:
2025-09-20T16:17:15:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:17:15:    2. Select "Phone Number Authentication"
2025-09-20T16:17:15:    3. Enter your phone number
2025-09-20T16:17:15:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:17:15: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:17:21: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:17:21: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:17:21: ğŸ”„ Reconnecting in 2s... (Attempt 2/10)
2025-09-20T16:17:23: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:17:23: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:17:23: âœ… Google Sheets API initialized
2025-09-20T16:17:23: âœ… Google Sheets API initialized
2025-09-20T16:17:23: â„¹ï¸ [4:17:23 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:17:23:   startupTime: 1758365229286,
2025-09-20T16:17:23:   gracePeriodMs: 240000,
2025-09-20T16:17:23:   dataDir: './safety-data',
2025-09-20T16:17:23:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:17:23:   processId: 13956,
2025-09-20T16:17:23:   nodeVersion: 'v22.19.0'
2025-09-20T16:17:23: }
2025-09-20T16:17:23: â„¹ï¸ [4:17:23 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:17:23: â„¹ï¸ [4:17:23 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:17:23: ğŸ§¹ Removed stale process lock
2025-09-20T16:17:23: ğŸ”’ Process lock acquired (PID: 13956)
2025-09-20T16:17:23: â„¹ï¸ [4:17:23 pm] INFO: Process isolation enforced {
2025-09-20T16:17:23:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:17:23:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:17:23:   processId: 13956
2025-09-20T16:17:23: }
2025-09-20T16:17:23: â° Starting 240 second startup grace period...
2025-09-20T16:17:23: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:17:23: â„¹ï¸ [4:17:23 pm] INFO: Grace Period: STARTED {
2025-09-20T16:17:23:   action: 'STARTED',
2025-09-20T16:17:23:   remainingMs: 240000,
2025-09-20T16:17:23:   remainingSeconds: 240,
2025-09-20T16:17:23:   details: { startupTime: 1758365229286, processId: 13956 },
2025-09-20T16:17:23:   timestamp: 1758365243325
2025-09-20T16:17:23: }
2025-09-20T16:17:23: â„¹ï¸ [4:17:23 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:17:23:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:17:23:   remainingMs: 240000,
2025-09-20T16:17:23:   remainingSeconds: 240,
2025-09-20T16:17:23:   details: { startupTime: 1758365229286, willExpireAt: 1758365469286 },
2025-09-20T16:17:23:   timestamp: 1758365243325
2025-09-20T16:17:23: }
2025-09-20T16:17:23: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:17:23: â° Startup grace period: 240 seconds
2025-09-20T16:17:23: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:17:23: â„¹ï¸ [4:17:23 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:17:23:   initializationDuration: 14045,
2025-09-20T16:17:23:   gracePeriodActive: true,
2025-09-20T16:17:23:   messageRulesCount: 8,
2025-09-20T16:17:23:   messageTypes: [
2025-09-20T16:17:23:     'welcome',
2025-09-20T16:17:23:     'confirmation',
2025-09-20T16:17:23:     'ready',
2025-09-20T16:17:23:     'delivery',
2025-09-20T16:17:23:     'pickup_reminder',
2025-09-20T16:17:23:     'payment_reminder',
2025-09-20T16:17:23:     'fabric_welcome',
2025-09-20T16:17:23:     'fabric_purchase'
2025-09-20T16:17:23:   ],
2025-09-20T16:17:23:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:17:23:   databaseReady: true,
2025-09-20T16:17:23:   loggerReady: true,
2025-09-20T16:17:23:   processIsolationActive: true
2025-09-20T16:17:23: }
2025-09-20T16:17:23: âœ… Safety Manager initialized
2025-09-20T16:17:23: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:17:23: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:17:23: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:17:23: ğŸ“ Loaded statistics from file
2025-09-20T16:17:23: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:17:23: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:17:23: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:17:23: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:17:23: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:17:23: âœ… WhatsApp connection started
2025-09-20T16:17:23: ğŸ”§ Initializing admin commands...
2025-09-20T16:17:23: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:17:23: âœ… Admin commands system initialized
2025-09-20T16:17:23: ğŸ”„ Initializing polling functionality...
2025-09-20T16:17:23: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:17:23: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:17:23: ğŸ“ Attempting to request pairing code...
2025-09-20T16:17:23: ğŸ’¡ To use phone authentication:
2025-09-20T16:17:23:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:17:23:    2. Select "Phone Number Authentication"
2025-09-20T16:17:23:    3. Enter your phone number
2025-09-20T16:17:23:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:17:23: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:17:26: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:17:26: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:17:26: ğŸ”„ Reconnecting in 4s... (Attempt 3/10)
2025-09-20T16:17:30: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:17:30: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:17:30: âœ… Google Sheets API initialized
2025-09-20T16:17:30: âœ… Google Sheets API initialized
2025-09-20T16:17:30: â„¹ï¸ [4:17:30 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:17:30:   startupTime: 1758365229286,
2025-09-20T16:17:30:   gracePeriodMs: 240000,
2025-09-20T16:17:30:   dataDir: './safety-data',
2025-09-20T16:17:30:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:17:30:   processId: 13956,
2025-09-20T16:17:30:   nodeVersion: 'v22.19.0'
2025-09-20T16:17:30: }
2025-09-20T16:17:30: â„¹ï¸ [4:17:30 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:17:30: â„¹ï¸ [4:17:30 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:17:30: ğŸ§¹ Removed stale process lock
2025-09-20T16:17:30: ğŸ”’ Process lock acquired (PID: 13956)
2025-09-20T16:17:30: â„¹ï¸ [4:17:30 pm] INFO: Process isolation enforced {
2025-09-20T16:17:30:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:17:30:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:17:30:   processId: 13956
2025-09-20T16:17:30: }
2025-09-20T16:17:30: â° Starting 240 second startup grace period...
2025-09-20T16:17:30: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:17:30: â„¹ï¸ [4:17:30 pm] INFO: Grace Period: STARTED {
2025-09-20T16:17:30:   action: 'STARTED',
2025-09-20T16:17:30:   remainingMs: 240000,
2025-09-20T16:17:30:   remainingSeconds: 240,
2025-09-20T16:17:30:   details: { startupTime: 1758365229286, processId: 13956 },
2025-09-20T16:17:30:   timestamp: 1758365250126
2025-09-20T16:17:30: }
2025-09-20T16:17:30: â„¹ï¸ [4:17:30 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:17:30:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:17:30:   remainingMs: 240000,
2025-09-20T16:17:30:   remainingSeconds: 240,
2025-09-20T16:17:30:   details: { startupTime: 1758365229286, willExpireAt: 1758365469286 },
2025-09-20T16:17:30:   timestamp: 1758365250128
2025-09-20T16:17:30: }
2025-09-20T16:17:30: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:17:30: â° Startup grace period: 240 seconds
2025-09-20T16:17:30: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:17:30: â„¹ï¸ [4:17:30 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:17:30:   initializationDuration: 20846,
2025-09-20T16:17:30:   gracePeriodActive: true,
2025-09-20T16:17:30:   messageRulesCount: 8,
2025-09-20T16:17:30:   messageTypes: [
2025-09-20T16:17:30:     'welcome',
2025-09-20T16:17:30:     'confirmation',
2025-09-20T16:17:30:     'ready',
2025-09-20T16:17:30:     'delivery',
2025-09-20T16:17:30:     'pickup_reminder',
2025-09-20T16:17:30:     'payment_reminder',
2025-09-20T16:17:30:     'fabric_welcome',
2025-09-20T16:17:30:     'fabric_purchase'
2025-09-20T16:17:30:   ],
2025-09-20T16:17:30:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:17:30:   databaseReady: true,
2025-09-20T16:17:30:   loggerReady: true,
2025-09-20T16:17:30:   processIsolationActive: true
2025-09-20T16:17:30: }
2025-09-20T16:17:30: âœ… Safety Manager initialized
2025-09-20T16:17:30: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:17:30: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:17:30: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:17:30: ğŸ“ Loaded statistics from file
2025-09-20T16:17:30: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:17:30: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:17:30: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:17:30: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:17:30: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:17:30: âœ… WhatsApp connection started
2025-09-20T16:17:30: ğŸ”§ Initializing admin commands...
2025-09-20T16:17:30: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:17:30: âœ… Admin commands system initialized
2025-09-20T16:17:30: ğŸ”„ Initializing polling functionality...
2025-09-20T16:17:30: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:17:30: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:17:30: ğŸ“ Attempting to request pairing code...
2025-09-20T16:17:30: ğŸ’¡ To use phone authentication:
2025-09-20T16:17:30:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:17:30:    2. Select "Phone Number Authentication"
2025-09-20T16:17:30:    3. Enter your phone number
2025-09-20T16:17:30:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:17:30: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:17:35: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:17:35: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:17:35: ğŸ”„ Reconnecting in 8s... (Attempt 4/10)
2025-09-20T16:17:39: ğŸ’¾ Data synced to files successfully
2025-09-20T16:17:43: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:17:43: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:17:43: âœ… Google Sheets API initialized
2025-09-20T16:17:43: âœ… Google Sheets API initialized
2025-09-20T16:17:43: â„¹ï¸ [4:17:43 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:17:43:   startupTime: 1758365229286,
2025-09-20T16:17:43:   gracePeriodMs: 240000,
2025-09-20T16:17:43:   dataDir: './safety-data',
2025-09-20T16:17:43:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:17:43:   processId: 13956,
2025-09-20T16:17:43:   nodeVersion: 'v22.19.0'
2025-09-20T16:17:43: }
2025-09-20T16:17:43: â„¹ï¸ [4:17:43 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:17:43: â„¹ï¸ [4:17:43 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:17:43: ğŸ§¹ Removed stale process lock
2025-09-20T16:17:43: ğŸ”’ Process lock acquired (PID: 13956)
2025-09-20T16:17:43: â„¹ï¸ [4:17:43 pm] INFO: Process isolation enforced {
2025-09-20T16:17:43:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:17:43:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:17:43:   processId: 13956
2025-09-20T16:17:43: }
2025-09-20T16:17:43: â° Starting 240 second startup grace period...
2025-09-20T16:17:43: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:17:43: â„¹ï¸ [4:17:43 pm] INFO: Grace Period: STARTED {
2025-09-20T16:17:43:   action: 'STARTED',
2025-09-20T16:17:43:   remainingMs: 240000,
2025-09-20T16:17:43:   remainingSeconds: 240,
2025-09-20T16:17:43:   details: { startupTime: 1758365229286, processId: 13956 },
2025-09-20T16:17:43:   timestamp: 1758365263918
2025-09-20T16:17:43: }
2025-09-20T16:17:43: â„¹ï¸ [4:17:43 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:17:43:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:17:43:   remainingMs: 240000,
2025-09-20T16:17:43:   remainingSeconds: 240,
2025-09-20T16:17:43:   details: { startupTime: 1758365229286, willExpireAt: 1758365469286 },
2025-09-20T16:17:43:   timestamp: 1758365263918
2025-09-20T16:17:43: }
2025-09-20T16:17:43: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:17:43: â° Startup grace period: 240 seconds
2025-09-20T16:17:43: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:17:43: â„¹ï¸ [4:17:43 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:17:43:   initializationDuration: 34636,
2025-09-20T16:17:43:   gracePeriodActive: true,
2025-09-20T16:17:43:   messageRulesCount: 8,
2025-09-20T16:17:43:   messageTypes: [
2025-09-20T16:17:43:     'welcome',
2025-09-20T16:17:43:     'confirmation',
2025-09-20T16:17:43:     'ready',
2025-09-20T16:17:43:     'delivery',
2025-09-20T16:17:43:     'pickup_reminder',
2025-09-20T16:17:43:     'payment_reminder',
2025-09-20T16:17:43:     'fabric_welcome',
2025-09-20T16:17:43:     'fabric_purchase'
2025-09-20T16:17:43:   ],
2025-09-20T16:17:43:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:17:43:   databaseReady: true,
2025-09-20T16:17:43:   loggerReady: true,
2025-09-20T16:17:43:   processIsolationActive: true
2025-09-20T16:17:43: }
2025-09-20T16:17:43: âœ… Safety Manager initialized
2025-09-20T16:17:43: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:17:43: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:17:43: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:17:43: ğŸ“ Loaded statistics from file
2025-09-20T16:17:43: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:17:43: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:17:43: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:17:43: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:17:43: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:17:43: âœ… WhatsApp connection started
2025-09-20T16:17:43: ğŸ”§ Initializing admin commands...
2025-09-20T16:17:43: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:17:43: âœ… Admin commands system initialized
2025-09-20T16:17:43: ğŸ”„ Initializing polling functionality...
2025-09-20T16:17:43: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:17:43: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:17:43: ğŸ“ Attempting to request pairing code...
2025-09-20T16:17:43: ğŸ’¡ To use phone authentication:
2025-09-20T16:17:43:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:17:43:    2. Select "Phone Number Authentication"
2025-09-20T16:17:43:    3. Enter your phone number
2025-09-20T16:17:43:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:17:43: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:17:46: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:17:46: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:17:46: ğŸ”„ Reconnecting in 16s... (Attempt 5/10)
2025-09-20T16:18:02: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:18:02: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:18:02: âœ… Google Sheets API initialized
2025-09-20T16:18:02: âœ… Google Sheets API initialized
2025-09-20T16:18:02: â„¹ï¸ [4:18:02 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:18:02:   startupTime: 1758365229286,
2025-09-20T16:18:02:   gracePeriodMs: 240000,
2025-09-20T16:18:02:   dataDir: './safety-data',
2025-09-20T16:18:02:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:18:02:   processId: 13956,
2025-09-20T16:18:02:   nodeVersion: 'v22.19.0'
2025-09-20T16:18:02: }
2025-09-20T16:18:02: â„¹ï¸ [4:18:02 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:18:02: â„¹ï¸ [4:18:02 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:18:02: ğŸ§¹ Removed stale process lock
2025-09-20T16:18:02: ğŸ”’ Process lock acquired (PID: 13956)
2025-09-20T16:18:02: â„¹ï¸ [4:18:02 pm] INFO: Process isolation enforced {
2025-09-20T16:18:02:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:18:02:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:18:02:   processId: 13956
2025-09-20T16:18:02: }
2025-09-20T16:18:02: â° Starting 240 second startup grace period...
2025-09-20T16:18:02: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:18:02: â„¹ï¸ [4:18:02 pm] INFO: Grace Period: STARTED {
2025-09-20T16:18:02:   action: 'STARTED',
2025-09-20T16:18:02:   remainingMs: 240000,
2025-09-20T16:18:02:   remainingSeconds: 240,
2025-09-20T16:18:02:   details: { startupTime: 1758365229286, processId: 13956 },
2025-09-20T16:18:02:   timestamp: 1758365282721
2025-09-20T16:18:02: }
2025-09-20T16:18:02: â„¹ï¸ [4:18:02 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:18:02:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:18:02:   remainingMs: 240000,
2025-09-20T16:18:02:   remainingSeconds: 240,
2025-09-20T16:18:02:   details: { startupTime: 1758365229286, willExpireAt: 1758365469286 },
2025-09-20T16:18:02:   timestamp: 1758365282722
2025-09-20T16:18:02: }
2025-09-20T16:18:02: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:18:02: â° Startup grace period: 240 seconds
2025-09-20T16:18:02: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:18:02: â„¹ï¸ [4:18:02 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:18:02:   initializationDuration: 53438,
2025-09-20T16:18:02:   gracePeriodActive: true,
2025-09-20T16:18:02:   messageRulesCount: 8,
2025-09-20T16:18:02:   messageTypes: [
2025-09-20T16:18:02:     'welcome',
2025-09-20T16:18:02:     'confirmation',
2025-09-20T16:18:02:     'ready',
2025-09-20T16:18:02:     'delivery',
2025-09-20T16:18:02:     'pickup_reminder',
2025-09-20T16:18:02:     'payment_reminder',
2025-09-20T16:18:02:     'fabric_welcome',
2025-09-20T16:18:02:     'fabric_purchase'
2025-09-20T16:18:02:   ],
2025-09-20T16:18:02:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:18:02:   databaseReady: true,
2025-09-20T16:18:02:   loggerReady: true,
2025-09-20T16:18:02:   processIsolationActive: true
2025-09-20T16:18:02: }
2025-09-20T16:18:02: âœ… Safety Manager initialized
2025-09-20T16:18:02: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:18:02: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:18:02: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:18:02: ğŸ“ Loaded statistics from file
2025-09-20T16:18:02: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:18:02: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:18:02: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:18:02: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:18:02: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:18:02: âœ… WhatsApp connection started
2025-09-20T16:18:02: ğŸ”§ Initializing admin commands...
2025-09-20T16:18:02: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:18:02: âœ… Admin commands system initialized
2025-09-20T16:18:02: ğŸ”„ Initializing polling functionality...
2025-09-20T16:18:02: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:18:02: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:18:02: ğŸ“ Attempting to request pairing code...
2025-09-20T16:18:02: ğŸ’¡ To use phone authentication:
2025-09-20T16:18:02:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:18:02:    2. Select "Phone Number Authentication"
2025-09-20T16:18:02:    3. Enter your phone number
2025-09-20T16:18:02:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:18:02: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:18:05: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:18:05: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:18:05: ğŸ”„ Reconnecting in 30s... (Attempt 6/10)
2025-09-20T16:18:09: ğŸ’¾ Data synced to files successfully
2025-09-20T16:18:35: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:18:35: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:18:35: âœ… Google Sheets API initialized
2025-09-20T16:18:35: âœ… Google Sheets API initialized
2025-09-20T16:18:35: â„¹ï¸ [4:18:35 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:18:35:   startupTime: 1758365229286,
2025-09-20T16:18:35:   gracePeriodMs: 240000,
2025-09-20T16:18:35:   dataDir: './safety-data',
2025-09-20T16:18:35:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:18:35:   processId: 13956,
2025-09-20T16:18:35:   nodeVersion: 'v22.19.0'
2025-09-20T16:18:35: }
2025-09-20T16:18:35: â„¹ï¸ [4:18:35 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:18:35: â„¹ï¸ [4:18:35 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:18:35: ğŸ§¹ Removed stale process lock
2025-09-20T16:18:35: ğŸ”’ Process lock acquired (PID: 13956)
2025-09-20T16:18:35: â„¹ï¸ [4:18:35 pm] INFO: Process isolation enforced {
2025-09-20T16:18:35:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:18:35:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:18:35:   processId: 13956
2025-09-20T16:18:35: }
2025-09-20T16:18:35: â° Starting 240 second startup grace period...
2025-09-20T16:18:35: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:18:35: â„¹ï¸ [4:18:35 pm] INFO: Grace Period: STARTED {
2025-09-20T16:18:35:   action: 'STARTED',
2025-09-20T16:18:35:   remainingMs: 240000,
2025-09-20T16:18:35:   remainingSeconds: 240,
2025-09-20T16:18:35:   details: { startupTime: 1758365229286, processId: 13956 },
2025-09-20T16:18:35:   timestamp: 1758365315254
2025-09-20T16:18:35: }
2025-09-20T16:18:35: â„¹ï¸ [4:18:35 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:18:35:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:18:35:   remainingMs: 240000,
2025-09-20T16:18:35:   remainingSeconds: 240,
2025-09-20T16:18:35:   details: { startupTime: 1758365229286, willExpireAt: 1758365469286 },
2025-09-20T16:18:35:   timestamp: 1758365315255
2025-09-20T16:18:35: }
2025-09-20T16:18:35: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:18:35: â° Startup grace period: 240 seconds
2025-09-20T16:18:35: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:18:35: â„¹ï¸ [4:18:35 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:18:35:   initializationDuration: 85974,
2025-09-20T16:18:35:   gracePeriodActive: true,
2025-09-20T16:18:35:   messageRulesCount: 8,
2025-09-20T16:18:35:   messageTypes: [
2025-09-20T16:18:35:     'welcome',
2025-09-20T16:18:35:     'confirmation',
2025-09-20T16:18:35:     'ready',
2025-09-20T16:18:35:     'delivery',
2025-09-20T16:18:35:     'pickup_reminder',
2025-09-20T16:18:35:     'payment_reminder',
2025-09-20T16:18:35:     'fabric_welcome',
2025-09-20T16:18:35:     'fabric_purchase'
2025-09-20T16:18:35:   ],
2025-09-20T16:18:35:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:18:35:   databaseReady: true,
2025-09-20T16:18:35:   loggerReady: true,
2025-09-20T16:18:35:   processIsolationActive: true
2025-09-20T16:18:35: }
2025-09-20T16:18:35: âœ… Safety Manager initialized
2025-09-20T16:18:35: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:18:35: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:18:35: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:18:35: ğŸ“ Loaded statistics from file
2025-09-20T16:18:35: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:18:35: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:18:35: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:18:35: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:18:35: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:18:35: âœ… WhatsApp connection started
2025-09-20T16:18:35: ğŸ”§ Initializing admin commands...
2025-09-20T16:18:35: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:18:35: âœ… Admin commands system initialized
2025-09-20T16:18:35: ğŸ”„ Initializing polling functionality...
2025-09-20T16:18:35: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:18:35: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:18:35: ğŸ“ Attempting to request pairing code...
2025-09-20T16:18:35: ğŸ’¡ To use phone authentication:
2025-09-20T16:18:35:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:18:35:    2. Select "Phone Number Authentication"
2025-09-20T16:18:35:    3. Enter your phone number
2025-09-20T16:18:35:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:18:35: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:18:39: ğŸ’¾ Data synced to files successfully
2025-09-20T16:18:41: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:18:41: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:18:41: ğŸ”„ Reconnecting in 30s... (Attempt 7/10)
2025-09-20T16:19:06: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T16:19:06: ğŸ“ Loaded 11 template types
2025-09-20T16:19:06: ğŸ”§ WhatsApp Bot initialized
2025-09-20T16:19:06: ğŸ“Š Configuration status: undefined
2025-09-20T16:19:06: âœ… Atomic State Manager initialized
2025-09-20T16:19:06: ğŸ“ Enhanced Logger initialized
2025-09-20T16:19:06: âœ… Google credentials loaded from service-account.json file
2025-09-20T16:19:06: ğŸ“± WhatsApp auth status: âœ… credentials, 5 session files
2025-09-20T16:19:06: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-20T16:19:06:    Auth Mode: both
2025-09-20T16:19:06:    QR Enabled: true
2025-09-20T16:19:06:    Phone Enabled: true
2025-09-20T16:19:06:    Session Persistence: true
2025-09-20T16:19:06:    Max Reconnect Attempts: 10
2025-09-20T16:19:06:    Default Phone: None
2025-09-20T16:19:06: ğŸ”’ Session validation enabled (check every 300s)
2025-09-20T16:19:06: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-20T16:19:06: ğŸ”§ Developer Configuration initialized
2025-09-20T16:19:06: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T16:19:06: â„¹ï¸ [4:19:06 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:19:06:   startupTime: 1758365346357,
2025-09-20T16:19:06:   gracePeriodMs: 240000,
2025-09-20T16:19:06:   dataDir: './safety-data',
2025-09-20T16:19:06:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:19:06:   processId: 12624,
2025-09-20T16:19:06:   nodeVersion: 'v22.19.0'
2025-09-20T16:19:06: }
2025-09-20T16:19:06: ğŸ”§ Developer Configuration initialized
2025-09-20T16:19:06: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T16:19:06: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-20T16:19:06: â° 4-minute startup delay active
2025-09-20T16:19:06: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-20T16:19:06: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-20T16:19:06: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:19:06: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:19:06: âœ… Google Sheets API initialized
2025-09-20T16:19:06: âœ… Google Sheets API initialized
2025-09-20T16:19:06: â„¹ï¸ [4:19:06 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:19:06:   startupTime: 1758365346357,
2025-09-20T16:19:06:   gracePeriodMs: 240000,
2025-09-20T16:19:06:   dataDir: './safety-data',
2025-09-20T16:19:06:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:19:06:   processId: 12624,
2025-09-20T16:19:06:   nodeVersion: 'v22.19.0'
2025-09-20T16:19:06: }
2025-09-20T16:19:06: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:19:06: â„¹ï¸ [4:19:06 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:19:06: â„¹ï¸ [4:19:06 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:19:06: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:19:06: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:19:06: â„¹ï¸ [4:19:06 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:19:06: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T09-40-30-382Z.log
2025-09-20T16:19:06: ğŸ“ Enhanced Logger initialized
2025-09-20T16:19:06: â„¹ï¸ [4:19:06 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:19:06: ğŸ“ Loaded statistics from file
2025-09-20T16:19:06: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:19:06: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:19:06: ğŸ§¹ Removed stale process lock
2025-09-20T16:19:06: ğŸ§¹ Lock file already cleaned up
2025-09-20T16:19:06: ğŸ”’ Process lock acquired (PID: 12624)
2025-09-20T16:19:06: ğŸ”’ Process lock acquired (PID: 12624)
2025-09-20T16:19:06: â„¹ï¸ [4:19:06 pm] INFO: Process isolation enforced {
2025-09-20T16:19:06:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:19:06:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:19:06:   processId: 12624
2025-09-20T16:19:06: }
2025-09-20T16:19:06: â° Starting 240 second startup grace period...
2025-09-20T16:19:06: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:19:06: â„¹ï¸ [4:19:06 pm] INFO: Process isolation enforced {
2025-09-20T16:19:06:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:19:06:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:19:06:   processId: 12624
2025-09-20T16:19:06: }
2025-09-20T16:19:06: â° Starting 240 second startup grace period...
2025-09-20T16:19:06: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:19:06: â„¹ï¸ [4:19:06 pm] INFO: Grace Period: STARTED {
2025-09-20T16:19:06:   action: 'STARTED',
2025-09-20T16:19:06:   remainingMs: 240000,
2025-09-20T16:19:06:   remainingSeconds: 240,
2025-09-20T16:19:06:   details: { startupTime: 1758365346357, processId: 12624 },
2025-09-20T16:19:06:   timestamp: 1758365346398
2025-09-20T16:19:06: }
2025-09-20T16:19:06: â„¹ï¸ [4:19:06 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:19:06:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:19:06:   remainingMs: 240000,
2025-09-20T16:19:06:   remainingSeconds: 240,
2025-09-20T16:19:06:   details: { startupTime: 1758365346357, willExpireAt: 1758365586357 },
2025-09-20T16:19:06:   timestamp: 1758365346398
2025-09-20T16:19:06: }
2025-09-20T16:19:06: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:19:06: â° Startup grace period: 240 seconds
2025-09-20T16:19:06: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:19:06: â„¹ï¸ [4:19:06 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:19:06:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:19:06:   remainingMs: 240000,
2025-09-20T16:19:06:   remainingSeconds: 240,
2025-09-20T16:19:06:   details: { startupTime: 1758365346357, willExpireAt: 1758365586357 },
2025-09-20T16:19:06:   timestamp: 1758365346400
2025-09-20T16:19:06: }
2025-09-20T16:19:06: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:19:06: â° Startup grace period: 240 seconds
2025-09-20T16:19:06: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:19:06: â„¹ï¸ [4:19:06 pm] INFO: Grace Period: STARTED {
2025-09-20T16:19:06:   action: 'STARTED',
2025-09-20T16:19:06:   remainingMs: 240000,
2025-09-20T16:19:06:   remainingSeconds: 240,
2025-09-20T16:19:06:   details: { startupTime: 1758365346357, processId: 12624 },
2025-09-20T16:19:06:   timestamp: 1758365346400
2025-09-20T16:19:06: }
2025-09-20T16:19:06: â„¹ï¸ [4:19:06 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:19:06:   initializationDuration: 43,
2025-09-20T16:19:06:   gracePeriodActive: true,
2025-09-20T16:19:06:   messageRulesCount: 8,
2025-09-20T16:19:06:   messageTypes: [
2025-09-20T16:19:06:     'welcome',
2025-09-20T16:19:06:     'confirmation',
2025-09-20T16:19:06:     'ready',
2025-09-20T16:19:06:     'delivery',
2025-09-20T16:19:06:     'pickup_reminder',
2025-09-20T16:19:06:     'payment_reminder',
2025-09-20T16:19:06:     'fabric_welcome',
2025-09-20T16:19:06:     'fabric_purchase'
2025-09-20T16:19:06:   ],
2025-09-20T16:19:06:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:19:06:   databaseReady: true,
2025-09-20T16:19:06:   loggerReady: true,
2025-09-20T16:19:06:   processIsolationActive: true
2025-09-20T16:19:06: }
2025-09-20T16:19:06: â„¹ï¸ [4:19:06 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:19:06:   initializationDuration: 45,
2025-09-20T16:19:06:   gracePeriodActive: true,
2025-09-20T16:19:06:   messageRulesCount: 8,
2025-09-20T16:19:06:   messageTypes: [
2025-09-20T16:19:06:     'welcome',
2025-09-20T16:19:06:     'confirmation',
2025-09-20T16:19:06:     'ready',
2025-09-20T16:19:06:     'delivery',
2025-09-20T16:19:06:     'pickup_reminder',
2025-09-20T16:19:06:     'payment_reminder',
2025-09-20T16:19:06:     'fabric_welcome',
2025-09-20T16:19:06:     'fabric_purchase'
2025-09-20T16:19:06:   ],
2025-09-20T16:19:06:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:19:06:   databaseReady: true,
2025-09-20T16:19:06:   loggerReady: true,
2025-09-20T16:19:06:   processIsolationActive: true
2025-09-20T16:19:06: }
2025-09-20T16:19:06: âœ… Safety Manager initialized
2025-09-20T16:19:06: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:19:06: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:19:06: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:19:06: ğŸ“ Loaded statistics from file
2025-09-20T16:19:06: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:19:06: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:19:06: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:19:06: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:19:06: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:19:06: âœ… WhatsApp connection started
2025-09-20T16:19:06: ğŸ”§ Initializing admin commands...
2025-09-20T16:19:06: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:19:06: âœ… Admin commands system initialized
2025-09-20T16:19:06: ğŸ”„ Initializing polling functionality...
2025-09-20T16:19:06: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:19:06: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:19:06: ğŸ“ Attempting to request pairing code...
2025-09-20T16:19:06: ğŸ’¡ To use phone authentication:
2025-09-20T16:19:06:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:19:06:    2. Select "Phone Number Authentication"
2025-09-20T16:19:06:    3. Enter your phone number
2025-09-20T16:19:06:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:19:06: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:19:10: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:19:10: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:19:10: ğŸ”„ Reconnecting in 1s... (Attempt 1/10)
2025-09-20T16:19:11: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:19:11: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:19:11: âœ… Google Sheets API initialized
2025-09-20T16:19:11: âœ… Google Sheets API initialized
2025-09-20T16:19:11: â„¹ï¸ [4:19:11 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:19:11:   startupTime: 1758365346357,
2025-09-20T16:19:11:   gracePeriodMs: 240000,
2025-09-20T16:19:11:   dataDir: './safety-data',
2025-09-20T16:19:11:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:19:11:   processId: 12624,
2025-09-20T16:19:11:   nodeVersion: 'v22.19.0'
2025-09-20T16:19:11: }
2025-09-20T16:19:11: â„¹ï¸ [4:19:11 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:19:11: â„¹ï¸ [4:19:11 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:19:11: ğŸ§¹ Removed stale process lock
2025-09-20T16:19:11: ğŸ”’ Process lock acquired (PID: 12624)
2025-09-20T16:19:11: â„¹ï¸ [4:19:11 pm] INFO: Process isolation enforced {
2025-09-20T16:19:11:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:19:11:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:19:11:   processId: 12624
2025-09-20T16:19:11: }
2025-09-20T16:19:11: â° Starting 240 second startup grace period...
2025-09-20T16:19:11: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:19:11: â„¹ï¸ [4:19:11 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:19:11:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:19:11:   remainingMs: 240000,
2025-09-20T16:19:11:   remainingSeconds: 240,
2025-09-20T16:19:11:   details: { startupTime: 1758365346357, willExpireAt: 1758365586357 },
2025-09-20T16:19:11:   timestamp: 1758365351073
2025-09-20T16:19:11: }
2025-09-20T16:19:11: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:19:11: â° Startup grace period: 240 seconds
2025-09-20T16:19:11: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:19:11: â„¹ï¸ [4:19:11 pm] INFO: Grace Period: STARTED {
2025-09-20T16:19:11:   action: 'STARTED',
2025-09-20T16:19:11:   remainingMs: 240000,
2025-09-20T16:19:11:   remainingSeconds: 240,
2025-09-20T16:19:11:   details: { startupTime: 1758365346357, processId: 12624 },
2025-09-20T16:19:11:   timestamp: 1758365351073
2025-09-20T16:19:11: }
2025-09-20T16:19:11: â„¹ï¸ [4:19:11 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:19:11:   initializationDuration: 4718,
2025-09-20T16:19:11:   gracePeriodActive: true,
2025-09-20T16:19:11:   messageRulesCount: 8,
2025-09-20T16:19:11:   messageTypes: [
2025-09-20T16:19:11:     'welcome',
2025-09-20T16:19:11:     'confirmation',
2025-09-20T16:19:11:     'ready',
2025-09-20T16:19:11:     'delivery',
2025-09-20T16:19:11:     'pickup_reminder',
2025-09-20T16:19:11:     'payment_reminder',
2025-09-20T16:19:11:     'fabric_welcome',
2025-09-20T16:19:11:     'fabric_purchase'
2025-09-20T16:19:11:   ],
2025-09-20T16:19:11:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:19:11:   databaseReady: true,
2025-09-20T16:19:11:   loggerReady: true,
2025-09-20T16:19:11:   processIsolationActive: true
2025-09-20T16:19:11: }
2025-09-20T16:19:11: âœ… Safety Manager initialized
2025-09-20T16:19:11: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:19:11: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:19:11: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:19:11: ğŸ“ Loaded statistics from file
2025-09-20T16:19:11: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:19:11: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:19:11: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:19:11: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:19:11: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:19:11: âœ… WhatsApp connection started
2025-09-20T16:19:11: ğŸ”§ Initializing admin commands...
2025-09-20T16:19:11: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:19:11: âœ… Admin commands system initialized
2025-09-20T16:19:11: ğŸ”„ Initializing polling functionality...
2025-09-20T16:19:11: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:19:11: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:19:11: ğŸ“ Attempting to request pairing code...
2025-09-20T16:19:11: ğŸ’¡ To use phone authentication:
2025-09-20T16:19:11:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:19:11:    2. Select "Phone Number Authentication"
2025-09-20T16:19:11:    3. Enter your phone number
2025-09-20T16:19:11:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:19:11: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:19:16: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:19:16: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:19:16: ğŸ”„ Reconnecting in 2s... (Attempt 2/10)
2025-09-20T16:19:18: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:19:18: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:19:18: âœ… Google Sheets API initialized
2025-09-20T16:19:18: âœ… Google Sheets API initialized
2025-09-20T16:19:18: â„¹ï¸ [4:19:18 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:19:18:   startupTime: 1758365346357,
2025-09-20T16:19:18:   gracePeriodMs: 240000,
2025-09-20T16:19:18:   dataDir: './safety-data',
2025-09-20T16:19:18:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:19:18:   processId: 12624,
2025-09-20T16:19:18:   nodeVersion: 'v22.19.0'
2025-09-20T16:19:18: }
2025-09-20T16:19:18: â„¹ï¸ [4:19:18 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:19:18: â„¹ï¸ [4:19:18 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:19:18: ğŸ§¹ Removed stale process lock
2025-09-20T16:19:18: ğŸ”’ Process lock acquired (PID: 12624)
2025-09-20T16:19:18: â„¹ï¸ [4:19:18 pm] INFO: Process isolation enforced {
2025-09-20T16:19:18:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:19:18:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:19:18:   processId: 12624
2025-09-20T16:19:18: }
2025-09-20T16:19:18: â° Starting 240 second startup grace period...
2025-09-20T16:19:18: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:19:18: â„¹ï¸ [4:19:18 pm] INFO: Grace Period: STARTED {
2025-09-20T16:19:18:   action: 'STARTED',
2025-09-20T16:19:18:   remainingMs: 240000,
2025-09-20T16:19:18:   remainingSeconds: 240,
2025-09-20T16:19:18:   details: { startupTime: 1758365346357, processId: 12624 },
2025-09-20T16:19:18:   timestamp: 1758365358628
2025-09-20T16:19:18: }
2025-09-20T16:19:18: â„¹ï¸ [4:19:18 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:19:18:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:19:18:   remainingMs: 240000,
2025-09-20T16:19:18:   remainingSeconds: 240,
2025-09-20T16:19:18:   details: { startupTime: 1758365346357, willExpireAt: 1758365586357 },
2025-09-20T16:19:18:   timestamp: 1758365358628
2025-09-20T16:19:18: }
2025-09-20T16:19:18: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:19:18: â° Startup grace period: 240 seconds
2025-09-20T16:19:18: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:19:18: â„¹ï¸ [4:19:18 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:19:18:   initializationDuration: 12275,
2025-09-20T16:19:18:   gracePeriodActive: true,
2025-09-20T16:19:18:   messageRulesCount: 8,
2025-09-20T16:19:18:   messageTypes: [
2025-09-20T16:19:18:     'welcome',
2025-09-20T16:19:18:     'confirmation',
2025-09-20T16:19:18:     'ready',
2025-09-20T16:19:18:     'delivery',
2025-09-20T16:19:18:     'pickup_reminder',
2025-09-20T16:19:18:     'payment_reminder',
2025-09-20T16:19:18:     'fabric_welcome',
2025-09-20T16:19:18:     'fabric_purchase'
2025-09-20T16:19:18:   ],
2025-09-20T16:19:18:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:19:18:   databaseReady: true,
2025-09-20T16:19:18:   loggerReady: true,
2025-09-20T16:19:18:   processIsolationActive: true
2025-09-20T16:19:18: }
2025-09-20T16:19:18: âœ… Safety Manager initialized
2025-09-20T16:19:18: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:19:18: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:19:18: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:19:18: ğŸ“ Loaded statistics from file
2025-09-20T16:19:18: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:19:18: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:19:18: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:19:18: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:19:18: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:19:18: âœ… WhatsApp connection started
2025-09-20T16:19:18: ğŸ”§ Initializing admin commands...
2025-09-20T16:19:18: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:19:18: âœ… Admin commands system initialized
2025-09-20T16:19:18: ğŸ”„ Initializing polling functionality...
2025-09-20T16:19:18: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:19:18: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:19:18: ğŸ“ Attempting to request pairing code...
2025-09-20T16:19:18: ğŸ’¡ To use phone authentication:
2025-09-20T16:19:18:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:19:18:    2. Select "Phone Number Authentication"
2025-09-20T16:19:18:    3. Enter your phone number
2025-09-20T16:19:18:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:19:18: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:19:19: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:19:19: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:19:19: ğŸ”„ Reconnecting in 4s... (Attempt 3/10)
2025-09-20T16:19:23: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:19:23: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:19:23: âœ… Google Sheets API initialized
2025-09-20T16:19:23: âœ… Google Sheets API initialized
2025-09-20T16:19:23: â„¹ï¸ [4:19:23 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:19:23:   startupTime: 1758365346357,
2025-09-20T16:19:23:   gracePeriodMs: 240000,
2025-09-20T16:19:23:   dataDir: './safety-data',
2025-09-20T16:19:23:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:19:23:   processId: 12624,
2025-09-20T16:19:23:   nodeVersion: 'v22.19.0'
2025-09-20T16:19:23: }
2025-09-20T16:19:23: â„¹ï¸ [4:19:23 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:19:23: â„¹ï¸ [4:19:23 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:19:23: ğŸ§¹ Removed stale process lock
2025-09-20T16:19:24: ğŸ”’ Process lock acquired (PID: 12624)
2025-09-20T16:19:24: â„¹ï¸ [4:19:24 pm] INFO: Process isolation enforced {
2025-09-20T16:19:24:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:19:24:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:19:24:   processId: 12624
2025-09-20T16:19:24: }
2025-09-20T16:19:24: â° Starting 240 second startup grace period...
2025-09-20T16:19:24: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:19:24: â„¹ï¸ [4:19:24 pm] INFO: Grace Period: STARTED {
2025-09-20T16:19:24:   action: 'STARTED',
2025-09-20T16:19:24:   remainingMs: 240000,
2025-09-20T16:19:24:   remainingSeconds: 240,
2025-09-20T16:19:24:   details: { startupTime: 1758365346357, processId: 12624 },
2025-09-20T16:19:24:   timestamp: 1758365364008
2025-09-20T16:19:24: }
2025-09-20T16:19:24: â„¹ï¸ [4:19:24 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:19:24:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:19:24:   remainingMs: 240000,
2025-09-20T16:19:24:   remainingSeconds: 240,
2025-09-20T16:19:24:   details: { startupTime: 1758365346357, willExpireAt: 1758365586357 },
2025-09-20T16:19:24:   timestamp: 1758365364009
2025-09-20T16:19:24: }
2025-09-20T16:19:24: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:19:24: â° Startup grace period: 240 seconds
2025-09-20T16:19:24: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:19:24: â„¹ï¸ [4:19:24 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:19:24:   initializationDuration: 17654,
2025-09-20T16:19:24:   gracePeriodActive: true,
2025-09-20T16:19:24:   messageRulesCount: 8,
2025-09-20T16:19:24:   messageTypes: [
2025-09-20T16:19:24:     'welcome',
2025-09-20T16:19:24:     'confirmation',
2025-09-20T16:19:24:     'ready',
2025-09-20T16:19:24:     'delivery',
2025-09-20T16:19:24:     'pickup_reminder',
2025-09-20T16:19:24:     'payment_reminder',
2025-09-20T16:19:24:     'fabric_welcome',
2025-09-20T16:19:24:     'fabric_purchase'
2025-09-20T16:19:24:   ],
2025-09-20T16:19:24:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:19:24:   databaseReady: true,
2025-09-20T16:19:24:   loggerReady: true,
2025-09-20T16:19:24:   processIsolationActive: true
2025-09-20T16:19:24: }
2025-09-20T16:19:24: âœ… Safety Manager initialized
2025-09-20T16:19:24: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:19:24: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:19:24: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:19:24: ğŸ“ Loaded statistics from file
2025-09-20T16:19:24: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:19:24: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:19:24: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:19:24: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:19:24: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:19:24: âœ… WhatsApp connection started
2025-09-20T16:19:24: ğŸ”§ Initializing admin commands...
2025-09-20T16:19:24: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:19:24: âœ… Admin commands system initialized
2025-09-20T16:19:24: ğŸ”„ Initializing polling functionality...
2025-09-20T16:19:24: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:19:24: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:19:24: ğŸ“ Attempting to request pairing code...
2025-09-20T16:19:24: ğŸ’¡ To use phone authentication:
2025-09-20T16:19:24:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:19:24:    2. Select "Phone Number Authentication"
2025-09-20T16:19:24:    3. Enter your phone number
2025-09-20T16:19:24:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:19:24: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:19:28: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:19:28: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:19:28: ğŸ”„ Reconnecting in 8s... (Attempt 4/10)
2025-09-20T16:19:36: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:19:36: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:19:36: âœ… Google Sheets API initialized
2025-09-20T16:19:36: âœ… Google Sheets API initialized
2025-09-20T16:19:36: â„¹ï¸ [4:19:36 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:19:36:   startupTime: 1758365346357,
2025-09-20T16:19:36:   gracePeriodMs: 240000,
2025-09-20T16:19:36:   dataDir: './safety-data',
2025-09-20T16:19:36:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:19:36:   processId: 12624,
2025-09-20T16:19:36:   nodeVersion: 'v22.19.0'
2025-09-20T16:19:36: }
2025-09-20T16:19:36: â„¹ï¸ [4:19:36 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:19:36: â„¹ï¸ [4:19:36 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:19:36: ğŸ§¹ Removed stale process lock
2025-09-20T16:19:36: ğŸ”’ Process lock acquired (PID: 12624)
2025-09-20T16:19:36: â„¹ï¸ [4:19:36 pm] INFO: Process isolation enforced {
2025-09-20T16:19:36:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:19:36:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:19:36:   processId: 12624
2025-09-20T16:19:36: }
2025-09-20T16:19:36: â° Starting 240 second startup grace period...
2025-09-20T16:19:36: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:19:36: â„¹ï¸ [4:19:36 pm] INFO: Grace Period: STARTED {
2025-09-20T16:19:36:   action: 'STARTED',
2025-09-20T16:19:36:   remainingMs: 240000,
2025-09-20T16:19:36:   remainingSeconds: 240,
2025-09-20T16:19:36:   details: { startupTime: 1758365346357, processId: 12624 },
2025-09-20T16:19:36:   timestamp: 1758365376201
2025-09-20T16:19:36: }
2025-09-20T16:19:36: â„¹ï¸ [4:19:36 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:19:36:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:19:36:   remainingMs: 240000,
2025-09-20T16:19:36:   remainingSeconds: 240,
2025-09-20T16:19:36:   details: { startupTime: 1758365346357, willExpireAt: 1758365586357 },
2025-09-20T16:19:36:   timestamp: 1758365376202
2025-09-20T16:19:36: }
2025-09-20T16:19:36: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:19:36: â° Startup grace period: 240 seconds
2025-09-20T16:19:36: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:19:36: â„¹ï¸ [4:19:36 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:19:36:   initializationDuration: 29850,
2025-09-20T16:19:36:   gracePeriodActive: true,
2025-09-20T16:19:36:   messageRulesCount: 8,
2025-09-20T16:19:36:   messageTypes: [
2025-09-20T16:19:36:     'welcome',
2025-09-20T16:19:36:     'confirmation',
2025-09-20T16:19:36:     'ready',
2025-09-20T16:19:36:     'delivery',
2025-09-20T16:19:36:     'pickup_reminder',
2025-09-20T16:19:36:     'payment_reminder',
2025-09-20T16:19:36:     'fabric_welcome',
2025-09-20T16:19:36:     'fabric_purchase'
2025-09-20T16:19:36:   ],
2025-09-20T16:19:36:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:19:36:   databaseReady: true,
2025-09-20T16:19:36:   loggerReady: true,
2025-09-20T16:19:36:   processIsolationActive: true
2025-09-20T16:19:36: }
2025-09-20T16:19:36: âœ… Safety Manager initialized
2025-09-20T16:19:36: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:19:36: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:19:36: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:19:36: ğŸ“ Loaded statistics from file
2025-09-20T16:19:36: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:19:36: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:19:36: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:19:36: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:19:36: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:19:36: âœ… WhatsApp connection started
2025-09-20T16:19:36: ğŸ”§ Initializing admin commands...
2025-09-20T16:19:36: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:19:36: âœ… Admin commands system initialized
2025-09-20T16:19:36: ğŸ”„ Initializing polling functionality...
2025-09-20T16:19:36: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:19:36: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:19:36: ğŸ“ Attempting to request pairing code...
2025-09-20T16:19:36: ğŸ’¡ To use phone authentication:
2025-09-20T16:19:36:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:19:36:    2. Select "Phone Number Authentication"
2025-09-20T16:19:36:    3. Enter your phone number
2025-09-20T16:19:36:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:19:36: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:19:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:19:43: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:19:43: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:19:43: ğŸ”„ Reconnecting in 16s... (Attempt 5/10)
2025-09-20T16:19:59: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:19:59: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:19:59: âœ… Google Sheets API initialized
2025-09-20T16:19:59: âœ… Google Sheets API initialized
2025-09-20T16:19:59: â„¹ï¸ [4:19:59 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:19:59:   startupTime: 1758365346357,
2025-09-20T16:19:59:   gracePeriodMs: 240000,
2025-09-20T16:19:59:   dataDir: './safety-data',
2025-09-20T16:19:59:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:19:59:   processId: 12624,
2025-09-20T16:19:59:   nodeVersion: 'v22.19.0'
2025-09-20T16:19:59: }
2025-09-20T16:19:59: â„¹ï¸ [4:19:59 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:19:59: â„¹ï¸ [4:19:59 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:19:59: ğŸ§¹ Removed stale process lock
2025-09-20T16:19:59: ğŸ”’ Process lock acquired (PID: 12624)
2025-09-20T16:19:59: â„¹ï¸ [4:19:59 pm] INFO: Process isolation enforced {
2025-09-20T16:19:59:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:19:59:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:19:59:   processId: 12624
2025-09-20T16:19:59: }
2025-09-20T16:19:59: â° Starting 240 second startup grace period...
2025-09-20T16:19:59: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:19:59: â„¹ï¸ [4:19:59 pm] INFO: Grace Period: STARTED {
2025-09-20T16:19:59:   action: 'STARTED',
2025-09-20T16:19:59:   remainingMs: 240000,
2025-09-20T16:19:59:   remainingSeconds: 240,
2025-09-20T16:19:59:   details: { startupTime: 1758365346357, processId: 12624 },
2025-09-20T16:19:59:   timestamp: 1758365399977
2025-09-20T16:19:59: }
2025-09-20T16:19:59: â„¹ï¸ [4:19:59 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:19:59:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:19:59:   remainingMs: 240000,
2025-09-20T16:19:59:   remainingSeconds: 240,
2025-09-20T16:19:59:   details: { startupTime: 1758365346357, willExpireAt: 1758365586357 },
2025-09-20T16:19:59:   timestamp: 1758365399977
2025-09-20T16:19:59: }
2025-09-20T16:19:59: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:19:59: â° Startup grace period: 240 seconds
2025-09-20T16:19:59: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:19:59: â„¹ï¸ [4:19:59 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:19:59:   initializationDuration: 53623,
2025-09-20T16:19:59:   gracePeriodActive: true,
2025-09-20T16:19:59:   messageRulesCount: 8,
2025-09-20T16:19:59:   messageTypes: [
2025-09-20T16:19:59:     'welcome',
2025-09-20T16:19:59:     'confirmation',
2025-09-20T16:19:59:     'ready',
2025-09-20T16:19:59:     'delivery',
2025-09-20T16:19:59:     'pickup_reminder',
2025-09-20T16:19:59:     'payment_reminder',
2025-09-20T16:19:59:     'fabric_welcome',
2025-09-20T16:19:59:     'fabric_purchase'
2025-09-20T16:19:59:   ],
2025-09-20T16:19:59:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:19:59:   databaseReady: true,
2025-09-20T16:19:59:   loggerReady: true,
2025-09-20T16:19:59:   processIsolationActive: true
2025-09-20T16:19:59: }
2025-09-20T16:19:59: âœ… Safety Manager initialized
2025-09-20T16:19:59: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:19:59: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:19:59: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:19:59: ğŸ“ Loaded statistics from file
2025-09-20T16:19:59: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:19:59: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:19:59: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:19:59: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:19:59: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:19:59: âœ… WhatsApp connection started
2025-09-20T16:19:59: ğŸ”§ Initializing admin commands...
2025-09-20T16:19:59: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:19:59: âœ… Admin commands system initialized
2025-09-20T16:19:59: ğŸ”„ Initializing polling functionality...
2025-09-20T16:19:59: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:19:59: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:20:00: ğŸ“ Attempting to request pairing code...
2025-09-20T16:20:00: ğŸ’¡ To use phone authentication:
2025-09-20T16:20:00:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:20:00:    2. Select "Phone Number Authentication"
2025-09-20T16:20:00:    3. Enter your phone number
2025-09-20T16:20:00:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:20:00: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:20:01: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:20:01: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:20:01: ğŸ”„ Reconnecting in 30s... (Attempt 6/10)
2025-09-20T16:20:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:20:31: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:20:31: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:20:31: âœ… Google Sheets API initialized
2025-09-20T16:20:31: âœ… Google Sheets API initialized
2025-09-20T16:20:31: â„¹ï¸ [4:20:31 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:20:31:   startupTime: 1758365346357,
2025-09-20T16:20:31:   gracePeriodMs: 240000,
2025-09-20T16:20:31:   dataDir: './safety-data',
2025-09-20T16:20:31:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:20:31:   processId: 12624,
2025-09-20T16:20:31:   nodeVersion: 'v22.19.0'
2025-09-20T16:20:31: }
2025-09-20T16:20:31: â„¹ï¸ [4:20:31 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:20:31: â„¹ï¸ [4:20:31 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:20:31: ğŸ§¹ Removed stale process lock
2025-09-20T16:20:31: ğŸ”’ Process lock acquired (PID: 12624)
2025-09-20T16:20:31: â„¹ï¸ [4:20:31 pm] INFO: Process isolation enforced {
2025-09-20T16:20:31:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:20:31:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:20:31:   processId: 12624
2025-09-20T16:20:31: }
2025-09-20T16:20:31: â° Starting 240 second startup grace period...
2025-09-20T16:20:31: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:20:31: â„¹ï¸ [4:20:31 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:20:31:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:20:31:   remainingMs: 240000,
2025-09-20T16:20:31:   remainingSeconds: 240,
2025-09-20T16:20:31:   details: { startupTime: 1758365346357, willExpireAt: 1758365586357 },
2025-09-20T16:20:31:   timestamp: 1758365431898
2025-09-20T16:20:31: }
2025-09-20T16:20:31: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:20:31: â° Startup grace period: 240 seconds
2025-09-20T16:20:31: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:20:31: â„¹ï¸ [4:20:31 pm] INFO: Grace Period: STARTED {
2025-09-20T16:20:31:   action: 'STARTED',
2025-09-20T16:20:31:   remainingMs: 240000,
2025-09-20T16:20:31:   remainingSeconds: 240,
2025-09-20T16:20:31:   details: { startupTime: 1758365346357, processId: 12624 },
2025-09-20T16:20:31:   timestamp: 1758365431897
2025-09-20T16:20:31: }
2025-09-20T16:20:31: â„¹ï¸ [4:20:31 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:20:31:   initializationDuration: 85545,
2025-09-20T16:20:31:   gracePeriodActive: true,
2025-09-20T16:20:31:   messageRulesCount: 8,
2025-09-20T16:20:31:   messageTypes: [
2025-09-20T16:20:31:     'welcome',
2025-09-20T16:20:31:     'confirmation',
2025-09-20T16:20:31:     'ready',
2025-09-20T16:20:31:     'delivery',
2025-09-20T16:20:31:     'pickup_reminder',
2025-09-20T16:20:31:     'payment_reminder',
2025-09-20T16:20:31:     'fabric_welcome',
2025-09-20T16:20:31:     'fabric_purchase'
2025-09-20T16:20:31:   ],
2025-09-20T16:20:31:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:20:31:   databaseReady: true,
2025-09-20T16:20:31:   loggerReady: true,
2025-09-20T16:20:31:   processIsolationActive: true
2025-09-20T16:20:31: }
2025-09-20T16:20:31: âœ… Safety Manager initialized
2025-09-20T16:20:31: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:20:31: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:20:31: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:20:31: ğŸ“ Loaded statistics from file
2025-09-20T16:20:31: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:20:31: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:20:31: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:20:31: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:20:31: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:20:31: âœ… WhatsApp connection started
2025-09-20T16:20:31: ğŸ”§ Initializing admin commands...
2025-09-20T16:20:31: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:20:31: âœ… Admin commands system initialized
2025-09-20T16:20:31: ğŸ”„ Initializing polling functionality...
2025-09-20T16:20:31: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:20:31: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:20:31: ğŸ“ Attempting to request pairing code...
2025-09-20T16:20:31: ğŸ’¡ To use phone authentication:
2025-09-20T16:20:31:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:20:31:    2. Select "Phone Number Authentication"
2025-09-20T16:20:31:    3. Enter your phone number
2025-09-20T16:20:31:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:20:31: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:20:32: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:20:32: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:20:32: ğŸ”„ Reconnecting in 30s... (Attempt 7/10)
2025-09-20T16:20:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:21:02: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:21:02: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:21:02: âœ… Google Sheets API initialized
2025-09-20T16:21:02: âœ… Google Sheets API initialized
2025-09-20T16:21:02: â„¹ï¸ [4:21:02 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:21:02:   startupTime: 1758365346357,
2025-09-20T16:21:02:   gracePeriodMs: 240000,
2025-09-20T16:21:02:   dataDir: './safety-data',
2025-09-20T16:21:02:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:21:02:   processId: 12624,
2025-09-20T16:21:02:   nodeVersion: 'v22.19.0'
2025-09-20T16:21:02: }
2025-09-20T16:21:02: â„¹ï¸ [4:21:02 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:21:02: â„¹ï¸ [4:21:02 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:21:02: ğŸ§¹ Removed stale process lock
2025-09-20T16:21:02: ğŸ”’ Process lock acquired (PID: 12624)
2025-09-20T16:21:02: â„¹ï¸ [4:21:02 pm] INFO: Process isolation enforced {
2025-09-20T16:21:02:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:21:02:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:21:02:   processId: 12624
2025-09-20T16:21:02: }
2025-09-20T16:21:02: â° Starting 240 second startup grace period...
2025-09-20T16:21:02: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:21:02: â„¹ï¸ [4:21:02 pm] INFO: Grace Period: STARTED {
2025-09-20T16:21:02:   action: 'STARTED',
2025-09-20T16:21:02:   remainingMs: 240000,
2025-09-20T16:21:02:   remainingSeconds: 240,
2025-09-20T16:21:02:   details: { startupTime: 1758365346357, processId: 12624 },
2025-09-20T16:21:02:   timestamp: 1758365462953
2025-09-20T16:21:02: }
2025-09-20T16:21:02: â„¹ï¸ [4:21:02 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:21:02:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:21:02:   remainingMs: 240000,
2025-09-20T16:21:02:   remainingSeconds: 240,
2025-09-20T16:21:02:   details: { startupTime: 1758365346357, willExpireAt: 1758365586357 },
2025-09-20T16:21:02:   timestamp: 1758365462954
2025-09-20T16:21:02: }
2025-09-20T16:21:02: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:21:02: â° Startup grace period: 240 seconds
2025-09-20T16:21:02: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:21:02: â„¹ï¸ [4:21:02 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:21:02:   initializationDuration: 116604,
2025-09-20T16:21:02:   gracePeriodActive: true,
2025-09-20T16:21:02:   messageRulesCount: 8,
2025-09-20T16:21:02:   messageTypes: [
2025-09-20T16:21:02:     'welcome',
2025-09-20T16:21:02:     'confirmation',
2025-09-20T16:21:02:     'ready',
2025-09-20T16:21:02:     'delivery',
2025-09-20T16:21:02:     'pickup_reminder',
2025-09-20T16:21:02:     'payment_reminder',
2025-09-20T16:21:02:     'fabric_welcome',
2025-09-20T16:21:02:     'fabric_purchase'
2025-09-20T16:21:02:   ],
2025-09-20T16:21:02:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:21:02:   databaseReady: true,
2025-09-20T16:21:02:   loggerReady: true,
2025-09-20T16:21:02:   processIsolationActive: true
2025-09-20T16:21:02: }
2025-09-20T16:21:02: âœ… Safety Manager initialized
2025-09-20T16:21:02: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:21:02: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:21:02: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:21:02: ğŸ“ Loaded statistics from file
2025-09-20T16:21:02: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:21:02: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:21:02: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:21:02: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:21:02: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:21:03: âœ… WhatsApp connection started
2025-09-20T16:21:03: ğŸ”§ Initializing admin commands...
2025-09-20T16:21:03: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:21:03: âœ… Admin commands system initialized
2025-09-20T16:21:03: ğŸ”„ Initializing polling functionality...
2025-09-20T16:21:03: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:21:03: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:21:03: ğŸ“ Attempting to request pairing code...
2025-09-20T16:21:03: ğŸ’¡ To use phone authentication:
2025-09-20T16:21:03:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:21:03:    2. Select "Phone Number Authentication"
2025-09-20T16:21:03:    3. Enter your phone number
2025-09-20T16:21:03:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:21:03: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:21:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:21:06: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:21:06: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:21:06: ğŸ”„ Reconnecting in 30s... (Attempt 8/10)
2025-09-20T16:21:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:21:36: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:21:36: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:21:36: âœ… Google Sheets API initialized
2025-09-20T16:21:36: âœ… Google Sheets API initialized
2025-09-20T16:21:36: â„¹ï¸ [4:21:36 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:21:36:   startupTime: 1758365346357,
2025-09-20T16:21:36:   gracePeriodMs: 240000,
2025-09-20T16:21:36:   dataDir: './safety-data',
2025-09-20T16:21:36:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:21:36:   processId: 12624,
2025-09-20T16:21:36:   nodeVersion: 'v22.19.0'
2025-09-20T16:21:36: }
2025-09-20T16:21:36: â„¹ï¸ [4:21:36 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:21:36: â„¹ï¸ [4:21:36 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:21:36: ğŸ§¹ Removed stale process lock
2025-09-20T16:21:36: ğŸ”’ Process lock acquired (PID: 12624)
2025-09-20T16:21:36: â„¹ï¸ [4:21:36 pm] INFO: Process isolation enforced {
2025-09-20T16:21:36:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:21:36:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:21:36:   processId: 12624
2025-09-20T16:21:36: }
2025-09-20T16:21:36: â° Starting 240 second startup grace period...
2025-09-20T16:21:36: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:21:36: â„¹ï¸ [4:21:36 pm] INFO: Grace Period: STARTED {
2025-09-20T16:21:36:   action: 'STARTED',
2025-09-20T16:21:36:   remainingMs: 240000,
2025-09-20T16:21:36:   remainingSeconds: 240,
2025-09-20T16:21:36:   details: { startupTime: 1758365346357, processId: 12624 },
2025-09-20T16:21:36:   timestamp: 1758365496619
2025-09-20T16:21:36: }
2025-09-20T16:21:36: â„¹ï¸ [4:21:36 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:21:36:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:21:36:   remainingMs: 240000,
2025-09-20T16:21:36:   remainingSeconds: 240,
2025-09-20T16:21:36:   details: { startupTime: 1758365346357, willExpireAt: 1758365586357 },
2025-09-20T16:21:36:   timestamp: 1758365496619
2025-09-20T16:21:36: }
2025-09-20T16:21:36: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:21:36: â° Startup grace period: 240 seconds
2025-09-20T16:21:36: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:21:36: â„¹ï¸ [4:21:36 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:21:36:   initializationDuration: 150266,
2025-09-20T16:21:36:   gracePeriodActive: true,
2025-09-20T16:21:36:   messageRulesCount: 8,
2025-09-20T16:21:36:   messageTypes: [
2025-09-20T16:21:36:     'welcome',
2025-09-20T16:21:36:     'confirmation',
2025-09-20T16:21:36:     'ready',
2025-09-20T16:21:36:     'delivery',
2025-09-20T16:21:36:     'pickup_reminder',
2025-09-20T16:21:36:     'payment_reminder',
2025-09-20T16:21:36:     'fabric_welcome',
2025-09-20T16:21:36:     'fabric_purchase'
2025-09-20T16:21:36:   ],
2025-09-20T16:21:36:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:21:36:   databaseReady: true,
2025-09-20T16:21:36:   loggerReady: true,
2025-09-20T16:21:36:   processIsolationActive: true
2025-09-20T16:21:36: }
2025-09-20T16:21:36: âœ… Safety Manager initialized
2025-09-20T16:21:36: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:21:36: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:21:36: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:21:36: ğŸ“ Loaded statistics from file
2025-09-20T16:21:36: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:21:36: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:21:36: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:21:36: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:21:36: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:21:36: âœ… WhatsApp connection started
2025-09-20T16:21:36: ğŸ”§ Initializing admin commands...
2025-09-20T16:21:36: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:21:36: âœ… Admin commands system initialized
2025-09-20T16:21:36: ğŸ”„ Initializing polling functionality...
2025-09-20T16:21:36: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:21:36: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:21:36: ğŸ“ Attempting to request pairing code...
2025-09-20T16:21:36: ğŸ’¡ To use phone authentication:
2025-09-20T16:21:36:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:21:36:    2. Select "Phone Number Authentication"
2025-09-20T16:21:36:    3. Enter your phone number
2025-09-20T16:21:36:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:21:36: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:21:38: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:21:38: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:21:38: ğŸ”„ Reconnecting in 30s... (Attempt 9/10)
2025-09-20T16:22:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:22:08: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:22:08: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:22:08: âœ… Google Sheets API initialized
2025-09-20T16:22:08: âœ… Google Sheets API initialized
2025-09-20T16:22:08: â„¹ï¸ [4:22:08 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:22:08:   startupTime: 1758365346357,
2025-09-20T16:22:08:   gracePeriodMs: 240000,
2025-09-20T16:22:08:   dataDir: './safety-data',
2025-09-20T16:22:08:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:22:08:   processId: 12624,
2025-09-20T16:22:08:   nodeVersion: 'v22.19.0'
2025-09-20T16:22:08: }
2025-09-20T16:22:08: â„¹ï¸ [4:22:08 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:22:08: â„¹ï¸ [4:22:08 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:22:08: ğŸ§¹ Removed stale process lock
2025-09-20T16:22:08: ğŸ”’ Process lock acquired (PID: 12624)
2025-09-20T16:22:08: â„¹ï¸ [4:22:08 pm] INFO: Process isolation enforced {
2025-09-20T16:22:08:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:22:08:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:22:08:   processId: 12624
2025-09-20T16:22:08: }
2025-09-20T16:22:08: â° Starting 240 second startup grace period...
2025-09-20T16:22:08: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:22:08: â„¹ï¸ [4:22:08 pm] INFO: Grace Period: STARTED {
2025-09-20T16:22:08:   action: 'STARTED',
2025-09-20T16:22:08:   remainingMs: 240000,
2025-09-20T16:22:08:   remainingSeconds: 240,
2025-09-20T16:22:08:   details: { startupTime: 1758365346357, processId: 12624 },
2025-09-20T16:22:08:   timestamp: 1758365528705
2025-09-20T16:22:08: }
2025-09-20T16:22:08: â„¹ï¸ [4:22:08 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:22:08:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:22:08:   remainingMs: 240000,
2025-09-20T16:22:08:   remainingSeconds: 240,
2025-09-20T16:22:08:   details: { startupTime: 1758365346357, willExpireAt: 1758365586357 },
2025-09-20T16:22:08:   timestamp: 1758365528705
2025-09-20T16:22:08: }
2025-09-20T16:22:08: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:22:08: â° Startup grace period: 240 seconds
2025-09-20T16:22:08: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:22:08: â„¹ï¸ [4:22:08 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:22:08:   initializationDuration: 182353,
2025-09-20T16:22:08:   gracePeriodActive: true,
2025-09-20T16:22:08:   messageRulesCount: 8,
2025-09-20T16:22:08:   messageTypes: [
2025-09-20T16:22:08:     'welcome',
2025-09-20T16:22:08:     'confirmation',
2025-09-20T16:22:08:     'ready',
2025-09-20T16:22:08:     'delivery',
2025-09-20T16:22:08:     'pickup_reminder',
2025-09-20T16:22:08:     'payment_reminder',
2025-09-20T16:22:08:     'fabric_welcome',
2025-09-20T16:22:08:     'fabric_purchase'
2025-09-20T16:22:08:   ],
2025-09-20T16:22:08:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:22:08:   databaseReady: true,
2025-09-20T16:22:08:   loggerReady: true,
2025-09-20T16:22:08:   processIsolationActive: true
2025-09-20T16:22:08: }
2025-09-20T16:22:08: âœ… Safety Manager initialized
2025-09-20T16:22:08: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:22:08: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:22:08: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:22:08: ğŸ“ Loaded statistics from file
2025-09-20T16:22:08: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:22:08: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:22:08: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:22:08: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:22:08: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:22:08: âœ… WhatsApp connection started
2025-09-20T16:22:08: ğŸ”§ Initializing admin commands...
2025-09-20T16:22:08: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:22:08: âœ… Admin commands system initialized
2025-09-20T16:22:08: ğŸ”„ Initializing polling functionality...
2025-09-20T16:22:08: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:22:08: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:22:08: ğŸ“ Attempting to request pairing code...
2025-09-20T16:22:08: ğŸ’¡ To use phone authentication:
2025-09-20T16:22:08:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:22:08:    2. Select "Phone Number Authentication"
2025-09-20T16:22:08:    3. Enter your phone number
2025-09-20T16:22:08:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:22:08: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:22:11: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:22:11: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:22:11: ğŸ”„ Reconnecting in 30s... (Attempt 10/10)
2025-09-20T16:22:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:22:41: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:22:41: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:22:41: âœ… Google Sheets API initialized
2025-09-20T16:22:41: âœ… Google Sheets API initialized
2025-09-20T16:22:41: â„¹ï¸ [4:22:41 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:22:41:   startupTime: 1758365346357,
2025-09-20T16:22:41:   gracePeriodMs: 240000,
2025-09-20T16:22:41:   dataDir: './safety-data',
2025-09-20T16:22:41:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:22:41:   processId: 12624,
2025-09-20T16:22:41:   nodeVersion: 'v22.19.0'
2025-09-20T16:22:41: }
2025-09-20T16:22:41: â„¹ï¸ [4:22:41 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:22:41: â„¹ï¸ [4:22:41 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:22:41: ğŸ§¹ Removed stale process lock
2025-09-20T16:22:41: ğŸ”’ Process lock acquired (PID: 12624)
2025-09-20T16:22:41: â„¹ï¸ [4:22:41 pm] INFO: Process isolation enforced {
2025-09-20T16:22:41:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:22:41:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:22:41:   processId: 12624
2025-09-20T16:22:41: }
2025-09-20T16:22:41: â° Starting 240 second startup grace period...
2025-09-20T16:22:41: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:22:41: â„¹ï¸ [4:22:41 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:22:41:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:22:41:   remainingMs: 240000,
2025-09-20T16:22:41:   remainingSeconds: 240,
2025-09-20T16:22:41:   details: { startupTime: 1758365346357, willExpireAt: 1758365586357 },
2025-09-20T16:22:41:   timestamp: 1758365561750
2025-09-20T16:22:41: }
2025-09-20T16:22:41: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:22:41: â° Startup grace period: 240 seconds
2025-09-20T16:22:41: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:22:41: â„¹ï¸ [4:22:41 pm] INFO: Grace Period: STARTED {
2025-09-20T16:22:41:   action: 'STARTED',
2025-09-20T16:22:41:   remainingMs: 240000,
2025-09-20T16:22:41:   remainingSeconds: 240,
2025-09-20T16:22:41:   details: { startupTime: 1758365346357, processId: 12624 },
2025-09-20T16:22:41:   timestamp: 1758365561750
2025-09-20T16:22:41: }
2025-09-20T16:22:41: â„¹ï¸ [4:22:41 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:22:41:   initializationDuration: 215398,
2025-09-20T16:22:41:   gracePeriodActive: true,
2025-09-20T16:22:41:   messageRulesCount: 8,
2025-09-20T16:22:41:   messageTypes: [
2025-09-20T16:22:41:     'welcome',
2025-09-20T16:22:41:     'confirmation',
2025-09-20T16:22:41:     'ready',
2025-09-20T16:22:41:     'delivery',
2025-09-20T16:22:41:     'pickup_reminder',
2025-09-20T16:22:41:     'payment_reminder',
2025-09-20T16:22:41:     'fabric_welcome',
2025-09-20T16:22:41:     'fabric_purchase'
2025-09-20T16:22:41:   ],
2025-09-20T16:22:41:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:22:41:   databaseReady: true,
2025-09-20T16:22:41:   loggerReady: true,
2025-09-20T16:22:41:   processIsolationActive: true
2025-09-20T16:22:41: }
2025-09-20T16:22:41: âœ… Safety Manager initialized
2025-09-20T16:22:41: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:22:41: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:22:41: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:22:41: ğŸ“ Loaded statistics from file
2025-09-20T16:22:41: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:22:41: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:22:41: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:22:41: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:22:41: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:22:41: âœ… WhatsApp connection started
2025-09-20T16:22:41: ğŸ”§ Initializing admin commands...
2025-09-20T16:22:41: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:22:41: âœ… Admin commands system initialized
2025-09-20T16:22:41: ğŸ”„ Initializing polling functionality...
2025-09-20T16:22:41: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:22:41: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:22:41: ğŸ“ Attempting to request pairing code...
2025-09-20T16:22:41: ğŸ’¡ To use phone authentication:
2025-09-20T16:22:41:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:22:41:    2. Select "Phone Number Authentication"
2025-09-20T16:22:41:    3. Enter your phone number
2025-09-20T16:22:41:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:22:41: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:22:44: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:22:44: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:22:44: âŒ Max reconnection attempts reached. Please restart the bot or check your internet connection.
2025-09-20T16:22:44: ğŸ’¡ You can visit http://localhost:3001 to see the status and authenticate again.
2025-09-20T16:23:06: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:23:06: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:23:06: â„¹ï¸ [4:23:06 pm] INFO: Grace Period: ENDED {
2025-09-20T16:23:06:   action: 'ENDED',
2025-09-20T16:23:06:   remainingMs: 0,
2025-09-20T16:23:06:   remainingSeconds: 0,
2025-09-20T16:23:06:   details: { totalDuration: 240000, processId: 12624 },
2025-09-20T16:23:06:   timestamp: 1758365586409
2025-09-20T16:23:06: }
2025-09-20T16:23:06: â„¹ï¸ [4:23:06 pm] INFO: Grace Period: ENDED {
2025-09-20T16:23:06:   action: 'ENDED',
2025-09-20T16:23:06:   remainingMs: 0,
2025-09-20T16:23:06:   remainingSeconds: 0,
2025-09-20T16:23:06:   details: { totalDuration: 240000, processId: 12624 },
2025-09-20T16:23:06:   timestamp: 1758365586421
2025-09-20T16:23:06: }
2025-09-20T16:23:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:23:06: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:23:06: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:23:11: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:23:11: â„¹ï¸ [4:23:11 pm] INFO: Grace Period: ENDED {
2025-09-20T16:23:11:   action: 'ENDED',
2025-09-20T16:23:11:   remainingMs: 0,
2025-09-20T16:23:11:   remainingSeconds: 0,
2025-09-20T16:23:11:   details: { totalDuration: 240000, processId: 12624 },
2025-09-20T16:23:11:   timestamp: 1758365591077
2025-09-20T16:23:11: }
2025-09-20T16:23:11: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:23:18: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:23:18: â„¹ï¸ [4:23:18 pm] INFO: Grace Period: ENDED {
2025-09-20T16:23:18:   action: 'ENDED',
2025-09-20T16:23:18:   remainingMs: 0,
2025-09-20T16:23:18:   remainingSeconds: 0,
2025-09-20T16:23:18:   details: { totalDuration: 240000, processId: 12624 },
2025-09-20T16:23:18:   timestamp: 1758365598638
2025-09-20T16:23:18: }
2025-09-20T16:23:18: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:23:24: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:23:24: â„¹ï¸ [4:23:24 pm] INFO: Grace Period: ENDED {
2025-09-20T16:23:24:   action: 'ENDED',
2025-09-20T16:23:24:   remainingMs: 0,
2025-09-20T16:23:24:   remainingSeconds: 0,
2025-09-20T16:23:24:   details: { totalDuration: 240000, processId: 12624 },
2025-09-20T16:23:24:   timestamp: 1758365604008
2025-09-20T16:23:24: }
2025-09-20T16:23:24: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:23:36: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:23:36: â„¹ï¸ [4:23:36 pm] INFO: Grace Period: ENDED {
2025-09-20T16:23:36:   action: 'ENDED',
2025-09-20T16:23:36:   remainingMs: 0,
2025-09-20T16:23:36:   remainingSeconds: 0,
2025-09-20T16:23:36:   details: { totalDuration: 240000, processId: 12624 },
2025-09-20T16:23:36:   timestamp: 1758365616211
2025-09-20T16:23:36: }
2025-09-20T16:23:36: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:23:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:23:59: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:23:59: â„¹ï¸ [4:23:59 pm] INFO: Grace Period: ENDED {
2025-09-20T16:23:59:   action: 'ENDED',
2025-09-20T16:23:59:   remainingMs: 0,
2025-09-20T16:23:59:   remainingSeconds: 0,
2025-09-20T16:23:59:   details: { totalDuration: 240000, processId: 12624 },
2025-09-20T16:23:59:   timestamp: 1758365639980
2025-09-20T16:23:59: }
2025-09-20T16:23:59: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:24:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:24:31: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:24:31: â„¹ï¸ [4:24:31 pm] INFO: Grace Period: ENDED {
2025-09-20T16:24:31:   action: 'ENDED',
2025-09-20T16:24:31:   remainingMs: 0,
2025-09-20T16:24:31:   remainingSeconds: 0,
2025-09-20T16:24:31:   details: { totalDuration: 240000, processId: 12624 },
2025-09-20T16:24:31:   timestamp: 1758365671904
2025-09-20T16:24:31: }
2025-09-20T16:24:31: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:24:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:25:02: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:25:02: â„¹ï¸ [4:25:02 pm] INFO: Grace Period: ENDED {
2025-09-20T16:25:02:   action: 'ENDED',
2025-09-20T16:25:02:   remainingMs: 0,
2025-09-20T16:25:02:   remainingSeconds: 0,
2025-09-20T16:25:02:   details: { totalDuration: 240000, processId: 12624 },
2025-09-20T16:25:02:   timestamp: 1758365702959
2025-09-20T16:25:02: }
2025-09-20T16:25:02: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:25:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:25:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:25:36: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:25:36: â„¹ï¸ [4:25:36 pm] INFO: Grace Period: ENDED {
2025-09-20T16:25:36:   action: 'ENDED',
2025-09-20T16:25:36:   remainingMs: 0,
2025-09-20T16:25:36:   remainingSeconds: 0,
2025-09-20T16:25:36:   details: { totalDuration: 240000, processId: 12624 },
2025-09-20T16:25:36:   timestamp: 1758365736632
2025-09-20T16:25:36: }
2025-09-20T16:25:36: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:26:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:26:08: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:26:08: â„¹ï¸ [4:26:08 pm] INFO: Grace Period: ENDED {
2025-09-20T16:26:08:   action: 'ENDED',
2025-09-20T16:26:08:   remainingMs: 0,
2025-09-20T16:26:08:   remainingSeconds: 0,
2025-09-20T16:26:08:   details: { totalDuration: 240000, processId: 12624 },
2025-09-20T16:26:08:   timestamp: 1758365768712
2025-09-20T16:26:08: }
2025-09-20T16:26:08: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:26:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:26:41: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:26:41: â„¹ï¸ [4:26:41 pm] INFO: Grace Period: ENDED {
2025-09-20T16:26:41:   action: 'ENDED',
2025-09-20T16:26:41:   remainingMs: 0,
2025-09-20T16:26:41:   remainingSeconds: 0,
2025-09-20T16:26:41:   details: { totalDuration: 240000, processId: 12624 },
2025-09-20T16:26:41:   timestamp: 1758365801757
2025-09-20T16:26:41: }
2025-09-20T16:26:41: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:27:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:27:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:28:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:28:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:29:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:29:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:30:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:30:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:31:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:31:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:32:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:32:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:33:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:33:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:34:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:34:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:35:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:35:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:36:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:36:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:37:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:37:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:38:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:38:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:39:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:39:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:40:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:40:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:41:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:41:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:42:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:42:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:43:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:43:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:44:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:44:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:45:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:45:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:46:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:46:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:47:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:47:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:48:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:48:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:49:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:49:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:50:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:50:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:51:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:51:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:52:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:52:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:53:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:53:36: ğŸ’¾ Data synced to files successfully
2025-09-20T16:54:06: ğŸ’¾ Data synced to files successfully
2025-09-20T16:54:38: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T16:54:38: ğŸ“ Loaded 11 template types
2025-09-20T16:54:38: ğŸ”§ WhatsApp Bot initialized
2025-09-20T16:54:38: ğŸ“Š Configuration status: undefined
2025-09-20T16:54:38: âœ… Atomic State Manager initialized
2025-09-20T16:54:38: ğŸ“ Enhanced Logger initialized
2025-09-20T16:54:38: âœ… Google credentials loaded from service-account.json file
2025-09-20T16:54:38: ğŸ“± WhatsApp auth status: âŒ credentials, 0 session files
2025-09-20T16:54:38: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-20T16:54:38:    Auth Mode: both
2025-09-20T16:54:38:    QR Enabled: true
2025-09-20T16:54:38:    Phone Enabled: true
2025-09-20T16:54:38:    Session Persistence: true
2025-09-20T16:54:38:    Max Reconnect Attempts: 10
2025-09-20T16:54:38:    Default Phone: None
2025-09-20T16:54:38: ğŸ”’ Session validation enabled (check every 300s)
2025-09-20T16:54:38: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-20T16:54:38: ğŸ”§ Developer Configuration initialized
2025-09-20T16:54:38: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T16:54:38: â„¹ï¸ [4:54:38 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:54:38:   startupTime: 1758367478084,
2025-09-20T16:54:38:   gracePeriodMs: 240000,
2025-09-20T16:54:38:   dataDir: './safety-data',
2025-09-20T16:54:38:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:54:38:   processId: 12528,
2025-09-20T16:54:38:   nodeVersion: 'v22.19.0'
2025-09-20T16:54:38: }
2025-09-20T16:54:38: ğŸ”§ Developer Configuration initialized
2025-09-20T16:54:38: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T16:54:38: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-20T16:54:38: â° 4-minute startup delay active
2025-09-20T16:54:38: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-20T16:54:38: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-20T16:54:38: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:54:38: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:54:38: âœ… Google Sheets API initialized
2025-09-20T16:54:38: âœ… Google Sheets API initialized
2025-09-20T16:54:38: â„¹ï¸ [4:54:38 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:54:38:   startupTime: 1758367478084,
2025-09-20T16:54:38:   gracePeriodMs: 240000,
2025-09-20T16:54:38:   dataDir: './safety-data',
2025-09-20T16:54:38:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:54:38:   processId: 12528,
2025-09-20T16:54:38:   nodeVersion: 'v22.19.0'
2025-09-20T16:54:38: }
2025-09-20T16:54:38: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:54:38: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:54:38: â„¹ï¸ [4:54:38 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:54:38: â„¹ï¸ [4:54:38 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:54:38: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:54:38: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T09-51-06-814Z.log
2025-09-20T16:54:38: ğŸ“ Enhanced Logger initialized
2025-09-20T16:54:38: ğŸ“ Loaded statistics from file
2025-09-20T16:54:38: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:54:38: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:54:38: â„¹ï¸ [4:54:38 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:54:38: â„¹ï¸ [4:54:38 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:54:38: ğŸ§¹ Removed stale process lock
2025-09-20T16:54:38: ğŸ”’ Process lock acquired (PID: 12528)
2025-09-20T16:54:38: â„¹ï¸ [4:54:38 pm] INFO: Process isolation enforced {
2025-09-20T16:54:38:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:54:38:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:54:38:   processId: 12528
2025-09-20T16:54:38: }
2025-09-20T16:54:38: â° Starting 240 second startup grace period...
2025-09-20T16:54:38: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:54:38: â„¹ï¸ [4:54:38 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:54:38:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:54:38:   remainingMs: 240000,
2025-09-20T16:54:38:   remainingSeconds: 240,
2025-09-20T16:54:38:   details: { startupTime: 1758367478084, willExpireAt: 1758367718084 },
2025-09-20T16:54:38:   timestamp: 1758367478248
2025-09-20T16:54:38: }
2025-09-20T16:54:38: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:54:38: â° Startup grace period: 240 seconds
2025-09-20T16:54:38: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:54:38: â„¹ï¸ [4:54:38 pm] INFO: Grace Period: STARTED {
2025-09-20T16:54:38:   action: 'STARTED',
2025-09-20T16:54:38:   remainingMs: 240000,
2025-09-20T16:54:38:   remainingSeconds: 240,
2025-09-20T16:54:38:   details: { startupTime: 1758367478084, processId: 12528 },
2025-09-20T16:54:38:   timestamp: 1758367478248
2025-09-20T16:54:38: }
2025-09-20T16:54:38: ğŸ”’ Process lock acquired (PID: 12528)
2025-09-20T16:54:38: â„¹ï¸ [4:54:38 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:54:38:   initializationDuration: 168,
2025-09-20T16:54:38:   gracePeriodActive: true,
2025-09-20T16:54:38:   messageRulesCount: 8,
2025-09-20T16:54:38:   messageTypes: [
2025-09-20T16:54:38:     'welcome',
2025-09-20T16:54:38:     'confirmation',
2025-09-20T16:54:38:     'ready',
2025-09-20T16:54:38:     'delivery',
2025-09-20T16:54:38:     'pickup_reminder',
2025-09-20T16:54:38:     'payment_reminder',
2025-09-20T16:54:38:     'fabric_welcome',
2025-09-20T16:54:38:     'fabric_purchase'
2025-09-20T16:54:38:   ],
2025-09-20T16:54:38:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:54:38:   databaseReady: true,
2025-09-20T16:54:38:   loggerReady: true,
2025-09-20T16:54:38:   processIsolationActive: true
2025-09-20T16:54:38: }
2025-09-20T16:54:38: âœ… Safety Manager initialized
2025-09-20T16:54:38: â„¹ï¸ [4:54:38 pm] INFO: Process isolation enforced {
2025-09-20T16:54:38:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:54:38:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:54:38:   processId: 12528
2025-09-20T16:54:38: }
2025-09-20T16:54:38: â° Starting 240 second startup grace period...
2025-09-20T16:54:38: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:54:38: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:54:38: â„¹ï¸ [4:54:38 pm] INFO: Grace Period: STARTED {
2025-09-20T16:54:38:   action: 'STARTED',
2025-09-20T16:54:38:   remainingMs: 240000,
2025-09-20T16:54:38:   remainingSeconds: 240,
2025-09-20T16:54:38:   details: { startupTime: 1758367478084, processId: 12528 },
2025-09-20T16:54:38:   timestamp: 1758367478259
2025-09-20T16:54:38: }
2025-09-20T16:54:38: â„¹ï¸ [4:54:38 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:54:38:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:54:38:   remainingMs: 240000,
2025-09-20T16:54:38:   remainingSeconds: 240,
2025-09-20T16:54:38:   details: { startupTime: 1758367478084, willExpireAt: 1758367718084 },
2025-09-20T16:54:38:   timestamp: 1758367478260
2025-09-20T16:54:38: }
2025-09-20T16:54:38: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:54:38: â° Startup grace period: 240 seconds
2025-09-20T16:54:38: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:54:38: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:54:38: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:54:38: â„¹ï¸ [4:54:38 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:54:38:   initializationDuration: 181,
2025-09-20T16:54:38:   gracePeriodActive: true,
2025-09-20T16:54:38:   messageRulesCount: 8,
2025-09-20T16:54:38:   messageTypes: [
2025-09-20T16:54:38:     'welcome',
2025-09-20T16:54:38:     'confirmation',
2025-09-20T16:54:38:     'ready',
2025-09-20T16:54:38:     'delivery',
2025-09-20T16:54:38:     'pickup_reminder',
2025-09-20T16:54:38:     'payment_reminder',
2025-09-20T16:54:38:     'fabric_welcome',
2025-09-20T16:54:38:     'fabric_purchase'
2025-09-20T16:54:38:   ],
2025-09-20T16:54:38:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:54:38:   databaseReady: true,
2025-09-20T16:54:38:   loggerReady: true,
2025-09-20T16:54:38:   processIsolationActive: true
2025-09-20T16:54:38: }
2025-09-20T16:54:38: ğŸ“ Loaded statistics from file
2025-09-20T16:54:38: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:54:38: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:54:38: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:54:38: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:54:38: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:54:38: âœ… WhatsApp connection started
2025-09-20T16:54:38: ğŸ”§ Initializing admin commands...
2025-09-20T16:54:38: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:54:38: âœ… Admin commands system initialized
2025-09-20T16:54:38: ğŸ”„ Initializing polling functionality...
2025-09-20T16:54:38: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:54:38: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:54:38: ğŸ“ Attempting to request pairing code...
2025-09-20T16:54:38: ğŸ’¡ To use phone authentication:
2025-09-20T16:54:38:    1. Use the dashboard at http://localhost:3001
2025-09-20T16:54:38:    2. Select "Phone Number Authentication"
2025-09-20T16:54:38:    3. Enter your phone number
2025-09-20T16:54:38:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T16:54:38: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:54:39: ğŸ“± QR Code received. Please scan with WhatsApp:
2025-09-20T16:54:39: [47m[30m â–„â–„â–„â–„â–„â–„â–„     â–„     â–„â–„  â–„â–„â–„   â–„â–„â–„â–„ â–„  â–„â–„    â–„â–„â–„â–„ â–„   â–„â–„ â–„â–„â–„â–„â–„â–„â–„ [0m
2025-09-20T16:54:39: [47m[30m â–ˆ â–„â–„â–„ â–ˆ â–„â–„â–€â–„â–„â–ˆâ–€ â–„â–„â–ˆâ–„â–ˆ â–€â–€â–€â–„â–ˆâ–€â–ˆâ–€â–„â–„ â–„â–ˆ â–ˆ â–„â–ˆâ–€â–€â–„â–ˆ  â–ˆâ–ˆâ–€ â–„â–ˆâ–ˆ â–ˆ â–„â–„â–„ â–ˆ [0m
2025-09-20T16:54:39: [47m[30m â–ˆ â–ˆâ–ˆâ–ˆ â–ˆ â–ˆâ–„â–ˆâ–„â–ˆ â–„  â–€â–„â–€ â–„â–€ â–€â–€â–„ â–„â–ˆâ–„â–„â–„â–„ â–€â–€â–„    â–„â–ˆâ–„â–€â–€â–ˆâ–€â–€â–ˆâ–„â–€ â–ˆ â–ˆâ–ˆâ–ˆ â–ˆ [0m
2025-09-20T16:54:39: [47m[30m â–ˆâ–„â–„â–„â–„â–„â–ˆ â–ˆâ–€â–ˆâ–€â–„â–€â–ˆ â–„ â–ˆ â–„ â–ˆâ–€â–ˆâ–€â–ˆâ–€â–ˆ â–„ â–ˆ â–ˆ â–„ â–ˆâ–€â–„ â–„ â–ˆâ–€â–„ â–„ â–ˆ â–„ â–ˆâ–„â–„â–„â–„â–„â–ˆ [0m
2025-09-20T16:54:39: [47m[30m â–„ â–„â–„â–„â–„â–„ â–€â–ˆâ–ˆâ–„â–ˆâ–„â–ˆâ–€  â–„â–ˆâ–ˆ  â–ˆâ–€â–ˆâ–€ â–ˆâ–„â–„â–„â–ˆ â–„â–ˆâ–„â–€   â–ˆ â–„â–€â–„ â–„â–ˆâ–€ â–„  â–„â–„â–„â–„â–„   [0m
2025-09-20T16:54:39: [47m[30m â–„â–„â–€â–ˆâ–„ â–„â–ˆâ–€â–„â–„â–€â–ˆ   â–€â–€â–ˆâ–ˆâ–„â–„â–„ â–€  â–„   â–„ â–„â–„â–ˆ â–„â–„ â–€ â–€â–€â–€ â–„â–„â–ˆâ–„â–„  â–€â–€  â–€â–„â–€â–„ [0m
2025-09-20T16:54:39: [47m[30m â–ˆ â–€ â–€â–€â–„ â–ˆâ–ˆâ–ˆâ–ˆâ–€â–ˆ â–„â–ˆ â–„ â–ˆ â–„ â–€â–ˆ â–„â–„â–€â–€ â–ˆâ–€ â–„â–„â–ˆâ–„ â–€ â–€â–„â–€â–ˆâ–ˆâ–„â–ˆâ–ˆ   â–„â–„â–ˆ  â–„â–ˆâ–ˆ [0m
2025-09-20T16:54:39: [47m[30m â–ˆâ–€â–€â–„â–ˆâ–€â–„â–ˆâ–€â–ˆâ–„ â–ˆ â–„â–ˆ â–„ â–€â–ˆâ–ˆâ–„â–ˆ â–„â–€â–ˆâ–€â–€â–ˆâ–ˆ   â–€â–ˆâ–€ â–„â–„â–€â–ˆâ–„â–€â–€â–„â–€â–ˆâ–ˆ â–„ â–„â–€    â–„â–ˆ [0m
2025-09-20T16:54:39: [47m[30m â–„â–„ â–ˆâ–ˆâ–„â–„â–€ â–€â–ˆâ–ˆâ–ˆâ–ˆ  â–„â–€â–ˆâ–ˆâ–ˆâ–€ â–€ â–ˆ â–„â–„â–€â–€â–ˆâ–ˆ â–„â–ˆâ–ˆ â–ˆâ–€ â–„â–„â–„â–€  â–„â–„â–€â–„â–ˆâ–€â–ˆ â–„â–€â–ˆâ–„   [0m
2025-09-20T16:54:39: [47m[30m â–€ â–€â–„ â–ˆâ–„â–€â–€ â–ˆâ–ˆ â–„ â–ˆ â–ˆ â–„â–„â–ˆâ–€â–€   â–ˆâ–„â–„â–„â–„ â–€â–„â–ˆâ–ˆâ–€ â–ˆâ–€ â–€â–ˆâ–€ â–„ â–„â–€â–„  â–ˆâ–€â–ˆâ–ˆâ–ˆâ–„â–€â–„ [0m
2025-09-20T16:54:39: [47m[30m â–€â–ˆâ–„â–„â–ˆ â–„â–€â–€â–€â–„ â–€ â–€â–€â–€ â–ˆâ–ˆâ–€ â–€â–€â–„â–€   â–„â–€  â–€â–€â–ˆâ–„ â–„â–„â–€â–€â–€â–ˆâ–€â–„â–„â–ˆâ–ˆâ–€  â–ˆâ–„â–ˆ â–€â–„ â–ˆâ–€ [0m
2025-09-20T16:54:39: [47m[30m â–„â–ˆâ–ˆâ–„â–„ â–„â–„â–€â–€â–„â–„â–„â–€â–ˆâ–„â–€â–„â–ˆâ–„ â–„â–„â–„â–„â–ˆâ–„â–€ â–€ â–„ â–€â–„â–„â–ˆâ–„â–„â–ˆâ–€â–ˆâ–ˆâ–„â–€ â–„â–„â–€â–ˆ â–„ â–ˆâ–€ â–„â–ˆâ–ˆâ–€â–„ [0m
2025-09-20T16:54:39: [47m[30m â–ˆ â–ˆâ–ˆ â–„â–„â–€â–ˆâ–ˆâ–„â–ˆ â–„â–ˆ   â–„â–„ â–€â–ˆâ–ˆâ–„â–€â–€â–€ â–€â–„â–„â–ˆ â–€â–ˆâ–„â–ˆâ–„  â–ˆ â–„â–€  â–„â–„ â–„ â–„â–ˆâ–ˆâ–ˆ    â–€ [0m
2025-09-20T16:54:39: [47m[30m â–ˆâ–„ â–€â–„â–ˆâ–„â–€â–€ â–ˆâ–€ â–„â–ˆâ–€â–„â–„ â–ˆâ–€â–ˆâ–„â–„â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–„â–„â–ˆ â–„â–ˆâ–„â–„â–€ â–„â–€â–„â–€  â–ˆ â–€â–„â–€â–„â–€â–ˆâ–€â–€ â–€â–ˆâ–„ [0m
2025-09-20T16:54:39: [47m[30m â–„â–€â–€â–ˆâ–„â–ˆâ–„â–ˆâ–„  â–ˆâ–ˆâ–€â–ˆâ–€â–ˆ â–€â–ˆâ–€â–„â–€â–„â–€â–ˆ â–„â–„â–„â–ˆâ–„â–ˆâ–€â–€â–„â–„â–ˆ â–€ â–ˆ â–ˆ   â–„â–ˆâ–„â–€ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„â–€  [0m
2025-09-20T16:54:39: [47m[30m â–„   â–ˆ â–„ â–ˆâ–€â–ˆâ–€ â–„â–ˆâ–„â–„â–€â–ˆ  â–„â–„â–„â–ˆ â–„â–„â–ˆ â–„ â–ˆâ–„â–„â–ˆâ–„ â–„â–€â–„â–€â–ˆ â–„â–„â–„ â–ˆâ–€â–„â–€â–ˆ â–„ â–ˆâ–ˆâ–€â–ˆâ–ˆ [0m
2025-09-20T16:54:39: [47m[30m â–„ â–€â–„â–ˆâ–„â–„â–„â–ˆâ–€ â–„â–ˆâ–ˆâ–ˆâ–€â–€â–€â–ˆâ–ˆâ–„â–ˆâ–„ â–ˆâ–€â–€â–€â–ˆâ–„â–„â–„â–ˆâ–„â–„â–„â–„â–„â–€ â–€â–€â–ˆâ–„â–€â–ˆâ–€â–ˆâ–ˆ  â–€â–ˆâ–„â–„â–„â–ˆâ–„â–„â–€â–„ [0m
2025-09-20T16:54:39: [47m[30m â–„â–ˆ â–€â–„â–€â–„â–ˆâ–ˆâ–€â–€â–€â–€â–„ â–„ â–€â–€â–„â–ˆâ–„â–ˆâ–€â–ˆâ–€â–€â–ˆâ–€â–ˆâ–„â–ˆâ–ˆâ–„â–„ â–€â–„â–„ â–„â–€â–ˆ â–„  â–ˆâ–„â–€â–„â–ˆâ–€â–€â–ˆâ–„â–„ â–ˆâ–„â–„ [0m
2025-09-20T16:54:39: [47m[30m â–ˆâ–€â–ˆâ–„â–€ â–„â–ˆâ–€â–€â–ˆ â–€ â–„â–ˆ â–ˆâ–€â–ˆâ–ˆâ–ˆ  â–„â–€â–€â–ˆ â–ˆâ–„â–ˆâ–„â–€ â–ˆâ–ˆâ–ˆâ–ˆâ–€ â–„ â–„â–€â–„ â–„â–„â–ˆâ–ˆâ–„â–€â–€â–„â–„â–ˆâ–€â–„â–€â–€ [0m
2025-09-20T16:54:39: [47m[30m  â–„â–„ â–„â–ˆâ–„ â–€â–€â–€â–€â–„â–„â–ˆâ–„â–„â–ˆâ–€â–ˆâ–„â–„â–„â–€â–ˆâ–ˆâ–ˆâ–„â–ˆâ–„â–„â–€â–„â–„â–„â–ˆâ–€â–ˆ â–ˆ â–€â–ˆâ–ˆâ–€  â–€â–€â–€â–„â–€ â–ˆâ–ˆâ–€â–„â–ˆ â–„  [0m
2025-09-20T16:54:39: [47m[30m  â–ˆâ–ˆâ–ˆâ–ˆ â–„â–„â–ˆâ–€â–„â–ˆ â–€â–€â–€â–ˆ â–„â–„â–„â–€â–ˆâ–€â–ˆâ–„â–ˆâ–„â–€â–ˆâ–„â–€ â–ˆâ–„â–„â–„â–€ â–„â–€â–€â–€â–„ â–€â–„â–„â–ˆâ–€â–„â–ˆâ–ˆâ–ˆâ–„â–€â–„ â–„ â–ˆ [0m
2025-09-20T16:54:39: [47m[30m â–€ â–„â–€â–€â–€â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„â–ˆ â–€ â–€â–„  â–ˆâ–„â–€â–€ â–„ â–ˆâ–€â–ˆâ–€â–ˆâ–„â–„ â–ˆâ–ˆâ–ˆ â–ˆâ–€â–„â–€ â–ˆâ–„ â–ˆâ–ˆâ–€  â–„â–„â–ˆâ–€ â–ˆ â–€â–„ [0m
2025-09-20T16:54:39: [47m[30m  â–€â–ˆâ–ˆâ–ˆâ–€â–„â–€   â–„â–ˆâ–€â–„ â–€â–„â–€â–€â–€â–ˆâ–„â–ˆâ–„â–„ â–„ â–€â–ˆâ–€ â–„â–ˆâ–„â–„ â–€  â–ˆâ–€â–„â–€â–„ â–„â–ˆ â–€â–ˆâ–€ â–€â–ˆâ–„â–„ â–€â–ˆ [0m
2025-09-20T16:54:39: [47m[30m â–€â–ˆâ–„  â–ˆâ–„ â–€  â–„ â–ˆ  â–€â–„ â–€â–€ â–ˆâ–€â–ˆâ–„ â–€â–€ â–„  â–„â–€â–ˆâ–€â–€â–„ â–€â–„â–€â–€â–€ â–„â–„â–ˆâ–€â–„â–„â–€ â–„â–€â–„â–„â–€â–„â–„ [0m
2025-09-20T16:54:39: [47m[30m  â–ˆ â–€â–„â–ˆâ–„â–ˆ â–€â–„â–€â–„  â–ˆ â–„â–€â–€â–€ â–€â–„â–€â–„  â–€â–€â–ˆâ–ˆâ–„ â–€â–€â–„â–ˆâ–ˆâ–€â–€â–„â–ˆâ–ˆ â–€ â–€â–„â–€â–ˆâ–„ â–ˆ â–ˆâ–„â–€â–„â–„â–€ [0m
2025-09-20T16:54:39: [47m[30m â–€ â–„â–„â–ˆâ–ˆâ–„â–„â–„ â–„ â–ˆ â–ˆâ–€â–€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–ˆâ–ˆâ–€â–€â–ˆâ–„â–€â–„ â–ˆâ–€â–ˆâ–„â–€â–ˆâ–€â–ˆ â–ˆâ–„â–„â–ˆâ–ˆâ–€â–„â–ˆâ–€â–„â–ˆâ–€â–„â–€â–„â–„â–„ [0m
2025-09-20T16:54:39: [47m[30m â–ˆâ–ˆâ–ˆâ–„â–€ â–„â–„â–€â–€â–„ â–„â–ˆâ–„â–€â–€â–ˆâ–ˆâ–€â–€â–ˆâ–„â–€â–„â–€ â–€â–ˆâ–„â–ˆâ–„â–„â–ˆâ–€â–ˆâ–ˆ â–€â–€â–€  â–€â–€ â–„â–€â–„â–„ â–ˆâ–ˆâ–„â–ˆâ–„â–„â–„â–„â–„â–„ [0m
2025-09-20T16:54:39: [47m[30m â–„â–„â–„â–„â–„â–„â–„ â–€ â–€â–€â–ˆâ–„â–„â–€â–ˆâ–ˆâ–ˆâ–ˆ â–„ â–€â–ˆ â–€â–„â–ˆ â–„ â–ˆ â–„â–€â–ˆâ–€â–„â–ˆâ–„â–€â–€â–€â–ˆâ–„ â–€ â–„â–„â–„â–ˆ â–„ â–ˆâ–„â–„â–ˆâ–ˆ [0m
2025-09-20T16:54:39: [47m[30m â–ˆ â–„â–„â–„ â–ˆ â–ˆâ–ˆâ–ˆ   â–„â–„â–„â–€â–€â–€   â–€â–€â–„â–€â–„â–ˆâ–„â–„â–„â–ˆâ–ˆâ–€â–„â–„â–ˆâ–„â–„â–€â–€â–€â–„â–€ â–„â–„â–„ â–ˆ â–ˆâ–„â–„â–„â–ˆâ–„â–„ â–€ [0m
2025-09-20T16:54:39: [47m[30m â–ˆ â–ˆâ–ˆâ–ˆ â–ˆ â–ˆâ–„â–€â–ˆâ–ˆâ–€  â–€â–€ â–ˆ â–€ â–ˆâ–ˆâ–€â–€â–€â–€â–„â–€â–€   â–ˆâ–„â–€ â–„â–„â–ˆâ–€ â–„   â–€â–„â–„â–„â–€â–ˆâ–ˆâ–„â–€   â–ˆ [0m
2025-09-20T16:54:39: [47m[30m â–ˆâ–„â–„â–„â–„â–„â–ˆ â–„â–ˆâ–€â–„â–„ â–€ â–ˆâ–„â–ˆâ–€â–„â–„â–ˆâ–„â–ˆâ–€ â–€â–€â–„â–„â–„ â–„â–„â–„â–ˆâ–€  â–€ â–€â–ˆâ–€â–„â–ˆâ–„â–„â–ˆ â–ˆâ–€â–€â–ˆâ–ˆâ–„ â–„â–„â–ˆ [0m
2025-09-20T16:54:39: [47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m[37mâ–€[47m[30m[0m
2025-09-20T16:54:39: [47m[30m[0m
2025-09-20T16:54:39: ğŸ“· QR Code saved as: C:\Users\gssai\OneDrive\Desktop\Whatsapp-Moblie-Bot\src\core\qr-code.png
2025-09-20T16:55:04: {"level":50,"time":1758367504182,"pid":12528,"hostname":"SAURABH","node":{"tag":"stream:error","attrs":{"code":"515"}},"msg":"stream errored out"}
2025-09-20T16:55:04: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T16:55:04: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T16:55:04: ğŸ”„ Reconnecting in 1s... (Attempt 1/10)
2025-09-20T16:55:05: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T16:55:05: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T16:55:05: âœ… Google Sheets API initialized
2025-09-20T16:55:05: âœ… Google Sheets API initialized
2025-09-20T16:55:05: â„¹ï¸ [4:55:05 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T16:55:05:   startupTime: 1758367478084,
2025-09-20T16:55:05:   gracePeriodMs: 240000,
2025-09-20T16:55:05:   dataDir: './safety-data',
2025-09-20T16:55:05:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T16:55:05:   processId: 12528,
2025-09-20T16:55:05:   nodeVersion: 'v22.19.0'
2025-09-20T16:55:05: }
2025-09-20T16:55:05: â„¹ï¸ [4:55:05 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T16:55:05: â„¹ï¸ [4:55:05 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T16:55:05: ğŸ§¹ Removed stale process lock
2025-09-20T16:55:05: ğŸ”’ Process lock acquired (PID: 12528)
2025-09-20T16:55:05: â„¹ï¸ [4:55:05 pm] INFO: Process isolation enforced {
2025-09-20T16:55:05:   lockFile: 'safety-data\\process.lock',
2025-09-20T16:55:05:   pidFile: 'safety-data\\process.pid',
2025-09-20T16:55:05:   processId: 12528
2025-09-20T16:55:05: }
2025-09-20T16:55:05: â° Starting 240 second startup grace period...
2025-09-20T16:55:05: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T16:55:05: â„¹ï¸ [4:55:05 pm] INFO: Grace Period: STARTED {
2025-09-20T16:55:05:   action: 'STARTED',
2025-09-20T16:55:05:   remainingMs: 240000,
2025-09-20T16:55:05:   remainingSeconds: 240,
2025-09-20T16:55:05:   details: { startupTime: 1758367478084, processId: 12528 },
2025-09-20T16:55:05:   timestamp: 1758367505288
2025-09-20T16:55:05: }
2025-09-20T16:55:05: â„¹ï¸ [4:55:05 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T16:55:05:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T16:55:05:   remainingMs: 240000,
2025-09-20T16:55:05:   remainingSeconds: 240,
2025-09-20T16:55:05:   details: { startupTime: 1758367478084, willExpireAt: 1758367718084 },
2025-09-20T16:55:05:   timestamp: 1758367505289
2025-09-20T16:55:05: }
2025-09-20T16:55:05: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T16:55:05: â° Startup grace period: 240 seconds
2025-09-20T16:55:05: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T16:55:05: â„¹ï¸ [4:55:05 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T16:55:05:   initializationDuration: 27235,
2025-09-20T16:55:05:   gracePeriodActive: true,
2025-09-20T16:55:05:   messageRulesCount: 8,
2025-09-20T16:55:05:   messageTypes: [
2025-09-20T16:55:05:     'welcome',
2025-09-20T16:55:05:     'confirmation',
2025-09-20T16:55:05:     'ready',
2025-09-20T16:55:05:     'delivery',
2025-09-20T16:55:05:     'pickup_reminder',
2025-09-20T16:55:05:     'payment_reminder',
2025-09-20T16:55:05:     'fabric_welcome',
2025-09-20T16:55:05:     'fabric_purchase'
2025-09-20T16:55:05:   ],
2025-09-20T16:55:05:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T16:55:05:   databaseReady: true,
2025-09-20T16:55:05:   loggerReady: true,
2025-09-20T16:55:05:   processIsolationActive: true
2025-09-20T16:55:05: }
2025-09-20T16:55:05: âœ… Safety Manager initialized
2025-09-20T16:55:05: ğŸ“ Loaded 0 sent messages from file
2025-09-20T16:55:05: ğŸ“ Loaded 0 customer histories from file
2025-09-20T16:55:05: ğŸ“ Loaded 0 message hashes from file
2025-09-20T16:55:05: ğŸ“ Loaded statistics from file
2025-09-20T16:55:05: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:55:05: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T16:55:05: âœ… Duplicate Prevention Manager initialized
2025-09-20T16:55:05: ğŸ”„ Starting WhatsApp connection...
2025-09-20T16:55:05: ğŸ”„ Initializing WhatsApp client...
2025-09-20T16:55:05: âœ… WhatsApp connection started
2025-09-20T16:55:05: ğŸ”§ Initializing admin commands...
2025-09-20T16:55:05: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T16:55:05: âœ… Admin commands system initialized
2025-09-20T16:55:05: ğŸ”„ Initializing polling functionality...
2025-09-20T16:55:05: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T16:55:05: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T16:55:05: ğŸ”„ Connecting to WhatsApp...
2025-09-20T16:55:07: âœ… WhatsApp connected successfully!
2025-09-20T16:55:07: ğŸ”„ Enhanced client: Connected event received, forwarding...
2025-09-20T16:55:07: ğŸ“± Session established successfully
2025-09-20T16:55:07: ğŸ”’ Session will be monitored for stability
2025-09-20T16:55:08: ğŸ’¾ Data synced to files successfully
2025-09-20T16:55:38: ğŸ’¾ Data synced to files successfully
2025-09-20T16:56:08: ğŸ’¾ Data synced to files successfully
2025-09-20T16:56:38: ğŸ’¾ Data synced to files successfully
2025-09-20T16:57:08: ğŸ’¾ Data synced to files successfully
2025-09-20T16:57:38: ğŸ’¾ Data synced to files successfully
2025-09-20T16:58:08: ğŸ’¾ Data synced to files successfully
2025-09-20T16:58:38: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:58:38: ğŸ’¾ Data synced to files successfully
2025-09-20T16:58:38: â„¹ï¸ [4:58:38 pm] INFO: Grace Period: ENDED {
2025-09-20T16:58:38:   action: 'ENDED',
2025-09-20T16:58:38:   remainingMs: 0,
2025-09-20T16:58:38:   remainingSeconds: 0,
2025-09-20T16:58:38:   details: { totalDuration: 240000, processId: 12528 },
2025-09-20T16:58:38:   timestamp: 1758367718260
2025-09-20T16:58:38: }
2025-09-20T16:58:38: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:58:38: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:58:38: â„¹ï¸ [4:58:38 pm] INFO: Grace Period: ENDED {
2025-09-20T16:58:38:   action: 'ENDED',
2025-09-20T16:58:38:   remainingMs: 0,
2025-09-20T16:58:38:   remainingSeconds: 0,
2025-09-20T16:58:38:   details: { totalDuration: 240000, processId: 12528 },
2025-09-20T16:58:38:   timestamp: 1758367718273
2025-09-20T16:58:38: }
2025-09-20T16:58:38: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:59:05: âœ… Startup grace period ended - message sending now allowed
2025-09-20T16:59:05: â„¹ï¸ [4:59:05 pm] INFO: Grace Period: ENDED {
2025-09-20T16:59:05:   action: 'ENDED',
2025-09-20T16:59:05:   remainingMs: 0,
2025-09-20T16:59:05:   remainingSeconds: 0,
2025-09-20T16:59:05:   details: { totalDuration: 240000, processId: 12528 },
2025-09-20T16:59:05:   timestamp: 1758367745316
2025-09-20T16:59:05: }
2025-09-20T16:59:05: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T16:59:08: ğŸ’¾ Data synced to files successfully
2025-09-20T16:59:38: ğŸ’¾ Data synced to files successfully
2025-09-20T17:00:08: ğŸ’¾ Data synced to files successfully
2025-09-20T17:00:38: ğŸ’¾ Data synced to files successfully
2025-09-20T17:01:08: ğŸ’¾ Data synced to files successfully
2025-09-20T17:01:38: ğŸ’¾ Data synced to files successfully
2025-09-20T17:02:08: ğŸ’¾ Data synced to files successfully
2025-09-20T17:02:38: ğŸ’¾ Data synced to files successfully
2025-09-20T17:02:55: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:02:55: ğŸ“ Loaded 11 template types
2025-09-20T17:02:55: ğŸ”§ WhatsApp Bot initialized
2025-09-20T17:02:55: ğŸ“Š Configuration status: undefined
2025-09-20T17:02:55: âœ… Atomic State Manager initialized
2025-09-20T17:02:55: ğŸ“ Enhanced Logger initialized
2025-09-20T17:02:55: âœ… Google credentials loaded from service-account.json file
2025-09-20T17:02:55: ğŸ“± WhatsApp auth status: âœ… credentials, 1 session files
2025-09-20T17:02:55: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-20T17:02:55:    Auth Mode: both
2025-09-20T17:02:55:    QR Enabled: true
2025-09-20T17:02:55:    Phone Enabled: true
2025-09-20T17:02:55:    Session Persistence: true
2025-09-20T17:02:55:    Max Reconnect Attempts: 10
2025-09-20T17:02:55:    Default Phone: None
2025-09-20T17:02:55: ğŸ”’ Session validation enabled (check every 300s)
2025-09-20T17:02:55: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-20T17:02:55: ğŸ”§ Developer Configuration initialized
2025-09-20T17:02:55: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T17:02:55: â„¹ï¸ [5:02:55 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T17:02:55:   startupTime: 1758367975888,
2025-09-20T17:02:55:   gracePeriodMs: 240000,
2025-09-20T17:02:55:   dataDir: './safety-data',
2025-09-20T17:02:55:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T17:02:55:   processId: 23536,
2025-09-20T17:02:55:   nodeVersion: 'v22.19.0'
2025-09-20T17:02:55: }
2025-09-20T17:02:56: ğŸ”§ Developer Configuration initialized
2025-09-20T17:02:56: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T17:02:56: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-20T17:02:56: â° 4-minute startup delay active
2025-09-20T17:02:56: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-20T17:02:56: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-20T17:02:56: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T17:02:56: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T17:02:56: âœ… Google Sheets API initialized
2025-09-20T17:02:56: âœ… Google Sheets API initialized
2025-09-20T17:02:56: â„¹ï¸ [5:02:56 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T17:02:56:   startupTime: 1758367975888,
2025-09-20T17:02:56:   gracePeriodMs: 240000,
2025-09-20T17:02:56:   dataDir: './safety-data',
2025-09-20T17:02:56:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T17:02:56:   processId: 23536,
2025-09-20T17:02:56:   nodeVersion: 'v22.19.0'
2025-09-20T17:02:56: }
2025-09-20T17:02:56: ğŸ“ Loaded 0 sent messages from file
2025-09-20T17:02:56: â„¹ï¸ [5:02:56 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T17:02:56: â„¹ï¸ [5:02:56 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T17:02:56: ğŸ“ Loaded 0 customer histories from file
2025-09-20T17:02:56: â„¹ï¸ [5:02:56 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T17:02:56: ğŸ“ Loaded 0 message hashes from file
2025-09-20T17:02:56: â„¹ï¸ [5:02:56 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T17:02:56: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T09-55-57-588Z.log
2025-09-20T17:02:56: ğŸ“ Enhanced Logger initialized
2025-09-20T17:02:56: ğŸ“ Loaded statistics from file
2025-09-20T17:02:56: âœ… Duplicate Prevention Manager initialized
2025-09-20T17:02:56: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T17:02:56: ğŸ§¹ Removed stale process lock
2025-09-20T17:02:56: ğŸ§¹ Lock file already cleaned up
2025-09-20T17:02:56: ğŸ”’ Process lock acquired (PID: 23536)
2025-09-20T17:02:56: ğŸ”’ Process lock acquired (PID: 23536)
2025-09-20T17:02:56: â„¹ï¸ [5:02:56 pm] INFO: Process isolation enforced {
2025-09-20T17:02:56:   lockFile: 'safety-data\\process.lock',
2025-09-20T17:02:56:   pidFile: 'safety-data\\process.pid',
2025-09-20T17:02:56:   processId: 23536
2025-09-20T17:02:56: }
2025-09-20T17:02:56: â° Starting 240 second startup grace period...
2025-09-20T17:02:56: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T17:02:56: â„¹ï¸ [5:02:56 pm] INFO: Process isolation enforced {
2025-09-20T17:02:56:   lockFile: 'safety-data\\process.lock',
2025-09-20T17:02:56:   pidFile: 'safety-data\\process.pid',
2025-09-20T17:02:56:   processId: 23536
2025-09-20T17:02:56: }
2025-09-20T17:02:56: â° Starting 240 second startup grace period...
2025-09-20T17:02:56: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T17:02:56: â„¹ï¸ [5:02:56 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T17:02:56:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T17:02:56:   remainingMs: 240000,
2025-09-20T17:02:56:   remainingSeconds: 240,
2025-09-20T17:02:56:   details: { startupTime: 1758367975888, willExpireAt: 1758368215888 },
2025-09-20T17:02:56:   timestamp: 1758367976044
2025-09-20T17:02:56: }
2025-09-20T17:02:56: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T17:02:56: â° Startup grace period: 240 seconds
2025-09-20T17:02:56: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T17:02:56: â„¹ï¸ [5:02:56 pm] INFO: Grace Period: STARTED {
2025-09-20T17:02:56:   action: 'STARTED',
2025-09-20T17:02:56:   remainingMs: 240000,
2025-09-20T17:02:56:   remainingSeconds: 240,
2025-09-20T17:02:56:   details: { startupTime: 1758367975888, processId: 23536 },
2025-09-20T17:02:56:   timestamp: 1758367976043
2025-09-20T17:02:56: }
2025-09-20T17:02:56: â„¹ï¸ [5:02:56 pm] INFO: Grace Period: STARTED {
2025-09-20T17:02:56:   action: 'STARTED',
2025-09-20T17:02:56:   remainingMs: 240000,
2025-09-20T17:02:56:   remainingSeconds: 240,
2025-09-20T17:02:56:   details: { startupTime: 1758367975888, processId: 23536 },
2025-09-20T17:02:56:   timestamp: 1758367976048
2025-09-20T17:02:56: }
2025-09-20T17:02:56: â„¹ï¸ [5:02:56 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T17:02:56:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T17:02:56:   remainingMs: 240000,
2025-09-20T17:02:56:   remainingSeconds: 240,
2025-09-20T17:02:56:   details: { startupTime: 1758367975888, willExpireAt: 1758368215888 },
2025-09-20T17:02:56:   timestamp: 1758367976048
2025-09-20T17:02:56: }
2025-09-20T17:02:56: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T17:02:56: â° Startup grace period: 240 seconds
2025-09-20T17:02:56: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T17:02:56: â„¹ï¸ [5:02:56 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T17:02:56:   initializationDuration: 163,
2025-09-20T17:02:56:   gracePeriodActive: true,
2025-09-20T17:02:56:   messageRulesCount: 8,
2025-09-20T17:02:56:   messageTypes: [
2025-09-20T17:02:56:     'welcome',
2025-09-20T17:02:56:     'confirmation',
2025-09-20T17:02:56:     'ready',
2025-09-20T17:02:56:     'delivery',
2025-09-20T17:02:56:     'pickup_reminder',
2025-09-20T17:02:56:     'payment_reminder',
2025-09-20T17:02:56:     'fabric_welcome',
2025-09-20T17:02:56:     'fabric_purchase'
2025-09-20T17:02:56:   ],
2025-09-20T17:02:56:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T17:02:56:   databaseReady: true,
2025-09-20T17:02:56:   loggerReady: true,
2025-09-20T17:02:56:   processIsolationActive: true
2025-09-20T17:02:56: }
2025-09-20T17:02:56: â„¹ï¸ [5:02:56 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T17:02:56:   initializationDuration: 167,
2025-09-20T17:02:56:   gracePeriodActive: true,
2025-09-20T17:02:56:   messageRulesCount: 8,
2025-09-20T17:02:56:   messageTypes: [
2025-09-20T17:02:56:     'welcome',
2025-09-20T17:02:56:     'confirmation',
2025-09-20T17:02:56:     'ready',
2025-09-20T17:02:56:     'delivery',
2025-09-20T17:02:56:     'pickup_reminder',
2025-09-20T17:02:56:     'payment_reminder',
2025-09-20T17:02:56:     'fabric_welcome',
2025-09-20T17:02:56:     'fabric_purchase'
2025-09-20T17:02:56:   ],
2025-09-20T17:02:56:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T17:02:56:   databaseReady: true,
2025-09-20T17:02:56:   loggerReady: true,
2025-09-20T17:02:56:   processIsolationActive: true
2025-09-20T17:02:56: }
2025-09-20T17:02:56: âœ… Safety Manager initialized
2025-09-20T17:02:56: ğŸ“ Loaded 0 sent messages from file
2025-09-20T17:02:56: ğŸ“ Loaded 0 customer histories from file
2025-09-20T17:02:56: ğŸ“ Loaded 0 message hashes from file
2025-09-20T17:02:56: ğŸ“ Loaded statistics from file
2025-09-20T17:02:56: âœ… Duplicate Prevention Manager initialized
2025-09-20T17:02:56: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T17:02:56: âœ… Duplicate Prevention Manager initialized
2025-09-20T17:02:56: ğŸ”„ Starting WhatsApp connection...
2025-09-20T17:02:56: ğŸ”„ Initializing WhatsApp client...
2025-09-20T17:02:56: âœ… WhatsApp connection started
2025-09-20T17:02:56: ğŸ”§ Initializing admin commands...
2025-09-20T17:02:56: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T17:02:56: âœ… Admin commands system initialized
2025-09-20T17:02:56: ğŸ”„ Initializing polling functionality...
2025-09-20T17:02:56: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T17:02:56: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T17:02:56: ğŸ“ Attempting to request pairing code...
2025-09-20T17:02:56: ğŸ’¡ To use phone authentication:
2025-09-20T17:02:56:    1. Use the dashboard at http://localhost:3001
2025-09-20T17:02:56:    2. Select "Phone Number Authentication"
2025-09-20T17:02:56:    3. Enter your phone number
2025-09-20T17:02:56:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T17:02:56: ğŸ”„ Connecting to WhatsApp...
2025-09-20T17:02:58: âœ… WhatsApp connected successfully!
2025-09-20T17:02:58: ğŸ”„ Enhanced client: Connected event received, forwarding...
2025-09-20T17:02:58: ğŸ“± Session established successfully
2025-09-20T17:02:58: ğŸ”’ Session will be monitored for stability
2025-09-20T17:03:05: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:03:05: ğŸ“ Loaded 11 template types
2025-09-20T17:03:05: ğŸ” [918058693371] Starting comprehensive message safety check...
2025-09-20T17:03:05: ğŸ“‹ [918058693371] Order: TXL18092517, Type: confirmation
2025-09-20T17:03:05: ğŸ›¡ï¸ [918058693371] Running primary safety check...
2025-09-20T17:03:05: ğŸ›¡ï¸ [918058693371_TXL18092517_confirmation_1758367985878] Starting comprehensive safety check...
2025-09-20T17:03:05: ğŸ“‹ [918058693371_TXL18092517_confirmation_1758367985878] Phone: 918058693371, Order: TXL18092517, Type: confirmation
2025-09-20T17:03:05: â„¹ï¸ [5:03:05 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:03:05:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:03:05:   phone: '918****371',
2025-09-20T17:03:05:   orderId: 'TXL18092517',
2025-09-20T17:03:05:   messageType: 'confirmation',
2025-09-20T17:03:05:   result: 'STARTED',
2025-09-20T17:03:05:   details: {
2025-09-20T17:03:05:     checkId: '918058693371_TXL18092517_confirmation_1758367985878',
2025-09-20T17:03:05:     hasOrderData: true,
2025-09-20T17:03:05:     hasSheetData: false,
2025-09-20T17:03:05:     messageLength: 472
2025-09-20T17:03:05:   },
2025-09-20T17:03:05:   timestamp: 1758367985878
2025-09-20T17:03:05: }
2025-09-20T17:03:05: ğŸ” [918058693371_TXL18092517_confirmation_1758367985878] Step 1: Kill Switch Check
2025-09-20T17:03:05: ğŸ” [918058693371_TXL18092517_confirmation_1758367985878] Step 1.5: Developer Phone Check
2025-09-20T17:03:05: ğŸ” [918058693371_TXL18092517_confirmation_1758367985878] Step 2: Grace Period Check
2025-09-20T17:03:05: â„¹ï¸ [5:03:05 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:03:05:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:03:05:   remainingMs: 230004,
2025-09-20T17:03:05:   remainingSeconds: 231,
2025-09-20T17:03:05:   details: {
2025-09-20T17:03:05:     checkId: '918058693371_TXL18092517_confirmation_1758367985878',
2025-09-20T17:03:05:     phone: '918058693371',
2025-09-20T17:03:05:     orderId: 'TXL18092517',
2025-09-20T17:03:05:     messageType: 'confirmation'
2025-09-20T17:03:05:   },
2025-09-20T17:03:05:   timestamp: 1758367985884
2025-09-20T17:03:05: }
2025-09-20T17:03:05: âŒ [918058693371_TXL18092517_confirmation_1758367985878] Startup grace period active (231s remaining)
2025-09-20T17:03:05: ğŸš« [918058693371] PRIMARY SAFETY CHECK FAILED: Startup grace period active (231s remaining)
2025-09-20T17:03:05: ğŸ“ Message recorded: 918058693371 | TXL18092517 | confirmation | Success: false
2025-09-20T17:03:05: â„¹ï¸ [5:03:05 pm] INFO: Message ALLOWED: confirmation for TXL18092517 {
2025-09-20T17:03:05:   phone: '918****371',
2025-09-20T17:03:05:   orderId: 'TXL18092517',
2025-09-20T17:03:05:   messageType: 'confirmation',
2025-09-20T17:03:05:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:03:05:   reason: {
2025-09-20T17:03:05:     contentHash: 'a1ead4760b0d2ad2',
2025-09-20T17:03:05:     timestamp: 1758367985889,
2025-09-20T17:03:05:     messageLength: 472,
2025-09-20T17:03:05:     errorMessage: 'Startup grace period active (231s remaining)',
2025-09-20T17:03:05:     backupFile: 'safety-data\\backup_918058693371_TXL18092517_confirmation.json'
2025-09-20T17:03:05:   },
2025-09-20T17:03:05:   duration: 0,
2025-09-20T17:03:05:   timestamp: 1758367985910
2025-09-20T17:03:05: }
2025-09-20T17:03:05: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:03:05: ğŸ“ Loaded 11 template types
2025-09-20T17:03:05: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T17:03:05: ğŸ“‹ [918890134811] Order: TGY18092517, Type: confirmation
2025-09-20T17:03:05: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T17:03:05: ğŸ›¡ï¸ [918890134811_TGY18092517_confirmation_1758367985914] Starting comprehensive safety check...
2025-09-20T17:03:05: ğŸ“‹ [918890134811_TGY18092517_confirmation_1758367985914] Phone: 918890134811, Order: TGY18092517, Type: confirmation
2025-09-20T17:03:05: â„¹ï¸ [5:03:05 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:03:05:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:03:05:   phone: '918****811',
2025-09-20T17:03:05:   orderId: 'TGY18092517',
2025-09-20T17:03:05:   messageType: 'confirmation',
2025-09-20T17:03:05:   result: 'STARTED',
2025-09-20T17:03:05:   details: {
2025-09-20T17:03:05:     checkId: '918890134811_TGY18092517_confirmation_1758367985914',
2025-09-20T17:03:05:     hasOrderData: true,
2025-09-20T17:03:05:     hasSheetData: false,
2025-09-20T17:03:05:     messageLength: 473
2025-09-20T17:03:05:   },
2025-09-20T17:03:05:   timestamp: 1758367985915
2025-09-20T17:03:05: }
2025-09-20T17:03:05: ğŸ” [918890134811_TGY18092517_confirmation_1758367985914] Step 1: Kill Switch Check
2025-09-20T17:03:05: ğŸ” [918890134811_TGY18092517_confirmation_1758367985914] Step 1.5: Developer Phone Check
2025-09-20T17:03:05: ğŸ” [918890134811_TGY18092517_confirmation_1758367985914] Step 2: Grace Period Check
2025-09-20T17:03:05: â„¹ï¸ [5:03:05 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:03:05:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:03:05:   remainingMs: 229967,
2025-09-20T17:03:05:   remainingSeconds: 230,
2025-09-20T17:03:05:   details: {
2025-09-20T17:03:05:     checkId: '918890134811_TGY18092517_confirmation_1758367985914',
2025-09-20T17:03:05:     phone: '918890134811',
2025-09-20T17:03:05:     orderId: 'TGY18092517',
2025-09-20T17:03:05:     messageType: 'confirmation'
2025-09-20T17:03:05:   },
2025-09-20T17:03:05:   timestamp: 1758367985922
2025-09-20T17:03:05: }
2025-09-20T17:03:05: âŒ [918890134811_TGY18092517_confirmation_1758367985914] Startup grace period active (230s remaining)
2025-09-20T17:03:05: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (230s remaining)
2025-09-20T17:03:05: ğŸ“ Message recorded: 918890134811 | TGY18092517 | confirmation | Success: false
2025-09-20T17:03:05: â„¹ï¸ [5:03:05 pm] INFO: Message ALLOWED: confirmation for TGY18092517 {
2025-09-20T17:03:05:   phone: '918****811',
2025-09-20T17:03:05:   orderId: 'TGY18092517',
2025-09-20T17:03:05:   messageType: 'confirmation',
2025-09-20T17:03:05:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:03:05:   reason: {
2025-09-20T17:03:05:     contentHash: '5ca42c940f17d86b',
2025-09-20T17:03:05:     timestamp: 1758367985926,
2025-09-20T17:03:05:     messageLength: 473,
2025-09-20T17:03:05:     errorMessage: 'Startup grace period active (230s remaining)',
2025-09-20T17:03:05:     backupFile: 'safety-data\\backup_918890134811_TGY18092517_confirmation.json'
2025-09-20T17:03:05:   },
2025-09-20T17:03:05:   duration: 0,
2025-09-20T17:03:05:   timestamp: 1758367985939
2025-09-20T17:03:05: }
2025-09-20T17:03:05: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:03:05: ğŸ“ Loaded 11 template types
2025-09-20T17:03:05: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T17:03:05: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T17:03:05: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T17:03:05: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758367985942] Starting comprehensive safety check...
2025-09-20T17:03:05: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758367985942] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T17:03:05: â„¹ï¸ [5:03:05 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:03:05:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:03:05:   phone: '919****706',
2025-09-20T17:03:05:   orderId: 'TJJ19092511',
2025-09-20T17:03:05:   messageType: 'confirmation',
2025-09-20T17:03:05:   result: 'STARTED',
2025-09-20T17:03:05:   details: {
2025-09-20T17:03:05:     checkId: '919953020706_TJJ19092511_confirmation_1758367985942',
2025-09-20T17:03:05:     hasOrderData: true,
2025-09-20T17:03:05:     hasSheetData: false,
2025-09-20T17:03:05:     messageLength: 469
2025-09-20T17:03:05:   },
2025-09-20T17:03:05:   timestamp: 1758367985942
2025-09-20T17:03:05: }
2025-09-20T17:03:05: ğŸ” [919953020706_TJJ19092511_confirmation_1758367985942] Step 1: Kill Switch Check
2025-09-20T17:03:05: ğŸ” [919953020706_TJJ19092511_confirmation_1758367985942] Step 1.5: Developer Phone Check
2025-09-20T17:03:05: ğŸ” [919953020706_TJJ19092511_confirmation_1758367985942] Step 2: Grace Period Check
2025-09-20T17:03:05: â„¹ï¸ [5:03:05 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:03:05:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:03:05:   remainingMs: 229944,
2025-09-20T17:03:05:   remainingSeconds: 230,
2025-09-20T17:03:05:   details: {
2025-09-20T17:03:05:     checkId: '919953020706_TJJ19092511_confirmation_1758367985942',
2025-09-20T17:03:05:     phone: '919953020706',
2025-09-20T17:03:05:     orderId: 'TJJ19092511',
2025-09-20T17:03:05:     messageType: 'confirmation'
2025-09-20T17:03:05:   },
2025-09-20T17:03:05:   timestamp: 1758367985944
2025-09-20T17:03:05: }
2025-09-20T17:03:05: âŒ [919953020706_TJJ19092511_confirmation_1758367985942] Startup grace period active (230s remaining)
2025-09-20T17:03:05: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Startup grace period active (230s remaining)
2025-09-20T17:03:05: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T17:03:05: â„¹ï¸ [5:03:05 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T17:03:05:   phone: '919****706',
2025-09-20T17:03:05:   orderId: 'TJJ19092511',
2025-09-20T17:03:05:   messageType: 'confirmation',
2025-09-20T17:03:05:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:03:05:   reason: {
2025-09-20T17:03:05:     contentHash: '97026037ffec053e',
2025-09-20T17:03:05:     timestamp: 1758367985946,
2025-09-20T17:03:05:     messageLength: 469,
2025-09-20T17:03:05:     errorMessage: 'Startup grace period active (230s remaining)',
2025-09-20T17:03:05:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T17:03:05:   },
2025-09-20T17:03:05:   duration: 0,
2025-09-20T17:03:05:   timestamp: 1758367985957
2025-09-20T17:03:05: }
2025-09-20T17:03:05: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:03:05: ğŸ“ Loaded 11 template types
2025-09-20T17:03:05: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T17:03:05: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T17:03:05: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T17:03:05: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758367985960] Starting comprehensive safety check...
2025-09-20T17:03:05: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758367985960] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T17:03:05: â„¹ï¸ [5:03:05 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:03:05:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:03:05:   phone: '919****488',
2025-09-20T17:03:05:   orderId: 'TWM19092511',
2025-09-20T17:03:05:   messageType: 'confirmation',
2025-09-20T17:03:05:   result: 'STARTED',
2025-09-20T17:03:05:   details: {
2025-09-20T17:03:05:     checkId: '919358537488_TWM19092511_confirmation_1758367985960',
2025-09-20T17:03:05:     hasOrderData: true,
2025-09-20T17:03:05:     hasSheetData: false,
2025-09-20T17:03:05:     messageLength: 475
2025-09-20T17:03:05:   },
2025-09-20T17:03:05:   timestamp: 1758367985960
2025-09-20T17:03:05: }
2025-09-20T17:03:05: ğŸ” [919358537488_TWM19092511_confirmation_1758367985960] Step 1: Kill Switch Check
2025-09-20T17:03:05: ğŸ” [919358537488_TWM19092511_confirmation_1758367985960] Step 1.5: Developer Phone Check
2025-09-20T17:03:05: ğŸ” [919358537488_TWM19092511_confirmation_1758367985960] Step 2: Grace Period Check
2025-09-20T17:03:05: â„¹ï¸ [5:03:05 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:03:05:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:03:05:   remainingMs: 229926,
2025-09-20T17:03:05:   remainingSeconds: 230,
2025-09-20T17:03:05:   details: {
2025-09-20T17:03:05:     checkId: '919358537488_TWM19092511_confirmation_1758367985960',
2025-09-20T17:03:05:     phone: '919358537488',
2025-09-20T17:03:05:     orderId: 'TWM19092511',
2025-09-20T17:03:05:     messageType: 'confirmation'
2025-09-20T17:03:05:   },
2025-09-20T17:03:05:   timestamp: 1758367985962
2025-09-20T17:03:05: }
2025-09-20T17:03:05: âŒ [919358537488_TWM19092511_confirmation_1758367985960] Startup grace period active (230s remaining)
2025-09-20T17:03:05: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Startup grace period active (230s remaining)
2025-09-20T17:03:05: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T17:03:05: â„¹ï¸ [5:03:05 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T17:03:05:   phone: '919****488',
2025-09-20T17:03:05:   orderId: 'TWM19092511',
2025-09-20T17:03:05:   messageType: 'confirmation',
2025-09-20T17:03:05:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:03:05:   reason: {
2025-09-20T17:03:05:     contentHash: 'e34d023f065922da',
2025-09-20T17:03:05:     timestamp: 1758367985963,
2025-09-20T17:03:05:     messageLength: 475,
2025-09-20T17:03:05:     errorMessage: 'Startup grace period active (230s remaining)',
2025-09-20T17:03:05:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T17:03:05:   },
2025-09-20T17:03:05:   duration: 0,
2025-09-20T17:03:05:   timestamp: 1758367985977
2025-09-20T17:03:05: }
2025-09-20T17:03:05: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:03:05: ğŸ“ Loaded 11 template types
2025-09-20T17:03:05: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T17:03:05: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T17:03:05: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T17:03:05: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758367985979] Starting comprehensive safety check...
2025-09-20T17:03:05: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758367985979] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T17:03:05: â„¹ï¸ [5:03:05 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:03:05:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:03:05:   phone: '918****811',
2025-09-20T17:03:05:   orderId: 'TOF19092511',
2025-09-20T17:03:05:   messageType: 'confirmation',
2025-09-20T17:03:05:   result: 'STARTED',
2025-09-20T17:03:05:   details: {
2025-09-20T17:03:05:     checkId: '918890134811_TOF19092511_confirmation_1758367985979',
2025-09-20T17:03:05:     hasOrderData: true,
2025-09-20T17:03:05:     hasSheetData: false,
2025-09-20T17:03:05:     messageLength: 473
2025-09-20T17:03:05:   },
2025-09-20T17:03:05:   timestamp: 1758367985980
2025-09-20T17:03:05: }
2025-09-20T17:03:05: ğŸ” [918890134811_TOF19092511_confirmation_1758367985979] Step 1: Kill Switch Check
2025-09-20T17:03:05: ğŸ” [918890134811_TOF19092511_confirmation_1758367985979] Step 1.5: Developer Phone Check
2025-09-20T17:03:05: ğŸ” [918890134811_TOF19092511_confirmation_1758367985979] Step 2: Grace Period Check
2025-09-20T17:03:05: â„¹ï¸ [5:03:05 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:03:05:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:03:05:   remainingMs: 229904,
2025-09-20T17:03:05:   remainingSeconds: 230,
2025-09-20T17:03:05:   details: {
2025-09-20T17:03:05:     checkId: '918890134811_TOF19092511_confirmation_1758367985979',
2025-09-20T17:03:05:     phone: '918890134811',
2025-09-20T17:03:05:     orderId: 'TOF19092511',
2025-09-20T17:03:05:     messageType: 'confirmation'
2025-09-20T17:03:05:   },
2025-09-20T17:03:05:   timestamp: 1758367985984
2025-09-20T17:03:05: }
2025-09-20T17:03:05: âŒ [918890134811_TOF19092511_confirmation_1758367985979] Startup grace period active (230s remaining)
2025-09-20T17:03:05: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (230s remaining)
2025-09-20T17:03:05: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T17:03:05: â„¹ï¸ [5:03:05 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T17:03:05:   phone: '918****811',
2025-09-20T17:03:05:   orderId: 'TOF19092511',
2025-09-20T17:03:05:   messageType: 'confirmation',
2025-09-20T17:03:05:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:03:05:   reason: {
2025-09-20T17:03:05:     contentHash: '388fbe812e19f1de',
2025-09-20T17:03:05:     timestamp: 1758367985987,
2025-09-20T17:03:05:     messageLength: 473,
2025-09-20T17:03:05:     errorMessage: 'Startup grace period active (230s remaining)',
2025-09-20T17:03:05:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T17:03:05:   },
2025-09-20T17:03:05:   duration: 0,
2025-09-20T17:03:05:   timestamp: 1758367985996
2025-09-20T17:03:05: }
2025-09-20T17:03:25: ğŸ” [917375938371] Starting comprehensive message safety check...
2025-09-20T17:03:25: ğŸ“‹ [917375938371] Order: TEST-1758368005237, Type: test
2025-09-20T17:03:25: âš ï¸ ALL SAFETY CHECKS DISABLED - SENDING MESSAGE DIRECTLY (EMERGENCY MODE)
2025-09-20T17:03:26: ğŸ’¾ Data synced to files successfully
2025-09-20T17:03:27: âœ… Message sent to 917375938371@s.whatsapp.net
2025-09-20T17:03:56: ğŸ’¾ Data synced to files successfully
2025-09-20T17:04:26: ğŸ’¾ Data synced to files successfully
2025-09-20T17:04:56: ğŸ’¾ Data synced to files successfully
2025-09-20T17:05:26: ğŸ’¾ Data synced to files successfully
2025-09-20T17:05:56: ğŸ’¾ Data synced to files successfully
2025-09-20T17:06:05: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:06:05: ğŸ“ Loaded 11 template types
2025-09-20T17:06:05: ğŸ” [918058693371] Starting comprehensive message safety check...
2025-09-20T17:06:05: ğŸ“‹ [918058693371] Order: TXL18092517, Type: confirmation
2025-09-20T17:06:05: ğŸ›¡ï¸ [918058693371] Running primary safety check...
2025-09-20T17:06:05: ğŸ›¡ï¸ [918058693371_TXL18092517_confirmation_1758368165569] Starting comprehensive safety check...
2025-09-20T17:06:05: ğŸ“‹ [918058693371_TXL18092517_confirmation_1758368165569] Phone: 918058693371, Order: TXL18092517, Type: confirmation
2025-09-20T17:06:05: â„¹ï¸ [5:06:05 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:06:05:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:06:05:   phone: '918****371',
2025-09-20T17:06:05:   orderId: 'TXL18092517',
2025-09-20T17:06:05:   messageType: 'confirmation',
2025-09-20T17:06:05:   result: 'STARTED',
2025-09-20T17:06:05:   details: {
2025-09-20T17:06:05:     checkId: '918058693371_TXL18092517_confirmation_1758368165569',
2025-09-20T17:06:05:     hasOrderData: true,
2025-09-20T17:06:05:     hasSheetData: false,
2025-09-20T17:06:05:     messageLength: 472
2025-09-20T17:06:05:   },
2025-09-20T17:06:05:   timestamp: 1758368165569
2025-09-20T17:06:05: }
2025-09-20T17:06:05: ğŸ” [918058693371_TXL18092517_confirmation_1758368165569] Step 1: Kill Switch Check
2025-09-20T17:06:05: ğŸ” [918058693371_TXL18092517_confirmation_1758368165569] Step 1.5: Developer Phone Check
2025-09-20T17:06:05: ğŸ” [918058693371_TXL18092517_confirmation_1758368165569] Step 2: Grace Period Check
2025-09-20T17:06:05: â„¹ï¸ [5:06:05 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:06:05:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:06:05:   remainingMs: 50306,
2025-09-20T17:06:05:   remainingSeconds: 51,
2025-09-20T17:06:05:   details: {
2025-09-20T17:06:05:     checkId: '918058693371_TXL18092517_confirmation_1758368165569',
2025-09-20T17:06:05:     phone: '918058693371',
2025-09-20T17:06:05:     orderId: 'TXL18092517',
2025-09-20T17:06:05:     messageType: 'confirmation'
2025-09-20T17:06:05:   },
2025-09-20T17:06:05:   timestamp: 1758368165582
2025-09-20T17:06:05: }
2025-09-20T17:06:05: âŒ [918058693371_TXL18092517_confirmation_1758368165569] Startup grace period active (51s remaining)
2025-09-20T17:06:05: ğŸš« [918058693371] PRIMARY SAFETY CHECK FAILED: Startup grace period active (51s remaining)
2025-09-20T17:06:05: ğŸ“ Message recorded: 918058693371 | TXL18092517 | confirmation | Success: false
2025-09-20T17:06:05: â„¹ï¸ [5:06:05 pm] INFO: Message ALLOWED: confirmation for TXL18092517 {
2025-09-20T17:06:05:   phone: '918****371',
2025-09-20T17:06:05:   orderId: 'TXL18092517',
2025-09-20T17:06:05:   messageType: 'confirmation',
2025-09-20T17:06:05:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:06:05:   reason: {
2025-09-20T17:06:05:     contentHash: 'a1ead4760b0d2ad2',
2025-09-20T17:06:05:     timestamp: 1758368165592,
2025-09-20T17:06:05:     messageLength: 472,
2025-09-20T17:06:05:     errorMessage: 'Startup grace period active (51s remaining)',
2025-09-20T17:06:05:     backupFile: 'safety-data\\backup_918058693371_TXL18092517_confirmation.json'
2025-09-20T17:06:05:   },
2025-09-20T17:06:05:   duration: 0,
2025-09-20T17:06:05:   timestamp: 1758368165619
2025-09-20T17:06:05: }
2025-09-20T17:06:05: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:06:05: ğŸ“ Loaded 11 template types
2025-09-20T17:06:05: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T17:06:05: ğŸ“‹ [918890134811] Order: TGY18092517, Type: confirmation
2025-09-20T17:06:05: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T17:06:05: ğŸ›¡ï¸ [918890134811_TGY18092517_confirmation_1758368165627] Starting comprehensive safety check...
2025-09-20T17:06:05: ğŸ“‹ [918890134811_TGY18092517_confirmation_1758368165627] Phone: 918890134811, Order: TGY18092517, Type: confirmation
2025-09-20T17:06:05: â„¹ï¸ [5:06:05 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:06:05:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:06:05:   phone: '918****811',
2025-09-20T17:06:05:   orderId: 'TGY18092517',
2025-09-20T17:06:05:   messageType: 'confirmation',
2025-09-20T17:06:05:   result: 'STARTED',
2025-09-20T17:06:05:   details: {
2025-09-20T17:06:05:     checkId: '918890134811_TGY18092517_confirmation_1758368165627',
2025-09-20T17:06:05:     hasOrderData: true,
2025-09-20T17:06:05:     hasSheetData: false,
2025-09-20T17:06:05:     messageLength: 473
2025-09-20T17:06:05:   },
2025-09-20T17:06:05:   timestamp: 1758368165628
2025-09-20T17:06:05: }
2025-09-20T17:06:05: ğŸ” [918890134811_TGY18092517_confirmation_1758368165627] Step 1: Kill Switch Check
2025-09-20T17:06:05: ğŸ” [918890134811_TGY18092517_confirmation_1758368165627] Step 1.5: Developer Phone Check
2025-09-20T17:06:05: ğŸ” [918890134811_TGY18092517_confirmation_1758368165627] Step 2: Grace Period Check
2025-09-20T17:06:05: â„¹ï¸ [5:06:05 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:06:05:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:06:05:   remainingMs: 50256,
2025-09-20T17:06:05:   remainingSeconds: 51,
2025-09-20T17:06:05:   details: {
2025-09-20T17:06:05:     checkId: '918890134811_TGY18092517_confirmation_1758368165627',
2025-09-20T17:06:05:     phone: '918890134811',
2025-09-20T17:06:05:     orderId: 'TGY18092517',
2025-09-20T17:06:05:     messageType: 'confirmation'
2025-09-20T17:06:05:   },
2025-09-20T17:06:05:   timestamp: 1758368165632
2025-09-20T17:06:05: }
2025-09-20T17:06:05: âŒ [918890134811_TGY18092517_confirmation_1758368165627] Startup grace period active (51s remaining)
2025-09-20T17:06:05: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (51s remaining)
2025-09-20T17:06:05: ğŸ“ Message recorded: 918890134811 | TGY18092517 | confirmation | Success: false
2025-09-20T17:06:05: â„¹ï¸ [5:06:05 pm] INFO: Message ALLOWED: confirmation for TGY18092517 {
2025-09-20T17:06:05:   phone: '918****811',
2025-09-20T17:06:05:   orderId: 'TGY18092517',
2025-09-20T17:06:05:   messageType: 'confirmation',
2025-09-20T17:06:05:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:06:05:   reason: {
2025-09-20T17:06:05:     contentHash: '5ca42c940f17d86b',
2025-09-20T17:06:05:     timestamp: 1758368165635,
2025-09-20T17:06:05:     messageLength: 473,
2025-09-20T17:06:05:     errorMessage: 'Startup grace period active (51s remaining)',
2025-09-20T17:06:05:     backupFile: 'safety-data\\backup_918890134811_TGY18092517_confirmation.json'
2025-09-20T17:06:05:   },
2025-09-20T17:06:05:   duration: 0,
2025-09-20T17:06:05:   timestamp: 1758368165650
2025-09-20T17:06:05: }
2025-09-20T17:06:05: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:06:05: ğŸ“ Loaded 11 template types
2025-09-20T17:06:05: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T17:06:05: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T17:06:05: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T17:06:05: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758368165653] Starting comprehensive safety check...
2025-09-20T17:06:05: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758368165653] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T17:06:05: â„¹ï¸ [5:06:05 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:06:05:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:06:05:   phone: '919****706',
2025-09-20T17:06:05:   orderId: 'TJJ19092511',
2025-09-20T17:06:05:   messageType: 'confirmation',
2025-09-20T17:06:05:   result: 'STARTED',
2025-09-20T17:06:05:   details: {
2025-09-20T17:06:05:     checkId: '919953020706_TJJ19092511_confirmation_1758368165653',
2025-09-20T17:06:05:     hasOrderData: true,
2025-09-20T17:06:05:     hasSheetData: false,
2025-09-20T17:06:05:     messageLength: 469
2025-09-20T17:06:05:   },
2025-09-20T17:06:05:   timestamp: 1758368165653
2025-09-20T17:06:05: }
2025-09-20T17:06:05: ğŸ” [919953020706_TJJ19092511_confirmation_1758368165653] Step 1: Kill Switch Check
2025-09-20T17:06:05: ğŸ” [919953020706_TJJ19092511_confirmation_1758368165653] Step 1.5: Developer Phone Check
2025-09-20T17:06:05: ğŸ” [919953020706_TJJ19092511_confirmation_1758368165653] Step 2: Grace Period Check
2025-09-20T17:06:05: â„¹ï¸ [5:06:05 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:06:05:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:06:05:   remainingMs: 50231,
2025-09-20T17:06:05:   remainingSeconds: 51,
2025-09-20T17:06:05:   details: {
2025-09-20T17:06:05:     checkId: '919953020706_TJJ19092511_confirmation_1758368165653',
2025-09-20T17:06:05:     phone: '919953020706',
2025-09-20T17:06:05:     orderId: 'TJJ19092511',
2025-09-20T17:06:05:     messageType: 'confirmation'
2025-09-20T17:06:05:   },
2025-09-20T17:06:05:   timestamp: 1758368165657
2025-09-20T17:06:05: }
2025-09-20T17:06:05: âŒ [919953020706_TJJ19092511_confirmation_1758368165653] Startup grace period active (51s remaining)
2025-09-20T17:06:05: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Startup grace period active (51s remaining)
2025-09-20T17:06:05: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T17:06:05: â„¹ï¸ [5:06:05 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T17:06:05:   phone: '919****706',
2025-09-20T17:06:05:   orderId: 'TJJ19092511',
2025-09-20T17:06:05:   messageType: 'confirmation',
2025-09-20T17:06:05:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:06:05:   reason: {
2025-09-20T17:06:05:     contentHash: '97026037ffec053e',
2025-09-20T17:06:05:     timestamp: 1758368165661,
2025-09-20T17:06:05:     messageLength: 469,
2025-09-20T17:06:05:     errorMessage: 'Startup grace period active (51s remaining)',
2025-09-20T17:06:05:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T17:06:05:   },
2025-09-20T17:06:05:   duration: 0,
2025-09-20T17:06:05:   timestamp: 1758368165670
2025-09-20T17:06:05: }
2025-09-20T17:06:05: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:06:05: ğŸ“ Loaded 11 template types
2025-09-20T17:06:05: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T17:06:05: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T17:06:05: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T17:06:05: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758368165674] Starting comprehensive safety check...
2025-09-20T17:06:05: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758368165674] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T17:06:05: â„¹ï¸ [5:06:05 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:06:05:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:06:05:   phone: '919****488',
2025-09-20T17:06:05:   orderId: 'TWM19092511',
2025-09-20T17:06:05:   messageType: 'confirmation',
2025-09-20T17:06:05:   result: 'STARTED',
2025-09-20T17:06:05:   details: {
2025-09-20T17:06:05:     checkId: '919358537488_TWM19092511_confirmation_1758368165674',
2025-09-20T17:06:05:     hasOrderData: true,
2025-09-20T17:06:05:     hasSheetData: false,
2025-09-20T17:06:05:     messageLength: 475
2025-09-20T17:06:05:   },
2025-09-20T17:06:05:   timestamp: 1758368165674
2025-09-20T17:06:05: }
2025-09-20T17:06:05: ğŸ” [919358537488_TWM19092511_confirmation_1758368165674] Step 1: Kill Switch Check
2025-09-20T17:06:05: ğŸ” [919358537488_TWM19092511_confirmation_1758368165674] Step 1.5: Developer Phone Check
2025-09-20T17:06:05: ğŸ” [919358537488_TWM19092511_confirmation_1758368165674] Step 2: Grace Period Check
2025-09-20T17:06:05: â„¹ï¸ [5:06:05 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:06:05:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:06:05:   remainingMs: 50209,
2025-09-20T17:06:05:   remainingSeconds: 51,
2025-09-20T17:06:05:   details: {
2025-09-20T17:06:05:     checkId: '919358537488_TWM19092511_confirmation_1758368165674',
2025-09-20T17:06:05:     phone: '919358537488',
2025-09-20T17:06:05:     orderId: 'TWM19092511',
2025-09-20T17:06:05:     messageType: 'confirmation'
2025-09-20T17:06:05:   },
2025-09-20T17:06:05:   timestamp: 1758368165679
2025-09-20T17:06:05: }
2025-09-20T17:06:05: âŒ [919358537488_TWM19092511_confirmation_1758368165674] Startup grace period active (51s remaining)
2025-09-20T17:06:05: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Startup grace period active (51s remaining)
2025-09-20T17:06:05: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T17:06:05: â„¹ï¸ [5:06:05 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T17:06:05:   phone: '919****488',
2025-09-20T17:06:05:   orderId: 'TWM19092511',
2025-09-20T17:06:05:   messageType: 'confirmation',
2025-09-20T17:06:05:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:06:05:   reason: {
2025-09-20T17:06:05:     contentHash: 'e34d023f065922da',
2025-09-20T17:06:05:     timestamp: 1758368165682,
2025-09-20T17:06:05:     messageLength: 475,
2025-09-20T17:06:05:     errorMessage: 'Startup grace period active (51s remaining)',
2025-09-20T17:06:05:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T17:06:05:   },
2025-09-20T17:06:05:   duration: 0,
2025-09-20T17:06:05:   timestamp: 1758368165689
2025-09-20T17:06:05: }
2025-09-20T17:06:05: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:06:05: ğŸ“ Loaded 11 template types
2025-09-20T17:06:05: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T17:06:05: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T17:06:05: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T17:06:05: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758368165696] Starting comprehensive safety check...
2025-09-20T17:06:05: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758368165696] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T17:06:05: â„¹ï¸ [5:06:05 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:06:05:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:06:05:   phone: '918****811',
2025-09-20T17:06:05:   orderId: 'TOF19092511',
2025-09-20T17:06:05:   messageType: 'confirmation',
2025-09-20T17:06:05:   result: 'STARTED',
2025-09-20T17:06:05:   details: {
2025-09-20T17:06:05:     checkId: '918890134811_TOF19092511_confirmation_1758368165696',
2025-09-20T17:06:05:     hasOrderData: true,
2025-09-20T17:06:05:     hasSheetData: false,
2025-09-20T17:06:05:     messageLength: 473
2025-09-20T17:06:05:   },
2025-09-20T17:06:05:   timestamp: 1758368165696
2025-09-20T17:06:05: }
2025-09-20T17:06:05: ğŸ” [918890134811_TOF19092511_confirmation_1758368165696] Step 1: Kill Switch Check
2025-09-20T17:06:05: ğŸ” [918890134811_TOF19092511_confirmation_1758368165696] Step 1.5: Developer Phone Check
2025-09-20T17:06:05: ğŸ” [918890134811_TOF19092511_confirmation_1758368165696] Step 2: Grace Period Check
2025-09-20T17:06:05: â„¹ï¸ [5:06:05 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:06:05:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:06:05:   remainingMs: 50190,
2025-09-20T17:06:05:   remainingSeconds: 51,
2025-09-20T17:06:05:   details: {
2025-09-20T17:06:05:     checkId: '918890134811_TOF19092511_confirmation_1758368165696',
2025-09-20T17:06:05:     phone: '918890134811',
2025-09-20T17:06:05:     orderId: 'TOF19092511',
2025-09-20T17:06:05:     messageType: 'confirmation'
2025-09-20T17:06:05:   },
2025-09-20T17:06:05:   timestamp: 1758368165698
2025-09-20T17:06:05: }
2025-09-20T17:06:05: âŒ [918890134811_TOF19092511_confirmation_1758368165696] Startup grace period active (51s remaining)
2025-09-20T17:06:05: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (51s remaining)
2025-09-20T17:06:05: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T17:06:05: â„¹ï¸ [5:06:05 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T17:06:05:   phone: '918****811',
2025-09-20T17:06:05:   orderId: 'TOF19092511',
2025-09-20T17:06:05:   messageType: 'confirmation',
2025-09-20T17:06:05:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:06:05:   reason: {
2025-09-20T17:06:05:     contentHash: '388fbe812e19f1de',
2025-09-20T17:06:05:     timestamp: 1758368165700,
2025-09-20T17:06:05:     messageLength: 473,
2025-09-20T17:06:05:     errorMessage: 'Startup grace period active (51s remaining)',
2025-09-20T17:06:05:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T17:06:05:   },
2025-09-20T17:06:05:   duration: 0,
2025-09-20T17:06:05:   timestamp: 1758368165712
2025-09-20T17:06:05: }
2025-09-20T17:06:26: ğŸ’¾ Data synced to files successfully
2025-09-20T17:06:56: âœ… Startup grace period ended - message sending now allowed
2025-09-20T17:06:56: âœ… Startup grace period ended - message sending now allowed
2025-09-20T17:06:56: â„¹ï¸ [5:06:56 pm] INFO: Grace Period: ENDED {
2025-09-20T17:06:56:   action: 'ENDED',
2025-09-20T17:06:56:   remainingMs: 0,
2025-09-20T17:06:56:   remainingSeconds: 0,
2025-09-20T17:06:56:   details: { totalDuration: 240000, processId: 23536 },
2025-09-20T17:06:56:   timestamp: 1758368216053
2025-09-20T17:06:56: }
2025-09-20T17:06:56: â„¹ï¸ [5:06:56 pm] INFO: Grace Period: ENDED {
2025-09-20T17:06:56:   action: 'ENDED',
2025-09-20T17:06:56:   remainingMs: 0,
2025-09-20T17:06:56:   remainingSeconds: 0,
2025-09-20T17:06:56:   details: { totalDuration: 240000, processId: 23536 },
2025-09-20T17:06:56:   timestamp: 1758368216054
2025-09-20T17:06:56: }
2025-09-20T17:06:56: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T17:06:56: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T17:06:56: ğŸ’¾ Data synced to files successfully
2025-09-20T17:07:26: ğŸ’¾ Data synced to files successfully
2025-09-20T17:07:56: ğŸ’¾ Data synced to files successfully
2025-09-20T17:08:26: ğŸ’¾ Data synced to files successfully
2025-09-20T17:08:44: âœ… Valid API key from ::1
2025-09-20T17:08:56: ğŸ’¾ Data synced to files successfully
2025-09-20T17:09:05: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:09:05: ğŸ“ Loaded 11 template types
2025-09-20T17:09:05: ğŸ” [918058693371] Starting comprehensive message safety check...
2025-09-20T17:09:05: ğŸ“‹ [918058693371] Order: TXL18092517, Type: confirmation
2025-09-20T17:09:05: ğŸ›¡ï¸ [918058693371] Running primary safety check...
2025-09-20T17:09:05: ğŸ›¡ï¸ [918058693371_TXL18092517_confirmation_1758368345370] Starting comprehensive safety check...
2025-09-20T17:09:05: ğŸ“‹ [918058693371_TXL18092517_confirmation_1758368345370] Phone: 918058693371, Order: TXL18092517, Type: confirmation
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:09:05:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:09:05:   phone: '918****371',
2025-09-20T17:09:05:   orderId: 'TXL18092517',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'STARTED',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     checkId: '918058693371_TXL18092517_confirmation_1758368345370',
2025-09-20T17:09:05:     hasOrderData: true,
2025-09-20T17:09:05:     hasSheetData: false,
2025-09-20T17:09:05:     messageLength: 472
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345370
2025-09-20T17:09:05: }
2025-09-20T17:09:05: ğŸ” [918058693371_TXL18092517_confirmation_1758368345370] Step 1: Kill Switch Check
2025-09-20T17:09:05: ğŸ” [918058693371_TXL18092517_confirmation_1758368345370] Step 1.5: Developer Phone Check
2025-09-20T17:09:05: ğŸ” [918058693371_TXL18092517_confirmation_1758368345370] Step 2: Grace Period Check
2025-09-20T17:09:05: ğŸ” [918058693371_TXL18092517_confirmation_1758368345370] Step 3: Business Hours Check
2025-09-20T17:09:05: ğŸ” [918058693371_TXL18092517_confirmation_1758368345370] Step 4: Message Type Rules Check
2025-09-20T17:09:05: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:09:05:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:09:05:   phone: '918****371',
2025-09-20T17:09:05:   orderId: 'TXL18092517',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'STARTED',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T17:09:05:     requiredFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'phone',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'delivery_date'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     orderDataFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'total_amount',
2025-09-20T17:09:05:       'advance_amount',
2025-09-20T17:09:05:       'remaining_amount',
2025-09-20T17:09:05:       'ready_date',
2025-09-20T17:09:05:       'delivery_date',
2025-09-20T17:09:05:       'shop_name',
2025-09-20T17:09:05:       'shop_phone',
2025-09-20T17:09:05:       'business_hours'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     sheetDataFields: []
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345376
2025-09-20T17:09:05: }
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:09:05:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:09:05:   phone: '918****371',
2025-09-20T17:09:05:   orderId: 'TXL18092517',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'MISSING_FIELD',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     missingField: 'phone',
2025-09-20T17:09:05:     requiredFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'phone',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'delivery_date'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     availableOrderFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'total_amount',
2025-09-20T17:09:05:       'advance_amount',
2025-09-20T17:09:05:       'remaining_amount',
2025-09-20T17:09:05:       'ready_date',
2025-09-20T17:09:05:       'delivery_date',
2025-09-20T17:09:05:       'shop_name',
2025-09-20T17:09:05:       'shop_phone',
2025-09-20T17:09:05:       'business_hours'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     availableSheetFields: []
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345379
2025-09-20T17:09:05: }
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:09:05:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:09:05:   phone: '918****371',
2025-09-20T17:09:05:   orderId: 'TXL18092517',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'BLOCKED',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     checkId: '918058693371_TXL18092517_confirmation_1758368345370',
2025-09-20T17:09:05:     ruleViolation: 'MISSING_REQUIRED_FIELD',
2025-09-20T17:09:05:     details: 'Missing required field: phone'
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345383
2025-09-20T17:09:05: }
2025-09-20T17:09:05: âŒ [918058693371_TXL18092517_confirmation_1758368345370] Missing required field: phone
2025-09-20T17:09:05: ğŸš« [918058693371] PRIMARY SAFETY CHECK FAILED: Missing required field: phone
2025-09-20T17:09:05: ğŸ“ Message recorded: 918058693371 | TXL18092517 | confirmation | Success: false
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Message ALLOWED: confirmation for TXL18092517 {
2025-09-20T17:09:05:   phone: '918****371',
2025-09-20T17:09:05:   orderId: 'TXL18092517',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:09:05:   reason: {
2025-09-20T17:09:05:     contentHash: 'a1ead4760b0d2ad2',
2025-09-20T17:09:05:     timestamp: 1758368345387,
2025-09-20T17:09:05:     messageLength: 472,
2025-09-20T17:09:05:     errorMessage: 'Missing required field: phone',
2025-09-20T17:09:05:     backupFile: 'safety-data\\backup_918058693371_TXL18092517_confirmation.json'
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   duration: 0,
2025-09-20T17:09:05:   timestamp: 1758368345402
2025-09-20T17:09:05: }
2025-09-20T17:09:05: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:09:05: ğŸ“ Loaded 11 template types
2025-09-20T17:09:05: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T17:09:05: ğŸ“‹ [918890134811] Order: TGY18092517, Type: confirmation
2025-09-20T17:09:05: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T17:09:05: ğŸ›¡ï¸ [918890134811_TGY18092517_confirmation_1758368345405] Starting comprehensive safety check...
2025-09-20T17:09:05: ğŸ“‹ [918890134811_TGY18092517_confirmation_1758368345405] Phone: 918890134811, Order: TGY18092517, Type: confirmation
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:09:05:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:09:05:   phone: '918****811',
2025-09-20T17:09:05:   orderId: 'TGY18092517',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'STARTED',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     checkId: '918890134811_TGY18092517_confirmation_1758368345405',
2025-09-20T17:09:05:     hasOrderData: true,
2025-09-20T17:09:05:     hasSheetData: false,
2025-09-20T17:09:05:     messageLength: 473
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345405
2025-09-20T17:09:05: }
2025-09-20T17:09:05: ğŸ” [918890134811_TGY18092517_confirmation_1758368345405] Step 1: Kill Switch Check
2025-09-20T17:09:05: ğŸ” [918890134811_TGY18092517_confirmation_1758368345405] Step 1.5: Developer Phone Check
2025-09-20T17:09:05: ğŸ” [918890134811_TGY18092517_confirmation_1758368345405] Step 2: Grace Period Check
2025-09-20T17:09:05: ğŸ” [918890134811_TGY18092517_confirmation_1758368345405] Step 3: Business Hours Check
2025-09-20T17:09:05: ğŸ” [918890134811_TGY18092517_confirmation_1758368345405] Step 4: Message Type Rules Check
2025-09-20T17:09:05: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:09:05:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:09:05:   phone: '918****811',
2025-09-20T17:09:05:   orderId: 'TGY18092517',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'STARTED',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T17:09:05:     requiredFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'phone',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'delivery_date'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     orderDataFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'total_amount',
2025-09-20T17:09:05:       'advance_amount',
2025-09-20T17:09:05:       'remaining_amount',
2025-09-20T17:09:05:       'ready_date',
2025-09-20T17:09:05:       'delivery_date',
2025-09-20T17:09:05:       'shop_name',
2025-09-20T17:09:05:       'shop_phone',
2025-09-20T17:09:05:       'business_hours'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     sheetDataFields: []
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345408
2025-09-20T17:09:05: }
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:09:05:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:09:05:   phone: '918****811',
2025-09-20T17:09:05:   orderId: 'TGY18092517',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'MISSING_FIELD',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     missingField: 'phone',
2025-09-20T17:09:05:     requiredFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'phone',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'delivery_date'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     availableOrderFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'total_amount',
2025-09-20T17:09:05:       'advance_amount',
2025-09-20T17:09:05:       'remaining_amount',
2025-09-20T17:09:05:       'ready_date',
2025-09-20T17:09:05:       'delivery_date',
2025-09-20T17:09:05:       'shop_name',
2025-09-20T17:09:05:       'shop_phone',
2025-09-20T17:09:05:       'business_hours'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     availableSheetFields: []
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345410
2025-09-20T17:09:05: }
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:09:05:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:09:05:   phone: '918****811',
2025-09-20T17:09:05:   orderId: 'TGY18092517',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'BLOCKED',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     checkId: '918890134811_TGY18092517_confirmation_1758368345405',
2025-09-20T17:09:05:     ruleViolation: 'MISSING_REQUIRED_FIELD',
2025-09-20T17:09:05:     details: 'Missing required field: phone'
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345413
2025-09-20T17:09:05: }
2025-09-20T17:09:05: âŒ [918890134811_TGY18092517_confirmation_1758368345405] Missing required field: phone
2025-09-20T17:09:05: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Missing required field: phone
2025-09-20T17:09:05: ğŸ“ Message recorded: 918890134811 | TGY18092517 | confirmation | Success: false
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Message ALLOWED: confirmation for TGY18092517 {
2025-09-20T17:09:05:   phone: '918****811',
2025-09-20T17:09:05:   orderId: 'TGY18092517',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:09:05:   reason: {
2025-09-20T17:09:05:     contentHash: '5ca42c940f17d86b',
2025-09-20T17:09:05:     timestamp: 1758368345416,
2025-09-20T17:09:05:     messageLength: 473,
2025-09-20T17:09:05:     errorMessage: 'Missing required field: phone',
2025-09-20T17:09:05:     backupFile: 'safety-data\\backup_918890134811_TGY18092517_confirmation.json'
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   duration: 0,
2025-09-20T17:09:05:   timestamp: 1758368345428
2025-09-20T17:09:05: }
2025-09-20T17:09:05: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:09:05: ğŸ“ Loaded 11 template types
2025-09-20T17:09:05: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T17:09:05: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T17:09:05: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T17:09:05: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758368345433] Starting comprehensive safety check...
2025-09-20T17:09:05: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758368345433] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:09:05:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:09:05:   phone: '919****706',
2025-09-20T17:09:05:   orderId: 'TJJ19092511',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'STARTED',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     checkId: '919953020706_TJJ19092511_confirmation_1758368345433',
2025-09-20T17:09:05:     hasOrderData: true,
2025-09-20T17:09:05:     hasSheetData: false,
2025-09-20T17:09:05:     messageLength: 469
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345433
2025-09-20T17:09:05: }
2025-09-20T17:09:05: ğŸ” [919953020706_TJJ19092511_confirmation_1758368345433] Step 1: Kill Switch Check
2025-09-20T17:09:05: ğŸ” [919953020706_TJJ19092511_confirmation_1758368345433] Step 1.5: Developer Phone Check
2025-09-20T17:09:05: ğŸ” [919953020706_TJJ19092511_confirmation_1758368345433] Step 2: Grace Period Check
2025-09-20T17:09:05: ğŸ” [919953020706_TJJ19092511_confirmation_1758368345433] Step 3: Business Hours Check
2025-09-20T17:09:05: ğŸ” [919953020706_TJJ19092511_confirmation_1758368345433] Step 4: Message Type Rules Check
2025-09-20T17:09:05: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:09:05:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:09:05:   phone: '919****706',
2025-09-20T17:09:05:   orderId: 'TJJ19092511',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'STARTED',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T17:09:05:     requiredFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'phone',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'delivery_date'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     orderDataFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'total_amount',
2025-09-20T17:09:05:       'advance_amount',
2025-09-20T17:09:05:       'remaining_amount',
2025-09-20T17:09:05:       'ready_date',
2025-09-20T17:09:05:       'delivery_date',
2025-09-20T17:09:05:       'shop_name',
2025-09-20T17:09:05:       'shop_phone',
2025-09-20T17:09:05:       'business_hours'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     sheetDataFields: []
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345435
2025-09-20T17:09:05: }
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:09:05:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:09:05:   phone: '919****706',
2025-09-20T17:09:05:   orderId: 'TJJ19092511',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'MISSING_FIELD',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     missingField: 'phone',
2025-09-20T17:09:05:     requiredFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'phone',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'delivery_date'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     availableOrderFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'total_amount',
2025-09-20T17:09:05:       'advance_amount',
2025-09-20T17:09:05:       'remaining_amount',
2025-09-20T17:09:05:       'ready_date',
2025-09-20T17:09:05:       'delivery_date',
2025-09-20T17:09:05:       'shop_name',
2025-09-20T17:09:05:       'shop_phone',
2025-09-20T17:09:05:       'business_hours'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     availableSheetFields: []
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345437
2025-09-20T17:09:05: }
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:09:05:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:09:05:   phone: '919****706',
2025-09-20T17:09:05:   orderId: 'TJJ19092511',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'BLOCKED',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     checkId: '919953020706_TJJ19092511_confirmation_1758368345433',
2025-09-20T17:09:05:     ruleViolation: 'MISSING_REQUIRED_FIELD',
2025-09-20T17:09:05:     details: 'Missing required field: phone'
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345439
2025-09-20T17:09:05: }
2025-09-20T17:09:05: âŒ [919953020706_TJJ19092511_confirmation_1758368345433] Missing required field: phone
2025-09-20T17:09:05: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Missing required field: phone
2025-09-20T17:09:05: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T17:09:05:   phone: '919****706',
2025-09-20T17:09:05:   orderId: 'TJJ19092511',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:09:05:   reason: {
2025-09-20T17:09:05:     contentHash: '97026037ffec053e',
2025-09-20T17:09:05:     timestamp: 1758368345442,
2025-09-20T17:09:05:     messageLength: 469,
2025-09-20T17:09:05:     errorMessage: 'Missing required field: phone',
2025-09-20T17:09:05:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   duration: 0,
2025-09-20T17:09:05:   timestamp: 1758368345452
2025-09-20T17:09:05: }
2025-09-20T17:09:05: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:09:05: ğŸ“ Loaded 11 template types
2025-09-20T17:09:05: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T17:09:05: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T17:09:05: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T17:09:05: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758368345454] Starting comprehensive safety check...
2025-09-20T17:09:05: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758368345454] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:09:05:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:09:05:   phone: '919****488',
2025-09-20T17:09:05:   orderId: 'TWM19092511',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'STARTED',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     checkId: '919358537488_TWM19092511_confirmation_1758368345454',
2025-09-20T17:09:05:     hasOrderData: true,
2025-09-20T17:09:05:     hasSheetData: false,
2025-09-20T17:09:05:     messageLength: 475
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345454
2025-09-20T17:09:05: }
2025-09-20T17:09:05: ğŸ” [919358537488_TWM19092511_confirmation_1758368345454] Step 1: Kill Switch Check
2025-09-20T17:09:05: ğŸ” [919358537488_TWM19092511_confirmation_1758368345454] Step 1.5: Developer Phone Check
2025-09-20T17:09:05: ğŸ” [919358537488_TWM19092511_confirmation_1758368345454] Step 2: Grace Period Check
2025-09-20T17:09:05: ğŸ” [919358537488_TWM19092511_confirmation_1758368345454] Step 3: Business Hours Check
2025-09-20T17:09:05: ğŸ” [919358537488_TWM19092511_confirmation_1758368345454] Step 4: Message Type Rules Check
2025-09-20T17:09:05: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:09:05:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:09:05:   phone: '919****488',
2025-09-20T17:09:05:   orderId: 'TWM19092511',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'STARTED',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T17:09:05:     requiredFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'phone',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'delivery_date'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     orderDataFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'total_amount',
2025-09-20T17:09:05:       'advance_amount',
2025-09-20T17:09:05:       'remaining_amount',
2025-09-20T17:09:05:       'ready_date',
2025-09-20T17:09:05:       'delivery_date',
2025-09-20T17:09:05:       'shop_name',
2025-09-20T17:09:05:       'shop_phone',
2025-09-20T17:09:05:       'business_hours'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     sheetDataFields: []
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345458
2025-09-20T17:09:05: }
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:09:05:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:09:05:   phone: '919****488',
2025-09-20T17:09:05:   orderId: 'TWM19092511',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'MISSING_FIELD',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     missingField: 'phone',
2025-09-20T17:09:05:     requiredFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'phone',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'delivery_date'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     availableOrderFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'total_amount',
2025-09-20T17:09:05:       'advance_amount',
2025-09-20T17:09:05:       'remaining_amount',
2025-09-20T17:09:05:       'ready_date',
2025-09-20T17:09:05:       'delivery_date',
2025-09-20T17:09:05:       'shop_name',
2025-09-20T17:09:05:       'shop_phone',
2025-09-20T17:09:05:       'business_hours'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     availableSheetFields: []
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345460
2025-09-20T17:09:05: }
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:09:05:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:09:05:   phone: '919****488',
2025-09-20T17:09:05:   orderId: 'TWM19092511',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'BLOCKED',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     checkId: '919358537488_TWM19092511_confirmation_1758368345454',
2025-09-20T17:09:05:     ruleViolation: 'MISSING_REQUIRED_FIELD',
2025-09-20T17:09:05:     details: 'Missing required field: phone'
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345463
2025-09-20T17:09:05: }
2025-09-20T17:09:05: âŒ [919358537488_TWM19092511_confirmation_1758368345454] Missing required field: phone
2025-09-20T17:09:05: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Missing required field: phone
2025-09-20T17:09:05: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T17:09:05:   phone: '919****488',
2025-09-20T17:09:05:   orderId: 'TWM19092511',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:09:05:   reason: {
2025-09-20T17:09:05:     contentHash: 'e34d023f065922da',
2025-09-20T17:09:05:     timestamp: 1758368345466,
2025-09-20T17:09:05:     messageLength: 475,
2025-09-20T17:09:05:     errorMessage: 'Missing required field: phone',
2025-09-20T17:09:05:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   duration: 0,
2025-09-20T17:09:05:   timestamp: 1758368345477
2025-09-20T17:09:05: }
2025-09-20T17:09:05: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:09:05: ğŸ“ Loaded 11 template types
2025-09-20T17:09:05: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T17:09:05: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T17:09:05: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T17:09:05: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758368345480] Starting comprehensive safety check...
2025-09-20T17:09:05: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758368345480] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:09:05:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:09:05:   phone: '918****811',
2025-09-20T17:09:05:   orderId: 'TOF19092511',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'STARTED',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     checkId: '918890134811_TOF19092511_confirmation_1758368345480',
2025-09-20T17:09:05:     hasOrderData: true,
2025-09-20T17:09:05:     hasSheetData: false,
2025-09-20T17:09:05:     messageLength: 473
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345480
2025-09-20T17:09:05: }
2025-09-20T17:09:05: ğŸ” [918890134811_TOF19092511_confirmation_1758368345480] Step 1: Kill Switch Check
2025-09-20T17:09:05: ğŸ” [918890134811_TOF19092511_confirmation_1758368345480] Step 1.5: Developer Phone Check
2025-09-20T17:09:05: ğŸ” [918890134811_TOF19092511_confirmation_1758368345480] Step 2: Grace Period Check
2025-09-20T17:09:05: ğŸ” [918890134811_TOF19092511_confirmation_1758368345480] Step 3: Business Hours Check
2025-09-20T17:09:05: ğŸ” [918890134811_TOF19092511_confirmation_1758368345480] Step 4: Message Type Rules Check
2025-09-20T17:09:05: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:09:05:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:09:05:   phone: '918****811',
2025-09-20T17:09:05:   orderId: 'TOF19092511',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'STARTED',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T17:09:05:     requiredFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'phone',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'delivery_date'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     orderDataFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'total_amount',
2025-09-20T17:09:05:       'advance_amount',
2025-09-20T17:09:05:       'remaining_amount',
2025-09-20T17:09:05:       'ready_date',
2025-09-20T17:09:05:       'delivery_date',
2025-09-20T17:09:05:       'shop_name',
2025-09-20T17:09:05:       'shop_phone',
2025-09-20T17:09:05:       'business_hours'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     sheetDataFields: []
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345485
2025-09-20T17:09:05: }
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:09:05:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:09:05:   phone: '918****811',
2025-09-20T17:09:05:   orderId: 'TOF19092511',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'MISSING_FIELD',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     missingField: 'phone',
2025-09-20T17:09:05:     requiredFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'phone',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'delivery_date'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     availableOrderFields: [
2025-09-20T17:09:05:       'customer_name',
2025-09-20T17:09:05:       'order_id',
2025-09-20T17:09:05:       'garment_type',
2025-09-20T17:09:05:       'total_amount',
2025-09-20T17:09:05:       'advance_amount',
2025-09-20T17:09:05:       'remaining_amount',
2025-09-20T17:09:05:       'ready_date',
2025-09-20T17:09:05:       'delivery_date',
2025-09-20T17:09:05:       'shop_name',
2025-09-20T17:09:05:       'shop_phone',
2025-09-20T17:09:05:       'business_hours'
2025-09-20T17:09:05:     ],
2025-09-20T17:09:05:     availableSheetFields: []
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345488
2025-09-20T17:09:05: }
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:09:05:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:09:05:   phone: '918****811',
2025-09-20T17:09:05:   orderId: 'TOF19092511',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   result: 'BLOCKED',
2025-09-20T17:09:05:   details: {
2025-09-20T17:09:05:     checkId: '918890134811_TOF19092511_confirmation_1758368345480',
2025-09-20T17:09:05:     ruleViolation: 'MISSING_REQUIRED_FIELD',
2025-09-20T17:09:05:     details: 'Missing required field: phone'
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   timestamp: 1758368345490
2025-09-20T17:09:05: }
2025-09-20T17:09:05: âŒ [918890134811_TOF19092511_confirmation_1758368345480] Missing required field: phone
2025-09-20T17:09:05: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Missing required field: phone
2025-09-20T17:09:05: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T17:09:05: â„¹ï¸ [5:09:05 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T17:09:05:   phone: '918****811',
2025-09-20T17:09:05:   orderId: 'TOF19092511',
2025-09-20T17:09:05:   messageType: 'confirmation',
2025-09-20T17:09:05:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:09:05:   reason: {
2025-09-20T17:09:05:     contentHash: '388fbe812e19f1de',
2025-09-20T17:09:05:     timestamp: 1758368345494,
2025-09-20T17:09:05:     messageLength: 473,
2025-09-20T17:09:05:     errorMessage: 'Missing required field: phone',
2025-09-20T17:09:05:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T17:09:05:   },
2025-09-20T17:09:05:   duration: 0,
2025-09-20T17:09:05:   timestamp: 1758368345504
2025-09-20T17:09:05: }
2025-09-20T17:09:26: ğŸ’¾ Data synced to files successfully
2025-09-20T17:09:56: ğŸ’¾ Data synced to files successfully
2025-09-20T17:10:26: ğŸ’¾ Data synced to files successfully
2025-09-20T17:10:44: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:10:44: ğŸ“ Loaded 11 template types
2025-09-20T17:10:44: ğŸ”§ WhatsApp Bot initialized
2025-09-20T17:10:44: ğŸ“Š Configuration status: undefined
2025-09-20T17:10:44: âœ… Atomic State Manager initialized
2025-09-20T17:10:44: ğŸ“ Enhanced Logger initialized
2025-09-20T17:10:44: âœ… Google credentials loaded from service-account.json file
2025-09-20T17:10:44: ğŸ“± WhatsApp auth status: âœ… credentials, 4 session files
2025-09-20T17:10:44: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-20T17:10:44:    Auth Mode: both
2025-09-20T17:10:44:    QR Enabled: true
2025-09-20T17:10:44:    Phone Enabled: true
2025-09-20T17:10:44:    Session Persistence: true
2025-09-20T17:10:44:    Max Reconnect Attempts: 10
2025-09-20T17:10:44:    Default Phone: None
2025-09-20T17:10:44: ğŸ”’ Session validation enabled (check every 300s)
2025-09-20T17:10:44: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-20T17:10:44: ğŸ”§ Developer Configuration initialized
2025-09-20T17:10:44: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T17:10:45: â„¹ï¸ [5:10:44 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T17:10:45:   startupTime: 1758368444916,
2025-09-20T17:10:45:   gracePeriodMs: 240000,
2025-09-20T17:10:45:   dataDir: './safety-data',
2025-09-20T17:10:45:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T17:10:45:   processId: 5840,
2025-09-20T17:10:45:   nodeVersion: 'v22.19.0'
2025-09-20T17:10:45: }
2025-09-20T17:10:45: ğŸ”§ Developer Configuration initialized
2025-09-20T17:10:45: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T17:10:45: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-20T17:10:45: â° 4-minute startup delay active
2025-09-20T17:10:45: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-20T17:10:45: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-20T17:10:45: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T17:10:45: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T17:10:45: âœ… Google Sheets API initialized
2025-09-20T17:10:45: âœ… Google Sheets API initialized
2025-09-20T17:10:45: â„¹ï¸ [5:10:44 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T17:10:45:   startupTime: 1758368444916,
2025-09-20T17:10:45:   gracePeriodMs: 240000,
2025-09-20T17:10:45:   dataDir: './safety-data',
2025-09-20T17:10:45:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T17:10:45:   processId: 5840,
2025-09-20T17:10:45:   nodeVersion: 'v22.19.0'
2025-09-20T17:10:45: }
2025-09-20T17:10:45: ğŸ“ Loaded 0 sent messages from file
2025-09-20T17:10:45: â„¹ï¸ [5:10:45 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T17:10:45: ğŸ“ Loaded 0 customer histories from file
2025-09-20T17:10:45: â„¹ï¸ [5:10:45 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T17:10:45: ğŸ“ Loaded 0 message hashes from file
2025-09-20T17:10:45: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T10-04-25-749Z.log
2025-09-20T17:10:45: ğŸ“ Enhanced Logger initialized
2025-09-20T17:10:45: ğŸ“ Loaded statistics from file
2025-09-20T17:10:45: âœ… Duplicate Prevention Manager initialized
2025-09-20T17:10:45: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T17:10:45: â„¹ï¸ [5:10:45 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T17:10:45: â„¹ï¸ [5:10:45 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T17:10:45: ğŸ§¹ Lock file already cleaned up
2025-09-20T17:10:45: ğŸ§¹ Removed stale process lock
2025-09-20T17:10:45: ğŸ”’ Process lock acquired (PID: 5840)
2025-09-20T17:10:45: ğŸ”’ Process lock acquired (PID: 5840)
2025-09-20T17:10:45: â„¹ï¸ [5:10:45 pm] INFO: Process isolation enforced {
2025-09-20T17:10:45:   lockFile: 'safety-data\\process.lock',
2025-09-20T17:10:45:   pidFile: 'safety-data\\process.pid',
2025-09-20T17:10:45:   processId: 5840
2025-09-20T17:10:45: }
2025-09-20T17:10:45: â° Starting 240 second startup grace period...
2025-09-20T17:10:45: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T17:10:45: â„¹ï¸ [5:10:45 pm] INFO: Grace Period: STARTED {
2025-09-20T17:10:45:   action: 'STARTED',
2025-09-20T17:10:45:   remainingMs: 240000,
2025-09-20T17:10:45:   remainingSeconds: 240,
2025-09-20T17:10:45:   details: { startupTime: 1758368444916, processId: 5840 },
2025-09-20T17:10:45:   timestamp: 1758368445025
2025-09-20T17:10:45: }
2025-09-20T17:10:45: â„¹ï¸ [5:10:45 pm] INFO: Process isolation enforced {
2025-09-20T17:10:45:   lockFile: 'safety-data\\process.lock',
2025-09-20T17:10:45:   pidFile: 'safety-data\\process.pid',
2025-09-20T17:10:45:   processId: 5840
2025-09-20T17:10:45: }
2025-09-20T17:10:45: â° Starting 240 second startup grace period...
2025-09-20T17:10:45: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T17:10:45: â„¹ï¸ [5:10:45 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T17:10:45:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T17:10:45:   remainingMs: 240000,
2025-09-20T17:10:45:   remainingSeconds: 240,
2025-09-20T17:10:45:   details: { startupTime: 1758368444916, willExpireAt: 1758368684916 },
2025-09-20T17:10:45:   timestamp: 1758368445025
2025-09-20T17:10:45: }
2025-09-20T17:10:45: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T17:10:45: â° Startup grace period: 240 seconds
2025-09-20T17:10:45: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T17:10:45: â„¹ï¸ [5:10:45 pm] INFO: Grace Period: STARTED {
2025-09-20T17:10:45:   action: 'STARTED',
2025-09-20T17:10:45:   remainingMs: 240000,
2025-09-20T17:10:45:   remainingSeconds: 240,
2025-09-20T17:10:45:   details: { startupTime: 1758368444916, processId: 5840 },
2025-09-20T17:10:45:   timestamp: 1758368445030
2025-09-20T17:10:45: }
2025-09-20T17:10:45: â„¹ï¸ [5:10:45 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T17:10:45:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T17:10:45:   remainingMs: 240000,
2025-09-20T17:10:45:   remainingSeconds: 240,
2025-09-20T17:10:45:   details: { startupTime: 1758368444916, willExpireAt: 1758368684916 },
2025-09-20T17:10:45:   timestamp: 1758368445031
2025-09-20T17:10:45: }
2025-09-20T17:10:45: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T17:10:45: â° Startup grace period: 240 seconds
2025-09-20T17:10:45: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T17:10:45: â„¹ï¸ [5:10:45 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T17:10:45:   initializationDuration: 116,
2025-09-20T17:10:45:   gracePeriodActive: true,
2025-09-20T17:10:45:   messageRulesCount: 8,
2025-09-20T17:10:45:   messageTypes: [
2025-09-20T17:10:45:     'welcome',
2025-09-20T17:10:45:     'confirmation',
2025-09-20T17:10:45:     'ready',
2025-09-20T17:10:45:     'delivery',
2025-09-20T17:10:45:     'pickup_reminder',
2025-09-20T17:10:45:     'payment_reminder',
2025-09-20T17:10:45:     'fabric_welcome',
2025-09-20T17:10:45:     'fabric_purchase'
2025-09-20T17:10:45:   ],
2025-09-20T17:10:45:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T17:10:45:   databaseReady: true,
2025-09-20T17:10:45:   loggerReady: true,
2025-09-20T17:10:45:   processIsolationActive: true
2025-09-20T17:10:45: }
2025-09-20T17:10:45: â„¹ï¸ [5:10:45 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T17:10:45:   initializationDuration: 118,
2025-09-20T17:10:45:   gracePeriodActive: true,
2025-09-20T17:10:45:   messageRulesCount: 8,
2025-09-20T17:10:45:   messageTypes: [
2025-09-20T17:10:45:     'welcome',
2025-09-20T17:10:45:     'confirmation',
2025-09-20T17:10:45:     'ready',
2025-09-20T17:10:45:     'delivery',
2025-09-20T17:10:45:     'pickup_reminder',
2025-09-20T17:10:45:     'payment_reminder',
2025-09-20T17:10:45:     'fabric_welcome',
2025-09-20T17:10:45:     'fabric_purchase'
2025-09-20T17:10:45:   ],
2025-09-20T17:10:45:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T17:10:45:   databaseReady: true,
2025-09-20T17:10:45:   loggerReady: true,
2025-09-20T17:10:45:   processIsolationActive: true
2025-09-20T17:10:45: }
2025-09-20T17:10:45: âœ… Safety Manager initialized
2025-09-20T17:10:45: ğŸ“ Loaded 0 sent messages from file
2025-09-20T17:10:45: ğŸ“ Loaded 0 customer histories from file
2025-09-20T17:10:45: ğŸ“ Loaded 0 message hashes from file
2025-09-20T17:10:45: ğŸ“ Loaded statistics from file
2025-09-20T17:10:45: âœ… Duplicate Prevention Manager initialized
2025-09-20T17:10:45: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T17:10:45: âœ… Duplicate Prevention Manager initialized
2025-09-20T17:10:45: ğŸ”„ Starting WhatsApp connection...
2025-09-20T17:10:45: ğŸ”„ Initializing WhatsApp client...
2025-09-20T17:10:45: âœ… WhatsApp connection started
2025-09-20T17:10:45: ğŸ”§ Initializing admin commands...
2025-09-20T17:10:45: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T17:10:45: âœ… Admin commands system initialized
2025-09-20T17:10:45: ğŸ”„ Initializing polling functionality...
2025-09-20T17:10:45: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T17:10:45: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T17:10:45: ğŸ“ Attempting to request pairing code...
2025-09-20T17:10:45: ğŸ’¡ To use phone authentication:
2025-09-20T17:10:45:    1. Use the dashboard at http://localhost:3001
2025-09-20T17:10:45:    2. Select "Phone Number Authentication"
2025-09-20T17:10:45:    3. Enter your phone number
2025-09-20T17:10:45:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T17:10:45: ğŸ”„ Connecting to WhatsApp...
2025-09-20T17:10:47: âœ… WhatsApp connected successfully!
2025-09-20T17:10:47: ğŸ”„ Enhanced client: Connected event received, forwarding...
2025-09-20T17:10:47: ğŸ“± Session established successfully
2025-09-20T17:10:47: ğŸ”’ Session will be monitored for stability
2025-09-20T17:10:53: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:10:53: ğŸ“ Loaded 11 template types
2025-09-20T17:10:53: ğŸ” [918058693371] Starting comprehensive message safety check...
2025-09-20T17:10:53: ğŸ“‹ [918058693371] Order: TXL18092517, Type: confirmation
2025-09-20T17:10:53: ğŸ›¡ï¸ [918058693371] Running primary safety check...
2025-09-20T17:10:53: ğŸ›¡ï¸ [918058693371_TXL18092517_confirmation_1758368453557] Starting comprehensive safety check...
2025-09-20T17:10:53: ğŸ“‹ [918058693371_TXL18092517_confirmation_1758368453557] Phone: 918058693371, Order: TXL18092517, Type: confirmation
2025-09-20T17:10:53: â„¹ï¸ [5:10:53 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:10:53:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:10:53:   phone: '918****371',
2025-09-20T17:10:53:   orderId: 'TXL18092517',
2025-09-20T17:10:53:   messageType: 'confirmation',
2025-09-20T17:10:53:   result: 'STARTED',
2025-09-20T17:10:53:   details: {
2025-09-20T17:10:53:     checkId: '918058693371_TXL18092517_confirmation_1758368453557',
2025-09-20T17:10:53:     hasOrderData: true,
2025-09-20T17:10:53:     hasSheetData: false,
2025-09-20T17:10:53:     messageLength: 472
2025-09-20T17:10:53:   },
2025-09-20T17:10:53:   timestamp: 1758368453558
2025-09-20T17:10:53: }
2025-09-20T17:10:53: ğŸ” [918058693371_TXL18092517_confirmation_1758368453557] Step 1: Kill Switch Check
2025-09-20T17:10:53: ğŸ” [918058693371_TXL18092517_confirmation_1758368453557] Step 1.5: Developer Phone Check
2025-09-20T17:10:53: ğŸ” [918058693371_TXL18092517_confirmation_1758368453557] Step 2: Grace Period Check
2025-09-20T17:10:53: â„¹ï¸ [5:10:53 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:10:53:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:10:53:   remainingMs: 231355,
2025-09-20T17:10:53:   remainingSeconds: 232,
2025-09-20T17:10:53:   details: {
2025-09-20T17:10:53:     checkId: '918058693371_TXL18092517_confirmation_1758368453557',
2025-09-20T17:10:53:     phone: '918058693371',
2025-09-20T17:10:53:     orderId: 'TXL18092517',
2025-09-20T17:10:53:     messageType: 'confirmation'
2025-09-20T17:10:53:   },
2025-09-20T17:10:53:   timestamp: 1758368453561
2025-09-20T17:10:53: }
2025-09-20T17:10:53: âŒ [918058693371_TXL18092517_confirmation_1758368453557] Startup grace period active (232s remaining)
2025-09-20T17:10:53: ğŸš« [918058693371] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T17:10:53: ğŸ“ Message recorded: 918058693371 | TXL18092517 | confirmation | Success: false
2025-09-20T17:10:53: â„¹ï¸ [5:10:53 pm] INFO: Message ALLOWED: confirmation for TXL18092517 {
2025-09-20T17:10:53:   phone: '918****371',
2025-09-20T17:10:53:   orderId: 'TXL18092517',
2025-09-20T17:10:53:   messageType: 'confirmation',
2025-09-20T17:10:53:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:10:53:   reason: {
2025-09-20T17:10:53:     contentHash: 'a1ead4760b0d2ad2',
2025-09-20T17:10:53:     timestamp: 1758368453564,
2025-09-20T17:10:53:     messageLength: 472,
2025-09-20T17:10:53:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T17:10:53:     backupFile: 'safety-data\\backup_918058693371_TXL18092517_confirmation.json'
2025-09-20T17:10:53:   },
2025-09-20T17:10:53:   duration: 0,
2025-09-20T17:10:53:   timestamp: 1758368453573
2025-09-20T17:10:53: }
2025-09-20T17:10:53: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:10:53: ğŸ“ Loaded 11 template types
2025-09-20T17:10:53: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T17:10:53: ğŸ“‹ [918890134811] Order: TGY18092517, Type: confirmation
2025-09-20T17:10:53: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T17:10:53: ğŸ›¡ï¸ [918890134811_TGY18092517_confirmation_1758368453576] Starting comprehensive safety check...
2025-09-20T17:10:53: ğŸ“‹ [918890134811_TGY18092517_confirmation_1758368453576] Phone: 918890134811, Order: TGY18092517, Type: confirmation
2025-09-20T17:10:53: â„¹ï¸ [5:10:53 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:10:53:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:10:53:   phone: '918****811',
2025-09-20T17:10:53:   orderId: 'TGY18092517',
2025-09-20T17:10:53:   messageType: 'confirmation',
2025-09-20T17:10:53:   result: 'STARTED',
2025-09-20T17:10:53:   details: {
2025-09-20T17:10:53:     checkId: '918890134811_TGY18092517_confirmation_1758368453576',
2025-09-20T17:10:53:     hasOrderData: true,
2025-09-20T17:10:53:     hasSheetData: false,
2025-09-20T17:10:53:     messageLength: 473
2025-09-20T17:10:53:   },
2025-09-20T17:10:53:   timestamp: 1758368453576
2025-09-20T17:10:53: }
2025-09-20T17:10:53: ğŸ” [918890134811_TGY18092517_confirmation_1758368453576] Step 1: Kill Switch Check
2025-09-20T17:10:53: ğŸ” [918890134811_TGY18092517_confirmation_1758368453576] Step 1.5: Developer Phone Check
2025-09-20T17:10:53: ğŸ” [918890134811_TGY18092517_confirmation_1758368453576] Step 2: Grace Period Check
2025-09-20T17:10:53: â„¹ï¸ [5:10:53 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:10:53:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:10:53:   remainingMs: 231336,
2025-09-20T17:10:53:   remainingSeconds: 232,
2025-09-20T17:10:53:   details: {
2025-09-20T17:10:53:     checkId: '918890134811_TGY18092517_confirmation_1758368453576',
2025-09-20T17:10:53:     phone: '918890134811',
2025-09-20T17:10:53:     orderId: 'TGY18092517',
2025-09-20T17:10:53:     messageType: 'confirmation'
2025-09-20T17:10:53:   },
2025-09-20T17:10:53:   timestamp: 1758368453580
2025-09-20T17:10:53: }
2025-09-20T17:10:53: âŒ [918890134811_TGY18092517_confirmation_1758368453576] Startup grace period active (232s remaining)
2025-09-20T17:10:53: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T17:10:53: ğŸ“ Message recorded: 918890134811 | TGY18092517 | confirmation | Success: false
2025-09-20T17:10:53: â„¹ï¸ [5:10:53 pm] INFO: Message ALLOWED: confirmation for TGY18092517 {
2025-09-20T17:10:53:   phone: '918****811',
2025-09-20T17:10:53:   orderId: 'TGY18092517',
2025-09-20T17:10:53:   messageType: 'confirmation',
2025-09-20T17:10:53:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:10:53:   reason: {
2025-09-20T17:10:53:     contentHash: '5ca42c940f17d86b',
2025-09-20T17:10:53:     timestamp: 1758368453582,
2025-09-20T17:10:53:     messageLength: 473,
2025-09-20T17:10:53:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T17:10:53:     backupFile: 'safety-data\\backup_918890134811_TGY18092517_confirmation.json'
2025-09-20T17:10:53:   },
2025-09-20T17:10:53:   duration: 0,
2025-09-20T17:10:53:   timestamp: 1758368453590
2025-09-20T17:10:53: }
2025-09-20T17:10:53: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:10:53: ğŸ“ Loaded 11 template types
2025-09-20T17:10:53: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T17:10:53: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T17:10:53: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T17:10:53: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758368453592] Starting comprehensive safety check...
2025-09-20T17:10:53: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758368453592] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T17:10:53: â„¹ï¸ [5:10:53 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:10:53:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:10:53:   phone: '919****706',
2025-09-20T17:10:53:   orderId: 'TJJ19092511',
2025-09-20T17:10:53:   messageType: 'confirmation',
2025-09-20T17:10:53:   result: 'STARTED',
2025-09-20T17:10:53:   details: {
2025-09-20T17:10:53:     checkId: '919953020706_TJJ19092511_confirmation_1758368453592',
2025-09-20T17:10:53:     hasOrderData: true,
2025-09-20T17:10:53:     hasSheetData: false,
2025-09-20T17:10:53:     messageLength: 469
2025-09-20T17:10:53:   },
2025-09-20T17:10:53:   timestamp: 1758368453592
2025-09-20T17:10:53: }
2025-09-20T17:10:53: ğŸ” [919953020706_TJJ19092511_confirmation_1758368453592] Step 1: Kill Switch Check
2025-09-20T17:10:53: ğŸ” [919953020706_TJJ19092511_confirmation_1758368453592] Step 1.5: Developer Phone Check
2025-09-20T17:10:53: ğŸ” [919953020706_TJJ19092511_confirmation_1758368453592] Step 2: Grace Period Check
2025-09-20T17:10:53: â„¹ï¸ [5:10:53 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:10:53:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:10:53:   remainingMs: 231320,
2025-09-20T17:10:53:   remainingSeconds: 232,
2025-09-20T17:10:53:   details: {
2025-09-20T17:10:53:     checkId: '919953020706_TJJ19092511_confirmation_1758368453592',
2025-09-20T17:10:53:     phone: '919953020706',
2025-09-20T17:10:53:     orderId: 'TJJ19092511',
2025-09-20T17:10:53:     messageType: 'confirmation'
2025-09-20T17:10:53:   },
2025-09-20T17:10:53:   timestamp: 1758368453596
2025-09-20T17:10:53: }
2025-09-20T17:10:53: âŒ [919953020706_TJJ19092511_confirmation_1758368453592] Startup grace period active (232s remaining)
2025-09-20T17:10:53: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T17:10:53: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T17:10:53: â„¹ï¸ [5:10:53 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T17:10:53:   phone: '919****706',
2025-09-20T17:10:53:   orderId: 'TJJ19092511',
2025-09-20T17:10:53:   messageType: 'confirmation',
2025-09-20T17:10:53:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:10:53:   reason: {
2025-09-20T17:10:53:     contentHash: '97026037ffec053e',
2025-09-20T17:10:53:     timestamp: 1758368453598,
2025-09-20T17:10:53:     messageLength: 469,
2025-09-20T17:10:53:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T17:10:53:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T17:10:53:   },
2025-09-20T17:10:53:   duration: 0,
2025-09-20T17:10:53:   timestamp: 1758368453606
2025-09-20T17:10:53: }
2025-09-20T17:10:53: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:10:53: ğŸ“ Loaded 11 template types
2025-09-20T17:10:53: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T17:10:53: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T17:10:53: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T17:10:53: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758368453609] Starting comprehensive safety check...
2025-09-20T17:10:53: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758368453609] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T17:10:53: â„¹ï¸ [5:10:53 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:10:53:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:10:53:   phone: '919****488',
2025-09-20T17:10:53:   orderId: 'TWM19092511',
2025-09-20T17:10:53:   messageType: 'confirmation',
2025-09-20T17:10:53:   result: 'STARTED',
2025-09-20T17:10:53:   details: {
2025-09-20T17:10:53:     checkId: '919358537488_TWM19092511_confirmation_1758368453609',
2025-09-20T17:10:53:     hasOrderData: true,
2025-09-20T17:10:53:     hasSheetData: false,
2025-09-20T17:10:53:     messageLength: 475
2025-09-20T17:10:53:   },
2025-09-20T17:10:53:   timestamp: 1758368453609
2025-09-20T17:10:53: }
2025-09-20T17:10:53: ğŸ” [919358537488_TWM19092511_confirmation_1758368453609] Step 1: Kill Switch Check
2025-09-20T17:10:53: ğŸ” [919358537488_TWM19092511_confirmation_1758368453609] Step 1.5: Developer Phone Check
2025-09-20T17:10:53: ğŸ” [919358537488_TWM19092511_confirmation_1758368453609] Step 2: Grace Period Check
2025-09-20T17:10:53: â„¹ï¸ [5:10:53 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:10:53:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:10:53:   remainingMs: 231304,
2025-09-20T17:10:53:   remainingSeconds: 232,
2025-09-20T17:10:53:   details: {
2025-09-20T17:10:53:     checkId: '919358537488_TWM19092511_confirmation_1758368453609',
2025-09-20T17:10:53:     phone: '919358537488',
2025-09-20T17:10:53:     orderId: 'TWM19092511',
2025-09-20T17:10:53:     messageType: 'confirmation'
2025-09-20T17:10:53:   },
2025-09-20T17:10:53:   timestamp: 1758368453612
2025-09-20T17:10:53: }
2025-09-20T17:10:53: âŒ [919358537488_TWM19092511_confirmation_1758368453609] Startup grace period active (232s remaining)
2025-09-20T17:10:53: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T17:10:53: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T17:10:53: â„¹ï¸ [5:10:53 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T17:10:53:   phone: '919****488',
2025-09-20T17:10:53:   orderId: 'TWM19092511',
2025-09-20T17:10:53:   messageType: 'confirmation',
2025-09-20T17:10:53:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:10:53:   reason: {
2025-09-20T17:10:53:     contentHash: 'e34d023f065922da',
2025-09-20T17:10:53:     timestamp: 1758368453615,
2025-09-20T17:10:53:     messageLength: 475,
2025-09-20T17:10:53:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T17:10:53:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T17:10:53:   },
2025-09-20T17:10:53:   duration: 0,
2025-09-20T17:10:53:   timestamp: 1758368453622
2025-09-20T17:10:53: }
2025-09-20T17:10:53: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:10:53: ğŸ“ Loaded 11 template types
2025-09-20T17:10:53: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T17:10:53: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T17:10:53: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T17:10:53: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758368453624] Starting comprehensive safety check...
2025-09-20T17:10:53: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758368453624] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T17:10:53: â„¹ï¸ [5:10:53 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:10:53:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:10:53:   phone: '918****811',
2025-09-20T17:10:53:   orderId: 'TOF19092511',
2025-09-20T17:10:53:   messageType: 'confirmation',
2025-09-20T17:10:53:   result: 'STARTED',
2025-09-20T17:10:53:   details: {
2025-09-20T17:10:53:     checkId: '918890134811_TOF19092511_confirmation_1758368453624',
2025-09-20T17:10:53:     hasOrderData: true,
2025-09-20T17:10:53:     hasSheetData: false,
2025-09-20T17:10:53:     messageLength: 473
2025-09-20T17:10:53:   },
2025-09-20T17:10:53:   timestamp: 1758368453625
2025-09-20T17:10:53: }
2025-09-20T17:10:53: ğŸ” [918890134811_TOF19092511_confirmation_1758368453624] Step 1: Kill Switch Check
2025-09-20T17:10:53: ğŸ” [918890134811_TOF19092511_confirmation_1758368453624] Step 1.5: Developer Phone Check
2025-09-20T17:10:53: ğŸ” [918890134811_TOF19092511_confirmation_1758368453624] Step 2: Grace Period Check
2025-09-20T17:10:53: â„¹ï¸ [5:10:53 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:10:53:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:10:53:   remainingMs: 231289,
2025-09-20T17:10:53:   remainingSeconds: 232,
2025-09-20T17:10:53:   details: {
2025-09-20T17:10:53:     checkId: '918890134811_TOF19092511_confirmation_1758368453624',
2025-09-20T17:10:53:     phone: '918890134811',
2025-09-20T17:10:53:     orderId: 'TOF19092511',
2025-09-20T17:10:53:     messageType: 'confirmation'
2025-09-20T17:10:53:   },
2025-09-20T17:10:53:   timestamp: 1758368453627
2025-09-20T17:10:53: }
2025-09-20T17:10:53: âŒ [918890134811_TOF19092511_confirmation_1758368453624] Startup grace period active (232s remaining)
2025-09-20T17:10:53: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T17:10:53: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T17:10:53: â„¹ï¸ [5:10:53 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T17:10:53:   phone: '918****811',
2025-09-20T17:10:53:   orderId: 'TOF19092511',
2025-09-20T17:10:53:   messageType: 'confirmation',
2025-09-20T17:10:53:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:10:53:   reason: {
2025-09-20T17:10:53:     contentHash: '388fbe812e19f1de',
2025-09-20T17:10:53:     timestamp: 1758368453631,
2025-09-20T17:10:53:     messageLength: 473,
2025-09-20T17:10:53:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T17:10:53:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T17:10:53:   },
2025-09-20T17:10:53:   duration: 0,
2025-09-20T17:10:53:   timestamp: 1758368453639
2025-09-20T17:10:53: }
2025-09-20T17:11:15: ğŸ’¾ Data synced to files successfully
2025-09-20T17:11:45: ğŸ’¾ Data synced to files successfully
2025-09-20T17:12:15: ğŸ’¾ Data synced to files successfully
2025-09-20T17:12:45: ğŸ’¾ Data synced to files successfully
2025-09-20T17:13:15: ğŸ’¾ Data synced to files successfully
2025-09-20T17:13:45: ğŸ’¾ Data synced to files successfully
2025-09-20T17:13:53: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:13:53: ğŸ“ Loaded 11 template types
2025-09-20T17:13:53: ğŸ” [918058693371] Starting comprehensive message safety check...
2025-09-20T17:13:53: ğŸ“‹ [918058693371] Order: TXL18092517, Type: confirmation
2025-09-20T17:13:53: ğŸ›¡ï¸ [918058693371] Running primary safety check...
2025-09-20T17:13:53: ğŸ›¡ï¸ [918058693371_TXL18092517_confirmation_1758368633595] Starting comprehensive safety check...
2025-09-20T17:13:53: ğŸ“‹ [918058693371_TXL18092517_confirmation_1758368633595] Phone: 918058693371, Order: TXL18092517, Type: confirmation
2025-09-20T17:13:53: â„¹ï¸ [5:13:53 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:13:53:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:13:53:   phone: '918****371',
2025-09-20T17:13:53:   orderId: 'TXL18092517',
2025-09-20T17:13:53:   messageType: 'confirmation',
2025-09-20T17:13:53:   result: 'STARTED',
2025-09-20T17:13:53:   details: {
2025-09-20T17:13:53:     checkId: '918058693371_TXL18092517_confirmation_1758368633595',
2025-09-20T17:13:53:     hasOrderData: true,
2025-09-20T17:13:53:     hasSheetData: false,
2025-09-20T17:13:53:     messageLength: 472
2025-09-20T17:13:53:   },
2025-09-20T17:13:53:   timestamp: 1758368633596
2025-09-20T17:13:53: }
2025-09-20T17:13:53: ğŸ” [918058693371_TXL18092517_confirmation_1758368633595] Step 1: Kill Switch Check
2025-09-20T17:13:53: ğŸ” [918058693371_TXL18092517_confirmation_1758368633595] Step 1.5: Developer Phone Check
2025-09-20T17:13:53: ğŸ” [918058693371_TXL18092517_confirmation_1758368633595] Step 2: Grace Period Check
2025-09-20T17:13:53: â„¹ï¸ [5:13:53 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:13:53:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:13:53:   remainingMs: 51310,
2025-09-20T17:13:53:   remainingSeconds: 52,
2025-09-20T17:13:53:   details: {
2025-09-20T17:13:53:     checkId: '918058693371_TXL18092517_confirmation_1758368633595',
2025-09-20T17:13:53:     phone: '918058693371',
2025-09-20T17:13:53:     orderId: 'TXL18092517',
2025-09-20T17:13:53:     messageType: 'confirmation'
2025-09-20T17:13:53:   },
2025-09-20T17:13:53:   timestamp: 1758368633606
2025-09-20T17:13:53: }
2025-09-20T17:13:53: âŒ [918058693371_TXL18092517_confirmation_1758368633595] Startup grace period active (52s remaining)
2025-09-20T17:13:53: ğŸš« [918058693371] PRIMARY SAFETY CHECK FAILED: Startup grace period active (52s remaining)
2025-09-20T17:13:53: ğŸ“ Message recorded: 918058693371 | TXL18092517 | confirmation | Success: false
2025-09-20T17:13:53: â„¹ï¸ [5:13:53 pm] INFO: Message ALLOWED: confirmation for TXL18092517 {
2025-09-20T17:13:53:   phone: '918****371',
2025-09-20T17:13:53:   orderId: 'TXL18092517',
2025-09-20T17:13:53:   messageType: 'confirmation',
2025-09-20T17:13:53:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:13:53:   reason: {
2025-09-20T17:13:53:     contentHash: 'a1ead4760b0d2ad2',
2025-09-20T17:13:53:     timestamp: 1758368633610,
2025-09-20T17:13:53:     messageLength: 472,
2025-09-20T17:13:53:     errorMessage: 'Startup grace period active (52s remaining)',
2025-09-20T17:13:53:     backupFile: 'safety-data\\backup_918058693371_TXL18092517_confirmation.json'
2025-09-20T17:13:53:   },
2025-09-20T17:13:53:   duration: 0,
2025-09-20T17:13:53:   timestamp: 1758368633631
2025-09-20T17:13:53: }
2025-09-20T17:13:53: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:13:53: ğŸ“ Loaded 11 template types
2025-09-20T17:13:53: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T17:13:53: ğŸ“‹ [918890134811] Order: TGY18092517, Type: confirmation
2025-09-20T17:13:53: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T17:13:53: ğŸ›¡ï¸ [918890134811_TGY18092517_confirmation_1758368633637] Starting comprehensive safety check...
2025-09-20T17:13:53: ğŸ“‹ [918890134811_TGY18092517_confirmation_1758368633637] Phone: 918890134811, Order: TGY18092517, Type: confirmation
2025-09-20T17:13:53: â„¹ï¸ [5:13:53 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:13:53:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:13:53:   phone: '918****811',
2025-09-20T17:13:53:   orderId: 'TGY18092517',
2025-09-20T17:13:53:   messageType: 'confirmation',
2025-09-20T17:13:53:   result: 'STARTED',
2025-09-20T17:13:53:   details: {
2025-09-20T17:13:53:     checkId: '918890134811_TGY18092517_confirmation_1758368633637',
2025-09-20T17:13:53:     hasOrderData: true,
2025-09-20T17:13:53:     hasSheetData: false,
2025-09-20T17:13:53:     messageLength: 473
2025-09-20T17:13:53:   },
2025-09-20T17:13:53:   timestamp: 1758368633638
2025-09-20T17:13:53: }
2025-09-20T17:13:53: ğŸ” [918890134811_TGY18092517_confirmation_1758368633637] Step 1: Kill Switch Check
2025-09-20T17:13:53: ğŸ” [918890134811_TGY18092517_confirmation_1758368633637] Step 1.5: Developer Phone Check
2025-09-20T17:13:53: ğŸ” [918890134811_TGY18092517_confirmation_1758368633637] Step 2: Grace Period Check
2025-09-20T17:13:53: â„¹ï¸ [5:13:53 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:13:53:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:13:53:   remainingMs: 51274,
2025-09-20T17:13:53:   remainingSeconds: 52,
2025-09-20T17:13:53:   details: {
2025-09-20T17:13:53:     checkId: '918890134811_TGY18092517_confirmation_1758368633637',
2025-09-20T17:13:53:     phone: '918890134811',
2025-09-20T17:13:53:     orderId: 'TGY18092517',
2025-09-20T17:13:53:     messageType: 'confirmation'
2025-09-20T17:13:53:   },
2025-09-20T17:13:53:   timestamp: 1758368633642
2025-09-20T17:13:53: }
2025-09-20T17:13:53: âŒ [918890134811_TGY18092517_confirmation_1758368633637] Startup grace period active (52s remaining)
2025-09-20T17:13:53: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (52s remaining)
2025-09-20T17:13:53: ğŸ“ Message recorded: 918890134811 | TGY18092517 | confirmation | Success: false
2025-09-20T17:13:53: â„¹ï¸ [5:13:53 pm] INFO: Message ALLOWED: confirmation for TGY18092517 {
2025-09-20T17:13:53:   phone: '918****811',
2025-09-20T17:13:53:   orderId: 'TGY18092517',
2025-09-20T17:13:53:   messageType: 'confirmation',
2025-09-20T17:13:53:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:13:53:   reason: {
2025-09-20T17:13:53:     contentHash: '5ca42c940f17d86b',
2025-09-20T17:13:53:     timestamp: 1758368633644,
2025-09-20T17:13:53:     messageLength: 473,
2025-09-20T17:13:53:     errorMessage: 'Startup grace period active (52s remaining)',
2025-09-20T17:13:53:     backupFile: 'safety-data\\backup_918890134811_TGY18092517_confirmation.json'
2025-09-20T17:13:53:   },
2025-09-20T17:13:53:   duration: 0,
2025-09-20T17:13:53:   timestamp: 1758368633656
2025-09-20T17:13:53: }
2025-09-20T17:13:53: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:13:53: ğŸ“ Loaded 11 template types
2025-09-20T17:13:53: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T17:13:53: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T17:13:53: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T17:13:53: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758368633662] Starting comprehensive safety check...
2025-09-20T17:13:53: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758368633662] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T17:13:53: â„¹ï¸ [5:13:53 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:13:53:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:13:53:   phone: '919****706',
2025-09-20T17:13:53:   orderId: 'TJJ19092511',
2025-09-20T17:13:53:   messageType: 'confirmation',
2025-09-20T17:13:53:   result: 'STARTED',
2025-09-20T17:13:53:   details: {
2025-09-20T17:13:53:     checkId: '919953020706_TJJ19092511_confirmation_1758368633662',
2025-09-20T17:13:53:     hasOrderData: true,
2025-09-20T17:13:53:     hasSheetData: false,
2025-09-20T17:13:53:     messageLength: 469
2025-09-20T17:13:53:   },
2025-09-20T17:13:53:   timestamp: 1758368633663
2025-09-20T17:13:53: }
2025-09-20T17:13:53: ğŸ” [919953020706_TJJ19092511_confirmation_1758368633662] Step 1: Kill Switch Check
2025-09-20T17:13:53: ğŸ” [919953020706_TJJ19092511_confirmation_1758368633662] Step 1.5: Developer Phone Check
2025-09-20T17:13:53: ğŸ” [919953020706_TJJ19092511_confirmation_1758368633662] Step 2: Grace Period Check
2025-09-20T17:13:53: â„¹ï¸ [5:13:53 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:13:53:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:13:53:   remainingMs: 51250,
2025-09-20T17:13:53:   remainingSeconds: 52,
2025-09-20T17:13:53:   details: {
2025-09-20T17:13:53:     checkId: '919953020706_TJJ19092511_confirmation_1758368633662',
2025-09-20T17:13:53:     phone: '919953020706',
2025-09-20T17:13:53:     orderId: 'TJJ19092511',
2025-09-20T17:13:53:     messageType: 'confirmation'
2025-09-20T17:13:53:   },
2025-09-20T17:13:53:   timestamp: 1758368633666
2025-09-20T17:13:53: }
2025-09-20T17:13:53: âŒ [919953020706_TJJ19092511_confirmation_1758368633662] Startup grace period active (52s remaining)
2025-09-20T17:13:53: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Startup grace period active (52s remaining)
2025-09-20T17:13:53: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T17:13:53: â„¹ï¸ [5:13:53 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T17:13:53:   phone: '919****706',
2025-09-20T17:13:53:   orderId: 'TJJ19092511',
2025-09-20T17:13:53:   messageType: 'confirmation',
2025-09-20T17:13:53:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:13:53:   reason: {
2025-09-20T17:13:53:     contentHash: '97026037ffec053e',
2025-09-20T17:13:53:     timestamp: 1758368633668,
2025-09-20T17:13:53:     messageLength: 469,
2025-09-20T17:13:53:     errorMessage: 'Startup grace period active (52s remaining)',
2025-09-20T17:13:53:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T17:13:53:   },
2025-09-20T17:13:53:   duration: 0,
2025-09-20T17:13:53:   timestamp: 1758368633683
2025-09-20T17:13:53: }
2025-09-20T17:13:53: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:13:53: ğŸ“ Loaded 11 template types
2025-09-20T17:13:53: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T17:13:53: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T17:13:53: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T17:13:53: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758368633688] Starting comprehensive safety check...
2025-09-20T17:13:53: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758368633688] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T17:13:53: â„¹ï¸ [5:13:53 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:13:53:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:13:53:   phone: '919****488',
2025-09-20T17:13:53:   orderId: 'TWM19092511',
2025-09-20T17:13:53:   messageType: 'confirmation',
2025-09-20T17:13:53:   result: 'STARTED',
2025-09-20T17:13:53:   details: {
2025-09-20T17:13:53:     checkId: '919358537488_TWM19092511_confirmation_1758368633688',
2025-09-20T17:13:53:     hasOrderData: true,
2025-09-20T17:13:53:     hasSheetData: false,
2025-09-20T17:13:53:     messageLength: 475
2025-09-20T17:13:53:   },
2025-09-20T17:13:53:   timestamp: 1758368633688
2025-09-20T17:13:53: }
2025-09-20T17:13:53: ğŸ” [919358537488_TWM19092511_confirmation_1758368633688] Step 1: Kill Switch Check
2025-09-20T17:13:53: ğŸ” [919358537488_TWM19092511_confirmation_1758368633688] Step 1.5: Developer Phone Check
2025-09-20T17:13:53: ğŸ” [919358537488_TWM19092511_confirmation_1758368633688] Step 2: Grace Period Check
2025-09-20T17:13:53: â„¹ï¸ [5:13:53 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:13:53:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:13:53:   remainingMs: 51224,
2025-09-20T17:13:53:   remainingSeconds: 52,
2025-09-20T17:13:53:   details: {
2025-09-20T17:13:53:     checkId: '919358537488_TWM19092511_confirmation_1758368633688',
2025-09-20T17:13:53:     phone: '919358537488',
2025-09-20T17:13:53:     orderId: 'TWM19092511',
2025-09-20T17:13:53:     messageType: 'confirmation'
2025-09-20T17:13:53:   },
2025-09-20T17:13:53:   timestamp: 1758368633693
2025-09-20T17:13:53: }
2025-09-20T17:13:53: âŒ [919358537488_TWM19092511_confirmation_1758368633688] Startup grace period active (52s remaining)
2025-09-20T17:13:53: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Startup grace period active (52s remaining)
2025-09-20T17:13:53: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T17:13:53: â„¹ï¸ [5:13:53 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T17:13:53:   phone: '919****488',
2025-09-20T17:13:53:   orderId: 'TWM19092511',
2025-09-20T17:13:53:   messageType: 'confirmation',
2025-09-20T17:13:53:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:13:53:   reason: {
2025-09-20T17:13:53:     contentHash: 'e34d023f065922da',
2025-09-20T17:13:53:     timestamp: 1758368633696,
2025-09-20T17:13:53:     messageLength: 475,
2025-09-20T17:13:53:     errorMessage: 'Startup grace period active (52s remaining)',
2025-09-20T17:13:53:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T17:13:53:   },
2025-09-20T17:13:53:   duration: 0,
2025-09-20T17:13:53:   timestamp: 1758368633710
2025-09-20T17:13:53: }
2025-09-20T17:13:53: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:13:53: ğŸ“ Loaded 11 template types
2025-09-20T17:13:53: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T17:13:53: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T17:13:53: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T17:13:53: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758368633716] Starting comprehensive safety check...
2025-09-20T17:13:53: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758368633716] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T17:13:53: â„¹ï¸ [5:13:53 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:13:53:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:13:53:   phone: '918****811',
2025-09-20T17:13:53:   orderId: 'TOF19092511',
2025-09-20T17:13:53:   messageType: 'confirmation',
2025-09-20T17:13:53:   result: 'STARTED',
2025-09-20T17:13:53:   details: {
2025-09-20T17:13:53:     checkId: '918890134811_TOF19092511_confirmation_1758368633716',
2025-09-20T17:13:53:     hasOrderData: true,
2025-09-20T17:13:53:     hasSheetData: false,
2025-09-20T17:13:53:     messageLength: 473
2025-09-20T17:13:53:   },
2025-09-20T17:13:53:   timestamp: 1758368633716
2025-09-20T17:13:53: }
2025-09-20T17:13:53: ğŸ” [918890134811_TOF19092511_confirmation_1758368633716] Step 1: Kill Switch Check
2025-09-20T17:13:53: ğŸ” [918890134811_TOF19092511_confirmation_1758368633716] Step 1.5: Developer Phone Check
2025-09-20T17:13:53: ğŸ” [918890134811_TOF19092511_confirmation_1758368633716] Step 2: Grace Period Check
2025-09-20T17:13:53: â„¹ï¸ [5:13:53 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:13:53:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:13:53:   remainingMs: 51195,
2025-09-20T17:13:53:   remainingSeconds: 52,
2025-09-20T17:13:53:   details: {
2025-09-20T17:13:53:     checkId: '918890134811_TOF19092511_confirmation_1758368633716',
2025-09-20T17:13:53:     phone: '918890134811',
2025-09-20T17:13:53:     orderId: 'TOF19092511',
2025-09-20T17:13:53:     messageType: 'confirmation'
2025-09-20T17:13:53:   },
2025-09-20T17:13:53:   timestamp: 1758368633721
2025-09-20T17:13:53: }
2025-09-20T17:13:53: âŒ [918890134811_TOF19092511_confirmation_1758368633716] Startup grace period active (52s remaining)
2025-09-20T17:13:53: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (52s remaining)
2025-09-20T17:13:53: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T17:13:53: â„¹ï¸ [5:13:53 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T17:13:53:   phone: '918****811',
2025-09-20T17:13:53:   orderId: 'TOF19092511',
2025-09-20T17:13:53:   messageType: 'confirmation',
2025-09-20T17:13:53:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:13:53:   reason: {
2025-09-20T17:13:53:     contentHash: '388fbe812e19f1de',
2025-09-20T17:13:53:     timestamp: 1758368633729,
2025-09-20T17:13:53:     messageLength: 473,
2025-09-20T17:13:53:     errorMessage: 'Startup grace period active (52s remaining)',
2025-09-20T17:13:53:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T17:13:53:   },
2025-09-20T17:13:53:   duration: 0,
2025-09-20T17:13:53:   timestamp: 1758368633751
2025-09-20T17:13:53: }
2025-09-20T17:14:15: ğŸ’¾ Data synced to files successfully
2025-09-20T17:14:45: âœ… Startup grace period ended - message sending now allowed
2025-09-20T17:14:45: âœ… Startup grace period ended - message sending now allowed
2025-09-20T17:14:45: â„¹ï¸ [5:14:45 pm] INFO: Grace Period: ENDED {
2025-09-20T17:14:45:   action: 'ENDED',
2025-09-20T17:14:45:   remainingMs: 0,
2025-09-20T17:14:45:   remainingSeconds: 0,
2025-09-20T17:14:45:   details: { totalDuration: 240000, processId: 5840 },
2025-09-20T17:14:45:   timestamp: 1758368685045
2025-09-20T17:14:45: }
2025-09-20T17:14:45: â„¹ï¸ [5:14:45 pm] INFO: Grace Period: ENDED {
2025-09-20T17:14:45:   action: 'ENDED',
2025-09-20T17:14:45:   remainingMs: 0,
2025-09-20T17:14:45:   remainingSeconds: 0,
2025-09-20T17:14:45:   details: { totalDuration: 240000, processId: 5840 },
2025-09-20T17:14:45:   timestamp: 1758368685047
2025-09-20T17:14:45: }
2025-09-20T17:14:45: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T17:14:45: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T17:14:45: ğŸ’¾ Data synced to files successfully
2025-09-20T17:15:15: ğŸ’¾ Data synced to files successfully
2025-09-20T17:15:45: ğŸ’¾ Data synced to files successfully
2025-09-20T17:16:15: ğŸ’¾ Data synced to files successfully
2025-09-20T17:16:45: ğŸ’¾ Data synced to files successfully
2025-09-20T17:16:53: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:16:53: ğŸ“ Loaded 11 template types
2025-09-20T17:16:53: ğŸ” [918058693371] Starting comprehensive message safety check...
2025-09-20T17:16:53: ğŸ“‹ [918058693371] Order: TXL18092517, Type: confirmation
2025-09-20T17:16:53: ğŸ›¡ï¸ [918058693371] Running primary safety check...
2025-09-20T17:16:53: ğŸ›¡ï¸ [918058693371_TXL18092517_confirmation_1758368813417] Starting comprehensive safety check...
2025-09-20T17:16:53: ğŸ“‹ [918058693371_TXL18092517_confirmation_1758368813417] Phone: 918058693371, Order: TXL18092517, Type: confirmation
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:16:53:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:16:53:   phone: '918****371',
2025-09-20T17:16:53:   orderId: 'TXL18092517',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'STARTED',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     checkId: '918058693371_TXL18092517_confirmation_1758368813417',
2025-09-20T17:16:53:     hasOrderData: true,
2025-09-20T17:16:53:     hasSheetData: false,
2025-09-20T17:16:53:     messageLength: 472
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813418
2025-09-20T17:16:53: }
2025-09-20T17:16:53: ğŸ” [918058693371_TXL18092517_confirmation_1758368813417] Step 1: Kill Switch Check
2025-09-20T17:16:53: ğŸ” [918058693371_TXL18092517_confirmation_1758368813417] Step 1.5: Developer Phone Check
2025-09-20T17:16:53: ğŸ” [918058693371_TXL18092517_confirmation_1758368813417] Step 2: Grace Period Check
2025-09-20T17:16:53: ğŸ” [918058693371_TXL18092517_confirmation_1758368813417] Step 3: Business Hours Check
2025-09-20T17:16:53: ğŸ” [918058693371_TXL18092517_confirmation_1758368813417] Step 4: Message Type Rules Check
2025-09-20T17:16:53: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:16:53:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:16:53:   phone: '918****371',
2025-09-20T17:16:53:   orderId: 'TXL18092517',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'STARTED',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T17:16:53:     requiredFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'phone',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'delivery_date'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     orderDataFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'total_amount',
2025-09-20T17:16:53:       'advance_amount',
2025-09-20T17:16:53:       'remaining_amount',
2025-09-20T17:16:53:       'ready_date',
2025-09-20T17:16:53:       'delivery_date',
2025-09-20T17:16:53:       'shop_name',
2025-09-20T17:16:53:       'shop_phone',
2025-09-20T17:16:53:       'business_hours'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     sheetDataFields: []
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813424
2025-09-20T17:16:53: }
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:16:53:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:16:53:   phone: '918****371',
2025-09-20T17:16:53:   orderId: 'TXL18092517',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'MISSING_FIELD',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     missingField: 'phone',
2025-09-20T17:16:53:     requiredFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'phone',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'delivery_date'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     availableOrderFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'total_amount',
2025-09-20T17:16:53:       'advance_amount',
2025-09-20T17:16:53:       'remaining_amount',
2025-09-20T17:16:53:       'ready_date',
2025-09-20T17:16:53:       'delivery_date',
2025-09-20T17:16:53:       'shop_name',
2025-09-20T17:16:53:       'shop_phone',
2025-09-20T17:16:53:       'business_hours'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     availableSheetFields: []
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813431
2025-09-20T17:16:53: }
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:16:53:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:16:53:   phone: '918****371',
2025-09-20T17:16:53:   orderId: 'TXL18092517',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'BLOCKED',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     checkId: '918058693371_TXL18092517_confirmation_1758368813417',
2025-09-20T17:16:53:     ruleViolation: 'MISSING_REQUIRED_FIELD',
2025-09-20T17:16:53:     details: 'Missing required field: phone'
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813434
2025-09-20T17:16:53: }
2025-09-20T17:16:53: âŒ [918058693371_TXL18092517_confirmation_1758368813417] Missing required field: phone
2025-09-20T17:16:53: ğŸš« [918058693371] PRIMARY SAFETY CHECK FAILED: Missing required field: phone
2025-09-20T17:16:53: ğŸ“ Message recorded: 918058693371 | TXL18092517 | confirmation | Success: false
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Message ALLOWED: confirmation for TXL18092517 {
2025-09-20T17:16:53:   phone: '918****371',
2025-09-20T17:16:53:   orderId: 'TXL18092517',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:16:53:   reason: {
2025-09-20T17:16:53:     contentHash: 'a1ead4760b0d2ad2',
2025-09-20T17:16:53:     timestamp: 1758368813436,
2025-09-20T17:16:53:     messageLength: 472,
2025-09-20T17:16:53:     errorMessage: 'Missing required field: phone',
2025-09-20T17:16:53:     backupFile: 'safety-data\\backup_918058693371_TXL18092517_confirmation.json'
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   duration: 0,
2025-09-20T17:16:53:   timestamp: 1758368813449
2025-09-20T17:16:53: }
2025-09-20T17:16:53: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:16:53: ğŸ“ Loaded 11 template types
2025-09-20T17:16:53: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T17:16:53: ğŸ“‹ [918890134811] Order: TGY18092517, Type: confirmation
2025-09-20T17:16:53: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T17:16:53: ğŸ›¡ï¸ [918890134811_TGY18092517_confirmation_1758368813452] Starting comprehensive safety check...
2025-09-20T17:16:53: ğŸ“‹ [918890134811_TGY18092517_confirmation_1758368813452] Phone: 918890134811, Order: TGY18092517, Type: confirmation
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:16:53:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:16:53:   phone: '918****811',
2025-09-20T17:16:53:   orderId: 'TGY18092517',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'STARTED',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     checkId: '918890134811_TGY18092517_confirmation_1758368813452',
2025-09-20T17:16:53:     hasOrderData: true,
2025-09-20T17:16:53:     hasSheetData: false,
2025-09-20T17:16:53:     messageLength: 473
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813452
2025-09-20T17:16:53: }
2025-09-20T17:16:53: ğŸ” [918890134811_TGY18092517_confirmation_1758368813452] Step 1: Kill Switch Check
2025-09-20T17:16:53: ğŸ” [918890134811_TGY18092517_confirmation_1758368813452] Step 1.5: Developer Phone Check
2025-09-20T17:16:53: ğŸ” [918890134811_TGY18092517_confirmation_1758368813452] Step 2: Grace Period Check
2025-09-20T17:16:53: ğŸ” [918890134811_TGY18092517_confirmation_1758368813452] Step 3: Business Hours Check
2025-09-20T17:16:53: ğŸ” [918890134811_TGY18092517_confirmation_1758368813452] Step 4: Message Type Rules Check
2025-09-20T17:16:53: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:16:53:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:16:53:   phone: '918****811',
2025-09-20T17:16:53:   orderId: 'TGY18092517',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'STARTED',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T17:16:53:     requiredFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'phone',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'delivery_date'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     orderDataFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'total_amount',
2025-09-20T17:16:53:       'advance_amount',
2025-09-20T17:16:53:       'remaining_amount',
2025-09-20T17:16:53:       'ready_date',
2025-09-20T17:16:53:       'delivery_date',
2025-09-20T17:16:53:       'shop_name',
2025-09-20T17:16:53:       'shop_phone',
2025-09-20T17:16:53:       'business_hours'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     sheetDataFields: []
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813479
2025-09-20T17:16:53: }
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:16:53:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:16:53:   phone: '918****811',
2025-09-20T17:16:53:   orderId: 'TGY18092517',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'MISSING_FIELD',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     missingField: 'phone',
2025-09-20T17:16:53:     requiredFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'phone',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'delivery_date'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     availableOrderFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'total_amount',
2025-09-20T17:16:53:       'advance_amount',
2025-09-20T17:16:53:       'remaining_amount',
2025-09-20T17:16:53:       'ready_date',
2025-09-20T17:16:53:       'delivery_date',
2025-09-20T17:16:53:       'shop_name',
2025-09-20T17:16:53:       'shop_phone',
2025-09-20T17:16:53:       'business_hours'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     availableSheetFields: []
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813483
2025-09-20T17:16:53: }
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:16:53:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:16:53:   phone: '918****811',
2025-09-20T17:16:53:   orderId: 'TGY18092517',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'BLOCKED',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     checkId: '918890134811_TGY18092517_confirmation_1758368813452',
2025-09-20T17:16:53:     ruleViolation: 'MISSING_REQUIRED_FIELD',
2025-09-20T17:16:53:     details: 'Missing required field: phone'
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813485
2025-09-20T17:16:53: }
2025-09-20T17:16:53: âŒ [918890134811_TGY18092517_confirmation_1758368813452] Missing required field: phone
2025-09-20T17:16:53: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Missing required field: phone
2025-09-20T17:16:53: ğŸ“ Message recorded: 918890134811 | TGY18092517 | confirmation | Success: false
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Message ALLOWED: confirmation for TGY18092517 {
2025-09-20T17:16:53:   phone: '918****811',
2025-09-20T17:16:53:   orderId: 'TGY18092517',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:16:53:   reason: {
2025-09-20T17:16:53:     contentHash: '5ca42c940f17d86b',
2025-09-20T17:16:53:     timestamp: 1758368813487,
2025-09-20T17:16:53:     messageLength: 473,
2025-09-20T17:16:53:     errorMessage: 'Missing required field: phone',
2025-09-20T17:16:53:     backupFile: 'safety-data\\backup_918890134811_TGY18092517_confirmation.json'
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   duration: 0,
2025-09-20T17:16:53:   timestamp: 1758368813519
2025-09-20T17:16:53: }
2025-09-20T17:16:53: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:16:53: ğŸ“ Loaded 11 template types
2025-09-20T17:16:53: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T17:16:53: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T17:16:53: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T17:16:53: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758368813522] Starting comprehensive safety check...
2025-09-20T17:16:53: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758368813522] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:16:53:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:16:53:   phone: '919****706',
2025-09-20T17:16:53:   orderId: 'TJJ19092511',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'STARTED',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     checkId: '919953020706_TJJ19092511_confirmation_1758368813522',
2025-09-20T17:16:53:     hasOrderData: true,
2025-09-20T17:16:53:     hasSheetData: false,
2025-09-20T17:16:53:     messageLength: 469
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813522
2025-09-20T17:16:53: }
2025-09-20T17:16:53: ğŸ” [919953020706_TJJ19092511_confirmation_1758368813522] Step 1: Kill Switch Check
2025-09-20T17:16:53: ğŸ” [919953020706_TJJ19092511_confirmation_1758368813522] Step 1.5: Developer Phone Check
2025-09-20T17:16:53: ğŸ” [919953020706_TJJ19092511_confirmation_1758368813522] Step 2: Grace Period Check
2025-09-20T17:16:53: ğŸ” [919953020706_TJJ19092511_confirmation_1758368813522] Step 3: Business Hours Check
2025-09-20T17:16:53: ğŸ” [919953020706_TJJ19092511_confirmation_1758368813522] Step 4: Message Type Rules Check
2025-09-20T17:16:53: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:16:53:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:16:53:   phone: '919****706',
2025-09-20T17:16:53:   orderId: 'TJJ19092511',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'STARTED',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T17:16:53:     requiredFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'phone',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'delivery_date'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     orderDataFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'total_amount',
2025-09-20T17:16:53:       'advance_amount',
2025-09-20T17:16:53:       'remaining_amount',
2025-09-20T17:16:53:       'ready_date',
2025-09-20T17:16:53:       'delivery_date',
2025-09-20T17:16:53:       'shop_name',
2025-09-20T17:16:53:       'shop_phone',
2025-09-20T17:16:53:       'business_hours'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     sheetDataFields: []
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813529
2025-09-20T17:16:53: }
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:16:53:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:16:53:   phone: '919****706',
2025-09-20T17:16:53:   orderId: 'TJJ19092511',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'MISSING_FIELD',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     missingField: 'phone',
2025-09-20T17:16:53:     requiredFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'phone',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'delivery_date'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     availableOrderFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'total_amount',
2025-09-20T17:16:53:       'advance_amount',
2025-09-20T17:16:53:       'remaining_amount',
2025-09-20T17:16:53:       'ready_date',
2025-09-20T17:16:53:       'delivery_date',
2025-09-20T17:16:53:       'shop_name',
2025-09-20T17:16:53:       'shop_phone',
2025-09-20T17:16:53:       'business_hours'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     availableSheetFields: []
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813535
2025-09-20T17:16:53: }
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:16:53:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:16:53:   phone: '919****706',
2025-09-20T17:16:53:   orderId: 'TJJ19092511',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'BLOCKED',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     checkId: '919953020706_TJJ19092511_confirmation_1758368813522',
2025-09-20T17:16:53:     ruleViolation: 'MISSING_REQUIRED_FIELD',
2025-09-20T17:16:53:     details: 'Missing required field: phone'
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813547
2025-09-20T17:16:53: }
2025-09-20T17:16:53: âŒ [919953020706_TJJ19092511_confirmation_1758368813522] Missing required field: phone
2025-09-20T17:16:53: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Missing required field: phone
2025-09-20T17:16:53: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T17:16:53:   phone: '919****706',
2025-09-20T17:16:53:   orderId: 'TJJ19092511',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:16:53:   reason: {
2025-09-20T17:16:53:     contentHash: '97026037ffec053e',
2025-09-20T17:16:53:     timestamp: 1758368813551,
2025-09-20T17:16:53:     messageLength: 469,
2025-09-20T17:16:53:     errorMessage: 'Missing required field: phone',
2025-09-20T17:16:53:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   duration: 0,
2025-09-20T17:16:53:   timestamp: 1758368813580
2025-09-20T17:16:53: }
2025-09-20T17:16:53: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:16:53: ğŸ“ Loaded 11 template types
2025-09-20T17:16:53: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T17:16:53: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T17:16:53: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T17:16:53: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758368813588] Starting comprehensive safety check...
2025-09-20T17:16:53: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758368813588] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:16:53:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:16:53:   phone: '919****488',
2025-09-20T17:16:53:   orderId: 'TWM19092511',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'STARTED',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     checkId: '919358537488_TWM19092511_confirmation_1758368813588',
2025-09-20T17:16:53:     hasOrderData: true,
2025-09-20T17:16:53:     hasSheetData: false,
2025-09-20T17:16:53:     messageLength: 475
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813588
2025-09-20T17:16:53: }
2025-09-20T17:16:53: ğŸ” [919358537488_TWM19092511_confirmation_1758368813588] Step 1: Kill Switch Check
2025-09-20T17:16:53: ğŸ” [919358537488_TWM19092511_confirmation_1758368813588] Step 1.5: Developer Phone Check
2025-09-20T17:16:53: ğŸ” [919358537488_TWM19092511_confirmation_1758368813588] Step 2: Grace Period Check
2025-09-20T17:16:53: ğŸ” [919358537488_TWM19092511_confirmation_1758368813588] Step 3: Business Hours Check
2025-09-20T17:16:53: ğŸ” [919358537488_TWM19092511_confirmation_1758368813588] Step 4: Message Type Rules Check
2025-09-20T17:16:53: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:16:53:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:16:53:   phone: '919****488',
2025-09-20T17:16:53:   orderId: 'TWM19092511',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'STARTED',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T17:16:53:     requiredFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'phone',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'delivery_date'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     orderDataFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'total_amount',
2025-09-20T17:16:53:       'advance_amount',
2025-09-20T17:16:53:       'remaining_amount',
2025-09-20T17:16:53:       'ready_date',
2025-09-20T17:16:53:       'delivery_date',
2025-09-20T17:16:53:       'shop_name',
2025-09-20T17:16:53:       'shop_phone',
2025-09-20T17:16:53:       'business_hours'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     sheetDataFields: []
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813597
2025-09-20T17:16:53: }
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:16:53:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:16:53:   phone: '919****488',
2025-09-20T17:16:53:   orderId: 'TWM19092511',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'MISSING_FIELD',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     missingField: 'phone',
2025-09-20T17:16:53:     requiredFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'phone',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'delivery_date'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     availableOrderFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'total_amount',
2025-09-20T17:16:53:       'advance_amount',
2025-09-20T17:16:53:       'remaining_amount',
2025-09-20T17:16:53:       'ready_date',
2025-09-20T17:16:53:       'delivery_date',
2025-09-20T17:16:53:       'shop_name',
2025-09-20T17:16:53:       'shop_phone',
2025-09-20T17:16:53:       'business_hours'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     availableSheetFields: []
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813600
2025-09-20T17:16:53: }
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:16:53:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:16:53:   phone: '919****488',
2025-09-20T17:16:53:   orderId: 'TWM19092511',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'BLOCKED',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     checkId: '919358537488_TWM19092511_confirmation_1758368813588',
2025-09-20T17:16:53:     ruleViolation: 'MISSING_REQUIRED_FIELD',
2025-09-20T17:16:53:     details: 'Missing required field: phone'
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813604
2025-09-20T17:16:53: }
2025-09-20T17:16:53: âŒ [919358537488_TWM19092511_confirmation_1758368813588] Missing required field: phone
2025-09-20T17:16:53: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Missing required field: phone
2025-09-20T17:16:53: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T17:16:53:   phone: '919****488',
2025-09-20T17:16:53:   orderId: 'TWM19092511',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:16:53:   reason: {
2025-09-20T17:16:53:     contentHash: 'e34d023f065922da',
2025-09-20T17:16:53:     timestamp: 1758368813608,
2025-09-20T17:16:53:     messageLength: 475,
2025-09-20T17:16:53:     errorMessage: 'Missing required field: phone',
2025-09-20T17:16:53:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   duration: 0,
2025-09-20T17:16:53:   timestamp: 1758368813639
2025-09-20T17:16:53: }
2025-09-20T17:16:53: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:16:53: ğŸ“ Loaded 11 template types
2025-09-20T17:16:53: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T17:16:53: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T17:16:53: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T17:16:53: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758368813646] Starting comprehensive safety check...
2025-09-20T17:16:53: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758368813646] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:16:53:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:16:53:   phone: '918****811',
2025-09-20T17:16:53:   orderId: 'TOF19092511',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'STARTED',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     checkId: '918890134811_TOF19092511_confirmation_1758368813646',
2025-09-20T17:16:53:     hasOrderData: true,
2025-09-20T17:16:53:     hasSheetData: false,
2025-09-20T17:16:53:     messageLength: 473
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813646
2025-09-20T17:16:53: }
2025-09-20T17:16:53: ğŸ” [918890134811_TOF19092511_confirmation_1758368813646] Step 1: Kill Switch Check
2025-09-20T17:16:53: ğŸ” [918890134811_TOF19092511_confirmation_1758368813646] Step 1.5: Developer Phone Check
2025-09-20T17:16:53: ğŸ” [918890134811_TOF19092511_confirmation_1758368813646] Step 2: Grace Period Check
2025-09-20T17:16:53: ğŸ” [918890134811_TOF19092511_confirmation_1758368813646] Step 3: Business Hours Check
2025-09-20T17:16:53: ğŸ” [918890134811_TOF19092511_confirmation_1758368813646] Step 4: Message Type Rules Check
2025-09-20T17:16:53: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:16:53:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:16:53:   phone: '918****811',
2025-09-20T17:16:53:   orderId: 'TOF19092511',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'STARTED',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T17:16:53:     requiredFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'phone',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'delivery_date'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     orderDataFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'total_amount',
2025-09-20T17:16:53:       'advance_amount',
2025-09-20T17:16:53:       'remaining_amount',
2025-09-20T17:16:53:       'ready_date',
2025-09-20T17:16:53:       'delivery_date',
2025-09-20T17:16:53:       'shop_name',
2025-09-20T17:16:53:       'shop_phone',
2025-09-20T17:16:53:       'business_hours'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     sheetDataFields: []
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813650
2025-09-20T17:16:53: }
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:16:53:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:16:53:   phone: '918****811',
2025-09-20T17:16:53:   orderId: 'TOF19092511',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'MISSING_FIELD',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     missingField: 'phone',
2025-09-20T17:16:53:     requiredFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'phone',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'delivery_date'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     availableOrderFields: [
2025-09-20T17:16:53:       'customer_name',
2025-09-20T17:16:53:       'order_id',
2025-09-20T17:16:53:       'garment_type',
2025-09-20T17:16:53:       'total_amount',
2025-09-20T17:16:53:       'advance_amount',
2025-09-20T17:16:53:       'remaining_amount',
2025-09-20T17:16:53:       'ready_date',
2025-09-20T17:16:53:       'delivery_date',
2025-09-20T17:16:53:       'shop_name',
2025-09-20T17:16:53:       'shop_phone',
2025-09-20T17:16:53:       'business_hours'
2025-09-20T17:16:53:     ],
2025-09-20T17:16:53:     availableSheetFields: []
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813652
2025-09-20T17:16:53: }
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T17:16:53:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T17:16:53:   phone: '918****811',
2025-09-20T17:16:53:   orderId: 'TOF19092511',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   result: 'BLOCKED',
2025-09-20T17:16:53:   details: {
2025-09-20T17:16:53:     checkId: '918890134811_TOF19092511_confirmation_1758368813646',
2025-09-20T17:16:53:     ruleViolation: 'MISSING_REQUIRED_FIELD',
2025-09-20T17:16:53:     details: 'Missing required field: phone'
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   timestamp: 1758368813661
2025-09-20T17:16:53: }
2025-09-20T17:16:53: âŒ [918890134811_TOF19092511_confirmation_1758368813646] Missing required field: phone
2025-09-20T17:16:53: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Missing required field: phone
2025-09-20T17:16:53: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T17:16:53: â„¹ï¸ [5:16:53 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T17:16:53:   phone: '918****811',
2025-09-20T17:16:53:   orderId: 'TOF19092511',
2025-09-20T17:16:53:   messageType: 'confirmation',
2025-09-20T17:16:53:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:16:53:   reason: {
2025-09-20T17:16:53:     contentHash: '388fbe812e19f1de',
2025-09-20T17:16:53:     timestamp: 1758368813665,
2025-09-20T17:16:53:     messageLength: 473,
2025-09-20T17:16:53:     errorMessage: 'Missing required field: phone',
2025-09-20T17:16:53:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T17:16:53:   },
2025-09-20T17:16:53:   duration: 0,
2025-09-20T17:16:53:   timestamp: 1758368813686
2025-09-20T17:16:53: }
2025-09-20T17:17:15: ğŸ’¾ Data synced to files successfully
2025-09-20T17:17:45: ğŸ’¾ Data synced to files successfully
2025-09-20T17:18:14: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:18:14: ğŸ“ Loaded 11 template types
2025-09-20T17:18:14: ğŸ”§ WhatsApp Bot initialized
2025-09-20T17:18:14: ğŸ“Š Configuration status: undefined
2025-09-20T17:18:14: âœ… Atomic State Manager initialized
2025-09-20T17:18:14: ğŸ“ Enhanced Logger initialized
2025-09-20T17:18:14: âœ… Google credentials loaded from service-account.json file
2025-09-20T17:18:14: ğŸ“± WhatsApp auth status: âœ… credentials, 4 session files
2025-09-20T17:18:14: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-20T17:18:14:    Auth Mode: both
2025-09-20T17:18:14:    QR Enabled: true
2025-09-20T17:18:14:    Phone Enabled: true
2025-09-20T17:18:14:    Session Persistence: true
2025-09-20T17:18:14:    Max Reconnect Attempts: 10
2025-09-20T17:18:14:    Default Phone: None
2025-09-20T17:18:14: ğŸ”’ Session validation enabled (check every 300s)
2025-09-20T17:18:14: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-20T17:18:14: ğŸ”§ Developer Configuration initialized
2025-09-20T17:18:14: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T17:18:14: â„¹ï¸ [5:18:14 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T17:18:14:   startupTime: 1758368894150,
2025-09-20T17:18:14:   gracePeriodMs: 240000,
2025-09-20T17:18:14:   dataDir: './safety-data',
2025-09-20T17:18:14:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T17:18:14:   processId: 22644,
2025-09-20T17:18:14:   nodeVersion: 'v22.19.0'
2025-09-20T17:18:14: }
2025-09-20T17:18:14: ğŸ”§ Developer Configuration initialized
2025-09-20T17:18:14: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T17:18:14: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-20T17:18:14: â° 4-minute startup delay active
2025-09-20T17:18:14: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-20T17:18:14: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-20T17:18:14: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T17:18:14: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T17:18:14: âœ… Google Sheets API initialized
2025-09-20T17:18:14: âœ… Google Sheets API initialized
2025-09-20T17:18:14: â„¹ï¸ [5:18:14 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T17:18:14:   startupTime: 1758368894150,
2025-09-20T17:18:14:   gracePeriodMs: 240000,
2025-09-20T17:18:14:   dataDir: './safety-data',
2025-09-20T17:18:14:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T17:18:14:   processId: 22644,
2025-09-20T17:18:14:   nodeVersion: 'v22.19.0'
2025-09-20T17:18:14: }
2025-09-20T17:18:14: ğŸ“ Loaded 0 sent messages from file
2025-09-20T17:18:14: â„¹ï¸ [5:18:14 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T17:18:14: â„¹ï¸ [5:18:14 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T17:18:14: ğŸ“ Loaded 0 customer histories from file
2025-09-20T17:18:14: ğŸ“ Loaded 0 message hashes from file
2025-09-20T17:18:14: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T10-10-35-454Z.log
2025-09-20T17:18:14: ğŸ“ Enhanced Logger initialized
2025-09-20T17:18:14: ğŸ“ Loaded statistics from file
2025-09-20T17:18:14: âœ… Duplicate Prevention Manager initialized
2025-09-20T17:18:14: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T17:18:14: â„¹ï¸ [5:18:14 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T17:18:14: â„¹ï¸ [5:18:14 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T17:18:14: ğŸ§¹ Removed stale process lock
2025-09-20T17:18:14: âš ï¸ Warning: Could not remove lock file: EPERM: operation not permitted, unlink 'C:\Users\gssai\OneDrive\Desktop\Whatsapp-Moblie-Bot\safety-data\process.lock'
2025-09-20T17:18:14: ğŸ”’ Process lock acquired (PID: 22644)
2025-09-20T17:18:14: ğŸ”’ Process lock acquired (PID: 22644)
2025-09-20T17:18:14: â„¹ï¸ [5:18:14 pm] INFO: Process isolation enforced {
2025-09-20T17:18:14:   lockFile: 'safety-data\\process.lock',
2025-09-20T17:18:14:   pidFile: 'safety-data\\process.pid',
2025-09-20T17:18:14:   processId: 22644
2025-09-20T17:18:14: }
2025-09-20T17:18:14: â° Starting 240 second startup grace period...
2025-09-20T17:18:14: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T17:18:14: â„¹ï¸ [5:18:14 pm] INFO: Grace Period: STARTED {
2025-09-20T17:18:14:   action: 'STARTED',
2025-09-20T17:18:14:   remainingMs: 240000,
2025-09-20T17:18:14:   remainingSeconds: 240,
2025-09-20T17:18:14:   details: { startupTime: 1758368894150, processId: 22644 },
2025-09-20T17:18:14:   timestamp: 1758368894317
2025-09-20T17:18:14: }
2025-09-20T17:18:14: â„¹ï¸ [5:18:14 pm] INFO: Process isolation enforced {
2025-09-20T17:18:14:   lockFile: 'safety-data\\process.lock',
2025-09-20T17:18:14:   pidFile: 'safety-data\\process.pid',
2025-09-20T17:18:14:   processId: 22644
2025-09-20T17:18:14: }
2025-09-20T17:18:14: â° Starting 240 second startup grace period...
2025-09-20T17:18:14: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T17:18:14: â„¹ï¸ [5:18:14 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T17:18:14:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T17:18:14:   remainingMs: 240000,
2025-09-20T17:18:14:   remainingSeconds: 240,
2025-09-20T17:18:14:   details: { startupTime: 1758368894150, willExpireAt: 1758369134150 },
2025-09-20T17:18:14:   timestamp: 1758368894318
2025-09-20T17:18:14: }
2025-09-20T17:18:14: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T17:18:14: â° Startup grace period: 240 seconds
2025-09-20T17:18:14: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T17:18:14: â„¹ï¸ [5:18:14 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T17:18:14:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T17:18:14:   remainingMs: 240000,
2025-09-20T17:18:14:   remainingSeconds: 240,
2025-09-20T17:18:14:   details: { startupTime: 1758368894150, willExpireAt: 1758369134150 },
2025-09-20T17:18:14:   timestamp: 1758368894321
2025-09-20T17:18:14: }
2025-09-20T17:18:14: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T17:18:14: â° Startup grace period: 240 seconds
2025-09-20T17:18:14: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T17:18:14: â„¹ï¸ [5:18:14 pm] INFO: Grace Period: STARTED {
2025-09-20T17:18:14:   action: 'STARTED',
2025-09-20T17:18:14:   remainingMs: 240000,
2025-09-20T17:18:14:   remainingSeconds: 240,
2025-09-20T17:18:14:   details: { startupTime: 1758368894150, processId: 22644 },
2025-09-20T17:18:14:   timestamp: 1758368894320
2025-09-20T17:18:14: }
2025-09-20T17:18:14: â„¹ï¸ [5:18:14 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T17:18:14:   initializationDuration: 173,
2025-09-20T17:18:14:   gracePeriodActive: true,
2025-09-20T17:18:14:   messageRulesCount: 8,
2025-09-20T17:18:14:   messageTypes: [
2025-09-20T17:18:14:     'welcome',
2025-09-20T17:18:14:     'confirmation',
2025-09-20T17:18:14:     'ready',
2025-09-20T17:18:14:     'delivery',
2025-09-20T17:18:14:     'pickup_reminder',
2025-09-20T17:18:14:     'payment_reminder',
2025-09-20T17:18:14:     'fabric_welcome',
2025-09-20T17:18:14:     'fabric_purchase'
2025-09-20T17:18:14:   ],
2025-09-20T17:18:14:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T17:18:14:   databaseReady: true,
2025-09-20T17:18:14:   loggerReady: true,
2025-09-20T17:18:14:   processIsolationActive: true
2025-09-20T17:18:14: }
2025-09-20T17:18:14: âœ… Safety Manager initialized
2025-09-20T17:18:14: â„¹ï¸ [5:18:14 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T17:18:14:   initializationDuration: 176,
2025-09-20T17:18:14:   gracePeriodActive: true,
2025-09-20T17:18:14:   messageRulesCount: 8,
2025-09-20T17:18:14:   messageTypes: [
2025-09-20T17:18:14:     'welcome',
2025-09-20T17:18:14:     'confirmation',
2025-09-20T17:18:14:     'ready',
2025-09-20T17:18:14:     'delivery',
2025-09-20T17:18:14:     'pickup_reminder',
2025-09-20T17:18:14:     'payment_reminder',
2025-09-20T17:18:14:     'fabric_welcome',
2025-09-20T17:18:14:     'fabric_purchase'
2025-09-20T17:18:14:   ],
2025-09-20T17:18:14:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T17:18:14:   databaseReady: true,
2025-09-20T17:18:14:   loggerReady: true,
2025-09-20T17:18:14:   processIsolationActive: true
2025-09-20T17:18:14: }
2025-09-20T17:18:14: ğŸ“ Loaded 0 sent messages from file
2025-09-20T17:18:14: ğŸ“ Loaded 0 customer histories from file
2025-09-20T17:18:14: ğŸ“ Loaded 0 message hashes from file
2025-09-20T17:18:14: ğŸ“ Loaded statistics from file
2025-09-20T17:18:14: âœ… Duplicate Prevention Manager initialized
2025-09-20T17:18:14: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T17:18:14: âœ… Duplicate Prevention Manager initialized
2025-09-20T17:18:14: ğŸ”„ Starting WhatsApp connection...
2025-09-20T17:18:14: ğŸ”„ Initializing WhatsApp client...
2025-09-20T17:18:14: âœ… WhatsApp connection started
2025-09-20T17:18:14: ğŸ”§ Initializing admin commands...
2025-09-20T17:18:14: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T17:18:14: âœ… Admin commands system initialized
2025-09-20T17:18:14: ğŸ”„ Initializing polling functionality...
2025-09-20T17:18:14: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T17:18:14: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T17:18:14: ğŸ“ Attempting to request pairing code...
2025-09-20T17:18:14: ğŸ’¡ To use phone authentication:
2025-09-20T17:18:14:    1. Use the dashboard at http://localhost:3001
2025-09-20T17:18:14:    2. Select "Phone Number Authentication"
2025-09-20T17:18:14:    3. Enter your phone number
2025-09-20T17:18:14:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T17:18:14: ğŸ”„ Connecting to WhatsApp...
2025-09-20T17:18:16: âœ… WhatsApp connected successfully!
2025-09-20T17:18:16: ğŸ”„ Enhanced client: Connected event received, forwarding...
2025-09-20T17:18:16: ğŸ“± Session established successfully
2025-09-20T17:18:16: ğŸ”’ Session will be monitored for stability
2025-09-20T17:18:22: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:18:22: ğŸ“ Loaded 11 template types
2025-09-20T17:18:22: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T17:18:22: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T17:18:22: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T17:18:22: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758368902367] Starting comprehensive safety check...
2025-09-20T17:18:22: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758368902367] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T17:18:22: â„¹ï¸ [5:18:22 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:18:22:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:18:22:   phone: '919****706',
2025-09-20T17:18:22:   orderId: 'TJJ19092511',
2025-09-20T17:18:22:   messageType: 'confirmation',
2025-09-20T17:18:22:   result: 'STARTED',
2025-09-20T17:18:22:   details: {
2025-09-20T17:18:22:     checkId: '919953020706_TJJ19092511_confirmation_1758368902367',
2025-09-20T17:18:22:     hasOrderData: true,
2025-09-20T17:18:22:     hasSheetData: false,
2025-09-20T17:18:22:     messageLength: 469
2025-09-20T17:18:22:   },
2025-09-20T17:18:22:   timestamp: 1758368902367
2025-09-20T17:18:22: }
2025-09-20T17:18:22: ğŸ” [919953020706_TJJ19092511_confirmation_1758368902367] Step 1: Kill Switch Check
2025-09-20T17:18:22: ğŸ” [919953020706_TJJ19092511_confirmation_1758368902367] Step 1.5: Developer Phone Check
2025-09-20T17:18:22: ğŸ” [919953020706_TJJ19092511_confirmation_1758368902367] Step 2: Grace Period Check
2025-09-20T17:18:22: â„¹ï¸ [5:18:22 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:18:22:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:18:22:   remainingMs: 231781,
2025-09-20T17:18:22:   remainingSeconds: 232,
2025-09-20T17:18:22:   details: {
2025-09-20T17:18:22:     checkId: '919953020706_TJJ19092511_confirmation_1758368902367',
2025-09-20T17:18:22:     phone: '919953020706',
2025-09-20T17:18:22:     orderId: 'TJJ19092511',
2025-09-20T17:18:22:     messageType: 'confirmation'
2025-09-20T17:18:22:   },
2025-09-20T17:18:22:   timestamp: 1758368902369
2025-09-20T17:18:22: }
2025-09-20T17:18:22: âŒ [919953020706_TJJ19092511_confirmation_1758368902367] Startup grace period active (232s remaining)
2025-09-20T17:18:22: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T17:18:22: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T17:18:22: â„¹ï¸ [5:18:22 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T17:18:22:   phone: '919****706',
2025-09-20T17:18:22:   orderId: 'TJJ19092511',
2025-09-20T17:18:22:   messageType: 'confirmation',
2025-09-20T17:18:22:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:18:22:   reason: {
2025-09-20T17:18:22:     contentHash: '97026037ffec053e',
2025-09-20T17:18:22:     timestamp: 1758368902372,
2025-09-20T17:18:22:     messageLength: 469,
2025-09-20T17:18:22:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T17:18:22:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T17:18:22:   },
2025-09-20T17:18:22:   duration: 0,
2025-09-20T17:18:22:   timestamp: 1758368902383
2025-09-20T17:18:22: }
2025-09-20T17:18:22: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:18:22: ğŸ“ Loaded 11 template types
2025-09-20T17:18:22: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T17:18:22: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T17:18:22: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T17:18:22: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758368902385] Starting comprehensive safety check...
2025-09-20T17:18:22: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758368902385] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T17:18:22: â„¹ï¸ [5:18:22 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:18:22:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:18:22:   phone: '919****488',
2025-09-20T17:18:22:   orderId: 'TWM19092511',
2025-09-20T17:18:22:   messageType: 'confirmation',
2025-09-20T17:18:22:   result: 'STARTED',
2025-09-20T17:18:22:   details: {
2025-09-20T17:18:22:     checkId: '919358537488_TWM19092511_confirmation_1758368902385',
2025-09-20T17:18:22:     hasOrderData: true,
2025-09-20T17:18:22:     hasSheetData: false,
2025-09-20T17:18:22:     messageLength: 475
2025-09-20T17:18:22:   },
2025-09-20T17:18:22:   timestamp: 1758368902385
2025-09-20T17:18:22: }
2025-09-20T17:18:22: ğŸ” [919358537488_TWM19092511_confirmation_1758368902385] Step 1: Kill Switch Check
2025-09-20T17:18:22: ğŸ” [919358537488_TWM19092511_confirmation_1758368902385] Step 1.5: Developer Phone Check
2025-09-20T17:18:22: ğŸ” [919358537488_TWM19092511_confirmation_1758368902385] Step 2: Grace Period Check
2025-09-20T17:18:22: â„¹ï¸ [5:18:22 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:18:22:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:18:22:   remainingMs: 231763,
2025-09-20T17:18:22:   remainingSeconds: 232,
2025-09-20T17:18:22:   details: {
2025-09-20T17:18:22:     checkId: '919358537488_TWM19092511_confirmation_1758368902385',
2025-09-20T17:18:22:     phone: '919358537488',
2025-09-20T17:18:22:     orderId: 'TWM19092511',
2025-09-20T17:18:22:     messageType: 'confirmation'
2025-09-20T17:18:22:   },
2025-09-20T17:18:22:   timestamp: 1758368902387
2025-09-20T17:18:22: }
2025-09-20T17:18:22: âŒ [919358537488_TWM19092511_confirmation_1758368902385] Startup grace period active (232s remaining)
2025-09-20T17:18:22: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T17:18:22: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T17:18:22: â„¹ï¸ [5:18:22 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T17:18:22:   phone: '919****488',
2025-09-20T17:18:22:   orderId: 'TWM19092511',
2025-09-20T17:18:22:   messageType: 'confirmation',
2025-09-20T17:18:22:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:18:22:   reason: {
2025-09-20T17:18:22:     contentHash: 'e34d023f065922da',
2025-09-20T17:18:22:     timestamp: 1758368902389,
2025-09-20T17:18:22:     messageLength: 475,
2025-09-20T17:18:22:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T17:18:22:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T17:18:22:   },
2025-09-20T17:18:22:   duration: 0,
2025-09-20T17:18:22:   timestamp: 1758368902400
2025-09-20T17:18:22: }
2025-09-20T17:18:22: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:18:22: ğŸ“ Loaded 11 template types
2025-09-20T17:18:22: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T17:18:22: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T17:18:22: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T17:18:22: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758368902402] Starting comprehensive safety check...
2025-09-20T17:18:22: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758368902402] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T17:18:22: â„¹ï¸ [5:18:22 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:18:22:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:18:22:   phone: '918****811',
2025-09-20T17:18:22:   orderId: 'TOF19092511',
2025-09-20T17:18:22:   messageType: 'confirmation',
2025-09-20T17:18:22:   result: 'STARTED',
2025-09-20T17:18:22:   details: {
2025-09-20T17:18:22:     checkId: '918890134811_TOF19092511_confirmation_1758368902402',
2025-09-20T17:18:22:     hasOrderData: true,
2025-09-20T17:18:22:     hasSheetData: false,
2025-09-20T17:18:22:     messageLength: 473
2025-09-20T17:18:22:   },
2025-09-20T17:18:22:   timestamp: 1758368902402
2025-09-20T17:18:22: }
2025-09-20T17:18:22: ğŸ” [918890134811_TOF19092511_confirmation_1758368902402] Step 1: Kill Switch Check
2025-09-20T17:18:22: ğŸ” [918890134811_TOF19092511_confirmation_1758368902402] Step 1.5: Developer Phone Check
2025-09-20T17:18:22: ğŸ” [918890134811_TOF19092511_confirmation_1758368902402] Step 2: Grace Period Check
2025-09-20T17:18:22: â„¹ï¸ [5:18:22 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:18:22:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:18:22:   remainingMs: 231745,
2025-09-20T17:18:22:   remainingSeconds: 232,
2025-09-20T17:18:22:   details: {
2025-09-20T17:18:22:     checkId: '918890134811_TOF19092511_confirmation_1758368902402',
2025-09-20T17:18:22:     phone: '918890134811',
2025-09-20T17:18:22:     orderId: 'TOF19092511',
2025-09-20T17:18:22:     messageType: 'confirmation'
2025-09-20T17:18:22:   },
2025-09-20T17:18:22:   timestamp: 1758368902405
2025-09-20T17:18:22: }
2025-09-20T17:18:22: âŒ [918890134811_TOF19092511_confirmation_1758368902402] Startup grace period active (232s remaining)
2025-09-20T17:18:22: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T17:18:22: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T17:18:22: â„¹ï¸ [5:18:22 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T17:18:22:   phone: '918****811',
2025-09-20T17:18:22:   orderId: 'TOF19092511',
2025-09-20T17:18:22:   messageType: 'confirmation',
2025-09-20T17:18:22:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:18:22:   reason: {
2025-09-20T17:18:22:     contentHash: '388fbe812e19f1de',
2025-09-20T17:18:22:     timestamp: 1758368902407,
2025-09-20T17:18:22:     messageLength: 473,
2025-09-20T17:18:22:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T17:18:22:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T17:18:22:   },
2025-09-20T17:18:22:   duration: 0,
2025-09-20T17:18:22:   timestamp: 1758368902418
2025-09-20T17:18:22: }
2025-09-20T17:18:44: ğŸ’¾ Data synced to files successfully
2025-09-20T17:19:14: ğŸ’¾ Data synced to files successfully
2025-09-20T17:19:44: ğŸ’¾ Data synced to files successfully
2025-09-20T17:20:14: ğŸ’¾ Data synced to files successfully
2025-09-20T17:20:44: ğŸ’¾ Data synced to files successfully
2025-09-20T17:21:14: ğŸ’¾ Data synced to files successfully
2025-09-20T17:21:22: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:21:22: ğŸ“ Loaded 11 template types
2025-09-20T17:21:22: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T17:21:22: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T17:21:22: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T17:21:22: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758369082344] Starting comprehensive safety check...
2025-09-20T17:21:22: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758369082344] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T17:21:22: â„¹ï¸ [5:21:22 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:21:22:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:21:22:   phone: '919****706',
2025-09-20T17:21:22:   orderId: 'TJJ19092511',
2025-09-20T17:21:22:   messageType: 'confirmation',
2025-09-20T17:21:22:   result: 'STARTED',
2025-09-20T17:21:22:   details: {
2025-09-20T17:21:22:     checkId: '919953020706_TJJ19092511_confirmation_1758369082344',
2025-09-20T17:21:22:     hasOrderData: true,
2025-09-20T17:21:22:     hasSheetData: false,
2025-09-20T17:21:22:     messageLength: 469
2025-09-20T17:21:22:   },
2025-09-20T17:21:22:   timestamp: 1758369082345
2025-09-20T17:21:22: }
2025-09-20T17:21:22: ğŸ” [919953020706_TJJ19092511_confirmation_1758369082344] Step 1: Kill Switch Check
2025-09-20T17:21:22: ğŸ” [919953020706_TJJ19092511_confirmation_1758369082344] Step 1.5: Developer Phone Check
2025-09-20T17:21:22: ğŸ” [919953020706_TJJ19092511_confirmation_1758369082344] Step 2: Grace Period Check
2025-09-20T17:21:22: â„¹ï¸ [5:21:22 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:21:22:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:21:22:   remainingMs: 51800,
2025-09-20T17:21:22:   remainingSeconds: 52,
2025-09-20T17:21:22:   details: {
2025-09-20T17:21:22:     checkId: '919953020706_TJJ19092511_confirmation_1758369082344',
2025-09-20T17:21:22:     phone: '919953020706',
2025-09-20T17:21:22:     orderId: 'TJJ19092511',
2025-09-20T17:21:22:     messageType: 'confirmation'
2025-09-20T17:21:22:   },
2025-09-20T17:21:22:   timestamp: 1758369082350
2025-09-20T17:21:22: }
2025-09-20T17:21:22: âŒ [919953020706_TJJ19092511_confirmation_1758369082344] Startup grace period active (52s remaining)
2025-09-20T17:21:22: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Startup grace period active (52s remaining)
2025-09-20T17:21:22: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T17:21:22: â„¹ï¸ [5:21:22 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T17:21:22:   phone: '919****706',
2025-09-20T17:21:22:   orderId: 'TJJ19092511',
2025-09-20T17:21:22:   messageType: 'confirmation',
2025-09-20T17:21:22:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:21:22:   reason: {
2025-09-20T17:21:22:     contentHash: '97026037ffec053e',
2025-09-20T17:21:22:     timestamp: 1758369082356,
2025-09-20T17:21:22:     messageLength: 469,
2025-09-20T17:21:22:     errorMessage: 'Startup grace period active (52s remaining)',
2025-09-20T17:21:22:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T17:21:22:   },
2025-09-20T17:21:22:   duration: 0,
2025-09-20T17:21:22:   timestamp: 1758369082372
2025-09-20T17:21:22: }
2025-09-20T17:21:22: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:21:22: ğŸ“ Loaded 11 template types
2025-09-20T17:21:22: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T17:21:22: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T17:21:22: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T17:21:22: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758369082377] Starting comprehensive safety check...
2025-09-20T17:21:22: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758369082377] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T17:21:22: â„¹ï¸ [5:21:22 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:21:22:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:21:22:   phone: '919****488',
2025-09-20T17:21:22:   orderId: 'TWM19092511',
2025-09-20T17:21:22:   messageType: 'confirmation',
2025-09-20T17:21:22:   result: 'STARTED',
2025-09-20T17:21:22:   details: {
2025-09-20T17:21:22:     checkId: '919358537488_TWM19092511_confirmation_1758369082377',
2025-09-20T17:21:22:     hasOrderData: true,
2025-09-20T17:21:22:     hasSheetData: false,
2025-09-20T17:21:22:     messageLength: 475
2025-09-20T17:21:22:   },
2025-09-20T17:21:22:   timestamp: 1758369082377
2025-09-20T17:21:22: }
2025-09-20T17:21:22: ğŸ” [919358537488_TWM19092511_confirmation_1758369082377] Step 1: Kill Switch Check
2025-09-20T17:21:22: ğŸ” [919358537488_TWM19092511_confirmation_1758369082377] Step 1.5: Developer Phone Check
2025-09-20T17:21:22: ğŸ” [919358537488_TWM19092511_confirmation_1758369082377] Step 2: Grace Period Check
2025-09-20T17:21:22: â„¹ï¸ [5:21:22 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:21:22:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:21:22:   remainingMs: 51767,
2025-09-20T17:21:22:   remainingSeconds: 52,
2025-09-20T17:21:22:   details: {
2025-09-20T17:21:22:     checkId: '919358537488_TWM19092511_confirmation_1758369082377',
2025-09-20T17:21:22:     phone: '919358537488',
2025-09-20T17:21:22:     orderId: 'TWM19092511',
2025-09-20T17:21:22:     messageType: 'confirmation'
2025-09-20T17:21:22:   },
2025-09-20T17:21:22:   timestamp: 1758369082383
2025-09-20T17:21:22: }
2025-09-20T17:21:22: âŒ [919358537488_TWM19092511_confirmation_1758369082377] Startup grace period active (52s remaining)
2025-09-20T17:21:22: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Startup grace period active (52s remaining)
2025-09-20T17:21:22: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T17:21:22: â„¹ï¸ [5:21:22 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T17:21:22:   phone: '919****488',
2025-09-20T17:21:22:   orderId: 'TWM19092511',
2025-09-20T17:21:22:   messageType: 'confirmation',
2025-09-20T17:21:22:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:21:22:   reason: {
2025-09-20T17:21:22:     contentHash: 'e34d023f065922da',
2025-09-20T17:21:22:     timestamp: 1758369082387,
2025-09-20T17:21:22:     messageLength: 475,
2025-09-20T17:21:22:     errorMessage: 'Startup grace period active (52s remaining)',
2025-09-20T17:21:22:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T17:21:22:   },
2025-09-20T17:21:22:   duration: 0,
2025-09-20T17:21:22:   timestamp: 1758369082411
2025-09-20T17:21:22: }
2025-09-20T17:21:22: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:21:22: ğŸ“ Loaded 11 template types
2025-09-20T17:21:22: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T17:21:22: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T17:21:22: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T17:21:22: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758369082419] Starting comprehensive safety check...
2025-09-20T17:21:22: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758369082419] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T17:21:22: â„¹ï¸ [5:21:22 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:21:22:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:21:22:   phone: '918****811',
2025-09-20T17:21:22:   orderId: 'TOF19092511',
2025-09-20T17:21:22:   messageType: 'confirmation',
2025-09-20T17:21:22:   result: 'STARTED',
2025-09-20T17:21:22:   details: {
2025-09-20T17:21:22:     checkId: '918890134811_TOF19092511_confirmation_1758369082419',
2025-09-20T17:21:22:     hasOrderData: true,
2025-09-20T17:21:22:     hasSheetData: false,
2025-09-20T17:21:22:     messageLength: 473
2025-09-20T17:21:22:   },
2025-09-20T17:21:22:   timestamp: 1758369082419
2025-09-20T17:21:22: }
2025-09-20T17:21:22: ğŸ” [918890134811_TOF19092511_confirmation_1758369082419] Step 1: Kill Switch Check
2025-09-20T17:21:22: ğŸ” [918890134811_TOF19092511_confirmation_1758369082419] Step 1.5: Developer Phone Check
2025-09-20T17:21:22: ğŸ” [918890134811_TOF19092511_confirmation_1758369082419] Step 2: Grace Period Check
2025-09-20T17:21:22: â„¹ï¸ [5:21:22 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:21:22:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:21:22:   remainingMs: 51726,
2025-09-20T17:21:22:   remainingSeconds: 52,
2025-09-20T17:21:22:   details: {
2025-09-20T17:21:22:     checkId: '918890134811_TOF19092511_confirmation_1758369082419',
2025-09-20T17:21:22:     phone: '918890134811',
2025-09-20T17:21:22:     orderId: 'TOF19092511',
2025-09-20T17:21:22:     messageType: 'confirmation'
2025-09-20T17:21:22:   },
2025-09-20T17:21:22:   timestamp: 1758369082424
2025-09-20T17:21:22: }
2025-09-20T17:21:22: âŒ [918890134811_TOF19092511_confirmation_1758369082419] Startup grace period active (52s remaining)
2025-09-20T17:21:22: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (52s remaining)
2025-09-20T17:21:22: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T17:21:22: â„¹ï¸ [5:21:22 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T17:21:22:   phone: '918****811',
2025-09-20T17:21:22:   orderId: 'TOF19092511',
2025-09-20T17:21:22:   messageType: 'confirmation',
2025-09-20T17:21:22:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:21:22:   reason: {
2025-09-20T17:21:22:     contentHash: '388fbe812e19f1de',
2025-09-20T17:21:22:     timestamp: 1758369082438,
2025-09-20T17:21:22:     messageLength: 473,
2025-09-20T17:21:22:     errorMessage: 'Startup grace period active (52s remaining)',
2025-09-20T17:21:22:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T17:21:22:   },
2025-09-20T17:21:22:   duration: 0,
2025-09-20T17:21:22:   timestamp: 1758369082474
2025-09-20T17:21:22: }
2025-09-20T17:21:44: ğŸ’¾ Data synced to files successfully
2025-09-20T17:22:14: âœ… Startup grace period ended - message sending now allowed
2025-09-20T17:22:14: âœ… Startup grace period ended - message sending now allowed
2025-09-20T17:22:14: â„¹ï¸ [5:22:14 pm] INFO: Grace Period: ENDED {
2025-09-20T17:22:14:   action: 'ENDED',
2025-09-20T17:22:14:   remainingMs: 0,
2025-09-20T17:22:14:   remainingSeconds: 0,
2025-09-20T17:22:14:   details: { totalDuration: 240000, processId: 22644 },
2025-09-20T17:22:14:   timestamp: 1758369134329
2025-09-20T17:22:14: }
2025-09-20T17:22:14: â„¹ï¸ [5:22:14 pm] INFO: Grace Period: ENDED {
2025-09-20T17:22:14:   action: 'ENDED',
2025-09-20T17:22:14:   remainingMs: 0,
2025-09-20T17:22:14:   remainingSeconds: 0,
2025-09-20T17:22:14:   details: { totalDuration: 240000, processId: 22644 },
2025-09-20T17:22:14:   timestamp: 1758369134331
2025-09-20T17:22:14: }
2025-09-20T17:22:14: ğŸ’¾ Data synced to files successfully
2025-09-20T17:22:14: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T17:22:14: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T17:22:44: ğŸ’¾ Data synced to files successfully
2025-09-20T17:23:07: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:23:07: ğŸ“ Loaded 11 template types
2025-09-20T17:23:07: ğŸ”§ WhatsApp Bot initialized
2025-09-20T17:23:07: ğŸ“Š Configuration status: undefined
2025-09-20T17:23:07: âœ… Atomic State Manager initialized
2025-09-20T17:23:07: ğŸ“ Enhanced Logger initialized
2025-09-20T17:23:07: âœ… Google credentials loaded from service-account.json file
2025-09-20T17:23:07: ğŸ“± WhatsApp auth status: âœ… credentials, 4 session files
2025-09-20T17:23:07: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-20T17:23:07:    Auth Mode: both
2025-09-20T17:23:07:    QR Enabled: true
2025-09-20T17:23:07:    Phone Enabled: true
2025-09-20T17:23:07:    Session Persistence: true
2025-09-20T17:23:07:    Max Reconnect Attempts: 10
2025-09-20T17:23:07:    Default Phone: None
2025-09-20T17:23:07: ğŸ”’ Session validation enabled (check every 300s)
2025-09-20T17:23:07: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-20T17:23:07: ğŸ”§ Developer Configuration initialized
2025-09-20T17:23:07: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T17:23:07: â„¹ï¸ [5:23:07 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T17:23:07:   startupTime: 1758369187659,
2025-09-20T17:23:07:   gracePeriodMs: 240000,
2025-09-20T17:23:07:   dataDir: './safety-data',
2025-09-20T17:23:07:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T17:23:07:   processId: 19880,
2025-09-20T17:23:07:   nodeVersion: 'v22.19.0'
2025-09-20T17:23:07: }
2025-09-20T17:23:07: ğŸ”§ Developer Configuration initialized
2025-09-20T17:23:07: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T17:23:07: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-20T17:23:07: â° 4-minute startup delay active
2025-09-20T17:23:07: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-20T17:23:07: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-20T17:23:07: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T17:23:07: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T17:23:07: âœ… Google Sheets API initialized
2025-09-20T17:23:07: âœ… Google Sheets API initialized
2025-09-20T17:23:07: â„¹ï¸ [5:23:07 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T17:23:07:   startupTime: 1758369187659,
2025-09-20T17:23:07:   gracePeriodMs: 240000,
2025-09-20T17:23:07:   dataDir: './safety-data',
2025-09-20T17:23:07:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T17:23:07:   processId: 19880,
2025-09-20T17:23:07:   nodeVersion: 'v22.19.0'
2025-09-20T17:23:07: }
2025-09-20T17:23:07: ğŸ“ Loaded 0 sent messages from file
2025-09-20T17:23:07: â„¹ï¸ [5:23:07 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T17:23:07: â„¹ï¸ [5:23:07 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T17:23:07: ğŸ“ Loaded 0 customer histories from file
2025-09-20T17:23:07: ğŸ“ Loaded 0 message hashes from file
2025-09-20T17:23:07: â„¹ï¸ [5:23:07 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T17:23:07: â„¹ï¸ [5:23:07 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T17:23:07: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T10-13-58-919Z.log
2025-09-20T17:23:07: ğŸ“ Enhanced Logger initialized
2025-09-20T17:23:07: ğŸ“ Loaded statistics from file
2025-09-20T17:23:07: âœ… Duplicate Prevention Manager initialized
2025-09-20T17:23:07: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T17:23:07: ğŸ§¹ Lock file already cleaned up
2025-09-20T17:23:07: ğŸ§¹ Removed stale process lock
2025-09-20T17:23:07: ğŸ”’ Process lock acquired (PID: 19880)
2025-09-20T17:23:07: ğŸ”’ Process lock acquired (PID: 19880)
2025-09-20T17:23:07: â„¹ï¸ [5:23:07 pm] INFO: Process isolation enforced {
2025-09-20T17:23:07:   lockFile: 'safety-data\\process.lock',
2025-09-20T17:23:07:   pidFile: 'safety-data\\process.pid',
2025-09-20T17:23:07:   processId: 19880
2025-09-20T17:23:07: }
2025-09-20T17:23:07: â° Starting 240 second startup grace period...
2025-09-20T17:23:07: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T17:23:07: â„¹ï¸ [5:23:07 pm] INFO: Process isolation enforced {
2025-09-20T17:23:07:   lockFile: 'safety-data\\process.lock',
2025-09-20T17:23:07:   pidFile: 'safety-data\\process.pid',
2025-09-20T17:23:07:   processId: 19880
2025-09-20T17:23:07: }
2025-09-20T17:23:07: â° Starting 240 second startup grace period...
2025-09-20T17:23:07: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T17:23:07: â„¹ï¸ [5:23:07 pm] INFO: Grace Period: STARTED {
2025-09-20T17:23:07:   action: 'STARTED',
2025-09-20T17:23:07:   remainingMs: 240000,
2025-09-20T17:23:07:   remainingSeconds: 240,
2025-09-20T17:23:07:   details: { startupTime: 1758369187659, processId: 19880 },
2025-09-20T17:23:07:   timestamp: 1758369187725
2025-09-20T17:23:07: }
2025-09-20T17:23:07: â„¹ï¸ [5:23:07 pm] INFO: Grace Period: STARTED {
2025-09-20T17:23:07:   action: 'STARTED',
2025-09-20T17:23:07:   remainingMs: 240000,
2025-09-20T17:23:07:   remainingSeconds: 240,
2025-09-20T17:23:07:   details: { startupTime: 1758369187659, processId: 19880 },
2025-09-20T17:23:07:   timestamp: 1758369187727
2025-09-20T17:23:07: }
2025-09-20T17:23:07: â„¹ï¸ [5:23:07 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T17:23:07:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T17:23:07:   remainingMs: 240000,
2025-09-20T17:23:07:   remainingSeconds: 240,
2025-09-20T17:23:07:   details: { startupTime: 1758369187659, willExpireAt: 1758369427659 },
2025-09-20T17:23:07:   timestamp: 1758369187725
2025-09-20T17:23:07: }
2025-09-20T17:23:07: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T17:23:07: â° Startup grace period: 240 seconds
2025-09-20T17:23:07: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T17:23:07: â„¹ï¸ [5:23:07 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T17:23:07:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T17:23:07:   remainingMs: 240000,
2025-09-20T17:23:07:   remainingSeconds: 240,
2025-09-20T17:23:07:   details: { startupTime: 1758369187659, willExpireAt: 1758369427659 },
2025-09-20T17:23:07:   timestamp: 1758369187727
2025-09-20T17:23:07: }
2025-09-20T17:23:07: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T17:23:07: â° Startup grace period: 240 seconds
2025-09-20T17:23:07: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T17:23:07: â„¹ï¸ [5:23:07 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T17:23:07:   initializationDuration: 71,
2025-09-20T17:23:07:   gracePeriodActive: true,
2025-09-20T17:23:07:   messageRulesCount: 8,
2025-09-20T17:23:07:   messageTypes: [
2025-09-20T17:23:07:     'welcome',
2025-09-20T17:23:07:     'confirmation',
2025-09-20T17:23:07:     'ready',
2025-09-20T17:23:07:     'delivery',
2025-09-20T17:23:07:     'pickup_reminder',
2025-09-20T17:23:07:     'payment_reminder',
2025-09-20T17:23:07:     'fabric_welcome',
2025-09-20T17:23:07:     'fabric_purchase'
2025-09-20T17:23:07:   ],
2025-09-20T17:23:07:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T17:23:07:   databaseReady: true,
2025-09-20T17:23:07:   loggerReady: true,
2025-09-20T17:23:07:   processIsolationActive: true
2025-09-20T17:23:07: }
2025-09-20T17:23:07: âœ… Safety Manager initialized
2025-09-20T17:23:07: â„¹ï¸ [5:23:07 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T17:23:07:   initializationDuration: 72,
2025-09-20T17:23:07:   gracePeriodActive: true,
2025-09-20T17:23:07:   messageRulesCount: 8,
2025-09-20T17:23:07:   messageTypes: [
2025-09-20T17:23:07:     'welcome',
2025-09-20T17:23:07:     'confirmation',
2025-09-20T17:23:07:     'ready',
2025-09-20T17:23:07:     'delivery',
2025-09-20T17:23:07:     'pickup_reminder',
2025-09-20T17:23:07:     'payment_reminder',
2025-09-20T17:23:07:     'fabric_welcome',
2025-09-20T17:23:07:     'fabric_purchase'
2025-09-20T17:23:07:   ],
2025-09-20T17:23:07:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T17:23:07:   databaseReady: true,
2025-09-20T17:23:07:   loggerReady: true,
2025-09-20T17:23:07:   processIsolationActive: true
2025-09-20T17:23:07: }
2025-09-20T17:23:07: ğŸ“ Loaded 0 sent messages from file
2025-09-20T17:23:07: ğŸ“ Loaded 0 customer histories from file
2025-09-20T17:23:07: ğŸ“ Loaded 0 message hashes from file
2025-09-20T17:23:07: ğŸ“ Loaded statistics from file
2025-09-20T17:23:07: âœ… Duplicate Prevention Manager initialized
2025-09-20T17:23:07: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T17:23:07: âœ… Duplicate Prevention Manager initialized
2025-09-20T17:23:07: ğŸ”„ Starting WhatsApp connection...
2025-09-20T17:23:07: ğŸ”„ Initializing WhatsApp client...
2025-09-20T17:23:07: âœ… WhatsApp connection started
2025-09-20T17:23:07: ğŸ”§ Initializing admin commands...
2025-09-20T17:23:07: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T17:23:07: âœ… Admin commands system initialized
2025-09-20T17:23:07: ğŸ”„ Initializing polling functionality...
2025-09-20T17:23:07: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T17:23:07: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T17:23:07: ğŸ“ Attempting to request pairing code...
2025-09-20T17:23:07: ğŸ’¡ To use phone authentication:
2025-09-20T17:23:07:    1. Use the dashboard at http://localhost:3001
2025-09-20T17:23:07:    2. Select "Phone Number Authentication"
2025-09-20T17:23:07:    3. Enter your phone number
2025-09-20T17:23:07:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T17:23:07: ğŸ”„ Connecting to WhatsApp...
2025-09-20T17:23:09: âœ… WhatsApp connected successfully!
2025-09-20T17:23:09: ğŸ”„ Enhanced client: Connected event received, forwarding...
2025-09-20T17:23:09: ğŸ“± Session established successfully
2025-09-20T17:23:09: ğŸ”’ Session will be monitored for stability
2025-09-20T17:23:15: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:23:15: ğŸ“ Loaded 11 template types
2025-09-20T17:23:15: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T17:23:15: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T17:23:15: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T17:23:15: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758369195791] Starting comprehensive safety check...
2025-09-20T17:23:15: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758369195791] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T17:23:15: â„¹ï¸ [5:23:15 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:23:15:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:23:15:   phone: '919****706',
2025-09-20T17:23:15:   orderId: 'TJJ19092511',
2025-09-20T17:23:15:   messageType: 'confirmation',
2025-09-20T17:23:15:   result: 'STARTED',
2025-09-20T17:23:15:   details: {
2025-09-20T17:23:15:     checkId: '919953020706_TJJ19092511_confirmation_1758369195791',
2025-09-20T17:23:15:     hasOrderData: true,
2025-09-20T17:23:15:     hasSheetData: false,
2025-09-20T17:23:15:     messageLength: 469
2025-09-20T17:23:15:   },
2025-09-20T17:23:15:   timestamp: 1758369195792
2025-09-20T17:23:15: }
2025-09-20T17:23:15: ğŸ” [919953020706_TJJ19092511_confirmation_1758369195791] Step 1: Kill Switch Check
2025-09-20T17:23:15: ğŸ” [919953020706_TJJ19092511_confirmation_1758369195791] Step 1.5: Developer Phone Check
2025-09-20T17:23:15: ğŸ” [919953020706_TJJ19092511_confirmation_1758369195791] Step 2: Grace Period Check
2025-09-20T17:23:15: â„¹ï¸ [5:23:15 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:23:15:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:23:15:   remainingMs: 231866,
2025-09-20T17:23:15:   remainingSeconds: 232,
2025-09-20T17:23:15:   details: {
2025-09-20T17:23:15:     checkId: '919953020706_TJJ19092511_confirmation_1758369195791',
2025-09-20T17:23:15:     phone: '919953020706',
2025-09-20T17:23:15:     orderId: 'TJJ19092511',
2025-09-20T17:23:15:     messageType: 'confirmation'
2025-09-20T17:23:15:   },
2025-09-20T17:23:15:   timestamp: 1758369195793
2025-09-20T17:23:15: }
2025-09-20T17:23:15: âŒ [919953020706_TJJ19092511_confirmation_1758369195791] Startup grace period active (232s remaining)
2025-09-20T17:23:15: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T17:23:15: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T17:23:15: â„¹ï¸ [5:23:15 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T17:23:15:   phone: '919****706',
2025-09-20T17:23:15:   orderId: 'TJJ19092511',
2025-09-20T17:23:15:   messageType: 'confirmation',
2025-09-20T17:23:15:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:23:15:   reason: {
2025-09-20T17:23:15:     contentHash: '97026037ffec053e',
2025-09-20T17:23:15:     timestamp: 1758369195795,
2025-09-20T17:23:15:     messageLength: 469,
2025-09-20T17:23:15:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T17:23:15:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T17:23:15:   },
2025-09-20T17:23:15:   duration: 0,
2025-09-20T17:23:15:   timestamp: 1758369195810
2025-09-20T17:23:15: }
2025-09-20T17:23:15: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:23:15: ğŸ“ Loaded 11 template types
2025-09-20T17:23:15: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T17:23:15: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T17:23:15: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T17:23:15: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758369195812] Starting comprehensive safety check...
2025-09-20T17:23:15: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758369195812] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T17:23:15: â„¹ï¸ [5:23:15 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:23:15:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:23:15:   phone: '919****488',
2025-09-20T17:23:15:   orderId: 'TWM19092511',
2025-09-20T17:23:15:   messageType: 'confirmation',
2025-09-20T17:23:15:   result: 'STARTED',
2025-09-20T17:23:15:   details: {
2025-09-20T17:23:15:     checkId: '919358537488_TWM19092511_confirmation_1758369195812',
2025-09-20T17:23:15:     hasOrderData: true,
2025-09-20T17:23:15:     hasSheetData: false,
2025-09-20T17:23:15:     messageLength: 475
2025-09-20T17:23:15:   },
2025-09-20T17:23:15:   timestamp: 1758369195812
2025-09-20T17:23:15: }
2025-09-20T17:23:15: ğŸ” [919358537488_TWM19092511_confirmation_1758369195812] Step 1: Kill Switch Check
2025-09-20T17:23:15: ğŸ” [919358537488_TWM19092511_confirmation_1758369195812] Step 1.5: Developer Phone Check
2025-09-20T17:23:15: ğŸ” [919358537488_TWM19092511_confirmation_1758369195812] Step 2: Grace Period Check
2025-09-20T17:23:15: â„¹ï¸ [5:23:15 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:23:15:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:23:15:   remainingMs: 231846,
2025-09-20T17:23:15:   remainingSeconds: 232,
2025-09-20T17:23:15:   details: {
2025-09-20T17:23:15:     checkId: '919358537488_TWM19092511_confirmation_1758369195812',
2025-09-20T17:23:15:     phone: '919358537488',
2025-09-20T17:23:15:     orderId: 'TWM19092511',
2025-09-20T17:23:15:     messageType: 'confirmation'
2025-09-20T17:23:15:   },
2025-09-20T17:23:15:   timestamp: 1758369195813
2025-09-20T17:23:15: }
2025-09-20T17:23:15: âŒ [919358537488_TWM19092511_confirmation_1758369195812] Startup grace period active (232s remaining)
2025-09-20T17:23:15: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T17:23:15: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T17:23:15: â„¹ï¸ [5:23:15 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T17:23:15:   phone: '919****488',
2025-09-20T17:23:15:   orderId: 'TWM19092511',
2025-09-20T17:23:15:   messageType: 'confirmation',
2025-09-20T17:23:15:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:23:15:   reason: {
2025-09-20T17:23:15:     contentHash: 'e34d023f065922da',
2025-09-20T17:23:15:     timestamp: 1758369195814,
2025-09-20T17:23:15:     messageLength: 475,
2025-09-20T17:23:15:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T17:23:15:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T17:23:15:   },
2025-09-20T17:23:15:   duration: 0,
2025-09-20T17:23:15:   timestamp: 1758369195827
2025-09-20T17:23:15: }
2025-09-20T17:23:15: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:23:15: ğŸ“ Loaded 11 template types
2025-09-20T17:23:15: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T17:23:15: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T17:23:15: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T17:23:15: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758369195828] Starting comprehensive safety check...
2025-09-20T17:23:15: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758369195828] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T17:23:15: â„¹ï¸ [5:23:15 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:23:15:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:23:15:   phone: '918****811',
2025-09-20T17:23:15:   orderId: 'TOF19092511',
2025-09-20T17:23:15:   messageType: 'confirmation',
2025-09-20T17:23:15:   result: 'STARTED',
2025-09-20T17:23:15:   details: {
2025-09-20T17:23:15:     checkId: '918890134811_TOF19092511_confirmation_1758369195828',
2025-09-20T17:23:15:     hasOrderData: true,
2025-09-20T17:23:15:     hasSheetData: false,
2025-09-20T17:23:15:     messageLength: 473
2025-09-20T17:23:15:   },
2025-09-20T17:23:15:   timestamp: 1758369195829
2025-09-20T17:23:15: }
2025-09-20T17:23:15: ğŸ” [918890134811_TOF19092511_confirmation_1758369195828] Step 1: Kill Switch Check
2025-09-20T17:23:15: ğŸ” [918890134811_TOF19092511_confirmation_1758369195828] Step 1.5: Developer Phone Check
2025-09-20T17:23:15: ğŸ” [918890134811_TOF19092511_confirmation_1758369195828] Step 2: Grace Period Check
2025-09-20T17:23:15: â„¹ï¸ [5:23:15 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:23:15:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:23:15:   remainingMs: 231829,
2025-09-20T17:23:15:   remainingSeconds: 232,
2025-09-20T17:23:15:   details: {
2025-09-20T17:23:15:     checkId: '918890134811_TOF19092511_confirmation_1758369195828',
2025-09-20T17:23:15:     phone: '918890134811',
2025-09-20T17:23:15:     orderId: 'TOF19092511',
2025-09-20T17:23:15:     messageType: 'confirmation'
2025-09-20T17:23:15:   },
2025-09-20T17:23:15:   timestamp: 1758369195830
2025-09-20T17:23:15: }
2025-09-20T17:23:15: âŒ [918890134811_TOF19092511_confirmation_1758369195828] Startup grace period active (232s remaining)
2025-09-20T17:23:15: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T17:23:15: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T17:23:15: â„¹ï¸ [5:23:15 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T17:23:15:   phone: '918****811',
2025-09-20T17:23:15:   orderId: 'TOF19092511',
2025-09-20T17:23:15:   messageType: 'confirmation',
2025-09-20T17:23:15:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:23:15:   reason: {
2025-09-20T17:23:15:     contentHash: '388fbe812e19f1de',
2025-09-20T17:23:15:     timestamp: 1758369195831,
2025-09-20T17:23:15:     messageLength: 473,
2025-09-20T17:23:15:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T17:23:15:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T17:23:15:   },
2025-09-20T17:23:15:   duration: 0,
2025-09-20T17:23:15:   timestamp: 1758369195843
2025-09-20T17:23:15: }
2025-09-20T17:23:37: ğŸ’¾ Data synced to files successfully
2025-09-20T17:24:07: ğŸ’¾ Data synced to files successfully
2025-09-20T17:24:37: ğŸ’¾ Data synced to files successfully
2025-09-20T17:26:00: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:26:00: ğŸ“ Loaded 11 template types
2025-09-20T17:26:00: ğŸ”§ WhatsApp Bot initialized
2025-09-20T17:26:00: ğŸ“Š Configuration status: undefined
2025-09-20T17:26:00: âœ… Atomic State Manager initialized
2025-09-20T17:26:00: ğŸ“ Enhanced Logger initialized
2025-09-20T17:26:00: âœ… Google credentials loaded from service-account.json file
2025-09-20T17:26:00: ğŸ“± WhatsApp auth status: âœ… credentials, 4 session files
2025-09-20T17:26:00: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-20T17:26:00:    Auth Mode: both
2025-09-20T17:26:00:    QR Enabled: true
2025-09-20T17:26:00:    Phone Enabled: true
2025-09-20T17:26:00:    Session Persistence: true
2025-09-20T17:26:00:    Max Reconnect Attempts: 10
2025-09-20T17:26:00:    Default Phone: None
2025-09-20T17:26:00: ğŸ”’ Session validation enabled (check every 300s)
2025-09-20T17:26:00: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-20T17:26:00: ğŸ”§ Developer Configuration initialized
2025-09-20T17:26:00: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T17:26:00: â„¹ï¸ [5:26:00 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T17:26:00:   startupTime: 1758369360482,
2025-09-20T17:26:00:   gracePeriodMs: 240000,
2025-09-20T17:26:00:   dataDir: './safety-data',
2025-09-20T17:26:00:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T17:26:00:   processId: 8664,
2025-09-20T17:26:00:   nodeVersion: 'v22.19.0'
2025-09-20T17:26:00: }
2025-09-20T17:26:00: ğŸ”§ Developer Configuration initialized
2025-09-20T17:26:00: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T17:26:00: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-20T17:26:00: â° 4-minute startup delay active
2025-09-20T17:26:00: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-20T17:26:00: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-20T17:26:00: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T17:26:00: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T17:26:00: âœ… Google Sheets API initialized
2025-09-20T17:26:00: âœ… Google Sheets API initialized
2025-09-20T17:26:00: â„¹ï¸ [5:26:00 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T17:26:00:   startupTime: 1758369360482,
2025-09-20T17:26:00:   gracePeriodMs: 240000,
2025-09-20T17:26:00:   dataDir: './safety-data',
2025-09-20T17:26:00:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T17:26:00:   processId: 8664,
2025-09-20T17:26:00:   nodeVersion: 'v22.19.0'
2025-09-20T17:26:00: }
2025-09-20T17:26:00: ğŸ“ Loaded 0 sent messages from file
2025-09-20T17:26:00: â„¹ï¸ [5:26:00 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T17:26:00: â„¹ï¸ [5:26:00 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T17:26:00: ğŸ“ Loaded 0 customer histories from file
2025-09-20T17:26:00: ğŸ“ Loaded 0 message hashes from file
2025-09-20T17:26:00: â„¹ï¸ [5:26:00 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T17:26:00: â„¹ï¸ [5:26:00 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T17:26:00: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T10-34-28-546Z.log
2025-09-20T17:26:00: ğŸ“ Enhanced Logger initialized
2025-09-20T17:26:00: ğŸ“ Loaded statistics from file
2025-09-20T17:26:00: âœ… Duplicate Prevention Manager initialized
2025-09-20T17:26:00: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T17:26:00: ğŸ§¹ Removed stale process lock
2025-09-20T17:26:00: âš ï¸ Warning: Could not remove lock file: EPERM: operation not permitted, unlink 'C:\Users\gssai\OneDrive\Desktop\Whatsapp-Moblie-Bot\safety-data\process.lock'
2025-09-20T17:26:00: ğŸ”’ Process lock acquired (PID: 8664)
2025-09-20T17:26:00: ğŸ”’ Process lock acquired (PID: 8664)
2025-09-20T17:26:00: â„¹ï¸ [5:26:00 pm] INFO: Process isolation enforced {
2025-09-20T17:26:00:   lockFile: 'safety-data\\process.lock',
2025-09-20T17:26:00:   pidFile: 'safety-data\\process.pid',
2025-09-20T17:26:00:   processId: 8664
2025-09-20T17:26:00: }
2025-09-20T17:26:00: â° Starting 240 second startup grace period...
2025-09-20T17:26:00: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T17:26:00: â„¹ï¸ [5:26:00 pm] INFO: Process isolation enforced {
2025-09-20T17:26:00:   lockFile: 'safety-data\\process.lock',
2025-09-20T17:26:00:   pidFile: 'safety-data\\process.pid',
2025-09-20T17:26:00:   processId: 8664
2025-09-20T17:26:00: }
2025-09-20T17:26:00: â° Starting 240 second startup grace period...
2025-09-20T17:26:00: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T17:26:00: â„¹ï¸ [5:26:00 pm] INFO: Grace Period: STARTED {
2025-09-20T17:26:00:   action: 'STARTED',
2025-09-20T17:26:00:   remainingMs: 240000,
2025-09-20T17:26:00:   remainingSeconds: 240,
2025-09-20T17:26:00:   details: { startupTime: 1758369360482, processId: 8664 },
2025-09-20T17:26:00:   timestamp: 1758369360565
2025-09-20T17:26:00: }
2025-09-20T17:26:00: â„¹ï¸ [5:26:00 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T17:26:00:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T17:26:00:   remainingMs: 240000,
2025-09-20T17:26:00:   remainingSeconds: 240,
2025-09-20T17:26:00:   details: { startupTime: 1758369360482, willExpireAt: 1758369600482 },
2025-09-20T17:26:00:   timestamp: 1758369360566
2025-09-20T17:26:00: }
2025-09-20T17:26:00: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T17:26:00: â° Startup grace period: 240 seconds
2025-09-20T17:26:00: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T17:26:00: â„¹ï¸ [5:26:00 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T17:26:00:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T17:26:00:   remainingMs: 240000,
2025-09-20T17:26:00:   remainingSeconds: 240,
2025-09-20T17:26:00:   details: { startupTime: 1758369360482, willExpireAt: 1758369600482 },
2025-09-20T17:26:00:   timestamp: 1758369360572
2025-09-20T17:26:00: }
2025-09-20T17:26:00: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T17:26:00: â° Startup grace period: 240 seconds
2025-09-20T17:26:00: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T17:26:00: â„¹ï¸ [5:26:00 pm] INFO: Grace Period: STARTED {
2025-09-20T17:26:00:   action: 'STARTED',
2025-09-20T17:26:00:   remainingMs: 240000,
2025-09-20T17:26:00:   remainingSeconds: 240,
2025-09-20T17:26:00:   details: { startupTime: 1758369360482, processId: 8664 },
2025-09-20T17:26:00:   timestamp: 1758369360571
2025-09-20T17:26:00: }
2025-09-20T17:26:00: â„¹ï¸ [5:26:00 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T17:26:00:   initializationDuration: 93,
2025-09-20T17:26:00:   gracePeriodActive: true,
2025-09-20T17:26:00:   messageRulesCount: 8,
2025-09-20T17:26:00:   messageTypes: [
2025-09-20T17:26:00:     'welcome',
2025-09-20T17:26:00:     'confirmation',
2025-09-20T17:26:00:     'ready',
2025-09-20T17:26:00:     'delivery',
2025-09-20T17:26:00:     'pickup_reminder',
2025-09-20T17:26:00:     'payment_reminder',
2025-09-20T17:26:00:     'fabric_welcome',
2025-09-20T17:26:00:     'fabric_purchase'
2025-09-20T17:26:00:   ],
2025-09-20T17:26:00:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T17:26:00:   databaseReady: true,
2025-09-20T17:26:00:   loggerReady: true,
2025-09-20T17:26:00:   processIsolationActive: true
2025-09-20T17:26:00: }
2025-09-20T17:26:00: â„¹ï¸ [5:26:00 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T17:26:00:   initializationDuration: 95,
2025-09-20T17:26:00:   gracePeriodActive: true,
2025-09-20T17:26:00:   messageRulesCount: 8,
2025-09-20T17:26:00:   messageTypes: [
2025-09-20T17:26:00:     'welcome',
2025-09-20T17:26:00:     'confirmation',
2025-09-20T17:26:00:     'ready',
2025-09-20T17:26:00:     'delivery',
2025-09-20T17:26:00:     'pickup_reminder',
2025-09-20T17:26:00:     'payment_reminder',
2025-09-20T17:26:00:     'fabric_welcome',
2025-09-20T17:26:00:     'fabric_purchase'
2025-09-20T17:26:00:   ],
2025-09-20T17:26:00:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T17:26:00:   databaseReady: true,
2025-09-20T17:26:00:   loggerReady: true,
2025-09-20T17:26:00:   processIsolationActive: true
2025-09-20T17:26:00: }
2025-09-20T17:26:00: âœ… Safety Manager initialized
2025-09-20T17:26:00: ğŸ“ Loaded 0 sent messages from file
2025-09-20T17:26:00: ğŸ“ Loaded 0 customer histories from file
2025-09-20T17:26:00: ğŸ“ Loaded 0 message hashes from file
2025-09-20T17:26:00: ğŸ“ Loaded statistics from file
2025-09-20T17:26:00: âœ… Duplicate Prevention Manager initialized
2025-09-20T17:26:00: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T17:26:00: âœ… Duplicate Prevention Manager initialized
2025-09-20T17:26:00: ğŸ”„ Starting WhatsApp connection...
2025-09-20T17:26:00: ğŸ”„ Initializing WhatsApp client...
2025-09-20T17:26:00: âœ… WhatsApp connection started
2025-09-20T17:26:00: ğŸ”§ Initializing admin commands...
2025-09-20T17:26:00: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T17:26:00: âœ… Admin commands system initialized
2025-09-20T17:26:00: ğŸ”„ Initializing polling functionality...
2025-09-20T17:26:00: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T17:26:00: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T17:26:00: ğŸ“ Attempting to request pairing code...
2025-09-20T17:26:00: ğŸ’¡ To use phone authentication:
2025-09-20T17:26:00:    1. Use the dashboard at http://localhost:3001
2025-09-20T17:26:00:    2. Select "Phone Number Authentication"
2025-09-20T17:26:00:    3. Enter your phone number
2025-09-20T17:26:00:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T17:26:00: ğŸ”„ Connecting to WhatsApp...
2025-09-20T17:26:02: âœ… WhatsApp connected successfully!
2025-09-20T17:26:02: ğŸ”„ Enhanced client: Connected event received, forwarding...
2025-09-20T17:26:02: ğŸ“± Session established successfully
2025-09-20T17:26:02: ğŸ”’ Session will be monitored for stability
2025-09-20T17:26:08: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:26:08: ğŸ“ Loaded 11 template types
2025-09-20T17:26:08: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T17:26:08: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T17:26:08: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T17:26:08: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758369368438] Starting comprehensive safety check...
2025-09-20T17:26:08: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758369368438] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T17:26:08: â„¹ï¸ [5:26:08 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:26:08:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:26:08:   phone: '919****706',
2025-09-20T17:26:08:   orderId: 'TJJ19092511',
2025-09-20T17:26:08:   messageType: 'confirmation',
2025-09-20T17:26:08:   result: 'STARTED',
2025-09-20T17:26:08:   details: {
2025-09-20T17:26:08:     checkId: '919953020706_TJJ19092511_confirmation_1758369368438',
2025-09-20T17:26:08:     hasOrderData: true,
2025-09-20T17:26:08:     hasSheetData: false,
2025-09-20T17:26:08:     messageLength: 469
2025-09-20T17:26:08:   },
2025-09-20T17:26:08:   timestamp: 1758369368438
2025-09-20T17:26:08: }
2025-09-20T17:26:08: ğŸ” [919953020706_TJJ19092511_confirmation_1758369368438] Step 1: Kill Switch Check
2025-09-20T17:26:08: ğŸ” [919953020706_TJJ19092511_confirmation_1758369368438] Step 1.5: Developer Phone Check
2025-09-20T17:26:08: ğŸ” [919953020706_TJJ19092511_confirmation_1758369368438] Step 2: Grace Period Check
2025-09-20T17:26:08: â„¹ï¸ [5:26:08 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:26:08:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:26:08:   remainingMs: 232042,
2025-09-20T17:26:08:   remainingSeconds: 233,
2025-09-20T17:26:08:   details: {
2025-09-20T17:26:08:     checkId: '919953020706_TJJ19092511_confirmation_1758369368438',
2025-09-20T17:26:08:     phone: '919953020706',
2025-09-20T17:26:08:     orderId: 'TJJ19092511',
2025-09-20T17:26:08:     messageType: 'confirmation'
2025-09-20T17:26:08:   },
2025-09-20T17:26:08:   timestamp: 1758369368440
2025-09-20T17:26:08: }
2025-09-20T17:26:08: âŒ [919953020706_TJJ19092511_confirmation_1758369368438] Startup grace period active (233s remaining)
2025-09-20T17:26:08: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Startup grace period active (233s remaining)
2025-09-20T17:26:08: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T17:26:08: â„¹ï¸ [5:26:08 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T17:26:08:   phone: '919****706',
2025-09-20T17:26:08:   orderId: 'TJJ19092511',
2025-09-20T17:26:08:   messageType: 'confirmation',
2025-09-20T17:26:08:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:26:08:   reason: {
2025-09-20T17:26:08:     contentHash: '97026037ffec053e',
2025-09-20T17:26:08:     timestamp: 1758369368442,
2025-09-20T17:26:08:     messageLength: 469,
2025-09-20T17:26:08:     errorMessage: 'Startup grace period active (233s remaining)',
2025-09-20T17:26:08:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T17:26:08:   },
2025-09-20T17:26:08:   duration: 0,
2025-09-20T17:26:08:   timestamp: 1758369368453
2025-09-20T17:26:08: }
2025-09-20T17:26:08: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:26:08: ğŸ“ Loaded 11 template types
2025-09-20T17:26:08: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T17:26:08: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T17:26:08: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T17:26:08: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758369368456] Starting comprehensive safety check...
2025-09-20T17:26:08: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758369368456] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T17:26:08: â„¹ï¸ [5:26:08 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:26:08:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:26:08:   phone: '919****488',
2025-09-20T17:26:08:   orderId: 'TWM19092511',
2025-09-20T17:26:08:   messageType: 'confirmation',
2025-09-20T17:26:08:   result: 'STARTED',
2025-09-20T17:26:08:   details: {
2025-09-20T17:26:08:     checkId: '919358537488_TWM19092511_confirmation_1758369368456',
2025-09-20T17:26:08:     hasOrderData: true,
2025-09-20T17:26:08:     hasSheetData: false,
2025-09-20T17:26:08:     messageLength: 475
2025-09-20T17:26:08:   },
2025-09-20T17:26:08:   timestamp: 1758369368456
2025-09-20T17:26:08: }
2025-09-20T17:26:08: ğŸ” [919358537488_TWM19092511_confirmation_1758369368456] Step 1: Kill Switch Check
2025-09-20T17:26:08: ğŸ” [919358537488_TWM19092511_confirmation_1758369368456] Step 1.5: Developer Phone Check
2025-09-20T17:26:08: ğŸ” [919358537488_TWM19092511_confirmation_1758369368456] Step 2: Grace Period Check
2025-09-20T17:26:08: â„¹ï¸ [5:26:08 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:26:08:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:26:08:   remainingMs: 232025,
2025-09-20T17:26:08:   remainingSeconds: 233,
2025-09-20T17:26:08:   details: {
2025-09-20T17:26:08:     checkId: '919358537488_TWM19092511_confirmation_1758369368456',
2025-09-20T17:26:08:     phone: '919358537488',
2025-09-20T17:26:08:     orderId: 'TWM19092511',
2025-09-20T17:26:08:     messageType: 'confirmation'
2025-09-20T17:26:08:   },
2025-09-20T17:26:08:   timestamp: 1758369368457
2025-09-20T17:26:08: }
2025-09-20T17:26:08: âŒ [919358537488_TWM19092511_confirmation_1758369368456] Startup grace period active (233s remaining)
2025-09-20T17:26:08: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Startup grace period active (233s remaining)
2025-09-20T17:26:08: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T17:26:08: â„¹ï¸ [5:26:08 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T17:26:08:   phone: '919****488',
2025-09-20T17:26:08:   orderId: 'TWM19092511',
2025-09-20T17:26:08:   messageType: 'confirmation',
2025-09-20T17:26:08:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:26:08:   reason: {
2025-09-20T17:26:08:     contentHash: 'e34d023f065922da',
2025-09-20T17:26:08:     timestamp: 1758369368459,
2025-09-20T17:26:08:     messageLength: 475,
2025-09-20T17:26:08:     errorMessage: 'Startup grace period active (233s remaining)',
2025-09-20T17:26:08:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T17:26:08:   },
2025-09-20T17:26:08:   duration: 0,
2025-09-20T17:26:08:   timestamp: 1758369368468
2025-09-20T17:26:08: }
2025-09-20T17:26:08: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:26:08: ğŸ“ Loaded 11 template types
2025-09-20T17:26:08: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T17:26:08: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T17:26:08: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T17:26:08: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758369368471] Starting comprehensive safety check...
2025-09-20T17:26:08: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758369368471] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T17:26:08: â„¹ï¸ [5:26:08 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:26:08:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:26:08:   phone: '918****811',
2025-09-20T17:26:08:   orderId: 'TOF19092511',
2025-09-20T17:26:08:   messageType: 'confirmation',
2025-09-20T17:26:08:   result: 'STARTED',
2025-09-20T17:26:08:   details: {
2025-09-20T17:26:08:     checkId: '918890134811_TOF19092511_confirmation_1758369368471',
2025-09-20T17:26:08:     hasOrderData: true,
2025-09-20T17:26:08:     hasSheetData: false,
2025-09-20T17:26:08:     messageLength: 473
2025-09-20T17:26:08:   },
2025-09-20T17:26:08:   timestamp: 1758369368471
2025-09-20T17:26:08: }
2025-09-20T17:26:08: ğŸ” [918890134811_TOF19092511_confirmation_1758369368471] Step 1: Kill Switch Check
2025-09-20T17:26:08: ğŸ” [918890134811_TOF19092511_confirmation_1758369368471] Step 1.5: Developer Phone Check
2025-09-20T17:26:08: ğŸ” [918890134811_TOF19092511_confirmation_1758369368471] Step 2: Grace Period Check
2025-09-20T17:26:08: â„¹ï¸ [5:26:08 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:26:08:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:26:08:   remainingMs: 232009,
2025-09-20T17:26:08:   remainingSeconds: 233,
2025-09-20T17:26:08:   details: {
2025-09-20T17:26:08:     checkId: '918890134811_TOF19092511_confirmation_1758369368471',
2025-09-20T17:26:08:     phone: '918890134811',
2025-09-20T17:26:08:     orderId: 'TOF19092511',
2025-09-20T17:26:08:     messageType: 'confirmation'
2025-09-20T17:26:08:   },
2025-09-20T17:26:08:   timestamp: 1758369368473
2025-09-20T17:26:08: }
2025-09-20T17:26:08: âŒ [918890134811_TOF19092511_confirmation_1758369368471] Startup grace period active (233s remaining)
2025-09-20T17:26:08: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (233s remaining)
2025-09-20T17:26:08: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T17:26:08: â„¹ï¸ [5:26:08 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T17:26:08:   phone: '918****811',
2025-09-20T17:26:08:   orderId: 'TOF19092511',
2025-09-20T17:26:08:   messageType: 'confirmation',
2025-09-20T17:26:08:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:26:08:   reason: {
2025-09-20T17:26:08:     contentHash: '388fbe812e19f1de',
2025-09-20T17:26:08:     timestamp: 1758369368474,
2025-09-20T17:26:08:     messageLength: 473,
2025-09-20T17:26:08:     errorMessage: 'Startup grace period active (233s remaining)',
2025-09-20T17:26:08:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T17:26:08:   },
2025-09-20T17:26:08:   duration: 0,
2025-09-20T17:26:08:   timestamp: 1758369368482
2025-09-20T17:26:08: }
2025-09-20T17:26:30: ğŸ’¾ Data synced to files successfully
2025-09-20T17:28:12: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:28:12: ğŸ“ Loaded 11 template types
2025-09-20T17:28:12: ğŸ”§ WhatsApp Bot initialized
2025-09-20T17:28:12: ğŸ“Š Configuration status: undefined
2025-09-20T17:28:12: âœ… Atomic State Manager initialized
2025-09-20T17:28:12: ğŸ“ Enhanced Logger initialized
2025-09-20T17:28:12: âœ… Google credentials loaded from service-account.json file
2025-09-20T17:28:12: ğŸ“± WhatsApp auth status: âœ… credentials, 4 session files
2025-09-20T17:28:12: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-20T17:28:12:    Auth Mode: both
2025-09-20T17:28:12:    QR Enabled: true
2025-09-20T17:28:12:    Phone Enabled: true
2025-09-20T17:28:12:    Session Persistence: true
2025-09-20T17:28:12:    Max Reconnect Attempts: 10
2025-09-20T17:28:12:    Default Phone: None
2025-09-20T17:28:12: ğŸ”’ Session validation enabled (check every 300s)
2025-09-20T17:28:12: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-20T17:28:12: ğŸ”§ Developer Configuration initialized
2025-09-20T17:28:12: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T17:28:13: â„¹ï¸ [5:28:12 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T17:28:13:   startupTime: 1758369492862,
2025-09-20T17:28:13:   gracePeriodMs: 240000,
2025-09-20T17:28:13:   dataDir: './safety-data',
2025-09-20T17:28:13:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T17:28:13:   processId: 13148,
2025-09-20T17:28:13:   nodeVersion: 'v22.19.0'
2025-09-20T17:28:13: }
2025-09-20T17:28:13: ğŸ”§ Developer Configuration initialized
2025-09-20T17:28:13: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T17:28:13: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-20T17:28:13: â° 4-minute startup delay active
2025-09-20T17:28:13: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-20T17:28:13: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-20T17:28:13: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T17:28:13: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T17:28:13: âœ… Google Sheets API initialized
2025-09-20T17:28:13: âœ… Google Sheets API initialized
2025-09-20T17:28:13: â„¹ï¸ [5:28:13 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T17:28:13:   startupTime: 1758369492862,
2025-09-20T17:28:13:   gracePeriodMs: 240000,
2025-09-20T17:28:13:   dataDir: './safety-data',
2025-09-20T17:28:13:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T17:28:13:   processId: 13148,
2025-09-20T17:28:13:   nodeVersion: 'v22.19.0'
2025-09-20T17:28:13: }
2025-09-20T17:28:13: ğŸ“ Loaded 0 sent messages from file
2025-09-20T17:28:13: ğŸ“ Loaded 0 customer histories from file
2025-09-20T17:28:13: â„¹ï¸ [5:28:13 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T17:28:13: â„¹ï¸ [5:28:13 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T17:28:13: ğŸ“ Loaded 0 message hashes from file
2025-09-20T17:28:13: ğŸ“ Loaded statistics from file
2025-09-20T17:28:13: âœ… Duplicate Prevention Manager initialized
2025-09-20T17:28:13: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T17:28:13: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T10-40-16-887Z.log
2025-09-20T17:28:13: ğŸ“ Enhanced Logger initialized
2025-09-20T17:28:13: â„¹ï¸ [5:28:13 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T17:28:13: â„¹ï¸ [5:28:13 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T17:28:13: ğŸ§¹ Removed stale process lock
2025-09-20T17:28:13: ğŸ§¹ Lock file already cleaned up
2025-09-20T17:28:13: ğŸ”’ Process lock acquired (PID: 13148)
2025-09-20T17:28:13: ğŸ”’ Process lock acquired (PID: 13148)
2025-09-20T17:28:13: â„¹ï¸ [5:28:13 pm] INFO: Process isolation enforced {
2025-09-20T17:28:13:   lockFile: 'safety-data\\process.lock',
2025-09-20T17:28:13:   pidFile: 'safety-data\\process.pid',
2025-09-20T17:28:13:   processId: 13148
2025-09-20T17:28:13: }
2025-09-20T17:28:13: â° Starting 240 second startup grace period...
2025-09-20T17:28:13: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T17:28:13: â„¹ï¸ [5:28:13 pm] INFO: Process isolation enforced {
2025-09-20T17:28:13:   lockFile: 'safety-data\\process.lock',
2025-09-20T17:28:13:   pidFile: 'safety-data\\process.pid',
2025-09-20T17:28:13:   processId: 13148
2025-09-20T17:28:13: }
2025-09-20T17:28:13: â° Starting 240 second startup grace period...
2025-09-20T17:28:13: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T17:28:13: â„¹ï¸ [5:28:13 pm] INFO: Grace Period: STARTED {
2025-09-20T17:28:13:   action: 'STARTED',
2025-09-20T17:28:13:   remainingMs: 240000,
2025-09-20T17:28:13:   remainingSeconds: 240,
2025-09-20T17:28:13:   details: { startupTime: 1758369492862, processId: 13148 },
2025-09-20T17:28:13:   timestamp: 1758369493175
2025-09-20T17:28:13: }
2025-09-20T17:28:13: â„¹ï¸ [5:28:13 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T17:28:13:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T17:28:13:   remainingMs: 240000,
2025-09-20T17:28:13:   remainingSeconds: 240,
2025-09-20T17:28:13:   details: { startupTime: 1758369492862, willExpireAt: 1758369732862 },
2025-09-20T17:28:13:   timestamp: 1758369493177
2025-09-20T17:28:13: }
2025-09-20T17:28:13: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T17:28:13: â° Startup grace period: 240 seconds
2025-09-20T17:28:13: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T17:28:13: â„¹ï¸ [5:28:13 pm] INFO: Grace Period: STARTED {
2025-09-20T17:28:13:   action: 'STARTED',
2025-09-20T17:28:13:   remainingMs: 240000,
2025-09-20T17:28:13:   remainingSeconds: 240,
2025-09-20T17:28:13:   details: { startupTime: 1758369492862, processId: 13148 },
2025-09-20T17:28:13:   timestamp: 1758369493181
2025-09-20T17:28:13: }
2025-09-20T17:28:13: â„¹ï¸ [5:28:13 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T17:28:13:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T17:28:13:   remainingMs: 240000,
2025-09-20T17:28:13:   remainingSeconds: 240,
2025-09-20T17:28:13:   details: { startupTime: 1758369492862, willExpireAt: 1758369732862 },
2025-09-20T17:28:13:   timestamp: 1758369493181
2025-09-20T17:28:13: }
2025-09-20T17:28:13: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T17:28:13: â° Startup grace period: 240 seconds
2025-09-20T17:28:13: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T17:28:13: â„¹ï¸ [5:28:13 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T17:28:13:   initializationDuration: 327,
2025-09-20T17:28:13:   gracePeriodActive: true,
2025-09-20T17:28:13:   messageRulesCount: 8,
2025-09-20T17:28:13:   messageTypes: [
2025-09-20T17:28:13:     'welcome',
2025-09-20T17:28:13:     'confirmation',
2025-09-20T17:28:13:     'ready',
2025-09-20T17:28:13:     'delivery',
2025-09-20T17:28:13:     'pickup_reminder',
2025-09-20T17:28:13:     'payment_reminder',
2025-09-20T17:28:13:     'fabric_welcome',
2025-09-20T17:28:13:     'fabric_purchase'
2025-09-20T17:28:13:   ],
2025-09-20T17:28:13:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T17:28:13:   databaseReady: true,
2025-09-20T17:28:13:   loggerReady: true,
2025-09-20T17:28:13:   processIsolationActive: true
2025-09-20T17:28:13: }
2025-09-20T17:28:13: âœ… Safety Manager initialized
2025-09-20T17:28:13: â„¹ï¸ [5:28:13 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T17:28:13:   initializationDuration: 329,
2025-09-20T17:28:13:   gracePeriodActive: true,
2025-09-20T17:28:13:   messageRulesCount: 8,
2025-09-20T17:28:13:   messageTypes: [
2025-09-20T17:28:13:     'welcome',
2025-09-20T17:28:13:     'confirmation',
2025-09-20T17:28:13:     'ready',
2025-09-20T17:28:13:     'delivery',
2025-09-20T17:28:13:     'pickup_reminder',
2025-09-20T17:28:13:     'payment_reminder',
2025-09-20T17:28:13:     'fabric_welcome',
2025-09-20T17:28:13:     'fabric_purchase'
2025-09-20T17:28:13:   ],
2025-09-20T17:28:13:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T17:28:13:   databaseReady: true,
2025-09-20T17:28:13:   loggerReady: true,
2025-09-20T17:28:13:   processIsolationActive: true
2025-09-20T17:28:13: }
2025-09-20T17:28:13: ğŸ“ Loaded 0 sent messages from file
2025-09-20T17:28:13: ğŸ“ Loaded 0 customer histories from file
2025-09-20T17:28:13: ğŸ“ Loaded 0 message hashes from file
2025-09-20T17:28:13: ğŸ“ Loaded statistics from file
2025-09-20T17:28:13: âœ… Duplicate Prevention Manager initialized
2025-09-20T17:28:13: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T17:28:13: âœ… Duplicate Prevention Manager initialized
2025-09-20T17:28:13: ğŸ”„ Starting WhatsApp connection...
2025-09-20T17:28:13: ğŸ”„ Initializing WhatsApp client...
2025-09-20T17:28:13: âœ… WhatsApp connection started
2025-09-20T17:28:13: ğŸ”§ Initializing admin commands...
2025-09-20T17:28:13: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T17:28:13: âœ… Admin commands system initialized
2025-09-20T17:28:13: ğŸ”„ Initializing polling functionality...
2025-09-20T17:28:13: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T17:28:13: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T17:28:13: ğŸ“ Attempting to request pairing code...
2025-09-20T17:28:13: ğŸ’¡ To use phone authentication:
2025-09-20T17:28:13:    1. Use the dashboard at http://localhost:3001
2025-09-20T17:28:13:    2. Select "Phone Number Authentication"
2025-09-20T17:28:13:    3. Enter your phone number
2025-09-20T17:28:13:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T17:28:13: ğŸ”„ Connecting to WhatsApp...
2025-09-20T17:28:16: âœ… WhatsApp connected successfully!
2025-09-20T17:28:16: ğŸ”„ Enhanced client: Connected event received, forwarding...
2025-09-20T17:28:16: ğŸ“± Session established successfully
2025-09-20T17:28:16: ğŸ”’ Session will be monitored for stability
2025-09-20T17:28:21: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:28:21: ğŸ“ Loaded 11 template types
2025-09-20T17:28:21: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T17:28:21: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T17:28:21: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T17:28:21: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758369501935] Starting comprehensive safety check...
2025-09-20T17:28:21: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758369501935] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T17:28:21: â„¹ï¸ [5:28:21 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:28:21:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:28:21:   phone: '919****706',
2025-09-20T17:28:21:   orderId: 'TJJ19092511',
2025-09-20T17:28:21:   messageType: 'confirmation',
2025-09-20T17:28:21:   result: 'STARTED',
2025-09-20T17:28:21:   details: {
2025-09-20T17:28:21:     checkId: '919953020706_TJJ19092511_confirmation_1758369501935',
2025-09-20T17:28:21:     hasOrderData: true,
2025-09-20T17:28:21:     hasSheetData: false,
2025-09-20T17:28:21:     messageLength: 469
2025-09-20T17:28:21:   },
2025-09-20T17:28:21:   timestamp: 1758369501935
2025-09-20T17:28:21: }
2025-09-20T17:28:21: ğŸ” [919953020706_TJJ19092511_confirmation_1758369501935] Step 1: Kill Switch Check
2025-09-20T17:28:21: ğŸ” [919953020706_TJJ19092511_confirmation_1758369501935] Step 1.5: Developer Phone Check
2025-09-20T17:28:21: ğŸ” [919953020706_TJJ19092511_confirmation_1758369501935] Step 2: Grace Period Check
2025-09-20T17:28:21: â„¹ï¸ [5:28:21 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:28:21:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:28:21:   remainingMs: 230924,
2025-09-20T17:28:21:   remainingSeconds: 231,
2025-09-20T17:28:21:   details: {
2025-09-20T17:28:21:     checkId: '919953020706_TJJ19092511_confirmation_1758369501935',
2025-09-20T17:28:21:     phone: '919953020706',
2025-09-20T17:28:21:     orderId: 'TJJ19092511',
2025-09-20T17:28:21:     messageType: 'confirmation'
2025-09-20T17:28:21:   },
2025-09-20T17:28:21:   timestamp: 1758369501938
2025-09-20T17:28:21: }
2025-09-20T17:28:21: âŒ [919953020706_TJJ19092511_confirmation_1758369501935] Startup grace period active (231s remaining)
2025-09-20T17:28:21: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Startup grace period active (231s remaining)
2025-09-20T17:28:21: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T17:28:21: â„¹ï¸ [5:28:21 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T17:28:21:   phone: '919****706',
2025-09-20T17:28:21:   orderId: 'TJJ19092511',
2025-09-20T17:28:21:   messageType: 'confirmation',
2025-09-20T17:28:21:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:28:21:   reason: {
2025-09-20T17:28:21:     contentHash: '97026037ffec053e',
2025-09-20T17:28:21:     timestamp: 1758369501942,
2025-09-20T17:28:21:     messageLength: 469,
2025-09-20T17:28:21:     errorMessage: 'Startup grace period active (231s remaining)',
2025-09-20T17:28:21:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T17:28:21:   },
2025-09-20T17:28:21:   duration: 0,
2025-09-20T17:28:21:   timestamp: 1758369501959
2025-09-20T17:28:21: }
2025-09-20T17:28:21: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:28:21: ğŸ“ Loaded 11 template types
2025-09-20T17:28:21: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T17:28:21: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T17:28:21: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T17:28:21: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758369501962] Starting comprehensive safety check...
2025-09-20T17:28:21: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758369501962] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T17:28:21: â„¹ï¸ [5:28:21 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:28:21:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:28:21:   phone: '919****488',
2025-09-20T17:28:21:   orderId: 'TWM19092511',
2025-09-20T17:28:21:   messageType: 'confirmation',
2025-09-20T17:28:21:   result: 'STARTED',
2025-09-20T17:28:21:   details: {
2025-09-20T17:28:21:     checkId: '919358537488_TWM19092511_confirmation_1758369501962',
2025-09-20T17:28:21:     hasOrderData: true,
2025-09-20T17:28:21:     hasSheetData: false,
2025-09-20T17:28:21:     messageLength: 475
2025-09-20T17:28:21:   },
2025-09-20T17:28:21:   timestamp: 1758369501962
2025-09-20T17:28:21: }
2025-09-20T17:28:21: ğŸ” [919358537488_TWM19092511_confirmation_1758369501962] Step 1: Kill Switch Check
2025-09-20T17:28:21: ğŸ” [919358537488_TWM19092511_confirmation_1758369501962] Step 1.5: Developer Phone Check
2025-09-20T17:28:21: ğŸ” [919358537488_TWM19092511_confirmation_1758369501962] Step 2: Grace Period Check
2025-09-20T17:28:21: â„¹ï¸ [5:28:21 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:28:21:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:28:21:   remainingMs: 230897,
2025-09-20T17:28:21:   remainingSeconds: 231,
2025-09-20T17:28:21:   details: {
2025-09-20T17:28:21:     checkId: '919358537488_TWM19092511_confirmation_1758369501962',
2025-09-20T17:28:21:     phone: '919358537488',
2025-09-20T17:28:21:     orderId: 'TWM19092511',
2025-09-20T17:28:21:     messageType: 'confirmation'
2025-09-20T17:28:21:   },
2025-09-20T17:28:21:   timestamp: 1758369501965
2025-09-20T17:28:21: }
2025-09-20T17:28:21: âŒ [919358537488_TWM19092511_confirmation_1758369501962] Startup grace period active (231s remaining)
2025-09-20T17:28:21: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Startup grace period active (231s remaining)
2025-09-20T17:28:21: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T17:28:21: â„¹ï¸ [5:28:21 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T17:28:21:   phone: '919****488',
2025-09-20T17:28:21:   orderId: 'TWM19092511',
2025-09-20T17:28:21:   messageType: 'confirmation',
2025-09-20T17:28:21:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:28:21:   reason: {
2025-09-20T17:28:21:     contentHash: 'e34d023f065922da',
2025-09-20T17:28:21:     timestamp: 1758369501967,
2025-09-20T17:28:21:     messageLength: 475,
2025-09-20T17:28:21:     errorMessage: 'Startup grace period active (231s remaining)',
2025-09-20T17:28:21:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T17:28:21:   },
2025-09-20T17:28:21:   duration: 0,
2025-09-20T17:28:21:   timestamp: 1758369501976
2025-09-20T17:28:21: }
2025-09-20T17:28:21: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:28:21: ğŸ“ Loaded 11 template types
2025-09-20T17:28:21: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T17:28:21: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T17:28:21: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T17:28:21: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758369501979] Starting comprehensive safety check...
2025-09-20T17:28:21: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758369501979] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T17:28:21: â„¹ï¸ [5:28:21 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T17:28:21:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T17:28:21:   phone: '918****811',
2025-09-20T17:28:21:   orderId: 'TOF19092511',
2025-09-20T17:28:21:   messageType: 'confirmation',
2025-09-20T17:28:21:   result: 'STARTED',
2025-09-20T17:28:21:   details: {
2025-09-20T17:28:21:     checkId: '918890134811_TOF19092511_confirmation_1758369501979',
2025-09-20T17:28:21:     hasOrderData: true,
2025-09-20T17:28:21:     hasSheetData: false,
2025-09-20T17:28:21:     messageLength: 473
2025-09-20T17:28:21:   },
2025-09-20T17:28:21:   timestamp: 1758369501979
2025-09-20T17:28:21: }
2025-09-20T17:28:21: ğŸ” [918890134811_TOF19092511_confirmation_1758369501979] Step 1: Kill Switch Check
2025-09-20T17:28:21: ğŸ” [918890134811_TOF19092511_confirmation_1758369501979] Step 1.5: Developer Phone Check
2025-09-20T17:28:21: ğŸ” [918890134811_TOF19092511_confirmation_1758369501979] Step 2: Grace Period Check
2025-09-20T17:28:21: â„¹ï¸ [5:28:21 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T17:28:21:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T17:28:21:   remainingMs: 230880,
2025-09-20T17:28:21:   remainingSeconds: 231,
2025-09-20T17:28:21:   details: {
2025-09-20T17:28:21:     checkId: '918890134811_TOF19092511_confirmation_1758369501979',
2025-09-20T17:28:21:     phone: '918890134811',
2025-09-20T17:28:21:     orderId: 'TOF19092511',
2025-09-20T17:28:21:     messageType: 'confirmation'
2025-09-20T17:28:21:   },
2025-09-20T17:28:21:   timestamp: 1758369501982
2025-09-20T17:28:21: }
2025-09-20T17:28:21: âŒ [918890134811_TOF19092511_confirmation_1758369501979] Startup grace period active (231s remaining)
2025-09-20T17:28:21: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (231s remaining)
2025-09-20T17:28:21: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T17:28:21: â„¹ï¸ [5:28:21 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T17:28:21:   phone: '918****811',
2025-09-20T17:28:21:   orderId: 'TOF19092511',
2025-09-20T17:28:21:   messageType: 'confirmation',
2025-09-20T17:28:21:   allowed: 'RECORDED_FAILURE',
2025-09-20T17:28:21:   reason: {
2025-09-20T17:28:21:     contentHash: '388fbe812e19f1de',
2025-09-20T17:28:21:     timestamp: 1758369501984,
2025-09-20T17:28:21:     messageLength: 473,
2025-09-20T17:28:21:     errorMessage: 'Startup grace period active (231s remaining)',
2025-09-20T17:28:21:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T17:28:21:   },
2025-09-20T17:28:21:   duration: 0,
2025-09-20T17:28:21:   timestamp: 1758369501994
2025-09-20T17:28:21: }
2025-09-20T17:28:43: ğŸ’¾ Data synced to files successfully
2025-09-20T17:31:29: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:31:29: ğŸ“ Loaded 11 template types
2025-09-20T17:31:29: ğŸ”§ WhatsApp Bot initialized
2025-09-20T17:31:29: ğŸ“Š Configuration status: undefined
2025-09-20T17:31:29: âœ… Atomic State Manager initialized
2025-09-20T17:31:29: ğŸ“ Enhanced Logger initialized
2025-09-20T17:31:33: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:31:33: ğŸ“ Loaded 11 template types
2025-09-20T17:31:33: ğŸ”§ WhatsApp Bot initialized
2025-09-20T17:31:33: ğŸ“Š Configuration status: undefined
2025-09-20T17:31:33: âœ… Atomic State Manager initialized
2025-09-20T17:31:33: ğŸ“ Enhanced Logger initialized
2025-09-20T17:31:38: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:31:38: ğŸ“ Loaded 11 template types
2025-09-20T17:31:38: ğŸ”§ WhatsApp Bot initialized
2025-09-20T17:31:38: ğŸ“Š Configuration status: undefined
2025-09-20T17:31:38: âœ… Atomic State Manager initialized
2025-09-20T17:31:38: ğŸ“ Enhanced Logger initialized
2025-09-20T17:31:41: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:31:41: ğŸ“ Loaded 11 template types
2025-09-20T17:31:41: ğŸ”§ WhatsApp Bot initialized
2025-09-20T17:31:41: ğŸ“Š Configuration status: undefined
2025-09-20T17:31:41: âœ… Atomic State Manager initialized
2025-09-20T17:31:41: ğŸ“ Enhanced Logger initialized
2025-09-20T17:31:45: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:31:45: ğŸ“ Loaded 11 template types
2025-09-20T17:31:45: ğŸ”§ WhatsApp Bot initialized
2025-09-20T17:31:45: ğŸ“Š Configuration status: undefined
2025-09-20T17:31:45: âœ… Atomic State Manager initialized
2025-09-20T17:31:45: ğŸ“ Enhanced Logger initialized
2025-09-20T17:31:49: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:31:49: ğŸ“ Loaded 11 template types
2025-09-20T17:31:49: ğŸ”§ WhatsApp Bot initialized
2025-09-20T17:31:49: ğŸ“Š Configuration status: undefined
2025-09-20T17:31:49: âœ… Atomic State Manager initialized
2025-09-20T17:31:49: ğŸ“ Enhanced Logger initialized
2025-09-20T17:31:51: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:31:51: ğŸ“ Loaded 11 template types
2025-09-20T17:31:51: ğŸ”§ WhatsApp Bot initialized
2025-09-20T17:31:51: ğŸ“Š Configuration status: undefined
2025-09-20T17:31:51: âœ… Atomic State Manager initialized
2025-09-20T17:31:51: ğŸ“ Enhanced Logger initialized
2025-09-20T17:31:54: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:31:54: ğŸ“ Loaded 11 template types
2025-09-20T17:31:54: ğŸ”§ WhatsApp Bot initialized
2025-09-20T17:31:54: ğŸ“Š Configuration status: undefined
2025-09-20T17:31:54: âœ… Atomic State Manager initialized
2025-09-20T17:31:54: ğŸ“ Enhanced Logger initialized
2025-09-20T17:31:56: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:31:56: ğŸ“ Loaded 11 template types
2025-09-20T17:31:56: ğŸ”§ WhatsApp Bot initialized
2025-09-20T17:31:56: ğŸ“Š Configuration status: undefined
2025-09-20T17:31:56: âœ… Atomic State Manager initialized
2025-09-20T17:31:56: ğŸ“ Enhanced Logger initialized
2025-09-20T17:31:59: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T17:31:59: ğŸ“ Loaded 11 template types
2025-09-20T17:31:59: ğŸ”§ WhatsApp Bot initialized
2025-09-20T17:31:59: ğŸ“Š Configuration status: undefined
2025-09-20T17:31:59: âœ… Atomic State Manager initialized
2025-09-20T17:31:59: ğŸ“ Enhanced Logger initialized
2025-09-20T19:08:25: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:08:25: ğŸ“ Loaded 11 template types
2025-09-20T19:08:25: ğŸ”§ WhatsApp Bot initialized
2025-09-20T19:08:25: ğŸ“Š Configuration status: undefined
2025-09-20T19:08:25: âœ… Atomic State Manager initialized
2025-09-20T19:08:25: ğŸ“ Enhanced Logger initialized
2025-09-20T19:08:25: âœ… Google credentials loaded from service-account.json file
2025-09-20T19:08:25: ğŸ“± WhatsApp auth status: âœ… credentials, 4 session files
2025-09-20T19:08:25: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-20T19:08:25:    Auth Mode: both
2025-09-20T19:08:25:    QR Enabled: true
2025-09-20T19:08:25:    Phone Enabled: true
2025-09-20T19:08:25:    Session Persistence: true
2025-09-20T19:08:25:    Max Reconnect Attempts: 10
2025-09-20T19:08:25:    Default Phone: None
2025-09-20T19:08:25: ğŸ”’ Session validation enabled (check every 300s)
2025-09-20T19:08:25: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-20T19:08:25: ğŸ”§ Developer Configuration initialized
2025-09-20T19:08:25: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T19:08:25: â„¹ï¸ [7:08:25 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T19:08:25:   startupTime: 1758375505589,
2025-09-20T19:08:25:   gracePeriodMs: 240000,
2025-09-20T19:08:25:   dataDir: './safety-data',
2025-09-20T19:08:25:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T19:08:25:   processId: 852,
2025-09-20T19:08:25:   nodeVersion: 'v22.19.0'
2025-09-20T19:08:25: }
2025-09-20T19:08:25: ğŸ”§ Developer Configuration initialized
2025-09-20T19:08:25: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T19:08:25: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-20T19:08:25: â° 4-minute startup delay active
2025-09-20T19:08:25: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-20T19:08:25: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-20T19:08:25: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T19:08:25: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T19:08:25: âœ… Google Sheets API initialized
2025-09-20T19:08:25: âœ… Google Sheets API initialized
2025-09-20T19:08:25: â„¹ï¸ [7:08:25 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T19:08:25:   startupTime: 1758375505589,
2025-09-20T19:08:25:   gracePeriodMs: 240000,
2025-09-20T19:08:25:   dataDir: './safety-data',
2025-09-20T19:08:25:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T19:08:25:   processId: 852,
2025-09-20T19:08:25:   nodeVersion: 'v22.19.0'
2025-09-20T19:08:25: }
2025-09-20T19:08:25: ğŸ“ Loaded 0 sent messages from file
2025-09-20T19:08:25: ğŸ“ Loaded 0 customer histories from file
2025-09-20T19:08:25: â„¹ï¸ [7:08:25 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T19:08:25: â„¹ï¸ [7:08:25 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T19:08:25: ğŸ“ Loaded 0 message hashes from file
2025-09-20T19:08:25: ğŸ“ Loaded statistics from file
2025-09-20T19:08:25: âœ… Duplicate Prevention Manager initialized
2025-09-20T19:08:25: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T19:08:25: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T11-24-38-209Z.log
2025-09-20T19:08:25: ğŸ“ Enhanced Logger initialized
2025-09-20T19:08:25: â„¹ï¸ [7:08:25 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T19:08:25: â„¹ï¸ [7:08:25 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T19:08:25: ğŸ§¹ Removed stale process lock
2025-09-20T19:08:25: âš ï¸ Warning: Could not remove lock file: EPERM: operation not permitted, unlink 'C:\Users\gssai\OneDrive\Desktop\Whatsapp-Moblie-Bot\safety-data\process.lock'
2025-09-20T19:08:25: ğŸ”’ Process lock acquired (PID: 852)
2025-09-20T19:08:25: ğŸ”’ Process lock acquired (PID: 852)
2025-09-20T19:08:25: â„¹ï¸ [7:08:25 pm] INFO: Process isolation enforced {
2025-09-20T19:08:25:   lockFile: 'safety-data\\process.lock',
2025-09-20T19:08:25:   pidFile: 'safety-data\\process.pid',
2025-09-20T19:08:25:   processId: 852
2025-09-20T19:08:25: }
2025-09-20T19:08:25: â° Starting 240 second startup grace period...
2025-09-20T19:08:25: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T19:08:25: â„¹ï¸ [7:08:25 pm] INFO: Process isolation enforced {
2025-09-20T19:08:25:   lockFile: 'safety-data\\process.lock',
2025-09-20T19:08:25:   pidFile: 'safety-data\\process.pid',
2025-09-20T19:08:25:   processId: 852
2025-09-20T19:08:25: }
2025-09-20T19:08:25: â° Starting 240 second startup grace period...
2025-09-20T19:08:25: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T19:08:25: â„¹ï¸ [7:08:25 pm] INFO: Grace Period: STARTED {
2025-09-20T19:08:25:   action: 'STARTED',
2025-09-20T19:08:25:   remainingMs: 240000,
2025-09-20T19:08:25:   remainingSeconds: 240,
2025-09-20T19:08:25:   details: { startupTime: 1758375505589, processId: 852 },
2025-09-20T19:08:25:   timestamp: 1758375505677
2025-09-20T19:08:25: }
2025-09-20T19:08:25: â„¹ï¸ [7:08:25 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T19:08:25:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T19:08:25:   remainingMs: 240000,
2025-09-20T19:08:25:   remainingSeconds: 240,
2025-09-20T19:08:25:   details: { startupTime: 1758375505589, willExpireAt: 1758375745589 },
2025-09-20T19:08:25:   timestamp: 1758375505677
2025-09-20T19:08:25: }
2025-09-20T19:08:25: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T19:08:25: â° Startup grace period: 240 seconds
2025-09-20T19:08:25: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T19:08:25: â„¹ï¸ [7:08:25 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T19:08:25:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T19:08:25:   remainingMs: 240000,
2025-09-20T19:08:25:   remainingSeconds: 240,
2025-09-20T19:08:25:   details: { startupTime: 1758375505589, willExpireAt: 1758375745589 },
2025-09-20T19:08:25:   timestamp: 1758375505678
2025-09-20T19:08:25: }
2025-09-20T19:08:25: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T19:08:25: â° Startup grace period: 240 seconds
2025-09-20T19:08:25: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T19:08:25: â„¹ï¸ [7:08:25 pm] INFO: Grace Period: STARTED {
2025-09-20T19:08:25:   action: 'STARTED',
2025-09-20T19:08:25:   remainingMs: 240000,
2025-09-20T19:08:25:   remainingSeconds: 240,
2025-09-20T19:08:25:   details: { startupTime: 1758375505589, processId: 852 },
2025-09-20T19:08:25:   timestamp: 1758375505678
2025-09-20T19:08:25: }
2025-09-20T19:08:25: â„¹ï¸ [7:08:25 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T19:08:25:   initializationDuration: 90,
2025-09-20T19:08:25:   gracePeriodActive: true,
2025-09-20T19:08:25:   messageRulesCount: 8,
2025-09-20T19:08:25:   messageTypes: [
2025-09-20T19:08:25:     'welcome',
2025-09-20T19:08:25:     'confirmation',
2025-09-20T19:08:25:     'ready',
2025-09-20T19:08:25:     'delivery',
2025-09-20T19:08:25:     'pickup_reminder',
2025-09-20T19:08:25:     'payment_reminder',
2025-09-20T19:08:25:     'fabric_welcome',
2025-09-20T19:08:25:     'fabric_purchase'
2025-09-20T19:08:25:   ],
2025-09-20T19:08:25:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T19:08:25:   databaseReady: true,
2025-09-20T19:08:25:   loggerReady: true,
2025-09-20T19:08:25:   processIsolationActive: true
2025-09-20T19:08:25: }
2025-09-20T19:08:25: âœ… Safety Manager initialized
2025-09-20T19:08:25: â„¹ï¸ [7:08:25 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T19:08:25:   initializationDuration: 91,
2025-09-20T19:08:25:   gracePeriodActive: true,
2025-09-20T19:08:25:   messageRulesCount: 8,
2025-09-20T19:08:25:   messageTypes: [
2025-09-20T19:08:25:     'welcome',
2025-09-20T19:08:25:     'confirmation',
2025-09-20T19:08:25:     'ready',
2025-09-20T19:08:25:     'delivery',
2025-09-20T19:08:25:     'pickup_reminder',
2025-09-20T19:08:25:     'payment_reminder',
2025-09-20T19:08:25:     'fabric_welcome',
2025-09-20T19:08:25:     'fabric_purchase'
2025-09-20T19:08:25:   ],
2025-09-20T19:08:25:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T19:08:25:   databaseReady: true,
2025-09-20T19:08:25:   loggerReady: true,
2025-09-20T19:08:25:   processIsolationActive: true
2025-09-20T19:08:25: }
2025-09-20T19:08:25: ğŸ“ Loaded 0 sent messages from file
2025-09-20T19:08:25: ğŸ“ Loaded 0 customer histories from file
2025-09-20T19:08:25: ğŸ“ Loaded 0 message hashes from file
2025-09-20T19:08:25: ğŸ“ Loaded statistics from file
2025-09-20T19:08:25: âœ… Duplicate Prevention Manager initialized
2025-09-20T19:08:25: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T19:08:25: âœ… Duplicate Prevention Manager initialized
2025-09-20T19:08:25: ğŸ”„ Starting WhatsApp connection...
2025-09-20T19:08:25: ğŸ”„ Initializing WhatsApp client...
2025-09-20T19:08:25: âœ… WhatsApp connection started
2025-09-20T19:08:25: ğŸ”§ Initializing admin commands...
2025-09-20T19:08:25: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T19:08:25: âœ… Admin commands system initialized
2025-09-20T19:08:25: ğŸ”„ Initializing polling functionality...
2025-09-20T19:08:25: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T19:08:25: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T19:08:25: ğŸ“ Attempting to request pairing code...
2025-09-20T19:08:25: ğŸ’¡ To use phone authentication:
2025-09-20T19:08:25:    1. Use the dashboard at http://localhost:3001
2025-09-20T19:08:25:    2. Select "Phone Number Authentication"
2025-09-20T19:08:25:    3. Enter your phone number
2025-09-20T19:08:25:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T19:08:25: ğŸ”„ Connecting to WhatsApp...
2025-09-20T19:08:28: âœ… WhatsApp connected successfully!
2025-09-20T19:08:28: ğŸ”„ Enhanced client: Connected event received, forwarding...
2025-09-20T19:08:28: ğŸ“± Session established successfully
2025-09-20T19:08:28: ğŸ”’ Session will be monitored for stability
2025-09-20T19:08:34: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:08:34: ğŸ“ Loaded 11 template types
2025-09-20T19:08:34: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T19:08:34: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T19:08:34: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T19:08:34: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758375514427] Starting comprehensive safety check...
2025-09-20T19:08:34: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758375514427] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T19:08:34: â„¹ï¸ [7:08:34 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:08:34:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:08:34:   phone: '919****706',
2025-09-20T19:08:34:   orderId: 'TJJ19092511',
2025-09-20T19:08:34:   messageType: 'confirmation',
2025-09-20T19:08:34:   result: 'STARTED',
2025-09-20T19:08:34:   details: {
2025-09-20T19:08:34:     checkId: '919953020706_TJJ19092511_confirmation_1758375514427',
2025-09-20T19:08:34:     hasOrderData: true,
2025-09-20T19:08:34:     hasSheetData: false,
2025-09-20T19:08:34:     messageLength: 469
2025-09-20T19:08:34:   },
2025-09-20T19:08:34:   timestamp: 1758375514429
2025-09-20T19:08:34: }
2025-09-20T19:08:34: ğŸ” [919953020706_TJJ19092511_confirmation_1758375514427] Step 1: Kill Switch Check
2025-09-20T19:08:34: ğŸ” [919953020706_TJJ19092511_confirmation_1758375514427] Step 1.5: Developer Phone Check
2025-09-20T19:08:34: ğŸ” [919953020706_TJJ19092511_confirmation_1758375514427] Step 2: Grace Period Check
2025-09-20T19:08:34: â„¹ï¸ [7:08:34 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:08:34:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:08:34:   remainingMs: 231155,
2025-09-20T19:08:34:   remainingSeconds: 232,
2025-09-20T19:08:34:   details: {
2025-09-20T19:08:34:     checkId: '919953020706_TJJ19092511_confirmation_1758375514427',
2025-09-20T19:08:34:     phone: '919953020706',
2025-09-20T19:08:34:     orderId: 'TJJ19092511',
2025-09-20T19:08:34:     messageType: 'confirmation'
2025-09-20T19:08:34:   },
2025-09-20T19:08:34:   timestamp: 1758375514434
2025-09-20T19:08:34: }
2025-09-20T19:08:34: âŒ [919953020706_TJJ19092511_confirmation_1758375514427] Startup grace period active (232s remaining)
2025-09-20T19:08:34: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T19:08:34: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T19:08:34: â„¹ï¸ [7:08:34 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T19:08:34:   phone: '919****706',
2025-09-20T19:08:34:   orderId: 'TJJ19092511',
2025-09-20T19:08:34:   messageType: 'confirmation',
2025-09-20T19:08:34:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:08:34:   reason: {
2025-09-20T19:08:34:     contentHash: '97026037ffec053e',
2025-09-20T19:08:34:     timestamp: 1758375514441,
2025-09-20T19:08:34:     messageLength: 469,
2025-09-20T19:08:34:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T19:08:34:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T19:08:34:   },
2025-09-20T19:08:34:   duration: 0,
2025-09-20T19:08:34:   timestamp: 1758375514470
2025-09-20T19:08:34: }
2025-09-20T19:08:34: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:08:34: ğŸ“ Loaded 11 template types
2025-09-20T19:08:34: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T19:08:34: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T19:08:34: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T19:08:34: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758375514475] Starting comprehensive safety check...
2025-09-20T19:08:34: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758375514475] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T19:08:34: â„¹ï¸ [7:08:34 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:08:34:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:08:34:   phone: '919****488',
2025-09-20T19:08:34:   orderId: 'TWM19092511',
2025-09-20T19:08:34:   messageType: 'confirmation',
2025-09-20T19:08:34:   result: 'STARTED',
2025-09-20T19:08:34:   details: {
2025-09-20T19:08:34:     checkId: '919358537488_TWM19092511_confirmation_1758375514475',
2025-09-20T19:08:34:     hasOrderData: true,
2025-09-20T19:08:34:     hasSheetData: false,
2025-09-20T19:08:34:     messageLength: 475
2025-09-20T19:08:34:   },
2025-09-20T19:08:34:   timestamp: 1758375514475
2025-09-20T19:08:34: }
2025-09-20T19:08:34: ğŸ” [919358537488_TWM19092511_confirmation_1758375514475] Step 1: Kill Switch Check
2025-09-20T19:08:34: ğŸ” [919358537488_TWM19092511_confirmation_1758375514475] Step 1.5: Developer Phone Check
2025-09-20T19:08:34: ğŸ” [919358537488_TWM19092511_confirmation_1758375514475] Step 2: Grace Period Check
2025-09-20T19:08:34: â„¹ï¸ [7:08:34 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:08:34:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:08:34:   remainingMs: 231109,
2025-09-20T19:08:34:   remainingSeconds: 232,
2025-09-20T19:08:34:   details: {
2025-09-20T19:08:34:     checkId: '919358537488_TWM19092511_confirmation_1758375514475',
2025-09-20T19:08:34:     phone: '919358537488',
2025-09-20T19:08:34:     orderId: 'TWM19092511',
2025-09-20T19:08:34:     messageType: 'confirmation'
2025-09-20T19:08:34:   },
2025-09-20T19:08:34:   timestamp: 1758375514480
2025-09-20T19:08:34: }
2025-09-20T19:08:34: âŒ [919358537488_TWM19092511_confirmation_1758375514475] Startup grace period active (232s remaining)
2025-09-20T19:08:34: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T19:08:34: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T19:08:34: â„¹ï¸ [7:08:34 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T19:08:34:   phone: '919****488',
2025-09-20T19:08:34:   orderId: 'TWM19092511',
2025-09-20T19:08:34:   messageType: 'confirmation',
2025-09-20T19:08:34:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:08:34:   reason: {
2025-09-20T19:08:34:     contentHash: 'e34d023f065922da',
2025-09-20T19:08:34:     timestamp: 1758375514484,
2025-09-20T19:08:34:     messageLength: 475,
2025-09-20T19:08:34:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T19:08:34:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T19:08:34:   },
2025-09-20T19:08:34:   duration: 0,
2025-09-20T19:08:34:   timestamp: 1758375514499
2025-09-20T19:08:34: }
2025-09-20T19:08:34: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:08:34: ğŸ“ Loaded 11 template types
2025-09-20T19:08:34: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T19:08:34: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T19:08:34: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T19:08:34: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758375514502] Starting comprehensive safety check...
2025-09-20T19:08:34: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758375514502] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T19:08:34: â„¹ï¸ [7:08:34 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:08:34:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:08:34:   phone: '918****811',
2025-09-20T19:08:34:   orderId: 'TOF19092511',
2025-09-20T19:08:34:   messageType: 'confirmation',
2025-09-20T19:08:34:   result: 'STARTED',
2025-09-20T19:08:34:   details: {
2025-09-20T19:08:34:     checkId: '918890134811_TOF19092511_confirmation_1758375514502',
2025-09-20T19:08:34:     hasOrderData: true,
2025-09-20T19:08:34:     hasSheetData: false,
2025-09-20T19:08:34:     messageLength: 473
2025-09-20T19:08:34:   },
2025-09-20T19:08:34:   timestamp: 1758375514502
2025-09-20T19:08:34: }
2025-09-20T19:08:34: ğŸ” [918890134811_TOF19092511_confirmation_1758375514502] Step 1: Kill Switch Check
2025-09-20T19:08:34: ğŸ” [918890134811_TOF19092511_confirmation_1758375514502] Step 1.5: Developer Phone Check
2025-09-20T19:08:34: ğŸ” [918890134811_TOF19092511_confirmation_1758375514502] Step 2: Grace Period Check
2025-09-20T19:08:34: â„¹ï¸ [7:08:34 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:08:34:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:08:34:   remainingMs: 231085,
2025-09-20T19:08:34:   remainingSeconds: 232,
2025-09-20T19:08:34:   details: {
2025-09-20T19:08:34:     checkId: '918890134811_TOF19092511_confirmation_1758375514502',
2025-09-20T19:08:34:     phone: '918890134811',
2025-09-20T19:08:34:     orderId: 'TOF19092511',
2025-09-20T19:08:34:     messageType: 'confirmation'
2025-09-20T19:08:34:   },
2025-09-20T19:08:34:   timestamp: 1758375514504
2025-09-20T19:08:34: }
2025-09-20T19:08:34: âŒ [918890134811_TOF19092511_confirmation_1758375514502] Startup grace period active (232s remaining)
2025-09-20T19:08:34: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T19:08:34: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T19:08:34: â„¹ï¸ [7:08:34 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T19:08:34:   phone: '918****811',
2025-09-20T19:08:34:   orderId: 'TOF19092511',
2025-09-20T19:08:34:   messageType: 'confirmation',
2025-09-20T19:08:34:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:08:34:   reason: {
2025-09-20T19:08:34:     contentHash: '388fbe812e19f1de',
2025-09-20T19:08:34:     timestamp: 1758375514505,
2025-09-20T19:08:34:     messageLength: 473,
2025-09-20T19:08:34:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T19:08:34:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T19:08:34:   },
2025-09-20T19:08:34:   duration: 0,
2025-09-20T19:08:34:   timestamp: 1758375514514
2025-09-20T19:08:34: }
2025-09-20T19:08:55: ğŸ’¾ Data synced to files successfully
2025-09-20T19:09:25: ğŸ’¾ Data synced to files successfully
2025-09-20T19:09:55: ğŸ’¾ Data synced to files successfully
2025-09-20T19:10:25: ğŸ’¾ Data synced to files successfully
2025-09-20T19:10:55: ğŸ’¾ Data synced to files successfully
2025-09-20T19:11:25: ğŸ’¾ Data synced to files successfully
2025-09-20T19:11:34: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:11:34: ğŸ“ Loaded 11 template types
2025-09-20T19:11:34: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T19:11:34: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T19:11:34: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T19:11:34: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758375694382] Starting comprehensive safety check...
2025-09-20T19:11:34: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758375694382] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T19:11:34: â„¹ï¸ [7:11:34 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:11:34:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:11:34:   phone: '919****706',
2025-09-20T19:11:34:   orderId: 'TJJ19092511',
2025-09-20T19:11:34:   messageType: 'confirmation',
2025-09-20T19:11:34:   result: 'STARTED',
2025-09-20T19:11:34:   details: {
2025-09-20T19:11:34:     checkId: '919953020706_TJJ19092511_confirmation_1758375694382',
2025-09-20T19:11:34:     hasOrderData: true,
2025-09-20T19:11:34:     hasSheetData: false,
2025-09-20T19:11:34:     messageLength: 469
2025-09-20T19:11:34:   },
2025-09-20T19:11:34:   timestamp: 1758375694382
2025-09-20T19:11:34: }
2025-09-20T19:11:34: ğŸ” [919953020706_TJJ19092511_confirmation_1758375694382] Step 1: Kill Switch Check
2025-09-20T19:11:34: ğŸ” [919953020706_TJJ19092511_confirmation_1758375694382] Step 1.5: Developer Phone Check
2025-09-20T19:11:34: ğŸ” [919953020706_TJJ19092511_confirmation_1758375694382] Step 2: Grace Period Check
2025-09-20T19:11:34: â„¹ï¸ [7:11:34 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:11:34:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:11:34:   remainingMs: 51204,
2025-09-20T19:11:34:   remainingSeconds: 52,
2025-09-20T19:11:34:   details: {
2025-09-20T19:11:34:     checkId: '919953020706_TJJ19092511_confirmation_1758375694382',
2025-09-20T19:11:34:     phone: '919953020706',
2025-09-20T19:11:34:     orderId: 'TJJ19092511',
2025-09-20T19:11:34:     messageType: 'confirmation'
2025-09-20T19:11:34:   },
2025-09-20T19:11:34:   timestamp: 1758375694385
2025-09-20T19:11:34: }
2025-09-20T19:11:34: âŒ [919953020706_TJJ19092511_confirmation_1758375694382] Startup grace period active (52s remaining)
2025-09-20T19:11:34: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Startup grace period active (52s remaining)
2025-09-20T19:11:34: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T19:11:34: â„¹ï¸ [7:11:34 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T19:11:34:   phone: '919****706',
2025-09-20T19:11:34:   orderId: 'TJJ19092511',
2025-09-20T19:11:34:   messageType: 'confirmation',
2025-09-20T19:11:34:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:11:34:   reason: {
2025-09-20T19:11:34:     contentHash: '97026037ffec053e',
2025-09-20T19:11:34:     timestamp: 1758375694390,
2025-09-20T19:11:34:     messageLength: 469,
2025-09-20T19:11:34:     errorMessage: 'Startup grace period active (52s remaining)',
2025-09-20T19:11:34:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T19:11:34:   },
2025-09-20T19:11:34:   duration: 0,
2025-09-20T19:11:34:   timestamp: 1758375694399
2025-09-20T19:11:34: }
2025-09-20T19:11:34: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:11:34: ğŸ“ Loaded 11 template types
2025-09-20T19:11:34: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T19:11:34: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T19:11:34: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T19:11:34: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758375694402] Starting comprehensive safety check...
2025-09-20T19:11:34: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758375694402] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T19:11:34: â„¹ï¸ [7:11:34 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:11:34:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:11:34:   phone: '919****488',
2025-09-20T19:11:34:   orderId: 'TWM19092511',
2025-09-20T19:11:34:   messageType: 'confirmation',
2025-09-20T19:11:34:   result: 'STARTED',
2025-09-20T19:11:34:   details: {
2025-09-20T19:11:34:     checkId: '919358537488_TWM19092511_confirmation_1758375694402',
2025-09-20T19:11:34:     hasOrderData: true,
2025-09-20T19:11:34:     hasSheetData: false,
2025-09-20T19:11:34:     messageLength: 475
2025-09-20T19:11:34:   },
2025-09-20T19:11:34:   timestamp: 1758375694402
2025-09-20T19:11:34: }
2025-09-20T19:11:34: ğŸ” [919358537488_TWM19092511_confirmation_1758375694402] Step 1: Kill Switch Check
2025-09-20T19:11:34: ğŸ” [919358537488_TWM19092511_confirmation_1758375694402] Step 1.5: Developer Phone Check
2025-09-20T19:11:34: ğŸ” [919358537488_TWM19092511_confirmation_1758375694402] Step 2: Grace Period Check
2025-09-20T19:11:34: â„¹ï¸ [7:11:34 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:11:34:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:11:34:   remainingMs: 51183,
2025-09-20T19:11:34:   remainingSeconds: 52,
2025-09-20T19:11:34:   details: {
2025-09-20T19:11:34:     checkId: '919358537488_TWM19092511_confirmation_1758375694402',
2025-09-20T19:11:34:     phone: '919358537488',
2025-09-20T19:11:34:     orderId: 'TWM19092511',
2025-09-20T19:11:34:     messageType: 'confirmation'
2025-09-20T19:11:34:   },
2025-09-20T19:11:34:   timestamp: 1758375694406
2025-09-20T19:11:34: }
2025-09-20T19:11:34: âŒ [919358537488_TWM19092511_confirmation_1758375694402] Startup grace period active (52s remaining)
2025-09-20T19:11:34: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Startup grace period active (52s remaining)
2025-09-20T19:11:34: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T19:11:34: â„¹ï¸ [7:11:34 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T19:11:34:   phone: '919****488',
2025-09-20T19:11:34:   orderId: 'TWM19092511',
2025-09-20T19:11:34:   messageType: 'confirmation',
2025-09-20T19:11:34:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:11:34:   reason: {
2025-09-20T19:11:34:     contentHash: 'e34d023f065922da',
2025-09-20T19:11:34:     timestamp: 1758375694408,
2025-09-20T19:11:34:     messageLength: 475,
2025-09-20T19:11:34:     errorMessage: 'Startup grace period active (52s remaining)',
2025-09-20T19:11:34:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T19:11:34:   },
2025-09-20T19:11:34:   duration: 0,
2025-09-20T19:11:34:   timestamp: 1758375694417
2025-09-20T19:11:34: }
2025-09-20T19:11:34: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:11:34: ğŸ“ Loaded 11 template types
2025-09-20T19:11:34: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T19:11:34: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T19:11:34: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T19:11:34: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758375694419] Starting comprehensive safety check...
2025-09-20T19:11:34: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758375694419] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T19:11:34: â„¹ï¸ [7:11:34 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:11:34:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:11:34:   phone: '918****811',
2025-09-20T19:11:34:   orderId: 'TOF19092511',
2025-09-20T19:11:34:   messageType: 'confirmation',
2025-09-20T19:11:34:   result: 'STARTED',
2025-09-20T19:11:34:   details: {
2025-09-20T19:11:34:     checkId: '918890134811_TOF19092511_confirmation_1758375694419',
2025-09-20T19:11:34:     hasOrderData: true,
2025-09-20T19:11:34:     hasSheetData: false,
2025-09-20T19:11:34:     messageLength: 473
2025-09-20T19:11:34:   },
2025-09-20T19:11:34:   timestamp: 1758375694419
2025-09-20T19:11:34: }
2025-09-20T19:11:34: ğŸ” [918890134811_TOF19092511_confirmation_1758375694419] Step 1: Kill Switch Check
2025-09-20T19:11:34: ğŸ” [918890134811_TOF19092511_confirmation_1758375694419] Step 1.5: Developer Phone Check
2025-09-20T19:11:34: ğŸ” [918890134811_TOF19092511_confirmation_1758375694419] Step 2: Grace Period Check
2025-09-20T19:11:34: â„¹ï¸ [7:11:34 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:11:34:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:11:34:   remainingMs: 51165,
2025-09-20T19:11:34:   remainingSeconds: 52,
2025-09-20T19:11:34:   details: {
2025-09-20T19:11:34:     checkId: '918890134811_TOF19092511_confirmation_1758375694419',
2025-09-20T19:11:34:     phone: '918890134811',
2025-09-20T19:11:34:     orderId: 'TOF19092511',
2025-09-20T19:11:34:     messageType: 'confirmation'
2025-09-20T19:11:34:   },
2025-09-20T19:11:34:   timestamp: 1758375694424
2025-09-20T19:11:34: }
2025-09-20T19:11:34: âŒ [918890134811_TOF19092511_confirmation_1758375694419] Startup grace period active (52s remaining)
2025-09-20T19:11:34: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (52s remaining)
2025-09-20T19:11:34: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T19:11:34: â„¹ï¸ [7:11:34 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T19:11:34:   phone: '918****811',
2025-09-20T19:11:34:   orderId: 'TOF19092511',
2025-09-20T19:11:34:   messageType: 'confirmation',
2025-09-20T19:11:34:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:11:34:   reason: {
2025-09-20T19:11:34:     contentHash: '388fbe812e19f1de',
2025-09-20T19:11:34:     timestamp: 1758375694426,
2025-09-20T19:11:34:     messageLength: 473,
2025-09-20T19:11:34:     errorMessage: 'Startup grace period active (52s remaining)',
2025-09-20T19:11:34:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T19:11:34:   },
2025-09-20T19:11:34:   duration: 0,
2025-09-20T19:11:34:   timestamp: 1758375694435
2025-09-20T19:11:34: }
2025-09-20T19:11:55: ğŸ’¾ Data synced to files successfully
2025-09-20T19:12:25: âœ… Startup grace period ended - message sending now allowed
2025-09-20T19:12:25: âœ… Startup grace period ended - message sending now allowed
2025-09-20T19:12:25: â„¹ï¸ [7:12:25 pm] INFO: Grace Period: ENDED {
2025-09-20T19:12:25:   action: 'ENDED',
2025-09-20T19:12:25:   remainingMs: 0,
2025-09-20T19:12:25:   remainingSeconds: 0,
2025-09-20T19:12:25:   details: { totalDuration: 240000, processId: 852 },
2025-09-20T19:12:25:   timestamp: 1758375745695
2025-09-20T19:12:25: }
2025-09-20T19:12:25: â„¹ï¸ [7:12:25 pm] INFO: Grace Period: ENDED {
2025-09-20T19:12:25:   action: 'ENDED',
2025-09-20T19:12:25:   remainingMs: 0,
2025-09-20T19:12:25:   remainingSeconds: 0,
2025-09-20T19:12:25:   details: { totalDuration: 240000, processId: 852 },
2025-09-20T19:12:25:   timestamp: 1758375745693
2025-09-20T19:12:25: }
2025-09-20T19:12:25: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T19:12:25: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T19:12:25: ğŸ’¾ Data synced to files successfully
2025-09-20T19:12:55: ğŸ’¾ Data synced to files successfully
2025-09-20T19:13:25: ğŸ’¾ Data synced to files successfully
2025-09-20T19:13:55: ğŸ’¾ Data synced to files successfully
2025-09-20T19:14:12: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:14:12: ğŸ“ Loaded 11 template types
2025-09-20T19:14:12: ğŸ”§ WhatsApp Bot initialized
2025-09-20T19:14:12: ğŸ“Š Configuration status: undefined
2025-09-20T19:14:12: âœ… Atomic State Manager initialized
2025-09-20T19:14:12: ğŸ“ Enhanced Logger initialized
2025-09-20T19:14:12: âœ… Google credentials loaded from service-account.json file
2025-09-20T19:14:12: ğŸ“± WhatsApp auth status: âœ… credentials, 4 session files
2025-09-20T19:14:12: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-20T19:14:12:    Auth Mode: both
2025-09-20T19:14:12:    QR Enabled: true
2025-09-20T19:14:12:    Phone Enabled: true
2025-09-20T19:14:12:    Session Persistence: true
2025-09-20T19:14:12:    Max Reconnect Attempts: 10
2025-09-20T19:14:12:    Default Phone: None
2025-09-20T19:14:12: ğŸ”’ Session validation enabled (check every 300s)
2025-09-20T19:14:12: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-20T19:14:12: ğŸ”§ Developer Configuration initialized
2025-09-20T19:14:12: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T19:14:12: â„¹ï¸ [7:14:12 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T19:14:12:   startupTime: 1758375852298,
2025-09-20T19:14:12:   gracePeriodMs: 240000,
2025-09-20T19:14:12:   dataDir: './safety-data',
2025-09-20T19:14:12:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T19:14:12:   processId: 16456,
2025-09-20T19:14:12:   nodeVersion: 'v22.19.0'
2025-09-20T19:14:12: }
2025-09-20T19:14:12: ğŸ”§ Developer Configuration initialized
2025-09-20T19:14:12: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T19:14:12: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-20T19:14:12: â° 4-minute startup delay active
2025-09-20T19:14:12: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-20T19:14:12: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-20T19:14:12: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T19:14:12: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T19:14:12: âœ… Google Sheets API initialized
2025-09-20T19:14:12: âœ… Google Sheets API initialized
2025-09-20T19:14:12: â„¹ï¸ [7:14:12 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T19:14:12:   startupTime: 1758375852298,
2025-09-20T19:14:12:   gracePeriodMs: 240000,
2025-09-20T19:14:12:   dataDir: './safety-data',
2025-09-20T19:14:12:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T19:14:12:   processId: 16456,
2025-09-20T19:14:12:   nodeVersion: 'v22.19.0'
2025-09-20T19:14:12: }
2025-09-20T19:14:12: â„¹ï¸ [7:14:12 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T19:14:12: ğŸ“ Loaded 0 sent messages from file
2025-09-20T19:14:12: ğŸ“ Loaded 0 customer histories from file
2025-09-20T19:14:12: â„¹ï¸ [7:14:12 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T19:14:12: â„¹ï¸ [7:14:12 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T19:14:12: ğŸ“ Loaded 0 message hashes from file
2025-09-20T19:14:12: â„¹ï¸ [7:14:12 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T19:14:12: ğŸ“ Loaded statistics from file
2025-09-20T19:14:12: âœ… Duplicate Prevention Manager initialized
2025-09-20T19:14:12: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T19:14:12: ğŸ§¹ Removed stale process lock
2025-09-20T19:14:12: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T11-32-56-005Z.log
2025-09-20T19:14:12: ğŸ“ Enhanced Logger initialized
2025-09-20T19:14:12: ğŸ”’ Process lock acquired (PID: 16456)
2025-09-20T19:14:12: ğŸ”’ Process lock acquired (PID: 16456)
2025-09-20T19:14:12: â„¹ï¸ [7:14:12 pm] INFO: Process isolation enforced {
2025-09-20T19:14:12:   lockFile: 'safety-data\\process.lock',
2025-09-20T19:14:12:   pidFile: 'safety-data\\process.pid',
2025-09-20T19:14:12:   processId: 16456
2025-09-20T19:14:12: }
2025-09-20T19:14:12: â° Starting 240 second startup grace period...
2025-09-20T19:14:12: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T19:14:12: â„¹ï¸ [7:14:12 pm] INFO: Process isolation enforced {
2025-09-20T19:14:12:   lockFile: 'safety-data\\process.lock',
2025-09-20T19:14:12:   pidFile: 'safety-data\\process.pid',
2025-09-20T19:14:12:   processId: 16456
2025-09-20T19:14:12: }
2025-09-20T19:14:12: â° Starting 240 second startup grace period...
2025-09-20T19:14:12: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T19:14:12: â„¹ï¸ [7:14:12 pm] INFO: Grace Period: STARTED {
2025-09-20T19:14:12:   action: 'STARTED',
2025-09-20T19:14:12:   remainingMs: 240000,
2025-09-20T19:14:12:   remainingSeconds: 240,
2025-09-20T19:14:12:   details: { startupTime: 1758375852298, processId: 16456 },
2025-09-20T19:14:12:   timestamp: 1758375852373
2025-09-20T19:14:12: }
2025-09-20T19:14:12: â„¹ï¸ [7:14:12 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T19:14:12:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T19:14:12:   remainingMs: 240000,
2025-09-20T19:14:12:   remainingSeconds: 240,
2025-09-20T19:14:12:   details: { startupTime: 1758375852298, willExpireAt: 1758376092298 },
2025-09-20T19:14:12:   timestamp: 1758375852375
2025-09-20T19:14:12: }
2025-09-20T19:14:12: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T19:14:12: â° Startup grace period: 240 seconds
2025-09-20T19:14:12: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T19:14:12: â„¹ï¸ [7:14:12 pm] INFO: Grace Period: STARTED {
2025-09-20T19:14:12:   action: 'STARTED',
2025-09-20T19:14:12:   remainingMs: 240000,
2025-09-20T19:14:12:   remainingSeconds: 240,
2025-09-20T19:14:12:   details: { startupTime: 1758375852298, processId: 16456 },
2025-09-20T19:14:12:   timestamp: 1758375852379
2025-09-20T19:14:12: }
2025-09-20T19:14:12: â„¹ï¸ [7:14:12 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T19:14:12:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T19:14:12:   remainingMs: 240000,
2025-09-20T19:14:12:   remainingSeconds: 240,
2025-09-20T19:14:12:   details: { startupTime: 1758375852298, willExpireAt: 1758376092298 },
2025-09-20T19:14:12:   timestamp: 1758375852379
2025-09-20T19:14:12: }
2025-09-20T19:14:12: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T19:14:12: â° Startup grace period: 240 seconds
2025-09-20T19:14:12: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T19:14:12: â„¹ï¸ [7:14:12 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T19:14:12:   initializationDuration: 83,
2025-09-20T19:14:12:   gracePeriodActive: true,
2025-09-20T19:14:12:   messageRulesCount: 8,
2025-09-20T19:14:12:   messageTypes: [
2025-09-20T19:14:12:     'welcome',
2025-09-20T19:14:12:     'confirmation',
2025-09-20T19:14:12:     'ready',
2025-09-20T19:14:12:     'delivery',
2025-09-20T19:14:12:     'pickup_reminder',
2025-09-20T19:14:12:     'payment_reminder',
2025-09-20T19:14:12:     'fabric_welcome',
2025-09-20T19:14:12:     'fabric_purchase'
2025-09-20T19:14:12:   ],
2025-09-20T19:14:12:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T19:14:12:   databaseReady: true,
2025-09-20T19:14:12:   loggerReady: true,
2025-09-20T19:14:12:   processIsolationActive: true
2025-09-20T19:14:12: }
2025-09-20T19:14:12: âœ… Safety Manager initialized
2025-09-20T19:14:12: â„¹ï¸ [7:14:12 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T19:14:12:   initializationDuration: 85,
2025-09-20T19:14:12:   gracePeriodActive: true,
2025-09-20T19:14:12:   messageRulesCount: 8,
2025-09-20T19:14:12:   messageTypes: [
2025-09-20T19:14:12:     'welcome',
2025-09-20T19:14:12:     'confirmation',
2025-09-20T19:14:12:     'ready',
2025-09-20T19:14:12:     'delivery',
2025-09-20T19:14:12:     'pickup_reminder',
2025-09-20T19:14:12:     'payment_reminder',
2025-09-20T19:14:12:     'fabric_welcome',
2025-09-20T19:14:12:     'fabric_purchase'
2025-09-20T19:14:12:   ],
2025-09-20T19:14:12:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T19:14:12:   databaseReady: true,
2025-09-20T19:14:12:   loggerReady: true,
2025-09-20T19:14:12:   processIsolationActive: true
2025-09-20T19:14:12: }
2025-09-20T19:14:12: ğŸ“ Loaded 0 sent messages from file
2025-09-20T19:14:12: ğŸ“ Loaded 0 customer histories from file
2025-09-20T19:14:12: ğŸ“ Loaded 0 message hashes from file
2025-09-20T19:14:12: ğŸ“ Loaded statistics from file
2025-09-20T19:14:12: âœ… Duplicate Prevention Manager initialized
2025-09-20T19:14:12: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T19:14:12: âœ… Duplicate Prevention Manager initialized
2025-09-20T19:14:12: ğŸ”„ Starting WhatsApp connection...
2025-09-20T19:14:12: ğŸ”„ Initializing WhatsApp client...
2025-09-20T19:14:12: âœ… WhatsApp connection started
2025-09-20T19:14:12: ğŸ”§ Initializing admin commands...
2025-09-20T19:14:12: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T19:14:12: âœ… Admin commands system initialized
2025-09-20T19:14:12: ğŸ”„ Initializing polling functionality...
2025-09-20T19:14:12: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T19:14:12: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T19:14:12: ğŸ“ Attempting to request pairing code...
2025-09-20T19:14:12: ğŸ’¡ To use phone authentication:
2025-09-20T19:14:12:    1. Use the dashboard at http://localhost:3001
2025-09-20T19:14:12:    2. Select "Phone Number Authentication"
2025-09-20T19:14:12:    3. Enter your phone number
2025-09-20T19:14:12:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T19:14:12: ğŸ”„ Connecting to WhatsApp...
2025-09-20T19:14:14: âœ… WhatsApp connected successfully!
2025-09-20T19:14:14: ğŸ”„ Enhanced client: Connected event received, forwarding...
2025-09-20T19:14:14: ğŸ“± Session established successfully
2025-09-20T19:14:14: ğŸ”’ Session will be monitored for stability
2025-09-20T19:14:19: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:14:19: ğŸ“ Loaded 11 template types
2025-09-20T19:14:19: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T19:14:19: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T19:14:19: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T19:14:19: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758375859976] Starting comprehensive safety check...
2025-09-20T19:14:19: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758375859976] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T19:14:19: â„¹ï¸ [7:14:19 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:14:19:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:14:19:   phone: '919****706',
2025-09-20T19:14:19:   orderId: 'TJJ19092511',
2025-09-20T19:14:19:   messageType: 'confirmation',
2025-09-20T19:14:19:   result: 'STARTED',
2025-09-20T19:14:19:   details: {
2025-09-20T19:14:19:     checkId: '919953020706_TJJ19092511_confirmation_1758375859976',
2025-09-20T19:14:19:     hasOrderData: true,
2025-09-20T19:14:19:     hasSheetData: false,
2025-09-20T19:14:19:     messageLength: 469
2025-09-20T19:14:19:   },
2025-09-20T19:14:19:   timestamp: 1758375859977
2025-09-20T19:14:19: }
2025-09-20T19:14:19: ğŸ” [919953020706_TJJ19092511_confirmation_1758375859976] Step 1: Kill Switch Check
2025-09-20T19:14:19: ğŸ” [919953020706_TJJ19092511_confirmation_1758375859976] Step 1.5: Developer Phone Check
2025-09-20T19:14:19: ğŸ” [919953020706_TJJ19092511_confirmation_1758375859976] Step 2: Grace Period Check
2025-09-20T19:14:19: â„¹ï¸ [7:14:19 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:14:19:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:14:19:   remainingMs: 232314,
2025-09-20T19:14:19:   remainingSeconds: 233,
2025-09-20T19:14:19:   details: {
2025-09-20T19:14:19:     checkId: '919953020706_TJJ19092511_confirmation_1758375859976',
2025-09-20T19:14:19:     phone: '919953020706',
2025-09-20T19:14:19:     orderId: 'TJJ19092511',
2025-09-20T19:14:19:     messageType: 'confirmation'
2025-09-20T19:14:19:   },
2025-09-20T19:14:19:   timestamp: 1758375859985
2025-09-20T19:14:19: }
2025-09-20T19:14:19: âŒ [919953020706_TJJ19092511_confirmation_1758375859976] Startup grace period active (233s remaining)
2025-09-20T19:14:19: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Startup grace period active (233s remaining)
2025-09-20T19:14:20: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T19:14:20: â„¹ï¸ [7:14:20 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T19:14:20:   phone: '919****706',
2025-09-20T19:14:20:   orderId: 'TJJ19092511',
2025-09-20T19:14:20:   messageType: 'confirmation',
2025-09-20T19:14:20:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:14:20:   reason: {
2025-09-20T19:14:20:     contentHash: '97026037ffec053e',
2025-09-20T19:14:20:     timestamp: 1758375859989,
2025-09-20T19:14:20:     messageLength: 469,
2025-09-20T19:14:20:     errorMessage: 'Startup grace period active (233s remaining)',
2025-09-20T19:14:20:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T19:14:20:   },
2025-09-20T19:14:20:   duration: 0,
2025-09-20T19:14:20:   timestamp: 1758375860007
2025-09-20T19:14:20: }
2025-09-20T19:14:20: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:14:20: ğŸ“ Loaded 11 template types
2025-09-20T19:14:20: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T19:14:20: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T19:14:20: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T19:14:20: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758375860011] Starting comprehensive safety check...
2025-09-20T19:14:20: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758375860011] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T19:14:20: â„¹ï¸ [7:14:20 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:14:20:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:14:20:   phone: '919****488',
2025-09-20T19:14:20:   orderId: 'TWM19092511',
2025-09-20T19:14:20:   messageType: 'confirmation',
2025-09-20T19:14:20:   result: 'STARTED',
2025-09-20T19:14:20:   details: {
2025-09-20T19:14:20:     checkId: '919358537488_TWM19092511_confirmation_1758375860011',
2025-09-20T19:14:20:     hasOrderData: true,
2025-09-20T19:14:20:     hasSheetData: false,
2025-09-20T19:14:20:     messageLength: 475
2025-09-20T19:14:20:   },
2025-09-20T19:14:20:   timestamp: 1758375860011
2025-09-20T19:14:20: }
2025-09-20T19:14:20: ğŸ” [919358537488_TWM19092511_confirmation_1758375860011] Step 1: Kill Switch Check
2025-09-20T19:14:20: ğŸ” [919358537488_TWM19092511_confirmation_1758375860011] Step 1.5: Developer Phone Check
2025-09-20T19:14:20: ğŸ” [919358537488_TWM19092511_confirmation_1758375860011] Step 2: Grace Period Check
2025-09-20T19:14:20: â„¹ï¸ [7:14:20 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:14:20:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:14:20:   remainingMs: 232282,
2025-09-20T19:14:20:   remainingSeconds: 233,
2025-09-20T19:14:20:   details: {
2025-09-20T19:14:20:     checkId: '919358537488_TWM19092511_confirmation_1758375860011',
2025-09-20T19:14:20:     phone: '919358537488',
2025-09-20T19:14:20:     orderId: 'TWM19092511',
2025-09-20T19:14:20:     messageType: 'confirmation'
2025-09-20T19:14:20:   },
2025-09-20T19:14:20:   timestamp: 1758375860016
2025-09-20T19:14:20: }
2025-09-20T19:14:20: âŒ [919358537488_TWM19092511_confirmation_1758375860011] Startup grace period active (233s remaining)
2025-09-20T19:14:20: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Startup grace period active (233s remaining)
2025-09-20T19:14:20: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T19:14:20: â„¹ï¸ [7:14:20 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T19:14:20:   phone: '919****488',
2025-09-20T19:14:20:   orderId: 'TWM19092511',
2025-09-20T19:14:20:   messageType: 'confirmation',
2025-09-20T19:14:20:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:14:20:   reason: {
2025-09-20T19:14:20:     contentHash: 'e34d023f065922da',
2025-09-20T19:14:20:     timestamp: 1758375860019,
2025-09-20T19:14:20:     messageLength: 475,
2025-09-20T19:14:20:     errorMessage: 'Startup grace period active (233s remaining)',
2025-09-20T19:14:20:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T19:14:20:   },
2025-09-20T19:14:20:   duration: 0,
2025-09-20T19:14:20:   timestamp: 1758375860032
2025-09-20T19:14:20: }
2025-09-20T19:14:20: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:14:20: ğŸ“ Loaded 11 template types
2025-09-20T19:14:20: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T19:14:20: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T19:14:20: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T19:14:20: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758375860035] Starting comprehensive safety check...
2025-09-20T19:14:20: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758375860035] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T19:14:20: â„¹ï¸ [7:14:20 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:14:20:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:14:20:   phone: '918****811',
2025-09-20T19:14:20:   orderId: 'TOF19092511',
2025-09-20T19:14:20:   messageType: 'confirmation',
2025-09-20T19:14:20:   result: 'STARTED',
2025-09-20T19:14:20:   details: {
2025-09-20T19:14:20:     checkId: '918890134811_TOF19092511_confirmation_1758375860035',
2025-09-20T19:14:20:     hasOrderData: true,
2025-09-20T19:14:20:     hasSheetData: false,
2025-09-20T19:14:20:     messageLength: 473
2025-09-20T19:14:20:   },
2025-09-20T19:14:20:   timestamp: 1758375860035
2025-09-20T19:14:20: }
2025-09-20T19:14:20: ğŸ” [918890134811_TOF19092511_confirmation_1758375860035] Step 1: Kill Switch Check
2025-09-20T19:14:20: ğŸ” [918890134811_TOF19092511_confirmation_1758375860035] Step 1.5: Developer Phone Check
2025-09-20T19:14:20: ğŸ” [918890134811_TOF19092511_confirmation_1758375860035] Step 2: Grace Period Check
2025-09-20T19:14:20: â„¹ï¸ [7:14:20 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:14:20:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:14:20:   remainingMs: 232261,
2025-09-20T19:14:20:   remainingSeconds: 233,
2025-09-20T19:14:20:   details: {
2025-09-20T19:14:20:     checkId: '918890134811_TOF19092511_confirmation_1758375860035',
2025-09-20T19:14:20:     phone: '918890134811',
2025-09-20T19:14:20:     orderId: 'TOF19092511',
2025-09-20T19:14:20:     messageType: 'confirmation'
2025-09-20T19:14:20:   },
2025-09-20T19:14:20:   timestamp: 1758375860038
2025-09-20T19:14:20: }
2025-09-20T19:14:20: âŒ [918890134811_TOF19092511_confirmation_1758375860035] Startup grace period active (233s remaining)
2025-09-20T19:14:20: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (233s remaining)
2025-09-20T19:14:20: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T19:14:20: â„¹ï¸ [7:14:20 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T19:14:20:   phone: '918****811',
2025-09-20T19:14:20:   orderId: 'TOF19092511',
2025-09-20T19:14:20:   messageType: 'confirmation',
2025-09-20T19:14:20:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:14:20:   reason: {
2025-09-20T19:14:20:     contentHash: '388fbe812e19f1de',
2025-09-20T19:14:20:     timestamp: 1758375860040,
2025-09-20T19:14:20:     messageLength: 473,
2025-09-20T19:14:20:     errorMessage: 'Startup grace period active (233s remaining)',
2025-09-20T19:14:20:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T19:14:20:   },
2025-09-20T19:14:20:   duration: 0,
2025-09-20T19:14:20:   timestamp: 1758375860053
2025-09-20T19:14:20: }
2025-09-20T19:14:42: ğŸ’¾ Data synced to files successfully
2025-09-20T19:15:12: ğŸ’¾ Data synced to files successfully
2025-09-20T19:25:55: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:25:55: ğŸ“ Loaded 11 template types
2025-09-20T19:25:55: ğŸ”§ WhatsApp Bot initialized
2025-09-20T19:25:55: ğŸ“Š Configuration status: undefined
2025-09-20T19:25:55: âœ… Atomic State Manager initialized
2025-09-20T19:25:55: ğŸ“ Enhanced Logger initialized
2025-09-20T19:25:55: âœ… Google credentials loaded from service-account.json file
2025-09-20T19:25:55: ğŸ“± WhatsApp auth status: âœ… credentials, 4 session files
2025-09-20T19:25:55: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-20T19:25:55:    Auth Mode: both
2025-09-20T19:25:55:    QR Enabled: true
2025-09-20T19:25:55:    Phone Enabled: true
2025-09-20T19:25:55:    Session Persistence: true
2025-09-20T19:25:55:    Max Reconnect Attempts: 10
2025-09-20T19:25:55:    Default Phone: None
2025-09-20T19:25:55: ğŸ”’ Session validation enabled (check every 300s)
2025-09-20T19:25:55: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-20T19:25:55: ğŸ”§ Developer Configuration initialized
2025-09-20T19:25:55: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T19:25:55: â„¹ï¸ [7:25:55 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T19:25:55:   startupTime: 1758376555509,
2025-09-20T19:25:55:   gracePeriodMs: 240000,
2025-09-20T19:25:55:   dataDir: './safety-data',
2025-09-20T19:25:55:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T19:25:55:   processId: 1988,
2025-09-20T19:25:55:   nodeVersion: 'v22.19.0'
2025-09-20T19:25:55: }
2025-09-20T19:25:55: ğŸ”§ Developer Configuration initialized
2025-09-20T19:25:55: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T19:25:55: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-20T19:25:55: â° 4-minute startup delay active
2025-09-20T19:25:55: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-20T19:25:55: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-20T19:25:55: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T19:25:55: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T19:25:55: âœ… Google Sheets API initialized
2025-09-20T19:25:55: âœ… Google Sheets API initialized
2025-09-20T19:25:55: â„¹ï¸ [7:25:55 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T19:25:55:   startupTime: 1758376555509,
2025-09-20T19:25:55:   gracePeriodMs: 240000,
2025-09-20T19:25:55:   dataDir: './safety-data',
2025-09-20T19:25:55:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T19:25:55:   processId: 1988,
2025-09-20T19:25:55:   nodeVersion: 'v22.19.0'
2025-09-20T19:25:55: }
2025-09-20T19:25:55: ğŸ“ Loaded 0 sent messages from file
2025-09-20T19:25:55: â„¹ï¸ [7:25:55 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T19:25:55: ğŸ“ Loaded 0 customer histories from file
2025-09-20T19:25:55: â„¹ï¸ [7:25:55 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T19:25:55: ğŸ“ Loaded 0 message hashes from file
2025-09-20T19:25:55: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T11-40-44-999Z.log
2025-09-20T19:25:55: ğŸ“ Enhanced Logger initialized
2025-09-20T19:25:55: ğŸ“ Loaded statistics from file
2025-09-20T19:25:55: âœ… Duplicate Prevention Manager initialized
2025-09-20T19:25:55: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T19:25:55: â„¹ï¸ [7:25:55 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T19:25:55: â„¹ï¸ [7:25:55 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T19:25:55: ğŸ§¹ Removed stale process lock
2025-09-20T19:25:55: ğŸ§¹ Lock file already cleaned up
2025-09-20T19:25:55: ğŸ”’ Process lock acquired (PID: 1988)
2025-09-20T19:25:55: ğŸ”’ Process lock acquired (PID: 1988)
2025-09-20T19:25:55: â„¹ï¸ [7:25:55 pm] INFO: Process isolation enforced {
2025-09-20T19:25:55:   lockFile: 'safety-data\\process.lock',
2025-09-20T19:25:55:   pidFile: 'safety-data\\process.pid',
2025-09-20T19:25:55:   processId: 1988
2025-09-20T19:25:55: }
2025-09-20T19:25:55: â° Starting 240 second startup grace period...
2025-09-20T19:25:55: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T19:25:55: â„¹ï¸ [7:25:55 pm] INFO: Process isolation enforced {
2025-09-20T19:25:55:   lockFile: 'safety-data\\process.lock',
2025-09-20T19:25:55:   pidFile: 'safety-data\\process.pid',
2025-09-20T19:25:55:   processId: 1988
2025-09-20T19:25:55: }
2025-09-20T19:25:55: â° Starting 240 second startup grace period...
2025-09-20T19:25:55: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T19:25:55: â„¹ï¸ [7:25:55 pm] INFO: Grace Period: STARTED {
2025-09-20T19:25:55:   action: 'STARTED',
2025-09-20T19:25:55:   remainingMs: 240000,
2025-09-20T19:25:55:   remainingSeconds: 240,
2025-09-20T19:25:55:   details: { startupTime: 1758376555509, processId: 1988 },
2025-09-20T19:25:55:   timestamp: 1758376555606
2025-09-20T19:25:55: }
2025-09-20T19:25:55: â„¹ï¸ [7:25:55 pm] INFO: Grace Period: STARTED {
2025-09-20T19:25:55:   action: 'STARTED',
2025-09-20T19:25:55:   remainingMs: 240000,
2025-09-20T19:25:55:   remainingSeconds: 240,
2025-09-20T19:25:55:   details: { startupTime: 1758376555509, processId: 1988 },
2025-09-20T19:25:55:   timestamp: 1758376555607
2025-09-20T19:25:55: }
2025-09-20T19:25:55: â„¹ï¸ [7:25:55 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T19:25:55:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T19:25:55:   remainingMs: 240000,
2025-09-20T19:25:55:   remainingSeconds: 240,
2025-09-20T19:25:55:   details: { startupTime: 1758376555509, willExpireAt: 1758376795509 },
2025-09-20T19:25:55:   timestamp: 1758376555607
2025-09-20T19:25:55: }
2025-09-20T19:25:55: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T19:25:55: â° Startup grace period: 240 seconds
2025-09-20T19:25:55: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T19:25:55: â„¹ï¸ [7:25:55 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T19:25:55:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T19:25:55:   remainingMs: 240000,
2025-09-20T19:25:55:   remainingSeconds: 240,
2025-09-20T19:25:55:   details: { startupTime: 1758376555509, willExpireAt: 1758376795509 },
2025-09-20T19:25:55:   timestamp: 1758376555606
2025-09-20T19:25:55: }
2025-09-20T19:25:55: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T19:25:55: â° Startup grace period: 240 seconds
2025-09-20T19:25:55: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T19:25:55: â„¹ï¸ [7:25:55 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T19:25:55:   initializationDuration: 101,
2025-09-20T19:25:55:   gracePeriodActive: true,
2025-09-20T19:25:55:   messageRulesCount: 8,
2025-09-20T19:25:55:   messageTypes: [
2025-09-20T19:25:55:     'welcome',
2025-09-20T19:25:55:     'confirmation',
2025-09-20T19:25:55:     'ready',
2025-09-20T19:25:55:     'delivery',
2025-09-20T19:25:55:     'pickup_reminder',
2025-09-20T19:25:55:     'payment_reminder',
2025-09-20T19:25:55:     'fabric_welcome',
2025-09-20T19:25:55:     'fabric_purchase'
2025-09-20T19:25:55:   ],
2025-09-20T19:25:55:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T19:25:55:   databaseReady: true,
2025-09-20T19:25:55:   loggerReady: true,
2025-09-20T19:25:55:   processIsolationActive: true
2025-09-20T19:25:55: }
2025-09-20T19:25:55: âœ… Safety Manager initialized
2025-09-20T19:25:55: â„¹ï¸ [7:25:55 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T19:25:55:   initializationDuration: 102,
2025-09-20T19:25:55:   gracePeriodActive: true,
2025-09-20T19:25:55:   messageRulesCount: 8,
2025-09-20T19:25:55:   messageTypes: [
2025-09-20T19:25:55:     'welcome',
2025-09-20T19:25:55:     'confirmation',
2025-09-20T19:25:55:     'ready',
2025-09-20T19:25:55:     'delivery',
2025-09-20T19:25:55:     'pickup_reminder',
2025-09-20T19:25:55:     'payment_reminder',
2025-09-20T19:25:55:     'fabric_welcome',
2025-09-20T19:25:55:     'fabric_purchase'
2025-09-20T19:25:55:   ],
2025-09-20T19:25:55:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T19:25:55:   databaseReady: true,
2025-09-20T19:25:55:   loggerReady: true,
2025-09-20T19:25:55:   processIsolationActive: true
2025-09-20T19:25:55: }
2025-09-20T19:25:55: ğŸ“ Loaded 0 sent messages from file
2025-09-20T19:25:55: ğŸ“ Loaded 0 customer histories from file
2025-09-20T19:25:55: ğŸ“ Loaded 0 message hashes from file
2025-09-20T19:25:55: ğŸ“ Loaded statistics from file
2025-09-20T19:25:55: âœ… Duplicate Prevention Manager initialized
2025-09-20T19:25:55: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T19:25:55: âœ… Duplicate Prevention Manager initialized
2025-09-20T19:25:55: ğŸ”„ Starting WhatsApp connection...
2025-09-20T19:25:55: ğŸ”„ Initializing WhatsApp client...
2025-09-20T19:25:55: âœ… WhatsApp connection started
2025-09-20T19:25:55: ğŸ”§ Initializing admin commands...
2025-09-20T19:25:55: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T19:25:55: âœ… Admin commands system initialized
2025-09-20T19:25:55: ğŸ”„ Initializing polling functionality...
2025-09-20T19:25:55: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T19:25:55: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T19:25:55: ğŸ“ Attempting to request pairing code...
2025-09-20T19:25:55: ğŸ’¡ To use phone authentication:
2025-09-20T19:25:55:    1. Use the dashboard at http://localhost:3001
2025-09-20T19:25:55:    2. Select "Phone Number Authentication"
2025-09-20T19:25:55:    3. Enter your phone number
2025-09-20T19:25:55:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T19:25:55: ğŸ”„ Connecting to WhatsApp...
2025-09-20T19:25:57: âœ… WhatsApp connected successfully!
2025-09-20T19:25:57: ğŸ”„ Enhanced client: Connected event received, forwarding...
2025-09-20T19:25:57: ğŸ“± Session established successfully
2025-09-20T19:25:57: ğŸ”’ Session will be monitored for stability
2025-09-20T19:26:03: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:26:03: ğŸ“ Loaded 11 template types
2025-09-20T19:26:03: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T19:26:03: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T19:26:03: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T19:26:03: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758376563870] Starting comprehensive safety check...
2025-09-20T19:26:03: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758376563870] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T19:26:03: â„¹ï¸ [7:26:03 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:26:03:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:26:03:   phone: '919****706',
2025-09-20T19:26:03:   orderId: 'TJJ19092511',
2025-09-20T19:26:03:   messageType: 'confirmation',
2025-09-20T19:26:03:   result: 'STARTED',
2025-09-20T19:26:03:   details: {
2025-09-20T19:26:03:     checkId: '919953020706_TJJ19092511_confirmation_1758376563870',
2025-09-20T19:26:03:     hasOrderData: true,
2025-09-20T19:26:03:     hasSheetData: false,
2025-09-20T19:26:03:     messageLength: 469
2025-09-20T19:26:03:   },
2025-09-20T19:26:03:   timestamp: 1758376563872
2025-09-20T19:26:03: }
2025-09-20T19:26:03: ğŸ” [919953020706_TJJ19092511_confirmation_1758376563870] Step 1: Kill Switch Check
2025-09-20T19:26:03: ğŸ” [919953020706_TJJ19092511_confirmation_1758376563870] Step 1.5: Developer Phone Check
2025-09-20T19:26:03: ğŸ” [919953020706_TJJ19092511_confirmation_1758376563870] Step 2: Grace Period Check
2025-09-20T19:26:03: â„¹ï¸ [7:26:03 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:26:03:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:26:03:   remainingMs: 231632,
2025-09-20T19:26:03:   remainingSeconds: 232,
2025-09-20T19:26:03:   details: {
2025-09-20T19:26:03:     checkId: '919953020706_TJJ19092511_confirmation_1758376563870',
2025-09-20T19:26:03:     phone: '919953020706',
2025-09-20T19:26:03:     orderId: 'TJJ19092511',
2025-09-20T19:26:03:     messageType: 'confirmation'
2025-09-20T19:26:03:   },
2025-09-20T19:26:03:   timestamp: 1758376563877
2025-09-20T19:26:03: }
2025-09-20T19:26:03: âŒ [919953020706_TJJ19092511_confirmation_1758376563870] Startup grace period active (232s remaining)
2025-09-20T19:26:03: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T19:26:03: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T19:26:03: â„¹ï¸ [7:26:03 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T19:26:03:   phone: '919****706',
2025-09-20T19:26:03:   orderId: 'TJJ19092511',
2025-09-20T19:26:03:   messageType: 'confirmation',
2025-09-20T19:26:03:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:26:03:   reason: {
2025-09-20T19:26:03:     contentHash: '97026037ffec053e',
2025-09-20T19:26:03:     timestamp: 1758376563880,
2025-09-20T19:26:03:     messageLength: 469,
2025-09-20T19:26:03:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T19:26:03:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T19:26:03:   },
2025-09-20T19:26:03:   duration: 0,
2025-09-20T19:26:03:   timestamp: 1758376563893
2025-09-20T19:26:03: }
2025-09-20T19:26:03: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:26:03: ğŸ“ Loaded 11 template types
2025-09-20T19:26:03: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T19:26:03: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T19:26:03: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T19:26:03: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758376563895] Starting comprehensive safety check...
2025-09-20T19:26:03: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758376563895] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T19:26:03: â„¹ï¸ [7:26:03 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:26:03:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:26:03:   phone: '919****488',
2025-09-20T19:26:03:   orderId: 'TWM19092511',
2025-09-20T19:26:03:   messageType: 'confirmation',
2025-09-20T19:26:03:   result: 'STARTED',
2025-09-20T19:26:03:   details: {
2025-09-20T19:26:03:     checkId: '919358537488_TWM19092511_confirmation_1758376563895',
2025-09-20T19:26:03:     hasOrderData: true,
2025-09-20T19:26:03:     hasSheetData: false,
2025-09-20T19:26:03:     messageLength: 475
2025-09-20T19:26:03:   },
2025-09-20T19:26:03:   timestamp: 1758376563895
2025-09-20T19:26:03: }
2025-09-20T19:26:03: ğŸ” [919358537488_TWM19092511_confirmation_1758376563895] Step 1: Kill Switch Check
2025-09-20T19:26:03: ğŸ” [919358537488_TWM19092511_confirmation_1758376563895] Step 1.5: Developer Phone Check
2025-09-20T19:26:03: ğŸ” [919358537488_TWM19092511_confirmation_1758376563895] Step 2: Grace Period Check
2025-09-20T19:26:03: â„¹ï¸ [7:26:03 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:26:03:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:26:03:   remainingMs: 231612,
2025-09-20T19:26:03:   remainingSeconds: 232,
2025-09-20T19:26:03:   details: {
2025-09-20T19:26:03:     checkId: '919358537488_TWM19092511_confirmation_1758376563895',
2025-09-20T19:26:03:     phone: '919358537488',
2025-09-20T19:26:03:     orderId: 'TWM19092511',
2025-09-20T19:26:03:     messageType: 'confirmation'
2025-09-20T19:26:03:   },
2025-09-20T19:26:03:   timestamp: 1758376563897
2025-09-20T19:26:03: }
2025-09-20T19:26:03: âŒ [919358537488_TWM19092511_confirmation_1758376563895] Startup grace period active (232s remaining)
2025-09-20T19:26:03: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T19:26:03: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T19:26:03: â„¹ï¸ [7:26:03 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T19:26:03:   phone: '919****488',
2025-09-20T19:26:03:   orderId: 'TWM19092511',
2025-09-20T19:26:03:   messageType: 'confirmation',
2025-09-20T19:26:03:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:26:03:   reason: {
2025-09-20T19:26:03:     contentHash: 'e34d023f065922da',
2025-09-20T19:26:03:     timestamp: 1758376563899,
2025-09-20T19:26:03:     messageLength: 475,
2025-09-20T19:26:03:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T19:26:03:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T19:26:03:   },
2025-09-20T19:26:03:   duration: 0,
2025-09-20T19:26:03:   timestamp: 1758376563910
2025-09-20T19:26:03: }
2025-09-20T19:26:03: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:26:03: ğŸ“ Loaded 11 template types
2025-09-20T19:26:03: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T19:26:03: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T19:26:03: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T19:26:03: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758376563912] Starting comprehensive safety check...
2025-09-20T19:26:03: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758376563912] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T19:26:03: â„¹ï¸ [7:26:03 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:26:03:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:26:03:   phone: '918****811',
2025-09-20T19:26:03:   orderId: 'TOF19092511',
2025-09-20T19:26:03:   messageType: 'confirmation',
2025-09-20T19:26:03:   result: 'STARTED',
2025-09-20T19:26:03:   details: {
2025-09-20T19:26:03:     checkId: '918890134811_TOF19092511_confirmation_1758376563912',
2025-09-20T19:26:03:     hasOrderData: true,
2025-09-20T19:26:03:     hasSheetData: false,
2025-09-20T19:26:03:     messageLength: 473
2025-09-20T19:26:03:   },
2025-09-20T19:26:03:   timestamp: 1758376563912
2025-09-20T19:26:03: }
2025-09-20T19:26:03: ğŸ” [918890134811_TOF19092511_confirmation_1758376563912] Step 1: Kill Switch Check
2025-09-20T19:26:03: ğŸ” [918890134811_TOF19092511_confirmation_1758376563912] Step 1.5: Developer Phone Check
2025-09-20T19:26:03: ğŸ” [918890134811_TOF19092511_confirmation_1758376563912] Step 2: Grace Period Check
2025-09-20T19:26:03: â„¹ï¸ [7:26:03 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:26:03:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:26:03:   remainingMs: 231594,
2025-09-20T19:26:03:   remainingSeconds: 232,
2025-09-20T19:26:03:   details: {
2025-09-20T19:26:03:     checkId: '918890134811_TOF19092511_confirmation_1758376563912',
2025-09-20T19:26:03:     phone: '918890134811',
2025-09-20T19:26:03:     orderId: 'TOF19092511',
2025-09-20T19:26:03:     messageType: 'confirmation'
2025-09-20T19:26:03:   },
2025-09-20T19:26:03:   timestamp: 1758376563915
2025-09-20T19:26:03: }
2025-09-20T19:26:03: âŒ [918890134811_TOF19092511_confirmation_1758376563912] Startup grace period active (232s remaining)
2025-09-20T19:26:03: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T19:26:03: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T19:26:03: â„¹ï¸ [7:26:03 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T19:26:03:   phone: '918****811',
2025-09-20T19:26:03:   orderId: 'TOF19092511',
2025-09-20T19:26:03:   messageType: 'confirmation',
2025-09-20T19:26:03:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:26:03:   reason: {
2025-09-20T19:26:03:     contentHash: '388fbe812e19f1de',
2025-09-20T19:26:03:     timestamp: 1758376563917,
2025-09-20T19:26:03:     messageLength: 473,
2025-09-20T19:26:03:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T19:26:03:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T19:26:03:   },
2025-09-20T19:26:03:   duration: 0,
2025-09-20T19:26:03:   timestamp: 1758376563931
2025-09-20T19:26:03: }
2025-09-20T19:26:25: ğŸ’¾ Data synced to files successfully
2025-09-20T19:26:48: {"level":40,"time":1758376608452,"pid":1988,"hostname":"SAURABH","node":{"tag":"notification","attrs":{"from":"918824781960@s.whatsapp.net","type":"mex","id":"4016525799","t":"1758376607"},"content":[{"tag":"update","attrs":{"op_name":"NotificationLinkedProfilesUpdatesSideSub"},"content":{"type":"Buffer","data":[123,34,100,97,116,97,34,58,123,34,120,119,97,50,95,110,111,116,105,102,121,95,108,105,110,107,101,100,95,112,114,111,102,105,108,101,115,95,115,105,100,101,95,115,117,98,34,58,123,34,104,97,115,104,34,58,34,48,48,56,99,34,125,125,125]}}]},"msg":"Invalid mex newsletter notification"}
2025-09-20T19:26:55: ğŸ’¾ Data synced to files successfully
2025-09-20T19:27:25: ğŸ’¾ Data synced to files successfully
2025-09-20T19:27:55: ğŸ’¾ Data synced to files successfully
2025-09-20T19:28:25: ğŸ’¾ Data synced to files successfully
2025-09-20T19:28:55: ğŸ’¾ Data synced to files successfully
2025-09-20T19:29:03: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:29:03: ğŸ“ Loaded 11 template types
2025-09-20T19:29:03: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T19:29:03: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T19:29:03: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T19:29:03: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758376743332] Starting comprehensive safety check...
2025-09-20T19:29:03: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758376743332] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T19:29:03: â„¹ï¸ [7:29:03 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:29:03:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:29:03:   phone: '919****706',
2025-09-20T19:29:03:   orderId: 'TJJ19092511',
2025-09-20T19:29:03:   messageType: 'confirmation',
2025-09-20T19:29:03:   result: 'STARTED',
2025-09-20T19:29:03:   details: {
2025-09-20T19:29:03:     checkId: '919953020706_TJJ19092511_confirmation_1758376743332',
2025-09-20T19:29:03:     hasOrderData: true,
2025-09-20T19:29:03:     hasSheetData: false,
2025-09-20T19:29:03:     messageLength: 469
2025-09-20T19:29:03:   },
2025-09-20T19:29:03:   timestamp: 1758376743332
2025-09-20T19:29:03: }
2025-09-20T19:29:03: ğŸ” [919953020706_TJJ19092511_confirmation_1758376743332] Step 1: Kill Switch Check
2025-09-20T19:29:03: ğŸ” [919953020706_TJJ19092511_confirmation_1758376743332] Step 1.5: Developer Phone Check
2025-09-20T19:29:03: ğŸ” [919953020706_TJJ19092511_confirmation_1758376743332] Step 2: Grace Period Check
2025-09-20T19:29:03: â„¹ï¸ [7:29:03 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:29:03:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:29:03:   remainingMs: 52175,
2025-09-20T19:29:03:   remainingSeconds: 53,
2025-09-20T19:29:03:   details: {
2025-09-20T19:29:03:     checkId: '919953020706_TJJ19092511_confirmation_1758376743332',
2025-09-20T19:29:03:     phone: '919953020706',
2025-09-20T19:29:03:     orderId: 'TJJ19092511',
2025-09-20T19:29:03:     messageType: 'confirmation'
2025-09-20T19:29:03:   },
2025-09-20T19:29:03:   timestamp: 1758376743334
2025-09-20T19:29:03: }
2025-09-20T19:29:03: âŒ [919953020706_TJJ19092511_confirmation_1758376743332] Startup grace period active (53s remaining)
2025-09-20T19:29:03: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Startup grace period active (53s remaining)
2025-09-20T19:29:03: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T19:29:03: â„¹ï¸ [7:29:03 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T19:29:03:   phone: '919****706',
2025-09-20T19:29:03:   orderId: 'TJJ19092511',
2025-09-20T19:29:03:   messageType: 'confirmation',
2025-09-20T19:29:03:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:29:03:   reason: {
2025-09-20T19:29:03:     contentHash: '97026037ffec053e',
2025-09-20T19:29:03:     timestamp: 1758376743337,
2025-09-20T19:29:03:     messageLength: 469,
2025-09-20T19:29:03:     errorMessage: 'Startup grace period active (53s remaining)',
2025-09-20T19:29:03:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T19:29:03:   },
2025-09-20T19:29:03:   duration: 0,
2025-09-20T19:29:03:   timestamp: 1758376743346
2025-09-20T19:29:03: }
2025-09-20T19:29:03: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:29:03: ğŸ“ Loaded 11 template types
2025-09-20T19:29:03: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T19:29:03: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T19:29:03: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T19:29:03: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758376743348] Starting comprehensive safety check...
2025-09-20T19:29:03: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758376743348] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T19:29:03: â„¹ï¸ [7:29:03 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:29:03:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:29:03:   phone: '919****488',
2025-09-20T19:29:03:   orderId: 'TWM19092511',
2025-09-20T19:29:03:   messageType: 'confirmation',
2025-09-20T19:29:03:   result: 'STARTED',
2025-09-20T19:29:03:   details: {
2025-09-20T19:29:03:     checkId: '919358537488_TWM19092511_confirmation_1758376743348',
2025-09-20T19:29:03:     hasOrderData: true,
2025-09-20T19:29:03:     hasSheetData: false,
2025-09-20T19:29:03:     messageLength: 475
2025-09-20T19:29:03:   },
2025-09-20T19:29:03:   timestamp: 1758376743349
2025-09-20T19:29:03: }
2025-09-20T19:29:03: ğŸ” [919358537488_TWM19092511_confirmation_1758376743348] Step 1: Kill Switch Check
2025-09-20T19:29:03: ğŸ” [919358537488_TWM19092511_confirmation_1758376743348] Step 1.5: Developer Phone Check
2025-09-20T19:29:03: ğŸ” [919358537488_TWM19092511_confirmation_1758376743348] Step 2: Grace Period Check
2025-09-20T19:29:03: â„¹ï¸ [7:29:03 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:29:03:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:29:03:   remainingMs: 52159,
2025-09-20T19:29:03:   remainingSeconds: 53,
2025-09-20T19:29:03:   details: {
2025-09-20T19:29:03:     checkId: '919358537488_TWM19092511_confirmation_1758376743348',
2025-09-20T19:29:03:     phone: '919358537488',
2025-09-20T19:29:03:     orderId: 'TWM19092511',
2025-09-20T19:29:03:     messageType: 'confirmation'
2025-09-20T19:29:03:   },
2025-09-20T19:29:03:   timestamp: 1758376743350
2025-09-20T19:29:03: }
2025-09-20T19:29:03: âŒ [919358537488_TWM19092511_confirmation_1758376743348] Startup grace period active (53s remaining)
2025-09-20T19:29:03: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Startup grace period active (53s remaining)
2025-09-20T19:29:03: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T19:29:03: â„¹ï¸ [7:29:03 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T19:29:03:   phone: '919****488',
2025-09-20T19:29:03:   orderId: 'TWM19092511',
2025-09-20T19:29:03:   messageType: 'confirmation',
2025-09-20T19:29:03:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:29:03:   reason: {
2025-09-20T19:29:03:     contentHash: 'e34d023f065922da',
2025-09-20T19:29:03:     timestamp: 1758376743353,
2025-09-20T19:29:03:     messageLength: 475,
2025-09-20T19:29:03:     errorMessage: 'Startup grace period active (53s remaining)',
2025-09-20T19:29:03:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T19:29:03:   },
2025-09-20T19:29:03:   duration: 0,
2025-09-20T19:29:03:   timestamp: 1758376743363
2025-09-20T19:29:03: }
2025-09-20T19:29:03: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:29:03: ğŸ“ Loaded 11 template types
2025-09-20T19:29:03: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T19:29:03: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T19:29:03: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T19:29:03: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758376743365] Starting comprehensive safety check...
2025-09-20T19:29:03: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758376743365] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T19:29:03: â„¹ï¸ [7:29:03 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:29:03:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:29:03:   phone: '918****811',
2025-09-20T19:29:03:   orderId: 'TOF19092511',
2025-09-20T19:29:03:   messageType: 'confirmation',
2025-09-20T19:29:03:   result: 'STARTED',
2025-09-20T19:29:03:   details: {
2025-09-20T19:29:03:     checkId: '918890134811_TOF19092511_confirmation_1758376743365',
2025-09-20T19:29:03:     hasOrderData: true,
2025-09-20T19:29:03:     hasSheetData: false,
2025-09-20T19:29:03:     messageLength: 473
2025-09-20T19:29:03:   },
2025-09-20T19:29:03:   timestamp: 1758376743365
2025-09-20T19:29:03: }
2025-09-20T19:29:03: ğŸ” [918890134811_TOF19092511_confirmation_1758376743365] Step 1: Kill Switch Check
2025-09-20T19:29:03: ğŸ” [918890134811_TOF19092511_confirmation_1758376743365] Step 1.5: Developer Phone Check
2025-09-20T19:29:03: ğŸ” [918890134811_TOF19092511_confirmation_1758376743365] Step 2: Grace Period Check
2025-09-20T19:29:03: â„¹ï¸ [7:29:03 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:29:03:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:29:03:   remainingMs: 52142,
2025-09-20T19:29:03:   remainingSeconds: 53,
2025-09-20T19:29:03:   details: {
2025-09-20T19:29:03:     checkId: '918890134811_TOF19092511_confirmation_1758376743365',
2025-09-20T19:29:03:     phone: '918890134811',
2025-09-20T19:29:03:     orderId: 'TOF19092511',
2025-09-20T19:29:03:     messageType: 'confirmation'
2025-09-20T19:29:03:   },
2025-09-20T19:29:03:   timestamp: 1758376743367
2025-09-20T19:29:03: }
2025-09-20T19:29:03: âŒ [918890134811_TOF19092511_confirmation_1758376743365] Startup grace period active (53s remaining)
2025-09-20T19:29:03: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (53s remaining)
2025-09-20T19:29:03: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T19:29:03: â„¹ï¸ [7:29:03 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T19:29:03:   phone: '918****811',
2025-09-20T19:29:03:   orderId: 'TOF19092511',
2025-09-20T19:29:03:   messageType: 'confirmation',
2025-09-20T19:29:03:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:29:03:   reason: {
2025-09-20T19:29:03:     contentHash: '388fbe812e19f1de',
2025-09-20T19:29:03:     timestamp: 1758376743369,
2025-09-20T19:29:03:     messageLength: 473,
2025-09-20T19:29:03:     errorMessage: 'Startup grace period active (53s remaining)',
2025-09-20T19:29:03:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T19:29:03:   },
2025-09-20T19:29:03:   duration: 0,
2025-09-20T19:29:03:   timestamp: 1758376743380
2025-09-20T19:29:03: }
2025-09-20T19:29:25: ğŸ’¾ Data synced to files successfully
2025-09-20T19:29:55: âœ… Startup grace period ended - message sending now allowed
2025-09-20T19:29:55: âœ… Startup grace period ended - message sending now allowed
2025-09-20T19:29:55: â„¹ï¸ [7:29:55 pm] INFO: Grace Period: ENDED {
2025-09-20T19:29:55:   action: 'ENDED',
2025-09-20T19:29:55:   remainingMs: 0,
2025-09-20T19:29:55:   remainingSeconds: 0,
2025-09-20T19:29:55:   details: { totalDuration: 240000, processId: 1988 },
2025-09-20T19:29:55:   timestamp: 1758376795612
2025-09-20T19:29:55: }
2025-09-20T19:29:55: â„¹ï¸ [7:29:55 pm] INFO: Grace Period: ENDED {
2025-09-20T19:29:55:   action: 'ENDED',
2025-09-20T19:29:55:   remainingMs: 0,
2025-09-20T19:29:55:   remainingSeconds: 0,
2025-09-20T19:29:55:   details: { totalDuration: 240000, processId: 1988 },
2025-09-20T19:29:55:   timestamp: 1758376795614
2025-09-20T19:29:55: }
2025-09-20T19:29:55: ğŸ’¾ Data synced to files successfully
2025-09-20T19:29:55: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T19:29:55: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T19:30:25: ğŸ’¾ Data synced to files successfully
2025-09-20T19:30:55: ğŸ’¾ Data synced to files successfully
2025-09-20T19:31:25: ğŸ’¾ Data synced to files successfully
2025-09-20T19:31:55: ğŸ’¾ Data synced to files successfully
2025-09-20T19:32:03: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:32:03: ğŸ“ Loaded 11 template types
2025-09-20T19:32:03: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T19:32:03: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T19:32:03: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T19:32:03: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758376923506] Starting comprehensive safety check...
2025-09-20T19:32:03: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758376923506] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T19:32:03: â„¹ï¸ [7:32:03 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:32:03:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:32:03:   phone: '919****706',
2025-09-20T19:32:03:   orderId: 'TJJ19092511',
2025-09-20T19:32:03:   messageType: 'confirmation',
2025-09-20T19:32:03:   result: 'STARTED',
2025-09-20T19:32:03:   details: {
2025-09-20T19:32:03:     checkId: '919953020706_TJJ19092511_confirmation_1758376923506',
2025-09-20T19:32:03:     hasOrderData: true,
2025-09-20T19:32:03:     hasSheetData: false,
2025-09-20T19:32:03:     messageLength: 469
2025-09-20T19:32:03:   },
2025-09-20T19:32:03:   timestamp: 1758376923507
2025-09-20T19:32:03: }
2025-09-20T19:32:03: ğŸ” [919953020706_TJJ19092511_confirmation_1758376923506] Step 1: Kill Switch Check
2025-09-20T19:32:03: ğŸ” [919953020706_TJJ19092511_confirmation_1758376923506] Step 1.5: Developer Phone Check
2025-09-20T19:32:03: ğŸ” [919953020706_TJJ19092511_confirmation_1758376923506] Step 2: Grace Period Check
2025-09-20T19:32:03: ğŸ” [919953020706_TJJ19092511_confirmation_1758376923506] Step 3: Business Hours Check
2025-09-20T19:32:03: ğŸ” [919953020706_TJJ19092511_confirmation_1758376923506] Step 4: Message Type Rules Check
2025-09-20T19:32:03: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T19:32:03: â„¹ï¸ [7:32:03 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:32:03:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:32:03:   phone: '919****706',
2025-09-20T19:32:03:   orderId: 'TJJ19092511',
2025-09-20T19:32:03:   messageType: 'confirmation',
2025-09-20T19:32:03:   result: 'STARTED',
2025-09-20T19:32:03:   details: {
2025-09-20T19:32:03:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T19:32:03:     requiredFields: [
2025-09-20T19:32:03:       'customer_name',
2025-09-20T19:32:03:       'order_id',
2025-09-20T19:32:03:       'phone',
2025-09-20T19:32:03:       'garment_type',
2025-09-20T19:32:03:       'delivery_date'
2025-09-20T19:32:03:     ],
2025-09-20T19:32:03:     orderDataFields: [
2025-09-20T19:32:03:       'customer_name',
2025-09-20T19:32:03:       'order_id',
2025-09-20T19:32:03:       'garment_type',
2025-09-20T19:32:03:       'total_amount',
2025-09-20T19:32:03:       'advance_amount',
2025-09-20T19:32:03:       'remaining_amount',
2025-09-20T19:32:03:       'ready_date',
2025-09-20T19:32:03:       'delivery_date',
2025-09-20T19:32:03:       'shop_name',
2025-09-20T19:32:03:       'shop_phone',
2025-09-20T19:32:03:       'business_hours'
2025-09-20T19:32:03:     ],
2025-09-20T19:32:03:     sheetDataFields: []
2025-09-20T19:32:03:   },
2025-09-20T19:32:03:   timestamp: 1758376923516
2025-09-20T19:32:03: }
2025-09-20T19:32:03: â„¹ï¸ [7:32:03 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:32:03:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:32:03:   phone: '919****706',
2025-09-20T19:32:03:   orderId: 'TJJ19092511',
2025-09-20T19:32:03:   messageType: 'confirmation',
2025-09-20T19:32:03:   result: 'MISSING_FIELD',
2025-09-20T19:32:03:   details: {
2025-09-20T19:32:03:     missingField: 'phone',
2025-09-20T19:32:03:     requiredFields: [
2025-09-20T19:32:03:       'customer_name',
2025-09-20T19:32:03:       'order_id',
2025-09-20T19:32:03:       'phone',
2025-09-20T19:32:03:       'garment_type',
2025-09-20T19:32:03:       'delivery_date'
2025-09-20T19:32:03:     ],
2025-09-20T19:32:03:     availableOrderFields: [
2025-09-20T19:32:03:       'customer_name',
2025-09-20T19:32:03:       'order_id',
2025-09-20T19:32:03:       'garment_type',
2025-09-20T19:32:03:       'total_amount',
2025-09-20T19:32:03:       'advance_amount',
2025-09-20T19:32:03:       'remaining_amount',
2025-09-20T19:32:03:       'ready_date',
2025-09-20T19:32:03:       'delivery_date',
2025-09-20T19:32:03:       'shop_name',
2025-09-20T19:32:03:       'shop_phone',
2025-09-20T19:32:03:       'business_hours'
2025-09-20T19:32:03:     ],
2025-09-20T19:32:03:     availableSheetFields: []
2025-09-20T19:32:03:   },
2025-09-20T19:32:03:   timestamp: 1758376923524
2025-09-20T19:32:03: }
2025-09-20T19:32:03: â„¹ï¸ [7:32:03 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:32:03:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:32:03:   phone: '919****706',
2025-09-20T19:32:03:   orderId: 'TJJ19092511',
2025-09-20T19:32:03:   messageType: 'confirmation',
2025-09-20T19:32:03:   result: 'BLOCKED',
2025-09-20T19:32:03:   details: {
2025-09-20T19:32:03:     checkId: '919953020706_TJJ19092511_confirmation_1758376923506',
2025-09-20T19:32:03:     ruleViolation: 'MISSING_REQUIRED_FIELD',
2025-09-20T19:32:03:     details: 'Missing required field: phone'
2025-09-20T19:32:03:   },
2025-09-20T19:32:03:   timestamp: 1758376923530
2025-09-20T19:32:03: }
2025-09-20T19:32:03: âŒ [919953020706_TJJ19092511_confirmation_1758376923506] Missing required field: phone
2025-09-20T19:32:03: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Missing required field: phone
2025-09-20T19:32:03: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T19:32:03: â„¹ï¸ [7:32:03 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T19:32:03:   phone: '919****706',
2025-09-20T19:32:03:   orderId: 'TJJ19092511',
2025-09-20T19:32:03:   messageType: 'confirmation',
2025-09-20T19:32:03:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:32:03:   reason: {
2025-09-20T19:32:03:     contentHash: '97026037ffec053e',
2025-09-20T19:32:03:     timestamp: 1758376923536,
2025-09-20T19:32:03:     messageLength: 469,
2025-09-20T19:32:03:     errorMessage: 'Missing required field: phone',
2025-09-20T19:32:03:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T19:32:03:   },
2025-09-20T19:32:03:   duration: 0,
2025-09-20T19:32:03:   timestamp: 1758376923562
2025-09-20T19:32:03: }
2025-09-20T19:32:03: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:32:03: ğŸ“ Loaded 11 template types
2025-09-20T19:32:03: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T19:32:03: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T19:32:03: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T19:32:03: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758376923571] Starting comprehensive safety check...
2025-09-20T19:32:03: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758376923571] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T19:32:03: â„¹ï¸ [7:32:03 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:32:03:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:32:03:   phone: '919****488',
2025-09-20T19:32:03:   orderId: 'TWM19092511',
2025-09-20T19:32:03:   messageType: 'confirmation',
2025-09-20T19:32:03:   result: 'STARTED',
2025-09-20T19:32:03:   details: {
2025-09-20T19:32:03:     checkId: '919358537488_TWM19092511_confirmation_1758376923571',
2025-09-20T19:32:03:     hasOrderData: true,
2025-09-20T19:32:03:     hasSheetData: false,
2025-09-20T19:32:03:     messageLength: 475
2025-09-20T19:32:03:   },
2025-09-20T19:32:03:   timestamp: 1758376923571
2025-09-20T19:32:03: }
2025-09-20T19:32:03: ğŸ” [919358537488_TWM19092511_confirmation_1758376923571] Step 1: Kill Switch Check
2025-09-20T19:32:03: ğŸ” [919358537488_TWM19092511_confirmation_1758376923571] Step 1.5: Developer Phone Check
2025-09-20T19:32:03: ğŸ” [919358537488_TWM19092511_confirmation_1758376923571] Step 2: Grace Period Check
2025-09-20T19:32:03: ğŸ” [919358537488_TWM19092511_confirmation_1758376923571] Step 3: Business Hours Check
2025-09-20T19:32:03: ğŸ” [919358537488_TWM19092511_confirmation_1758376923571] Step 4: Message Type Rules Check
2025-09-20T19:32:03: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T19:32:03: â„¹ï¸ [7:32:03 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:32:03:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:32:03:   phone: '919****488',
2025-09-20T19:32:03:   orderId: 'TWM19092511',
2025-09-20T19:32:03:   messageType: 'confirmation',
2025-09-20T19:32:03:   result: 'STARTED',
2025-09-20T19:32:03:   details: {
2025-09-20T19:32:03:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T19:32:03:     requiredFields: [
2025-09-20T19:32:03:       'customer_name',
2025-09-20T19:32:03:       'order_id',
2025-09-20T19:32:03:       'phone',
2025-09-20T19:32:03:       'garment_type',
2025-09-20T19:32:03:       'delivery_date'
2025-09-20T19:32:03:     ],
2025-09-20T19:32:03:     orderDataFields: [
2025-09-20T19:32:03:       'customer_name',
2025-09-20T19:32:03:       'order_id',
2025-09-20T19:32:03:       'garment_type',
2025-09-20T19:32:03:       'total_amount',
2025-09-20T19:32:03:       'advance_amount',
2025-09-20T19:32:03:       'remaining_amount',
2025-09-20T19:32:03:       'ready_date',
2025-09-20T19:32:03:       'delivery_date',
2025-09-20T19:32:03:       'shop_name',
2025-09-20T19:32:03:       'shop_phone',
2025-09-20T19:32:03:       'business_hours'
2025-09-20T19:32:03:     ],
2025-09-20T19:32:03:     sheetDataFields: []
2025-09-20T19:32:03:   },
2025-09-20T19:32:03:   timestamp: 1758376923579
2025-09-20T19:32:03: }
2025-09-20T19:32:03: â„¹ï¸ [7:32:03 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:32:03:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:32:03:   phone: '919****488',
2025-09-20T19:32:03:   orderId: 'TWM19092511',
2025-09-20T19:32:03:   messageType: 'confirmation',
2025-09-20T19:32:03:   result: 'MISSING_FIELD',
2025-09-20T19:32:03:   details: {
2025-09-20T19:32:03:     missingField: 'phone',
2025-09-20T19:32:03:     requiredFields: [
2025-09-20T19:32:03:       'customer_name',
2025-09-20T19:32:03:       'order_id',
2025-09-20T19:32:03:       'phone',
2025-09-20T19:32:03:       'garment_type',
2025-09-20T19:32:03:       'delivery_date'
2025-09-20T19:32:03:     ],
2025-09-20T19:32:03:     availableOrderFields: [
2025-09-20T19:32:03:       'customer_name',
2025-09-20T19:32:03:       'order_id',
2025-09-20T19:32:03:       'garment_type',
2025-09-20T19:32:03:       'total_amount',
2025-09-20T19:32:03:       'advance_amount',
2025-09-20T19:32:03:       'remaining_amount',
2025-09-20T19:32:03:       'ready_date',
2025-09-20T19:32:03:       'delivery_date',
2025-09-20T19:32:03:       'shop_name',
2025-09-20T19:32:03:       'shop_phone',
2025-09-20T19:32:03:       'business_hours'
2025-09-20T19:32:03:     ],
2025-09-20T19:32:03:     availableSheetFields: []
2025-09-20T19:32:03:   },
2025-09-20T19:32:03:   timestamp: 1758376923583
2025-09-20T19:32:03: }
2025-09-20T19:32:03: â„¹ï¸ [7:32:03 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:32:03:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:32:03:   phone: '919****488',
2025-09-20T19:32:03:   orderId: 'TWM19092511',
2025-09-20T19:32:03:   messageType: 'confirmation',
2025-09-20T19:32:03:   result: 'BLOCKED',
2025-09-20T19:32:03:   details: {
2025-09-20T19:32:03:     checkId: '919358537488_TWM19092511_confirmation_1758376923571',
2025-09-20T19:32:03:     ruleViolation: 'MISSING_REQUIRED_FIELD',
2025-09-20T19:32:03:     details: 'Missing required field: phone'
2025-09-20T19:32:03:   },
2025-09-20T19:32:03:   timestamp: 1758376923590
2025-09-20T19:32:03: }
2025-09-20T19:32:03: âŒ [919358537488_TWM19092511_confirmation_1758376923571] Missing required field: phone
2025-09-20T19:32:03: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Missing required field: phone
2025-09-20T19:32:03: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T19:32:03: â„¹ï¸ [7:32:03 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T19:32:03:   phone: '919****488',
2025-09-20T19:32:03:   orderId: 'TWM19092511',
2025-09-20T19:32:03:   messageType: 'confirmation',
2025-09-20T19:32:03:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:32:03:   reason: {
2025-09-20T19:32:03:     contentHash: 'e34d023f065922da',
2025-09-20T19:32:03:     timestamp: 1758376923592,
2025-09-20T19:32:03:     messageLength: 475,
2025-09-20T19:32:03:     errorMessage: 'Missing required field: phone',
2025-09-20T19:32:03:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T19:32:03:   },
2025-09-20T19:32:03:   duration: 0,
2025-09-20T19:32:03:   timestamp: 1758376923608
2025-09-20T19:32:03: }
2025-09-20T19:32:03: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:32:03: ğŸ“ Loaded 11 template types
2025-09-20T19:32:03: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T19:32:03: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T19:32:03: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T19:32:03: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758376923610] Starting comprehensive safety check...
2025-09-20T19:32:03: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758376923610] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T19:32:03: â„¹ï¸ [7:32:03 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:32:03:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:32:03:   phone: '918****811',
2025-09-20T19:32:03:   orderId: 'TOF19092511',
2025-09-20T19:32:03:   messageType: 'confirmation',
2025-09-20T19:32:03:   result: 'STARTED',
2025-09-20T19:32:03:   details: {
2025-09-20T19:32:03:     checkId: '918890134811_TOF19092511_confirmation_1758376923610',
2025-09-20T19:32:03:     hasOrderData: true,
2025-09-20T19:32:03:     hasSheetData: false,
2025-09-20T19:32:03:     messageLength: 473
2025-09-20T19:32:03:   },
2025-09-20T19:32:03:   timestamp: 1758376923610
2025-09-20T19:32:03: }
2025-09-20T19:32:03: ğŸ” [918890134811_TOF19092511_confirmation_1758376923610] Step 1: Kill Switch Check
2025-09-20T19:32:03: ğŸ” [918890134811_TOF19092511_confirmation_1758376923610] Step 1.5: Developer Phone Check
2025-09-20T19:32:03: ğŸ” [918890134811_TOF19092511_confirmation_1758376923610] Step 2: Grace Period Check
2025-09-20T19:32:03: ğŸ” [918890134811_TOF19092511_confirmation_1758376923610] Step 3: Business Hours Check
2025-09-20T19:32:03: ğŸ” [918890134811_TOF19092511_confirmation_1758376923610] Step 4: Message Type Rules Check
2025-09-20T19:32:03: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T19:32:03: â„¹ï¸ [7:32:03 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:32:03:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:32:03:   phone: '918****811',
2025-09-20T19:32:03:   orderId: 'TOF19092511',
2025-09-20T19:32:03:   messageType: 'confirmation',
2025-09-20T19:32:03:   result: 'STARTED',
2025-09-20T19:32:03:   details: {
2025-09-20T19:32:03:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T19:32:03:     requiredFields: [
2025-09-20T19:32:03:       'customer_name',
2025-09-20T19:32:03:       'order_id',
2025-09-20T19:32:03:       'phone',
2025-09-20T19:32:03:       'garment_type',
2025-09-20T19:32:03:       'delivery_date'
2025-09-20T19:32:03:     ],
2025-09-20T19:32:03:     orderDataFields: [
2025-09-20T19:32:03:       'customer_name',
2025-09-20T19:32:03:       'order_id',
2025-09-20T19:32:03:       'garment_type',
2025-09-20T19:32:03:       'total_amount',
2025-09-20T19:32:03:       'advance_amount',
2025-09-20T19:32:03:       'remaining_amount',
2025-09-20T19:32:03:       'ready_date',
2025-09-20T19:32:03:       'delivery_date',
2025-09-20T19:32:03:       'shop_name',
2025-09-20T19:32:03:       'shop_phone',
2025-09-20T19:32:03:       'business_hours'
2025-09-20T19:32:03:     ],
2025-09-20T19:32:03:     sheetDataFields: []
2025-09-20T19:32:03:   },
2025-09-20T19:32:03:   timestamp: 1758376923612
2025-09-20T19:32:03: }
2025-09-20T19:32:03: â„¹ï¸ [7:32:03 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:32:03:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:32:03:   phone: '918****811',
2025-09-20T19:32:03:   orderId: 'TOF19092511',
2025-09-20T19:32:03:   messageType: 'confirmation',
2025-09-20T19:32:03:   result: 'MISSING_FIELD',
2025-09-20T19:32:03:   details: {
2025-09-20T19:32:03:     missingField: 'phone',
2025-09-20T19:32:03:     requiredFields: [
2025-09-20T19:32:03:       'customer_name',
2025-09-20T19:32:03:       'order_id',
2025-09-20T19:32:03:       'phone',
2025-09-20T19:32:03:       'garment_type',
2025-09-20T19:32:03:       'delivery_date'
2025-09-20T19:32:03:     ],
2025-09-20T19:32:03:     availableOrderFields: [
2025-09-20T19:32:03:       'customer_name',
2025-09-20T19:32:03:       'order_id',
2025-09-20T19:32:03:       'garment_type',
2025-09-20T19:32:03:       'total_amount',
2025-09-20T19:32:03:       'advance_amount',
2025-09-20T19:32:03:       'remaining_amount',
2025-09-20T19:32:03:       'ready_date',
2025-09-20T19:32:03:       'delivery_date',
2025-09-20T19:32:03:       'shop_name',
2025-09-20T19:32:03:       'shop_phone',
2025-09-20T19:32:03:       'business_hours'
2025-09-20T19:32:03:     ],
2025-09-20T19:32:03:     availableSheetFields: []
2025-09-20T19:32:03:   },
2025-09-20T19:32:03:   timestamp: 1758376923614
2025-09-20T19:32:03: }
2025-09-20T19:32:03: â„¹ï¸ [7:32:03 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:32:03:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:32:03:   phone: '918****811',
2025-09-20T19:32:03:   orderId: 'TOF19092511',
2025-09-20T19:32:03:   messageType: 'confirmation',
2025-09-20T19:32:03:   result: 'BLOCKED',
2025-09-20T19:32:03:   details: {
2025-09-20T19:32:03:     checkId: '918890134811_TOF19092511_confirmation_1758376923610',
2025-09-20T19:32:03:     ruleViolation: 'MISSING_REQUIRED_FIELD',
2025-09-20T19:32:03:     details: 'Missing required field: phone'
2025-09-20T19:32:03:   },
2025-09-20T19:32:03:   timestamp: 1758376923616
2025-09-20T19:32:03: }
2025-09-20T19:32:03: âŒ [918890134811_TOF19092511_confirmation_1758376923610] Missing required field: phone
2025-09-20T19:32:03: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Missing required field: phone
2025-09-20T19:32:03: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T19:32:03: â„¹ï¸ [7:32:03 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T19:32:03:   phone: '918****811',
2025-09-20T19:32:03:   orderId: 'TOF19092511',
2025-09-20T19:32:03:   messageType: 'confirmation',
2025-09-20T19:32:03:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:32:03:   reason: {
2025-09-20T19:32:03:     contentHash: '388fbe812e19f1de',
2025-09-20T19:32:03:     timestamp: 1758376923620,
2025-09-20T19:32:03:     messageLength: 473,
2025-09-20T19:32:03:     errorMessage: 'Missing required field: phone',
2025-09-20T19:32:03:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T19:32:03:   },
2025-09-20T19:32:03:   duration: 0,
2025-09-20T19:32:03:   timestamp: 1758376923629
2025-09-20T19:32:03: }
2025-09-20T19:32:25: ğŸ’¾ Data synced to files successfully
2025-09-20T19:32:55: ğŸ’¾ Data synced to files successfully
2025-09-20T19:33:25: ğŸ’¾ Data synced to files successfully
2025-09-20T19:33:55: ğŸ’¾ Data synced to files successfully
2025-09-20T19:34:25: ğŸ’¾ Data synced to files successfully
2025-09-20T19:34:55: ğŸ’¾ Data synced to files successfully
2025-09-20T19:35:03: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:35:03: ğŸ“ Loaded 11 template types
2025-09-20T19:35:03: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T19:35:03: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T19:35:03: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T19:35:03: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758377103310] Starting comprehensive safety check...
2025-09-20T19:35:03: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758377103310] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T19:35:03: â„¹ï¸ [7:35:03 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:35:03:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:35:03:   phone: '919****706',
2025-09-20T19:35:03:   orderId: 'TJJ19092511',
2025-09-20T19:35:03:   messageType: 'confirmation',
2025-09-20T19:35:03:   result: 'STARTED',
2025-09-20T19:35:03:   details: {
2025-09-20T19:35:03:     checkId: '919953020706_TJJ19092511_confirmation_1758377103310',
2025-09-20T19:35:03:     hasOrderData: true,
2025-09-20T19:35:03:     hasSheetData: false,
2025-09-20T19:35:03:     messageLength: 469
2025-09-20T19:35:03:   },
2025-09-20T19:35:03:   timestamp: 1758377103310
2025-09-20T19:35:03: }
2025-09-20T19:35:03: ğŸ” [919953020706_TJJ19092511_confirmation_1758377103310] Step 1: Kill Switch Check
2025-09-20T19:35:03: ğŸ” [919953020706_TJJ19092511_confirmation_1758377103310] Step 1.5: Developer Phone Check
2025-09-20T19:35:03: ğŸ” [919953020706_TJJ19092511_confirmation_1758377103310] Step 2: Grace Period Check
2025-09-20T19:35:03: ğŸ” [919953020706_TJJ19092511_confirmation_1758377103310] Step 3: Business Hours Check
2025-09-20T19:35:03: ğŸ” [919953020706_TJJ19092511_confirmation_1758377103310] Step 4: Message Type Rules Check
2025-09-20T19:35:03: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T19:35:03: â„¹ï¸ [7:35:03 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:35:03:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:35:03:   phone: '919****706',
2025-09-20T19:35:03:   orderId: 'TJJ19092511',
2025-09-20T19:35:03:   messageType: 'confirmation',
2025-09-20T19:35:03:   result: 'STARTED',
2025-09-20T19:35:03:   details: {
2025-09-20T19:35:03:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T19:35:03:     requiredFields: [
2025-09-20T19:35:03:       'customer_name',
2025-09-20T19:35:03:       'order_id',
2025-09-20T19:35:03:       'phone',
2025-09-20T19:35:03:       'garment_type',
2025-09-20T19:35:03:       'delivery_date'
2025-09-20T19:35:03:     ],
2025-09-20T19:35:03:     orderDataFields: [
2025-09-20T19:35:03:       'customer_name',
2025-09-20T19:35:03:       'order_id',
2025-09-20T19:35:03:       'garment_type',
2025-09-20T19:35:03:       'total_amount',
2025-09-20T19:35:03:       'advance_amount',
2025-09-20T19:35:03:       'remaining_amount',
2025-09-20T19:35:03:       'ready_date',
2025-09-20T19:35:03:       'delivery_date',
2025-09-20T19:35:03:       'shop_name',
2025-09-20T19:35:03:       'shop_phone',
2025-09-20T19:35:03:       'business_hours'
2025-09-20T19:35:03:     ],
2025-09-20T19:35:03:     sheetDataFields: []
2025-09-20T19:35:03:   },
2025-09-20T19:35:03:   timestamp: 1758377103312
2025-09-20T19:35:03: }
2025-09-20T19:35:03: â„¹ï¸ [7:35:03 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:35:03:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:35:03:   phone: '919****706',
2025-09-20T19:35:03:   orderId: 'TJJ19092511',
2025-09-20T19:35:03:   messageType: 'confirmation',
2025-09-20T19:35:03:   result: 'MISSING_FIELD',
2025-09-20T19:35:03:   details: {
2025-09-20T19:35:03:     missingField: 'phone',
2025-09-20T19:35:03:     requiredFields: [
2025-09-20T19:35:03:       'customer_name',
2025-09-20T19:35:03:       'order_id',
2025-09-20T19:35:03:       'phone',
2025-09-20T19:35:03:       'garment_type',
2025-09-20T19:35:03:       'delivery_date'
2025-09-20T19:35:03:     ],
2025-09-20T19:35:03:     availableOrderFields: [
2025-09-20T19:35:03:       'customer_name',
2025-09-20T19:35:03:       'order_id',
2025-09-20T19:35:03:       'garment_type',
2025-09-20T19:35:03:       'total_amount',
2025-09-20T19:35:03:       'advance_amount',
2025-09-20T19:35:03:       'remaining_amount',
2025-09-20T19:35:03:       'ready_date',
2025-09-20T19:35:03:       'delivery_date',
2025-09-20T19:35:03:       'shop_name',
2025-09-20T19:35:03:       'shop_phone',
2025-09-20T19:35:03:       'business_hours'
2025-09-20T19:35:03:     ],
2025-09-20T19:35:03:     availableSheetFields: []
2025-09-20T19:35:03:   },
2025-09-20T19:35:03:   timestamp: 1758377103315
2025-09-20T19:35:03: }
2025-09-20T19:35:03: â„¹ï¸ [7:35:03 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:35:03:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:35:03:   phone: '919****706',
2025-09-20T19:35:03:   orderId: 'TJJ19092511',
2025-09-20T19:35:03:   messageType: 'confirmation',
2025-09-20T19:35:03:   result: 'BLOCKED',
2025-09-20T19:35:03:   details: {
2025-09-20T19:35:03:     checkId: '919953020706_TJJ19092511_confirmation_1758377103310',
2025-09-20T19:35:03:     ruleViolation: 'MISSING_REQUIRED_FIELD',
2025-09-20T19:35:03:     details: 'Missing required field: phone'
2025-09-20T19:35:03:   },
2025-09-20T19:35:03:   timestamp: 1758377103317
2025-09-20T19:35:03: }
2025-09-20T19:35:03: âŒ [919953020706_TJJ19092511_confirmation_1758377103310] Missing required field: phone
2025-09-20T19:35:03: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Missing required field: phone
2025-09-20T19:35:03: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T19:35:03: â„¹ï¸ [7:35:03 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T19:35:03:   phone: '919****706',
2025-09-20T19:35:03:   orderId: 'TJJ19092511',
2025-09-20T19:35:03:   messageType: 'confirmation',
2025-09-20T19:35:03:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:35:03:   reason: {
2025-09-20T19:35:03:     contentHash: '97026037ffec053e',
2025-09-20T19:35:03:     timestamp: 1758377103319,
2025-09-20T19:35:03:     messageLength: 469,
2025-09-20T19:35:03:     errorMessage: 'Missing required field: phone',
2025-09-20T19:35:03:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T19:35:03:   },
2025-09-20T19:35:03:   duration: 0,
2025-09-20T19:35:03:   timestamp: 1758377103326
2025-09-20T19:35:03: }
2025-09-20T19:35:03: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:35:03: ğŸ“ Loaded 11 template types
2025-09-20T19:35:03: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T19:35:03: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T19:35:03: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T19:35:03: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758377103330] Starting comprehensive safety check...
2025-09-20T19:35:03: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758377103330] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T19:35:03: â„¹ï¸ [7:35:03 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:35:03:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:35:03:   phone: '919****488',
2025-09-20T19:35:03:   orderId: 'TWM19092511',
2025-09-20T19:35:03:   messageType: 'confirmation',
2025-09-20T19:35:03:   result: 'STARTED',
2025-09-20T19:35:03:   details: {
2025-09-20T19:35:03:     checkId: '919358537488_TWM19092511_confirmation_1758377103330',
2025-09-20T19:35:03:     hasOrderData: true,
2025-09-20T19:35:03:     hasSheetData: false,
2025-09-20T19:35:03:     messageLength: 475
2025-09-20T19:35:03:   },
2025-09-20T19:35:03:   timestamp: 1758377103330
2025-09-20T19:35:03: }
2025-09-20T19:35:03: ğŸ” [919358537488_TWM19092511_confirmation_1758377103330] Step 1: Kill Switch Check
2025-09-20T19:35:03: ğŸ” [919358537488_TWM19092511_confirmation_1758377103330] Step 1.5: Developer Phone Check
2025-09-20T19:35:03: ğŸ” [919358537488_TWM19092511_confirmation_1758377103330] Step 2: Grace Period Check
2025-09-20T19:35:03: ğŸ” [919358537488_TWM19092511_confirmation_1758377103330] Step 3: Business Hours Check
2025-09-20T19:35:03: ğŸ” [919358537488_TWM19092511_confirmation_1758377103330] Step 4: Message Type Rules Check
2025-09-20T19:35:03: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T19:35:03: â„¹ï¸ [7:35:03 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:35:03:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:35:03:   phone: '919****488',
2025-09-20T19:35:03:   orderId: 'TWM19092511',
2025-09-20T19:35:03:   messageType: 'confirmation',
2025-09-20T19:35:03:   result: 'STARTED',
2025-09-20T19:35:03:   details: {
2025-09-20T19:35:03:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T19:35:03:     requiredFields: [
2025-09-20T19:35:03:       'customer_name',
2025-09-20T19:35:03:       'order_id',
2025-09-20T19:35:03:       'phone',
2025-09-20T19:35:03:       'garment_type',
2025-09-20T19:35:03:       'delivery_date'
2025-09-20T19:35:03:     ],
2025-09-20T19:35:03:     orderDataFields: [
2025-09-20T19:35:03:       'customer_name',
2025-09-20T19:35:03:       'order_id',
2025-09-20T19:35:03:       'garment_type',
2025-09-20T19:35:03:       'total_amount',
2025-09-20T19:35:03:       'advance_amount',
2025-09-20T19:35:03:       'remaining_amount',
2025-09-20T19:35:03:       'ready_date',
2025-09-20T19:35:03:       'delivery_date',
2025-09-20T19:35:03:       'shop_name',
2025-09-20T19:35:03:       'shop_phone',
2025-09-20T19:35:03:       'business_hours'
2025-09-20T19:35:03:     ],
2025-09-20T19:35:03:     sheetDataFields: []
2025-09-20T19:35:03:   },
2025-09-20T19:35:03:   timestamp: 1758377103333
2025-09-20T19:35:03: }
2025-09-20T19:35:03: â„¹ï¸ [7:35:03 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:35:03:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:35:03:   phone: '919****488',
2025-09-20T19:35:03:   orderId: 'TWM19092511',
2025-09-20T19:35:03:   messageType: 'confirmation',
2025-09-20T19:35:03:   result: 'MISSING_FIELD',
2025-09-20T19:35:03:   details: {
2025-09-20T19:35:03:     missingField: 'phone',
2025-09-20T19:35:03:     requiredFields: [
2025-09-20T19:35:03:       'customer_name',
2025-09-20T19:35:03:       'order_id',
2025-09-20T19:35:03:       'phone',
2025-09-20T19:35:03:       'garment_type',
2025-09-20T19:35:03:       'delivery_date'
2025-09-20T19:35:03:     ],
2025-09-20T19:35:03:     availableOrderFields: [
2025-09-20T19:35:03:       'customer_name',
2025-09-20T19:35:03:       'order_id',
2025-09-20T19:35:03:       'garment_type',
2025-09-20T19:35:03:       'total_amount',
2025-09-20T19:35:03:       'advance_amount',
2025-09-20T19:35:03:       'remaining_amount',
2025-09-20T19:35:03:       'ready_date',
2025-09-20T19:35:03:       'delivery_date',
2025-09-20T19:35:03:       'shop_name',
2025-09-20T19:35:03:       'shop_phone',
2025-09-20T19:35:03:       'business_hours'
2025-09-20T19:35:03:     ],
2025-09-20T19:35:03:     availableSheetFields: []
2025-09-20T19:35:03:   },
2025-09-20T19:35:03:   timestamp: 1758377103337
2025-09-20T19:35:03: }
2025-09-20T19:35:03: â„¹ï¸ [7:35:03 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:35:03:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:35:03:   phone: '919****488',
2025-09-20T19:35:03:   orderId: 'TWM19092511',
2025-09-20T19:35:03:   messageType: 'confirmation',
2025-09-20T19:35:03:   result: 'BLOCKED',
2025-09-20T19:35:03:   details: {
2025-09-20T19:35:03:     checkId: '919358537488_TWM19092511_confirmation_1758377103330',
2025-09-20T19:35:03:     ruleViolation: 'MISSING_REQUIRED_FIELD',
2025-09-20T19:35:03:     details: 'Missing required field: phone'
2025-09-20T19:35:03:   },
2025-09-20T19:35:03:   timestamp: 1758377103339
2025-09-20T19:35:03: }
2025-09-20T19:35:03: âŒ [919358537488_TWM19092511_confirmation_1758377103330] Missing required field: phone
2025-09-20T19:35:03: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Missing required field: phone
2025-09-20T19:35:03: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T19:35:03: â„¹ï¸ [7:35:03 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T19:35:03:   phone: '919****488',
2025-09-20T19:35:03:   orderId: 'TWM19092511',
2025-09-20T19:35:03:   messageType: 'confirmation',
2025-09-20T19:35:03:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:35:03:   reason: {
2025-09-20T19:35:03:     contentHash: 'e34d023f065922da',
2025-09-20T19:35:03:     timestamp: 1758377103343,
2025-09-20T19:35:03:     messageLength: 475,
2025-09-20T19:35:03:     errorMessage: 'Missing required field: phone',
2025-09-20T19:35:03:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T19:35:03:   },
2025-09-20T19:35:03:   duration: 0,
2025-09-20T19:35:03:   timestamp: 1758377103351
2025-09-20T19:35:03: }
2025-09-20T19:35:03: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:35:03: ğŸ“ Loaded 11 template types
2025-09-20T19:35:03: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T19:35:03: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T19:35:03: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T19:35:03: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758377103353] Starting comprehensive safety check...
2025-09-20T19:35:03: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758377103353] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T19:35:03: â„¹ï¸ [7:35:03 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:35:03:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:35:03:   phone: '918****811',
2025-09-20T19:35:03:   orderId: 'TOF19092511',
2025-09-20T19:35:03:   messageType: 'confirmation',
2025-09-20T19:35:03:   result: 'STARTED',
2025-09-20T19:35:03:   details: {
2025-09-20T19:35:03:     checkId: '918890134811_TOF19092511_confirmation_1758377103353',
2025-09-20T19:35:03:     hasOrderData: true,
2025-09-20T19:35:03:     hasSheetData: false,
2025-09-20T19:35:03:     messageLength: 473
2025-09-20T19:35:03:   },
2025-09-20T19:35:03:   timestamp: 1758377103354
2025-09-20T19:35:03: }
2025-09-20T19:35:03: ğŸ” [918890134811_TOF19092511_confirmation_1758377103353] Step 1: Kill Switch Check
2025-09-20T19:35:03: ğŸ” [918890134811_TOF19092511_confirmation_1758377103353] Step 1.5: Developer Phone Check
2025-09-20T19:35:03: ğŸ” [918890134811_TOF19092511_confirmation_1758377103353] Step 2: Grace Period Check
2025-09-20T19:35:03: ğŸ” [918890134811_TOF19092511_confirmation_1758377103353] Step 3: Business Hours Check
2025-09-20T19:35:03: ğŸ” [918890134811_TOF19092511_confirmation_1758377103353] Step 4: Message Type Rules Check
2025-09-20T19:35:03: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T19:35:03: â„¹ï¸ [7:35:03 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:35:03:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:35:03:   phone: '918****811',
2025-09-20T19:35:03:   orderId: 'TOF19092511',
2025-09-20T19:35:03:   messageType: 'confirmation',
2025-09-20T19:35:03:   result: 'STARTED',
2025-09-20T19:35:03:   details: {
2025-09-20T19:35:03:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T19:35:03:     requiredFields: [
2025-09-20T19:35:03:       'customer_name',
2025-09-20T19:35:03:       'order_id',
2025-09-20T19:35:03:       'phone',
2025-09-20T19:35:03:       'garment_type',
2025-09-20T19:35:03:       'delivery_date'
2025-09-20T19:35:03:     ],
2025-09-20T19:35:03:     orderDataFields: [
2025-09-20T19:35:03:       'customer_name',
2025-09-20T19:35:03:       'order_id',
2025-09-20T19:35:03:       'garment_type',
2025-09-20T19:35:03:       'total_amount',
2025-09-20T19:35:03:       'advance_amount',
2025-09-20T19:35:03:       'remaining_amount',
2025-09-20T19:35:03:       'ready_date',
2025-09-20T19:35:03:       'delivery_date',
2025-09-20T19:35:03:       'shop_name',
2025-09-20T19:35:03:       'shop_phone',
2025-09-20T19:35:03:       'business_hours'
2025-09-20T19:35:03:     ],
2025-09-20T19:35:03:     sheetDataFields: []
2025-09-20T19:35:03:   },
2025-09-20T19:35:03:   timestamp: 1758377103357
2025-09-20T19:35:03: }
2025-09-20T19:35:03: â„¹ï¸ [7:35:03 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:35:03:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:35:03:   phone: '918****811',
2025-09-20T19:35:03:   orderId: 'TOF19092511',
2025-09-20T19:35:03:   messageType: 'confirmation',
2025-09-20T19:35:03:   result: 'MISSING_FIELD',
2025-09-20T19:35:03:   details: {
2025-09-20T19:35:03:     missingField: 'phone',
2025-09-20T19:35:03:     requiredFields: [
2025-09-20T19:35:03:       'customer_name',
2025-09-20T19:35:03:       'order_id',
2025-09-20T19:35:03:       'phone',
2025-09-20T19:35:03:       'garment_type',
2025-09-20T19:35:03:       'delivery_date'
2025-09-20T19:35:03:     ],
2025-09-20T19:35:03:     availableOrderFields: [
2025-09-20T19:35:03:       'customer_name',
2025-09-20T19:35:03:       'order_id',
2025-09-20T19:35:03:       'garment_type',
2025-09-20T19:35:03:       'total_amount',
2025-09-20T19:35:03:       'advance_amount',
2025-09-20T19:35:03:       'remaining_amount',
2025-09-20T19:35:03:       'ready_date',
2025-09-20T19:35:03:       'delivery_date',
2025-09-20T19:35:03:       'shop_name',
2025-09-20T19:35:03:       'shop_phone',
2025-09-20T19:35:03:       'business_hours'
2025-09-20T19:35:03:     ],
2025-09-20T19:35:03:     availableSheetFields: []
2025-09-20T19:35:03:   },
2025-09-20T19:35:03:   timestamp: 1758377103360
2025-09-20T19:35:03: }
2025-09-20T19:35:03: â„¹ï¸ [7:35:03 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:35:03:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:35:03:   phone: '918****811',
2025-09-20T19:35:03:   orderId: 'TOF19092511',
2025-09-20T19:35:03:   messageType: 'confirmation',
2025-09-20T19:35:03:   result: 'BLOCKED',
2025-09-20T19:35:03:   details: {
2025-09-20T19:35:03:     checkId: '918890134811_TOF19092511_confirmation_1758377103353',
2025-09-20T19:35:03:     ruleViolation: 'MISSING_REQUIRED_FIELD',
2025-09-20T19:35:03:     details: 'Missing required field: phone'
2025-09-20T19:35:03:   },
2025-09-20T19:35:03:   timestamp: 1758377103362
2025-09-20T19:35:03: }
2025-09-20T19:35:03: âŒ [918890134811_TOF19092511_confirmation_1758377103353] Missing required field: phone
2025-09-20T19:35:03: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Missing required field: phone
2025-09-20T19:35:03: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T19:35:03: â„¹ï¸ [7:35:03 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T19:35:03:   phone: '918****811',
2025-09-20T19:35:03:   orderId: 'TOF19092511',
2025-09-20T19:35:03:   messageType: 'confirmation',
2025-09-20T19:35:03:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:35:03:   reason: {
2025-09-20T19:35:03:     contentHash: '388fbe812e19f1de',
2025-09-20T19:35:03:     timestamp: 1758377103365,
2025-09-20T19:35:03:     messageLength: 473,
2025-09-20T19:35:03:     errorMessage: 'Missing required field: phone',
2025-09-20T19:35:03:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T19:35:03:   },
2025-09-20T19:35:03:   duration: 0,
2025-09-20T19:35:03:   timestamp: 1758377103376
2025-09-20T19:35:03: }
2025-09-20T19:35:25: ğŸ’¾ Data synced to files successfully
2025-09-20T19:35:57: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:35:57: ğŸ“ Loaded 11 template types
2025-09-20T19:35:57: ğŸ”§ WhatsApp Bot initialized
2025-09-20T19:35:57: ğŸ“Š Configuration status: undefined
2025-09-20T19:35:57: âœ… Atomic State Manager initialized
2025-09-20T19:35:57: ğŸ“ Enhanced Logger initialized
2025-09-20T19:35:57: âœ… Google credentials loaded from service-account.json file
2025-09-20T19:35:57: ğŸ“± WhatsApp auth status: âœ… credentials, 4 session files
2025-09-20T19:35:57: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-20T19:35:57:    Auth Mode: both
2025-09-20T19:35:57:    QR Enabled: true
2025-09-20T19:35:57:    Phone Enabled: true
2025-09-20T19:35:57:    Session Persistence: true
2025-09-20T19:35:57:    Max Reconnect Attempts: 10
2025-09-20T19:35:57:    Default Phone: None
2025-09-20T19:35:57: ğŸ”’ Session validation enabled (check every 300s)
2025-09-20T19:35:57: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-20T19:35:57: ğŸ”§ Developer Configuration initialized
2025-09-20T19:35:57: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T19:35:57: â„¹ï¸ [7:35:57 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T19:35:57:   startupTime: 1758377157097,
2025-09-20T19:35:57:   gracePeriodMs: 240000,
2025-09-20T19:35:57:   dataDir: './safety-data',
2025-09-20T19:35:57:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T19:35:57:   processId: 4416,
2025-09-20T19:35:57:   nodeVersion: 'v22.19.0'
2025-09-20T19:35:57: }
2025-09-20T19:35:57: ğŸ”§ Developer Configuration initialized
2025-09-20T19:35:57: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T19:35:57: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-20T19:35:57: â° 4-minute startup delay active
2025-09-20T19:35:57: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-20T19:35:57: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-20T19:35:57: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T19:35:57: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T19:35:57: âœ… Google Sheets API initialized
2025-09-20T19:35:57: âœ… Google Sheets API initialized
2025-09-20T19:35:57: â„¹ï¸ [7:35:57 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T19:35:57:   startupTime: 1758377157097,
2025-09-20T19:35:57:   gracePeriodMs: 240000,
2025-09-20T19:35:57:   dataDir: './safety-data',
2025-09-20T19:35:57:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T19:35:57:   processId: 4416,
2025-09-20T19:35:57:   nodeVersion: 'v22.19.0'
2025-09-20T19:35:57: }
2025-09-20T19:35:57: â„¹ï¸ [7:35:57 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T19:35:57: ğŸ“ Loaded 0 sent messages from file
2025-09-20T19:35:57: â„¹ï¸ [7:35:57 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T19:35:57: ğŸ“ Loaded 0 customer histories from file
2025-09-20T19:35:57: ğŸ“ Loaded 0 message hashes from file
2025-09-20T19:35:57: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T11-48-14-282Z.log
2025-09-20T19:35:57: ğŸ“ Enhanced Logger initialized
2025-09-20T19:35:57: ğŸ“ Loaded statistics from file
2025-09-20T19:35:57: âœ… Duplicate Prevention Manager initialized
2025-09-20T19:35:57: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T19:35:57: â„¹ï¸ [7:35:57 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T19:35:57: â„¹ï¸ [7:35:57 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T19:35:57: ğŸ§¹ Removed stale process lock
2025-09-20T19:35:57: ğŸ§¹ Removed stale process lock
2025-09-20T19:35:57: ğŸ”’ Process lock acquired (PID: 4416)
2025-09-20T19:35:57: ğŸ”’ Process lock acquired (PID: 4416)
2025-09-20T19:35:57: â„¹ï¸ [7:35:57 pm] INFO: Process isolation enforced {
2025-09-20T19:35:57:   lockFile: 'safety-data\\process.lock',
2025-09-20T19:35:57:   pidFile: 'safety-data\\process.pid',
2025-09-20T19:35:57:   processId: 4416
2025-09-20T19:35:57: }
2025-09-20T19:35:57: â° Starting 240 second startup grace period...
2025-09-20T19:35:57: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T19:35:57: â„¹ï¸ [7:35:57 pm] INFO: Process isolation enforced {
2025-09-20T19:35:57:   lockFile: 'safety-data\\process.lock',
2025-09-20T19:35:57:   pidFile: 'safety-data\\process.pid',
2025-09-20T19:35:57:   processId: 4416
2025-09-20T19:35:57: }
2025-09-20T19:35:57: â° Starting 240 second startup grace period...
2025-09-20T19:35:57: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T19:35:57: â„¹ï¸ [7:35:57 pm] INFO: Grace Period: STARTED {
2025-09-20T19:35:57:   action: 'STARTED',
2025-09-20T19:35:57:   remainingMs: 240000,
2025-09-20T19:35:57:   remainingSeconds: 240,
2025-09-20T19:35:57:   details: { startupTime: 1758377157097, processId: 4416 },
2025-09-20T19:35:57:   timestamp: 1758377157139
2025-09-20T19:35:57: }
2025-09-20T19:35:57: â„¹ï¸ [7:35:57 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T19:35:57:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T19:35:57:   remainingMs: 240000,
2025-09-20T19:35:57:   remainingSeconds: 240,
2025-09-20T19:35:57:   details: { startupTime: 1758377157097, willExpireAt: 1758377397097 },
2025-09-20T19:35:57:   timestamp: 1758377157139
2025-09-20T19:35:57: }
2025-09-20T19:35:57: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T19:35:57: â° Startup grace period: 240 seconds
2025-09-20T19:35:57: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T19:35:57: â„¹ï¸ [7:35:57 pm] INFO: Grace Period: STARTED {
2025-09-20T19:35:57:   action: 'STARTED',
2025-09-20T19:35:57:   remainingMs: 240000,
2025-09-20T19:35:57:   remainingSeconds: 240,
2025-09-20T19:35:57:   details: { startupTime: 1758377157097, processId: 4416 },
2025-09-20T19:35:57:   timestamp: 1758377157141
2025-09-20T19:35:57: }
2025-09-20T19:35:57: â„¹ï¸ [7:35:57 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T19:35:57:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T19:35:57:   remainingMs: 240000,
2025-09-20T19:35:57:   remainingSeconds: 240,
2025-09-20T19:35:57:   details: { startupTime: 1758377157097, willExpireAt: 1758377397097 },
2025-09-20T19:35:57:   timestamp: 1758377157141
2025-09-20T19:35:57: }
2025-09-20T19:35:57: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T19:35:57: â° Startup grace period: 240 seconds
2025-09-20T19:35:57: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T19:35:57: â„¹ï¸ [7:35:57 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T19:35:57:   initializationDuration: 46,
2025-09-20T19:35:57:   gracePeriodActive: true,
2025-09-20T19:35:57:   messageRulesCount: 8,
2025-09-20T19:35:57:   messageTypes: [
2025-09-20T19:35:57:     'welcome',
2025-09-20T19:35:57:     'confirmation',
2025-09-20T19:35:57:     'ready',
2025-09-20T19:35:57:     'delivery',
2025-09-20T19:35:57:     'pickup_reminder',
2025-09-20T19:35:57:     'payment_reminder',
2025-09-20T19:35:57:     'fabric_welcome',
2025-09-20T19:35:57:     'fabric_purchase'
2025-09-20T19:35:57:   ],
2025-09-20T19:35:57:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T19:35:57:   databaseReady: true,
2025-09-20T19:35:57:   loggerReady: true,
2025-09-20T19:35:57:   processIsolationActive: true
2025-09-20T19:35:57: }
2025-09-20T19:35:57: â„¹ï¸ [7:35:57 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T19:35:57:   initializationDuration: 48,
2025-09-20T19:35:57:   gracePeriodActive: true,
2025-09-20T19:35:57:   messageRulesCount: 8,
2025-09-20T19:35:57:   messageTypes: [
2025-09-20T19:35:57:     'welcome',
2025-09-20T19:35:57:     'confirmation',
2025-09-20T19:35:57:     'ready',
2025-09-20T19:35:57:     'delivery',
2025-09-20T19:35:57:     'pickup_reminder',
2025-09-20T19:35:57:     'payment_reminder',
2025-09-20T19:35:57:     'fabric_welcome',
2025-09-20T19:35:57:     'fabric_purchase'
2025-09-20T19:35:57:   ],
2025-09-20T19:35:57:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T19:35:57:   databaseReady: true,
2025-09-20T19:35:57:   loggerReady: true,
2025-09-20T19:35:57:   processIsolationActive: true
2025-09-20T19:35:57: }
2025-09-20T19:35:57: âœ… Safety Manager initialized
2025-09-20T19:35:57: ğŸ“ Loaded 0 sent messages from file
2025-09-20T19:35:57: ğŸ“ Loaded 0 customer histories from file
2025-09-20T19:35:57: ğŸ“ Loaded 0 message hashes from file
2025-09-20T19:35:57: ğŸ“ Loaded statistics from file
2025-09-20T19:35:57: âœ… Duplicate Prevention Manager initialized
2025-09-20T19:35:57: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T19:35:57: âœ… Duplicate Prevention Manager initialized
2025-09-20T19:35:57: ğŸ”„ Starting WhatsApp connection...
2025-09-20T19:35:57: ğŸ”„ Initializing WhatsApp client...
2025-09-20T19:35:57: âœ… WhatsApp connection started
2025-09-20T19:35:57: ğŸ”§ Initializing admin commands...
2025-09-20T19:35:57: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T19:35:57: âœ… Admin commands system initialized
2025-09-20T19:35:57: ğŸ”„ Initializing polling functionality...
2025-09-20T19:35:57: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T19:35:57: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T19:35:57: ğŸ“ Attempting to request pairing code...
2025-09-20T19:35:57: ğŸ’¡ To use phone authentication:
2025-09-20T19:35:57:    1. Use the dashboard at http://localhost:3001
2025-09-20T19:35:57:    2. Select "Phone Number Authentication"
2025-09-20T19:35:57:    3. Enter your phone number
2025-09-20T19:35:57:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T19:35:57: ğŸ”„ Connecting to WhatsApp...
2025-09-20T19:35:58: âœ… WhatsApp connected successfully!
2025-09-20T19:35:58: ğŸ”„ Enhanced client: Connected event received, forwarding...
2025-09-20T19:35:58: ğŸ“± Session established successfully
2025-09-20T19:35:58: ğŸ”’ Session will be monitored for stability
2025-09-20T19:36:04: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:36:04: ğŸ“ Loaded 11 template types
2025-09-20T19:36:04: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T19:36:04: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T19:36:04: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T19:36:04: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758377164652] Starting comprehensive safety check...
2025-09-20T19:36:04: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758377164652] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T19:36:04: â„¹ï¸ [7:36:04 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:36:04:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:36:04:   phone: '919****706',
2025-09-20T19:36:04:   orderId: 'TJJ19092511',
2025-09-20T19:36:04:   messageType: 'confirmation',
2025-09-20T19:36:04:   result: 'STARTED',
2025-09-20T19:36:04:   details: {
2025-09-20T19:36:04:     checkId: '919953020706_TJJ19092511_confirmation_1758377164652',
2025-09-20T19:36:04:     hasOrderData: true,
2025-09-20T19:36:04:     hasSheetData: false,
2025-09-20T19:36:04:     messageLength: 469
2025-09-20T19:36:04:   },
2025-09-20T19:36:04:   timestamp: 1758377164653
2025-09-20T19:36:04: }
2025-09-20T19:36:04: ğŸ” [919953020706_TJJ19092511_confirmation_1758377164652] Step 1: Kill Switch Check
2025-09-20T19:36:04: ğŸ” [919953020706_TJJ19092511_confirmation_1758377164652] Step 1.5: Developer Phone Check
2025-09-20T19:36:04: ğŸ” [919953020706_TJJ19092511_confirmation_1758377164652] Step 2: Grace Period Check
2025-09-20T19:36:04: â„¹ï¸ [7:36:04 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:36:04:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:36:04:   remainingMs: 232435,
2025-09-20T19:36:04:   remainingSeconds: 233,
2025-09-20T19:36:04:   details: {
2025-09-20T19:36:04:     checkId: '919953020706_TJJ19092511_confirmation_1758377164652',
2025-09-20T19:36:04:     phone: '919953020706',
2025-09-20T19:36:04:     orderId: 'TJJ19092511',
2025-09-20T19:36:04:     messageType: 'confirmation'
2025-09-20T19:36:04:   },
2025-09-20T19:36:04:   timestamp: 1758377164663
2025-09-20T19:36:04: }
2025-09-20T19:36:04: âŒ [919953020706_TJJ19092511_confirmation_1758377164652] Startup grace period active (233s remaining)
2025-09-20T19:36:04: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Startup grace period active (233s remaining)
2025-09-20T19:36:04: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T19:36:04: â„¹ï¸ [7:36:04 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T19:36:04:   phone: '919****706',
2025-09-20T19:36:04:   orderId: 'TJJ19092511',
2025-09-20T19:36:04:   messageType: 'confirmation',
2025-09-20T19:36:04:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:36:04:   reason: {
2025-09-20T19:36:04:     contentHash: '97026037ffec053e',
2025-09-20T19:36:04:     timestamp: 1758377164671,
2025-09-20T19:36:04:     messageLength: 469,
2025-09-20T19:36:04:     errorMessage: 'Startup grace period active (233s remaining)',
2025-09-20T19:36:04:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T19:36:04:   },
2025-09-20T19:36:04:   duration: 0,
2025-09-20T19:36:04:   timestamp: 1758377164696
2025-09-20T19:36:04: }
2025-09-20T19:36:04: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:36:04: ğŸ“ Loaded 11 template types
2025-09-20T19:36:04: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T19:36:04: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T19:36:04: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T19:36:04: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758377164702] Starting comprehensive safety check...
2025-09-20T19:36:04: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758377164702] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T19:36:04: â„¹ï¸ [7:36:04 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:36:04:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:36:04:   phone: '919****488',
2025-09-20T19:36:04:   orderId: 'TWM19092511',
2025-09-20T19:36:04:   messageType: 'confirmation',
2025-09-20T19:36:04:   result: 'STARTED',
2025-09-20T19:36:04:   details: {
2025-09-20T19:36:04:     checkId: '919358537488_TWM19092511_confirmation_1758377164702',
2025-09-20T19:36:04:     hasOrderData: true,
2025-09-20T19:36:04:     hasSheetData: false,
2025-09-20T19:36:04:     messageLength: 475
2025-09-20T19:36:04:   },
2025-09-20T19:36:04:   timestamp: 1758377164703
2025-09-20T19:36:04: }
2025-09-20T19:36:04: ğŸ” [919358537488_TWM19092511_confirmation_1758377164702] Step 1: Kill Switch Check
2025-09-20T19:36:04: ğŸ” [919358537488_TWM19092511_confirmation_1758377164702] Step 1.5: Developer Phone Check
2025-09-20T19:36:04: ğŸ” [919358537488_TWM19092511_confirmation_1758377164702] Step 2: Grace Period Check
2025-09-20T19:36:04: â„¹ï¸ [7:36:04 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:36:04:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:36:04:   remainingMs: 232390,
2025-09-20T19:36:04:   remainingSeconds: 233,
2025-09-20T19:36:04:   details: {
2025-09-20T19:36:04:     checkId: '919358537488_TWM19092511_confirmation_1758377164702',
2025-09-20T19:36:04:     phone: '919358537488',
2025-09-20T19:36:04:     orderId: 'TWM19092511',
2025-09-20T19:36:04:     messageType: 'confirmation'
2025-09-20T19:36:04:   },
2025-09-20T19:36:04:   timestamp: 1758377164707
2025-09-20T19:36:04: }
2025-09-20T19:36:04: âŒ [919358537488_TWM19092511_confirmation_1758377164702] Startup grace period active (233s remaining)
2025-09-20T19:36:04: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Startup grace period active (233s remaining)
2025-09-20T19:36:04: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T19:36:04: â„¹ï¸ [7:36:04 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T19:36:04:   phone: '919****488',
2025-09-20T19:36:04:   orderId: 'TWM19092511',
2025-09-20T19:36:04:   messageType: 'confirmation',
2025-09-20T19:36:04:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:36:04:   reason: {
2025-09-20T19:36:04:     contentHash: 'e34d023f065922da',
2025-09-20T19:36:04:     timestamp: 1758377164713,
2025-09-20T19:36:04:     messageLength: 475,
2025-09-20T19:36:04:     errorMessage: 'Startup grace period active (233s remaining)',
2025-09-20T19:36:04:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T19:36:04:   },
2025-09-20T19:36:04:   duration: 0,
2025-09-20T19:36:04:   timestamp: 1758377164726
2025-09-20T19:36:04: }
2025-09-20T19:36:04: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:36:04: ğŸ“ Loaded 11 template types
2025-09-20T19:36:04: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T19:36:04: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T19:36:04: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T19:36:04: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758377164732] Starting comprehensive safety check...
2025-09-20T19:36:04: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758377164732] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T19:36:04: â„¹ï¸ [7:36:04 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:36:04:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:36:04:   phone: '918****811',
2025-09-20T19:36:04:   orderId: 'TOF19092511',
2025-09-20T19:36:04:   messageType: 'confirmation',
2025-09-20T19:36:04:   result: 'STARTED',
2025-09-20T19:36:04:   details: {
2025-09-20T19:36:04:     checkId: '918890134811_TOF19092511_confirmation_1758377164732',
2025-09-20T19:36:04:     hasOrderData: true,
2025-09-20T19:36:04:     hasSheetData: false,
2025-09-20T19:36:04:     messageLength: 473
2025-09-20T19:36:04:   },
2025-09-20T19:36:04:   timestamp: 1758377164732
2025-09-20T19:36:04: }
2025-09-20T19:36:04: ğŸ” [918890134811_TOF19092511_confirmation_1758377164732] Step 1: Kill Switch Check
2025-09-20T19:36:04: ğŸ” [918890134811_TOF19092511_confirmation_1758377164732] Step 1.5: Developer Phone Check
2025-09-20T19:36:04: ğŸ” [918890134811_TOF19092511_confirmation_1758377164732] Step 2: Grace Period Check
2025-09-20T19:36:04: â„¹ï¸ [7:36:04 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:36:04:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:36:04:   remainingMs: 232362,
2025-09-20T19:36:04:   remainingSeconds: 233,
2025-09-20T19:36:04:   details: {
2025-09-20T19:36:04:     checkId: '918890134811_TOF19092511_confirmation_1758377164732',
2025-09-20T19:36:04:     phone: '918890134811',
2025-09-20T19:36:04:     orderId: 'TOF19092511',
2025-09-20T19:36:04:     messageType: 'confirmation'
2025-09-20T19:36:04:   },
2025-09-20T19:36:04:   timestamp: 1758377164735
2025-09-20T19:36:04: }
2025-09-20T19:36:04: âŒ [918890134811_TOF19092511_confirmation_1758377164732] Startup grace period active (233s remaining)
2025-09-20T19:36:04: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (233s remaining)
2025-09-20T19:36:04: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T19:36:04: â„¹ï¸ [7:36:04 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T19:36:04:   phone: '918****811',
2025-09-20T19:36:04:   orderId: 'TOF19092511',
2025-09-20T19:36:04:   messageType: 'confirmation',
2025-09-20T19:36:04:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:36:04:   reason: {
2025-09-20T19:36:04:     contentHash: '388fbe812e19f1de',
2025-09-20T19:36:04:     timestamp: 1758377164737,
2025-09-20T19:36:04:     messageLength: 473,
2025-09-20T19:36:04:     errorMessage: 'Startup grace period active (233s remaining)',
2025-09-20T19:36:04:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T19:36:04:   },
2025-09-20T19:36:04:   duration: 0,
2025-09-20T19:36:04:   timestamp: 1758377164747
2025-09-20T19:36:04: }
2025-09-20T19:36:27: ğŸ’¾ Data synced to files successfully
2025-09-20T19:36:57: ğŸ’¾ Data synced to files successfully
2025-09-20T19:37:27: ğŸ’¾ Data synced to files successfully
2025-09-20T19:37:57: ğŸ’¾ Data synced to files successfully
2025-09-20T19:38:27: ğŸ’¾ Data synced to files successfully
2025-09-20T19:38:57: ğŸ’¾ Data synced to files successfully
2025-09-20T19:39:04: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:39:04: ğŸ“ Loaded 11 template types
2025-09-20T19:39:04: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T19:39:04: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T19:39:04: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T19:39:04: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758377344569] Starting comprehensive safety check...
2025-09-20T19:39:04: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758377344569] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T19:39:04: â„¹ï¸ [7:39:04 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:39:04:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:39:04:   phone: '919****706',
2025-09-20T19:39:04:   orderId: 'TJJ19092511',
2025-09-20T19:39:04:   messageType: 'confirmation',
2025-09-20T19:39:04:   result: 'STARTED',
2025-09-20T19:39:04:   details: {
2025-09-20T19:39:04:     checkId: '919953020706_TJJ19092511_confirmation_1758377344569',
2025-09-20T19:39:04:     hasOrderData: true,
2025-09-20T19:39:04:     hasSheetData: false,
2025-09-20T19:39:04:     messageLength: 469
2025-09-20T19:39:04:   },
2025-09-20T19:39:04:   timestamp: 1758377344569
2025-09-20T19:39:04: }
2025-09-20T19:39:04: ğŸ” [919953020706_TJJ19092511_confirmation_1758377344569] Step 1: Kill Switch Check
2025-09-20T19:39:04: ğŸ” [919953020706_TJJ19092511_confirmation_1758377344569] Step 1.5: Developer Phone Check
2025-09-20T19:39:04: ğŸ” [919953020706_TJJ19092511_confirmation_1758377344569] Step 2: Grace Period Check
2025-09-20T19:39:04: â„¹ï¸ [7:39:04 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:39:04:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:39:04:   remainingMs: 52521,
2025-09-20T19:39:04:   remainingSeconds: 53,
2025-09-20T19:39:04:   details: {
2025-09-20T19:39:04:     checkId: '919953020706_TJJ19092511_confirmation_1758377344569',
2025-09-20T19:39:04:     phone: '919953020706',
2025-09-20T19:39:04:     orderId: 'TJJ19092511',
2025-09-20T19:39:04:     messageType: 'confirmation'
2025-09-20T19:39:04:   },
2025-09-20T19:39:04:   timestamp: 1758377344576
2025-09-20T19:39:04: }
2025-09-20T19:39:04: âŒ [919953020706_TJJ19092511_confirmation_1758377344569] Startup grace period active (53s remaining)
2025-09-20T19:39:04: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Startup grace period active (53s remaining)
2025-09-20T19:39:04: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T19:39:04: â„¹ï¸ [7:39:04 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T19:39:04:   phone: '919****706',
2025-09-20T19:39:04:   orderId: 'TJJ19092511',
2025-09-20T19:39:04:   messageType: 'confirmation',
2025-09-20T19:39:04:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:39:04:   reason: {
2025-09-20T19:39:04:     contentHash: '97026037ffec053e',
2025-09-20T19:39:04:     timestamp: 1758377344585,
2025-09-20T19:39:04:     messageLength: 469,
2025-09-20T19:39:04:     errorMessage: 'Startup grace period active (53s remaining)',
2025-09-20T19:39:04:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T19:39:04:   },
2025-09-20T19:39:04:   duration: 0,
2025-09-20T19:39:04:   timestamp: 1758377344601
2025-09-20T19:39:04: }
2025-09-20T19:39:04: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:39:04: ğŸ“ Loaded 11 template types
2025-09-20T19:39:04: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T19:39:04: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T19:39:04: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T19:39:04: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758377344609] Starting comprehensive safety check...
2025-09-20T19:39:04: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758377344609] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T19:39:04: â„¹ï¸ [7:39:04 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:39:04:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:39:04:   phone: '919****488',
2025-09-20T19:39:04:   orderId: 'TWM19092511',
2025-09-20T19:39:04:   messageType: 'confirmation',
2025-09-20T19:39:04:   result: 'STARTED',
2025-09-20T19:39:04:   details: {
2025-09-20T19:39:04:     checkId: '919358537488_TWM19092511_confirmation_1758377344609',
2025-09-20T19:39:04:     hasOrderData: true,
2025-09-20T19:39:04:     hasSheetData: false,
2025-09-20T19:39:04:     messageLength: 475
2025-09-20T19:39:04:   },
2025-09-20T19:39:04:   timestamp: 1758377344610
2025-09-20T19:39:04: }
2025-09-20T19:39:04: ğŸ” [919358537488_TWM19092511_confirmation_1758377344609] Step 1: Kill Switch Check
2025-09-20T19:39:04: ğŸ” [919358537488_TWM19092511_confirmation_1758377344609] Step 1.5: Developer Phone Check
2025-09-20T19:39:04: ğŸ” [919358537488_TWM19092511_confirmation_1758377344609] Step 2: Grace Period Check
2025-09-20T19:39:04: â„¹ï¸ [7:39:04 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:39:04:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:39:04:   remainingMs: 52481,
2025-09-20T19:39:04:   remainingSeconds: 53,
2025-09-20T19:39:04:   details: {
2025-09-20T19:39:04:     checkId: '919358537488_TWM19092511_confirmation_1758377344609',
2025-09-20T19:39:04:     phone: '919358537488',
2025-09-20T19:39:04:     orderId: 'TWM19092511',
2025-09-20T19:39:04:     messageType: 'confirmation'
2025-09-20T19:39:04:   },
2025-09-20T19:39:04:   timestamp: 1758377344617
2025-09-20T19:39:04: }
2025-09-20T19:39:04: âŒ [919358537488_TWM19092511_confirmation_1758377344609] Startup grace period active (53s remaining)
2025-09-20T19:39:04: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Startup grace period active (53s remaining)
2025-09-20T19:39:04: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T19:39:04: â„¹ï¸ [7:39:04 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T19:39:04:   phone: '919****488',
2025-09-20T19:39:04:   orderId: 'TWM19092511',
2025-09-20T19:39:04:   messageType: 'confirmation',
2025-09-20T19:39:04:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:39:04:   reason: {
2025-09-20T19:39:04:     contentHash: 'e34d023f065922da',
2025-09-20T19:39:04:     timestamp: 1758377344620,
2025-09-20T19:39:04:     messageLength: 475,
2025-09-20T19:39:04:     errorMessage: 'Startup grace period active (53s remaining)',
2025-09-20T19:39:04:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T19:39:04:   },
2025-09-20T19:39:04:   duration: 0,
2025-09-20T19:39:04:   timestamp: 1758377344639
2025-09-20T19:39:04: }
2025-09-20T19:39:04: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:39:04: ğŸ“ Loaded 11 template types
2025-09-20T19:39:04: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T19:39:04: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T19:39:04: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T19:39:04: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758377344645] Starting comprehensive safety check...
2025-09-20T19:39:04: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758377344645] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T19:39:04: â„¹ï¸ [7:39:04 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:39:04:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:39:04:   phone: '918****811',
2025-09-20T19:39:04:   orderId: 'TOF19092511',
2025-09-20T19:39:04:   messageType: 'confirmation',
2025-09-20T19:39:04:   result: 'STARTED',
2025-09-20T19:39:04:   details: {
2025-09-20T19:39:04:     checkId: '918890134811_TOF19092511_confirmation_1758377344645',
2025-09-20T19:39:04:     hasOrderData: true,
2025-09-20T19:39:04:     hasSheetData: false,
2025-09-20T19:39:04:     messageLength: 473
2025-09-20T19:39:04:   },
2025-09-20T19:39:04:   timestamp: 1758377344645
2025-09-20T19:39:04: }
2025-09-20T19:39:04: ğŸ” [918890134811_TOF19092511_confirmation_1758377344645] Step 1: Kill Switch Check
2025-09-20T19:39:04: ğŸ” [918890134811_TOF19092511_confirmation_1758377344645] Step 1.5: Developer Phone Check
2025-09-20T19:39:04: ğŸ” [918890134811_TOF19092511_confirmation_1758377344645] Step 2: Grace Period Check
2025-09-20T19:39:04: â„¹ï¸ [7:39:04 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:39:04:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:39:04:   remainingMs: 52449,
2025-09-20T19:39:04:   remainingSeconds: 53,
2025-09-20T19:39:04:   details: {
2025-09-20T19:39:04:     checkId: '918890134811_TOF19092511_confirmation_1758377344645',
2025-09-20T19:39:04:     phone: '918890134811',
2025-09-20T19:39:04:     orderId: 'TOF19092511',
2025-09-20T19:39:04:     messageType: 'confirmation'
2025-09-20T19:39:04:   },
2025-09-20T19:39:04:   timestamp: 1758377344648
2025-09-20T19:39:04: }
2025-09-20T19:39:04: âŒ [918890134811_TOF19092511_confirmation_1758377344645] Startup grace period active (53s remaining)
2025-09-20T19:39:04: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (53s remaining)
2025-09-20T19:39:04: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T19:39:04: â„¹ï¸ [7:39:04 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T19:39:04:   phone: '918****811',
2025-09-20T19:39:04:   orderId: 'TOF19092511',
2025-09-20T19:39:04:   messageType: 'confirmation',
2025-09-20T19:39:04:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:39:04:   reason: {
2025-09-20T19:39:04:     contentHash: '388fbe812e19f1de',
2025-09-20T19:39:04:     timestamp: 1758377344651,
2025-09-20T19:39:04:     messageLength: 473,
2025-09-20T19:39:04:     errorMessage: 'Startup grace period active (53s remaining)',
2025-09-20T19:39:04:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T19:39:04:   },
2025-09-20T19:39:04:   duration: 0,
2025-09-20T19:39:04:   timestamp: 1758377344667
2025-09-20T19:39:04: }
2025-09-20T19:39:27: ğŸ’¾ Data synced to files successfully
2025-09-20T19:39:57: âœ… Startup grace period ended - message sending now allowed
2025-09-20T19:39:57: âœ… Startup grace period ended - message sending now allowed
2025-09-20T19:39:57: â„¹ï¸ [7:39:57 pm] INFO: Grace Period: ENDED {
2025-09-20T19:39:57:   action: 'ENDED',
2025-09-20T19:39:57:   remainingMs: 0,
2025-09-20T19:39:57:   remainingSeconds: 0,
2025-09-20T19:39:57:   details: { totalDuration: 240000, processId: 4416 },
2025-09-20T19:39:57:   timestamp: 1758377397151
2025-09-20T19:39:57: }
2025-09-20T19:39:57: â„¹ï¸ [7:39:57 pm] INFO: Grace Period: ENDED {
2025-09-20T19:39:57:   action: 'ENDED',
2025-09-20T19:39:57:   remainingMs: 0,
2025-09-20T19:39:57:   remainingSeconds: 0,
2025-09-20T19:39:57:   details: { totalDuration: 240000, processId: 4416 },
2025-09-20T19:39:57:   timestamp: 1758377397152
2025-09-20T19:39:57: }
2025-09-20T19:39:57: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T19:39:57: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T19:39:57: ğŸ’¾ Data synced to files successfully
2025-09-20T19:40:27: ğŸ’¾ Data synced to files successfully
2025-09-20T19:40:57: ğŸ’¾ Data synced to files successfully
2025-09-20T19:41:27: ğŸ’¾ Data synced to files successfully
2025-09-20T19:41:57: ğŸ’¾ Data synced to files successfully
2025-09-20T19:42:04: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:42:04: ğŸ“ Loaded 11 template types
2025-09-20T19:42:04: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T19:42:04: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T19:42:04: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T19:42:04: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758377524490] Starting comprehensive safety check...
2025-09-20T19:42:04: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758377524490] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T19:42:04: â„¹ï¸ [7:42:04 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:42:04:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:42:04:   phone: '919****706',
2025-09-20T19:42:04:   orderId: 'TJJ19092511',
2025-09-20T19:42:04:   messageType: 'confirmation',
2025-09-20T19:42:04:   result: 'STARTED',
2025-09-20T19:42:04:   details: {
2025-09-20T19:42:04:     checkId: '919953020706_TJJ19092511_confirmation_1758377524490',
2025-09-20T19:42:04:     hasOrderData: true,
2025-09-20T19:42:04:     hasSheetData: false,
2025-09-20T19:42:04:     messageLength: 469
2025-09-20T19:42:04:   },
2025-09-20T19:42:04:   timestamp: 1758377524490
2025-09-20T19:42:04: }
2025-09-20T19:42:04: ğŸ” [919953020706_TJJ19092511_confirmation_1758377524490] Step 1: Kill Switch Check
2025-09-20T19:42:04: ğŸ” [919953020706_TJJ19092511_confirmation_1758377524490] Step 1.5: Developer Phone Check
2025-09-20T19:42:04: ğŸ” [919953020706_TJJ19092511_confirmation_1758377524490] Step 2: Grace Period Check
2025-09-20T19:42:04: ğŸ” [919953020706_TJJ19092511_confirmation_1758377524490] Step 3: Business Hours Check
2025-09-20T19:42:04: ğŸ” [919953020706_TJJ19092511_confirmation_1758377524490] Step 4: Message Type Rules Check
2025-09-20T19:42:04: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T19:42:04: â„¹ï¸ [7:42:04 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:42:04:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:42:04:   phone: '919****706',
2025-09-20T19:42:04:   orderId: 'TJJ19092511',
2025-09-20T19:42:04:   messageType: 'confirmation',
2025-09-20T19:42:04:   result: 'STARTED',
2025-09-20T19:42:04:   details: {
2025-09-20T19:42:04:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T19:42:04:     requiredFields: [
2025-09-20T19:42:04:       'customer_name',
2025-09-20T19:42:04:       'order_id',
2025-09-20T19:42:04:       'phone',
2025-09-20T19:42:04:       'garment_type',
2025-09-20T19:42:04:       'delivery_date'
2025-09-20T19:42:04:     ],
2025-09-20T19:42:04:     orderDataFields: [
2025-09-20T19:42:04:       'customer_name',
2025-09-20T19:42:04:       'order_id',
2025-09-20T19:42:04:       'phone',
2025-09-20T19:42:04:       'garment_type',
2025-09-20T19:42:04:       'total_amount',
2025-09-20T19:42:04:       'advance_amount',
2025-09-20T19:42:04:       'remaining_amount',
2025-09-20T19:42:04:       'ready_date',
2025-09-20T19:42:04:       'delivery_date',
2025-09-20T19:42:04:       'shop_name',
2025-09-20T19:42:04:       'shop_phone',
2025-09-20T19:42:04:       'business_hours'
2025-09-20T19:42:04:     ],
2025-09-20T19:42:04:     sheetDataFields: []
2025-09-20T19:42:04:   },
2025-09-20T19:42:04:   timestamp: 1758377524500
2025-09-20T19:42:04: }
2025-09-20T19:42:04: â„¹ï¸ [7:42:04 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:42:04:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:42:04:   phone: '919****706',
2025-09-20T19:42:04:   orderId: 'TJJ19092511',
2025-09-20T19:42:04:   messageType: 'confirmation',
2025-09-20T19:42:04:   result: 'CONDITIONS_FAILED',
2025-09-20T19:42:04:   details: {
2025-09-20T19:42:04:     conditionResult: {
2025-09-20T19:42:04:       allowed: false,
2025-09-20T19:42:04:       reason: 'WELCOME_NOT_SENT_FIRST',
2025-09-20T19:42:04:       message: 'Welcome message must be sent before confirmation for order TJJ19092511'
2025-09-20T19:42:04:     },
2025-09-20T19:42:04:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent'
2025-09-20T19:42:04:   },
2025-09-20T19:42:04:   timestamp: 1758377524513
2025-09-20T19:42:04: }
2025-09-20T19:42:04: â„¹ï¸ [7:42:04 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:42:04:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:42:04:   phone: '919****706',
2025-09-20T19:42:04:   orderId: 'TJJ19092511',
2025-09-20T19:42:04:   messageType: 'confirmation',
2025-09-20T19:42:04:   result: 'BLOCKED',
2025-09-20T19:42:04:   details: {
2025-09-20T19:42:04:     checkId: '919953020706_TJJ19092511_confirmation_1758377524490',
2025-09-20T19:42:04:     ruleViolation: 'WELCOME_NOT_SENT_FIRST',
2025-09-20T19:42:04:     details: 'Welcome message must be sent before confirmation for order TJJ19092511'
2025-09-20T19:42:04:   },
2025-09-20T19:42:04:   timestamp: 1758377524521
2025-09-20T19:42:04: }
2025-09-20T19:42:04: âŒ [919953020706_TJJ19092511_confirmation_1758377524490] Welcome message must be sent before confirmation for order TJJ19092511
2025-09-20T19:42:04: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Welcome message must be sent before confirmation for order TJJ19092511
2025-09-20T19:42:04: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T19:42:04: â„¹ï¸ [7:42:04 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T19:42:04:   phone: '919****706',
2025-09-20T19:42:04:   orderId: 'TJJ19092511',
2025-09-20T19:42:04:   messageType: 'confirmation',
2025-09-20T19:42:04:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:42:04:   reason: {
2025-09-20T19:42:04:     contentHash: '97026037ffec053e',
2025-09-20T19:42:04:     timestamp: 1758377524528,
2025-09-20T19:42:04:     messageLength: 469,
2025-09-20T19:42:04:     errorMessage: 'Welcome message must be sent before confirmation for order TJJ19092511',
2025-09-20T19:42:04:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T19:42:04:   },
2025-09-20T19:42:04:   duration: 0,
2025-09-20T19:42:04:   timestamp: 1758377524553
2025-09-20T19:42:04: }
2025-09-20T19:42:04: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:42:04: ğŸ“ Loaded 11 template types
2025-09-20T19:42:04: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T19:42:04: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T19:42:04: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T19:42:04: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758377524559] Starting comprehensive safety check...
2025-09-20T19:42:04: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758377524559] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T19:42:04: â„¹ï¸ [7:42:04 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:42:04:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:42:04:   phone: '919****488',
2025-09-20T19:42:04:   orderId: 'TWM19092511',
2025-09-20T19:42:04:   messageType: 'confirmation',
2025-09-20T19:42:04:   result: 'STARTED',
2025-09-20T19:42:04:   details: {
2025-09-20T19:42:04:     checkId: '919358537488_TWM19092511_confirmation_1758377524559',
2025-09-20T19:42:04:     hasOrderData: true,
2025-09-20T19:42:04:     hasSheetData: false,
2025-09-20T19:42:04:     messageLength: 475
2025-09-20T19:42:04:   },
2025-09-20T19:42:04:   timestamp: 1758377524559
2025-09-20T19:42:04: }
2025-09-20T19:42:04: ğŸ” [919358537488_TWM19092511_confirmation_1758377524559] Step 1: Kill Switch Check
2025-09-20T19:42:04: ğŸ” [919358537488_TWM19092511_confirmation_1758377524559] Step 1.5: Developer Phone Check
2025-09-20T19:42:04: ğŸ” [919358537488_TWM19092511_confirmation_1758377524559] Step 2: Grace Period Check
2025-09-20T19:42:04: ğŸ” [919358537488_TWM19092511_confirmation_1758377524559] Step 3: Business Hours Check
2025-09-20T19:42:04: ğŸ” [919358537488_TWM19092511_confirmation_1758377524559] Step 4: Message Type Rules Check
2025-09-20T19:42:04: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T19:42:04: â„¹ï¸ [7:42:04 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:42:04:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:42:04:   phone: '919****488',
2025-09-20T19:42:04:   orderId: 'TWM19092511',
2025-09-20T19:42:04:   messageType: 'confirmation',
2025-09-20T19:42:04:   result: 'STARTED',
2025-09-20T19:42:04:   details: {
2025-09-20T19:42:04:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T19:42:04:     requiredFields: [
2025-09-20T19:42:04:       'customer_name',
2025-09-20T19:42:04:       'order_id',
2025-09-20T19:42:04:       'phone',
2025-09-20T19:42:04:       'garment_type',
2025-09-20T19:42:04:       'delivery_date'
2025-09-20T19:42:04:     ],
2025-09-20T19:42:04:     orderDataFields: [
2025-09-20T19:42:04:       'customer_name',
2025-09-20T19:42:04:       'order_id',
2025-09-20T19:42:04:       'phone',
2025-09-20T19:42:04:       'garment_type',
2025-09-20T19:42:04:       'total_amount',
2025-09-20T19:42:04:       'advance_amount',
2025-09-20T19:42:04:       'remaining_amount',
2025-09-20T19:42:04:       'ready_date',
2025-09-20T19:42:04:       'delivery_date',
2025-09-20T19:42:04:       'shop_name',
2025-09-20T19:42:04:       'shop_phone',
2025-09-20T19:42:04:       'business_hours'
2025-09-20T19:42:04:     ],
2025-09-20T19:42:04:     sheetDataFields: []
2025-09-20T19:42:04:   },
2025-09-20T19:42:04:   timestamp: 1758377524563
2025-09-20T19:42:04: }
2025-09-20T19:42:04: â„¹ï¸ [7:42:04 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:42:04:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:42:04:   phone: '919****488',
2025-09-20T19:42:04:   orderId: 'TWM19092511',
2025-09-20T19:42:04:   messageType: 'confirmation',
2025-09-20T19:42:04:   result: 'CONDITIONS_FAILED',
2025-09-20T19:42:04:   details: {
2025-09-20T19:42:04:     conditionResult: {
2025-09-20T19:42:04:       allowed: false,
2025-09-20T19:42:04:       reason: 'WELCOME_NOT_SENT_FIRST',
2025-09-20T19:42:04:       message: 'Welcome message must be sent before confirmation for order TWM19092511'
2025-09-20T19:42:04:     },
2025-09-20T19:42:04:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent'
2025-09-20T19:42:04:   },
2025-09-20T19:42:04:   timestamp: 1758377524569
2025-09-20T19:42:04: }
2025-09-20T19:42:04: â„¹ï¸ [7:42:04 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:42:04:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:42:04:   phone: '919****488',
2025-09-20T19:42:04:   orderId: 'TWM19092511',
2025-09-20T19:42:04:   messageType: 'confirmation',
2025-09-20T19:42:04:   result: 'BLOCKED',
2025-09-20T19:42:04:   details: {
2025-09-20T19:42:04:     checkId: '919358537488_TWM19092511_confirmation_1758377524559',
2025-09-20T19:42:04:     ruleViolation: 'WELCOME_NOT_SENT_FIRST',
2025-09-20T19:42:04:     details: 'Welcome message must be sent before confirmation for order TWM19092511'
2025-09-20T19:42:04:   },
2025-09-20T19:42:04:   timestamp: 1758377524571
2025-09-20T19:42:04: }
2025-09-20T19:42:04: âŒ [919358537488_TWM19092511_confirmation_1758377524559] Welcome message must be sent before confirmation for order TWM19092511
2025-09-20T19:42:04: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Welcome message must be sent before confirmation for order TWM19092511
2025-09-20T19:42:04: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T19:42:04: â„¹ï¸ [7:42:04 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T19:42:04:   phone: '919****488',
2025-09-20T19:42:04:   orderId: 'TWM19092511',
2025-09-20T19:42:04:   messageType: 'confirmation',
2025-09-20T19:42:04:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:42:04:   reason: {
2025-09-20T19:42:04:     contentHash: 'e34d023f065922da',
2025-09-20T19:42:04:     timestamp: 1758377524574,
2025-09-20T19:42:04:     messageLength: 475,
2025-09-20T19:42:04:     errorMessage: 'Welcome message must be sent before confirmation for order TWM19092511',
2025-09-20T19:42:04:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T19:42:04:   },
2025-09-20T19:42:04:   duration: 0,
2025-09-20T19:42:04:   timestamp: 1758377524596
2025-09-20T19:42:04: }
2025-09-20T19:42:04: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:42:04: ğŸ“ Loaded 11 template types
2025-09-20T19:42:04: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T19:42:04: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T19:42:04: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T19:42:04: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758377524602] Starting comprehensive safety check...
2025-09-20T19:42:04: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758377524602] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T19:42:04: â„¹ï¸ [7:42:04 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:42:04:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:42:04:   phone: '918****811',
2025-09-20T19:42:04:   orderId: 'TOF19092511',
2025-09-20T19:42:04:   messageType: 'confirmation',
2025-09-20T19:42:04:   result: 'STARTED',
2025-09-20T19:42:04:   details: {
2025-09-20T19:42:04:     checkId: '918890134811_TOF19092511_confirmation_1758377524602',
2025-09-20T19:42:04:     hasOrderData: true,
2025-09-20T19:42:04:     hasSheetData: false,
2025-09-20T19:42:04:     messageLength: 473
2025-09-20T19:42:04:   },
2025-09-20T19:42:04:   timestamp: 1758377524602
2025-09-20T19:42:04: }
2025-09-20T19:42:04: ğŸ” [918890134811_TOF19092511_confirmation_1758377524602] Step 1: Kill Switch Check
2025-09-20T19:42:04: ğŸ” [918890134811_TOF19092511_confirmation_1758377524602] Step 1.5: Developer Phone Check
2025-09-20T19:42:04: ğŸ” [918890134811_TOF19092511_confirmation_1758377524602] Step 2: Grace Period Check
2025-09-20T19:42:04: ğŸ” [918890134811_TOF19092511_confirmation_1758377524602] Step 3: Business Hours Check
2025-09-20T19:42:04: ğŸ” [918890134811_TOF19092511_confirmation_1758377524602] Step 4: Message Type Rules Check
2025-09-20T19:42:04: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T19:42:04: â„¹ï¸ [7:42:04 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:42:04:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:42:04:   phone: '918****811',
2025-09-20T19:42:04:   orderId: 'TOF19092511',
2025-09-20T19:42:04:   messageType: 'confirmation',
2025-09-20T19:42:04:   result: 'STARTED',
2025-09-20T19:42:04:   details: {
2025-09-20T19:42:04:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T19:42:04:     requiredFields: [
2025-09-20T19:42:04:       'customer_name',
2025-09-20T19:42:04:       'order_id',
2025-09-20T19:42:04:       'phone',
2025-09-20T19:42:04:       'garment_type',
2025-09-20T19:42:04:       'delivery_date'
2025-09-20T19:42:04:     ],
2025-09-20T19:42:04:     orderDataFields: [
2025-09-20T19:42:04:       'customer_name',
2025-09-20T19:42:04:       'order_id',
2025-09-20T19:42:04:       'phone',
2025-09-20T19:42:04:       'garment_type',
2025-09-20T19:42:04:       'total_amount',
2025-09-20T19:42:04:       'advance_amount',
2025-09-20T19:42:04:       'remaining_amount',
2025-09-20T19:42:04:       'ready_date',
2025-09-20T19:42:04:       'delivery_date',
2025-09-20T19:42:04:       'shop_name',
2025-09-20T19:42:04:       'shop_phone',
2025-09-20T19:42:04:       'business_hours'
2025-09-20T19:42:04:     ],
2025-09-20T19:42:04:     sheetDataFields: []
2025-09-20T19:42:04:   },
2025-09-20T19:42:04:   timestamp: 1758377524606
2025-09-20T19:42:04: }
2025-09-20T19:42:04: â„¹ï¸ [7:42:04 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:42:04:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:42:04:   phone: '918****811',
2025-09-20T19:42:04:   orderId: 'TOF19092511',
2025-09-20T19:42:04:   messageType: 'confirmation',
2025-09-20T19:42:04:   result: 'CONDITIONS_FAILED',
2025-09-20T19:42:04:   details: {
2025-09-20T19:42:04:     conditionResult: {
2025-09-20T19:42:04:       allowed: false,
2025-09-20T19:42:04:       reason: 'WELCOME_NOT_SENT_FIRST',
2025-09-20T19:42:04:       message: 'Welcome message must be sent before confirmation for order TOF19092511'
2025-09-20T19:42:04:     },
2025-09-20T19:42:04:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent'
2025-09-20T19:42:04:   },
2025-09-20T19:42:04:   timestamp: 1758377524611
2025-09-20T19:42:04: }
2025-09-20T19:42:04: â„¹ï¸ [7:42:04 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:42:04:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:42:04:   phone: '918****811',
2025-09-20T19:42:04:   orderId: 'TOF19092511',
2025-09-20T19:42:04:   messageType: 'confirmation',
2025-09-20T19:42:04:   result: 'BLOCKED',
2025-09-20T19:42:04:   details: {
2025-09-20T19:42:04:     checkId: '918890134811_TOF19092511_confirmation_1758377524602',
2025-09-20T19:42:04:     ruleViolation: 'WELCOME_NOT_SENT_FIRST',
2025-09-20T19:42:04:     details: 'Welcome message must be sent before confirmation for order TOF19092511'
2025-09-20T19:42:04:   },
2025-09-20T19:42:04:   timestamp: 1758377524615
2025-09-20T19:42:04: }
2025-09-20T19:42:04: âŒ [918890134811_TOF19092511_confirmation_1758377524602] Welcome message must be sent before confirmation for order TOF19092511
2025-09-20T19:42:04: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Welcome message must be sent before confirmation for order TOF19092511
2025-09-20T19:42:04: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T19:42:04: â„¹ï¸ [7:42:04 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T19:42:04:   phone: '918****811',
2025-09-20T19:42:04:   orderId: 'TOF19092511',
2025-09-20T19:42:04:   messageType: 'confirmation',
2025-09-20T19:42:04:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:42:04:   reason: {
2025-09-20T19:42:04:     contentHash: '388fbe812e19f1de',
2025-09-20T19:42:04:     timestamp: 1758377524617,
2025-09-20T19:42:04:     messageLength: 473,
2025-09-20T19:42:04:     errorMessage: 'Welcome message must be sent before confirmation for order TOF19092511',
2025-09-20T19:42:04:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T19:42:04:   },
2025-09-20T19:42:04:   duration: 0,
2025-09-20T19:42:04:   timestamp: 1758377524627
2025-09-20T19:42:04: }
2025-09-20T19:42:27: ğŸ’¾ Data synced to files successfully
2025-09-20T19:42:57: ğŸ’¾ Data synced to files successfully
2025-09-20T19:43:27: ğŸ’¾ Data synced to files successfully
2025-09-20T19:43:57: ğŸ’¾ Data synced to files successfully
2025-09-20T19:44:27: ğŸ’¾ Data synced to files successfully
2025-09-20T19:44:57: ğŸ’¾ Data synced to files successfully
2025-09-20T19:45:04: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:45:04: ğŸ“ Loaded 11 template types
2025-09-20T19:45:04: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T19:45:04: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: confirmation
2025-09-20T19:45:04: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T19:45:04: ğŸ›¡ï¸ [919953020706_TJJ19092511_confirmation_1758377704612] Starting comprehensive safety check...
2025-09-20T19:45:04: ğŸ“‹ [919953020706_TJJ19092511_confirmation_1758377704612] Phone: 919953020706, Order: TJJ19092511, Type: confirmation
2025-09-20T19:45:04: â„¹ï¸ [7:45:04 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:45:04:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:45:04:   phone: '919****706',
2025-09-20T19:45:04:   orderId: 'TJJ19092511',
2025-09-20T19:45:04:   messageType: 'confirmation',
2025-09-20T19:45:04:   result: 'STARTED',
2025-09-20T19:45:04:   details: {
2025-09-20T19:45:04:     checkId: '919953020706_TJJ19092511_confirmation_1758377704612',
2025-09-20T19:45:04:     hasOrderData: true,
2025-09-20T19:45:04:     hasSheetData: false,
2025-09-20T19:45:04:     messageLength: 469
2025-09-20T19:45:04:   },
2025-09-20T19:45:04:   timestamp: 1758377704612
2025-09-20T19:45:04: }
2025-09-20T19:45:04: ğŸ” [919953020706_TJJ19092511_confirmation_1758377704612] Step 1: Kill Switch Check
2025-09-20T19:45:04: ğŸ” [919953020706_TJJ19092511_confirmation_1758377704612] Step 1.5: Developer Phone Check
2025-09-20T19:45:04: ğŸ” [919953020706_TJJ19092511_confirmation_1758377704612] Step 2: Grace Period Check
2025-09-20T19:45:04: ğŸ” [919953020706_TJJ19092511_confirmation_1758377704612] Step 3: Business Hours Check
2025-09-20T19:45:04: ğŸ” [919953020706_TJJ19092511_confirmation_1758377704612] Step 4: Message Type Rules Check
2025-09-20T19:45:04: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T19:45:04: â„¹ï¸ [7:45:04 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:45:04:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:45:04:   phone: '919****706',
2025-09-20T19:45:04:   orderId: 'TJJ19092511',
2025-09-20T19:45:04:   messageType: 'confirmation',
2025-09-20T19:45:04:   result: 'STARTED',
2025-09-20T19:45:04:   details: {
2025-09-20T19:45:04:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T19:45:04:     requiredFields: [
2025-09-20T19:45:04:       'customer_name',
2025-09-20T19:45:04:       'order_id',
2025-09-20T19:45:04:       'phone',
2025-09-20T19:45:04:       'garment_type',
2025-09-20T19:45:04:       'delivery_date'
2025-09-20T19:45:04:     ],
2025-09-20T19:45:04:     orderDataFields: [
2025-09-20T19:45:04:       'customer_name',
2025-09-20T19:45:04:       'order_id',
2025-09-20T19:45:04:       'phone',
2025-09-20T19:45:04:       'garment_type',
2025-09-20T19:45:04:       'total_amount',
2025-09-20T19:45:04:       'advance_amount',
2025-09-20T19:45:04:       'remaining_amount',
2025-09-20T19:45:04:       'ready_date',
2025-09-20T19:45:04:       'delivery_date',
2025-09-20T19:45:04:       'shop_name',
2025-09-20T19:45:04:       'shop_phone',
2025-09-20T19:45:04:       'business_hours'
2025-09-20T19:45:04:     ],
2025-09-20T19:45:04:     sheetDataFields: []
2025-09-20T19:45:04:   },
2025-09-20T19:45:04:   timestamp: 1758377704618
2025-09-20T19:45:04: }
2025-09-20T19:45:04: â„¹ï¸ [7:45:04 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:45:04:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:45:04:   phone: '919****706',
2025-09-20T19:45:04:   orderId: 'TJJ19092511',
2025-09-20T19:45:04:   messageType: 'confirmation',
2025-09-20T19:45:04:   result: 'CONDITIONS_FAILED',
2025-09-20T19:45:04:   details: {
2025-09-20T19:45:04:     conditionResult: {
2025-09-20T19:45:04:       allowed: false,
2025-09-20T19:45:04:       reason: 'WELCOME_NOT_SENT_FIRST',
2025-09-20T19:45:04:       message: 'Welcome message must be sent before confirmation for order TJJ19092511'
2025-09-20T19:45:04:     },
2025-09-20T19:45:04:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent'
2025-09-20T19:45:04:   },
2025-09-20T19:45:04:   timestamp: 1758377704627
2025-09-20T19:45:04: }
2025-09-20T19:45:04: â„¹ï¸ [7:45:04 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:45:04:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:45:04:   phone: '919****706',
2025-09-20T19:45:04:   orderId: 'TJJ19092511',
2025-09-20T19:45:04:   messageType: 'confirmation',
2025-09-20T19:45:04:   result: 'BLOCKED',
2025-09-20T19:45:04:   details: {
2025-09-20T19:45:04:     checkId: '919953020706_TJJ19092511_confirmation_1758377704612',
2025-09-20T19:45:04:     ruleViolation: 'WELCOME_NOT_SENT_FIRST',
2025-09-20T19:45:04:     details: 'Welcome message must be sent before confirmation for order TJJ19092511'
2025-09-20T19:45:04:   },
2025-09-20T19:45:04:   timestamp: 1758377704636
2025-09-20T19:45:04: }
2025-09-20T19:45:04: âŒ [919953020706_TJJ19092511_confirmation_1758377704612] Welcome message must be sent before confirmation for order TJJ19092511
2025-09-20T19:45:04: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Welcome message must be sent before confirmation for order TJJ19092511
2025-09-20T19:45:04: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | confirmation | Success: false
2025-09-20T19:45:04: â„¹ï¸ [7:45:04 pm] INFO: Message ALLOWED: confirmation for TJJ19092511 {
2025-09-20T19:45:04:   phone: '919****706',
2025-09-20T19:45:04:   orderId: 'TJJ19092511',
2025-09-20T19:45:04:   messageType: 'confirmation',
2025-09-20T19:45:04:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:45:04:   reason: {
2025-09-20T19:45:04:     contentHash: '97026037ffec053e',
2025-09-20T19:45:04:     timestamp: 1758377704640,
2025-09-20T19:45:04:     messageLength: 469,
2025-09-20T19:45:04:     errorMessage: 'Welcome message must be sent before confirmation for order TJJ19092511',
2025-09-20T19:45:04:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_confirmation.json'
2025-09-20T19:45:04:   },
2025-09-20T19:45:04:   duration: 0,
2025-09-20T19:45:04:   timestamp: 1758377704657
2025-09-20T19:45:04: }
2025-09-20T19:45:04: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:45:04: ğŸ“ Loaded 11 template types
2025-09-20T19:45:04: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T19:45:04: ğŸ“‹ [919358537488] Order: TWM19092511, Type: confirmation
2025-09-20T19:45:04: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T19:45:04: ğŸ›¡ï¸ [919358537488_TWM19092511_confirmation_1758377704661] Starting comprehensive safety check...
2025-09-20T19:45:04: ğŸ“‹ [919358537488_TWM19092511_confirmation_1758377704661] Phone: 919358537488, Order: TWM19092511, Type: confirmation
2025-09-20T19:45:04: â„¹ï¸ [7:45:04 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:45:04:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:45:04:   phone: '919****488',
2025-09-20T19:45:04:   orderId: 'TWM19092511',
2025-09-20T19:45:04:   messageType: 'confirmation',
2025-09-20T19:45:04:   result: 'STARTED',
2025-09-20T19:45:04:   details: {
2025-09-20T19:45:04:     checkId: '919358537488_TWM19092511_confirmation_1758377704661',
2025-09-20T19:45:04:     hasOrderData: true,
2025-09-20T19:45:04:     hasSheetData: false,
2025-09-20T19:45:04:     messageLength: 475
2025-09-20T19:45:04:   },
2025-09-20T19:45:04:   timestamp: 1758377704661
2025-09-20T19:45:04: }
2025-09-20T19:45:04: ğŸ” [919358537488_TWM19092511_confirmation_1758377704661] Step 1: Kill Switch Check
2025-09-20T19:45:04: ğŸ” [919358537488_TWM19092511_confirmation_1758377704661] Step 1.5: Developer Phone Check
2025-09-20T19:45:04: ğŸ” [919358537488_TWM19092511_confirmation_1758377704661] Step 2: Grace Period Check
2025-09-20T19:45:04: ğŸ” [919358537488_TWM19092511_confirmation_1758377704661] Step 3: Business Hours Check
2025-09-20T19:45:04: ğŸ” [919358537488_TWM19092511_confirmation_1758377704661] Step 4: Message Type Rules Check
2025-09-20T19:45:04: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T19:45:04: â„¹ï¸ [7:45:04 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:45:04:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:45:04:   phone: '919****488',
2025-09-20T19:45:04:   orderId: 'TWM19092511',
2025-09-20T19:45:04:   messageType: 'confirmation',
2025-09-20T19:45:04:   result: 'STARTED',
2025-09-20T19:45:04:   details: {
2025-09-20T19:45:04:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T19:45:04:     requiredFields: [
2025-09-20T19:45:04:       'customer_name',
2025-09-20T19:45:04:       'order_id',
2025-09-20T19:45:04:       'phone',
2025-09-20T19:45:04:       'garment_type',
2025-09-20T19:45:04:       'delivery_date'
2025-09-20T19:45:04:     ],
2025-09-20T19:45:04:     orderDataFields: [
2025-09-20T19:45:04:       'customer_name',
2025-09-20T19:45:04:       'order_id',
2025-09-20T19:45:04:       'phone',
2025-09-20T19:45:04:       'garment_type',
2025-09-20T19:45:04:       'total_amount',
2025-09-20T19:45:04:       'advance_amount',
2025-09-20T19:45:04:       'remaining_amount',
2025-09-20T19:45:04:       'ready_date',
2025-09-20T19:45:04:       'delivery_date',
2025-09-20T19:45:04:       'shop_name',
2025-09-20T19:45:04:       'shop_phone',
2025-09-20T19:45:04:       'business_hours'
2025-09-20T19:45:04:     ],
2025-09-20T19:45:04:     sheetDataFields: []
2025-09-20T19:45:04:   },
2025-09-20T19:45:04:   timestamp: 1758377704664
2025-09-20T19:45:04: }
2025-09-20T19:45:04: â„¹ï¸ [7:45:04 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:45:04:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:45:04:   phone: '919****488',
2025-09-20T19:45:04:   orderId: 'TWM19092511',
2025-09-20T19:45:04:   messageType: 'confirmation',
2025-09-20T19:45:04:   result: 'CONDITIONS_FAILED',
2025-09-20T19:45:04:   details: {
2025-09-20T19:45:04:     conditionResult: {
2025-09-20T19:45:04:       allowed: false,
2025-09-20T19:45:04:       reason: 'WELCOME_NOT_SENT_FIRST',
2025-09-20T19:45:04:       message: 'Welcome message must be sent before confirmation for order TWM19092511'
2025-09-20T19:45:04:     },
2025-09-20T19:45:04:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent'
2025-09-20T19:45:04:   },
2025-09-20T19:45:04:   timestamp: 1758377704672
2025-09-20T19:45:04: }
2025-09-20T19:45:04: â„¹ï¸ [7:45:04 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:45:04:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:45:04:   phone: '919****488',
2025-09-20T19:45:04:   orderId: 'TWM19092511',
2025-09-20T19:45:04:   messageType: 'confirmation',
2025-09-20T19:45:04:   result: 'BLOCKED',
2025-09-20T19:45:04:   details: {
2025-09-20T19:45:04:     checkId: '919358537488_TWM19092511_confirmation_1758377704661',
2025-09-20T19:45:04:     ruleViolation: 'WELCOME_NOT_SENT_FIRST',
2025-09-20T19:45:04:     details: 'Welcome message must be sent before confirmation for order TWM19092511'
2025-09-20T19:45:04:   },
2025-09-20T19:45:04:   timestamp: 1758377704674
2025-09-20T19:45:04: }
2025-09-20T19:45:04: âŒ [919358537488_TWM19092511_confirmation_1758377704661] Welcome message must be sent before confirmation for order TWM19092511
2025-09-20T19:45:04: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Welcome message must be sent before confirmation for order TWM19092511
2025-09-20T19:45:04: ğŸ“ Message recorded: 919358537488 | TWM19092511 | confirmation | Success: false
2025-09-20T19:45:04: â„¹ï¸ [7:45:04 pm] INFO: Message ALLOWED: confirmation for TWM19092511 {
2025-09-20T19:45:04:   phone: '919****488',
2025-09-20T19:45:04:   orderId: 'TWM19092511',
2025-09-20T19:45:04:   messageType: 'confirmation',
2025-09-20T19:45:04:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:45:04:   reason: {
2025-09-20T19:45:04:     contentHash: 'e34d023f065922da',
2025-09-20T19:45:04:     timestamp: 1758377704676,
2025-09-20T19:45:04:     messageLength: 475,
2025-09-20T19:45:04:     errorMessage: 'Welcome message must be sent before confirmation for order TWM19092511',
2025-09-20T19:45:04:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_confirmation.json'
2025-09-20T19:45:04:   },
2025-09-20T19:45:04:   duration: 0,
2025-09-20T19:45:04:   timestamp: 1758377704688
2025-09-20T19:45:04: }
2025-09-20T19:45:04: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:45:04: ğŸ“ Loaded 11 template types
2025-09-20T19:45:04: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T19:45:04: ğŸ“‹ [918890134811] Order: TOF19092511, Type: confirmation
2025-09-20T19:45:04: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T19:45:04: ğŸ›¡ï¸ [918890134811_TOF19092511_confirmation_1758377704690] Starting comprehensive safety check...
2025-09-20T19:45:04: ğŸ“‹ [918890134811_TOF19092511_confirmation_1758377704690] Phone: 918890134811, Order: TOF19092511, Type: confirmation
2025-09-20T19:45:04: â„¹ï¸ [7:45:04 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:45:04:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:45:04:   phone: '918****811',
2025-09-20T19:45:04:   orderId: 'TOF19092511',
2025-09-20T19:45:04:   messageType: 'confirmation',
2025-09-20T19:45:04:   result: 'STARTED',
2025-09-20T19:45:04:   details: {
2025-09-20T19:45:04:     checkId: '918890134811_TOF19092511_confirmation_1758377704690',
2025-09-20T19:45:04:     hasOrderData: true,
2025-09-20T19:45:04:     hasSheetData: false,
2025-09-20T19:45:04:     messageLength: 473
2025-09-20T19:45:04:   },
2025-09-20T19:45:04:   timestamp: 1758377704690
2025-09-20T19:45:04: }
2025-09-20T19:45:04: ğŸ” [918890134811_TOF19092511_confirmation_1758377704690] Step 1: Kill Switch Check
2025-09-20T19:45:04: ğŸ” [918890134811_TOF19092511_confirmation_1758377704690] Step 1.5: Developer Phone Check
2025-09-20T19:45:04: ğŸ” [918890134811_TOF19092511_confirmation_1758377704690] Step 2: Grace Period Check
2025-09-20T19:45:04: ğŸ” [918890134811_TOF19092511_confirmation_1758377704690] Step 3: Business Hours Check
2025-09-20T19:45:04: ğŸ” [918890134811_TOF19092511_confirmation_1758377704690] Step 4: Message Type Rules Check
2025-09-20T19:45:04: ğŸ“‹ Checking rules for confirmation: phone + orderId unique AND Confirmation Notified = No AND Welcome already sent
2025-09-20T19:45:04: â„¹ï¸ [7:45:04 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:45:04:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:45:04:   phone: '918****811',
2025-09-20T19:45:04:   orderId: 'TOF19092511',
2025-09-20T19:45:04:   messageType: 'confirmation',
2025-09-20T19:45:04:   result: 'STARTED',
2025-09-20T19:45:04:   details: {
2025-09-20T19:45:04:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent',
2025-09-20T19:45:04:     requiredFields: [
2025-09-20T19:45:04:       'customer_name',
2025-09-20T19:45:04:       'order_id',
2025-09-20T19:45:04:       'phone',
2025-09-20T19:45:04:       'garment_type',
2025-09-20T19:45:04:       'delivery_date'
2025-09-20T19:45:04:     ],
2025-09-20T19:45:04:     orderDataFields: [
2025-09-20T19:45:04:       'customer_name',
2025-09-20T19:45:04:       'order_id',
2025-09-20T19:45:04:       'phone',
2025-09-20T19:45:04:       'garment_type',
2025-09-20T19:45:04:       'total_amount',
2025-09-20T19:45:04:       'advance_amount',
2025-09-20T19:45:04:       'remaining_amount',
2025-09-20T19:45:04:       'ready_date',
2025-09-20T19:45:04:       'delivery_date',
2025-09-20T19:45:04:       'shop_name',
2025-09-20T19:45:04:       'shop_phone',
2025-09-20T19:45:04:       'business_hours'
2025-09-20T19:45:04:     ],
2025-09-20T19:45:04:     sheetDataFields: []
2025-09-20T19:45:04:   },
2025-09-20T19:45:04:   timestamp: 1758377704694
2025-09-20T19:45:04: }
2025-09-20T19:45:04: â„¹ï¸ [7:45:04 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:45:04:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:45:04:   phone: '918****811',
2025-09-20T19:45:04:   orderId: 'TOF19092511',
2025-09-20T19:45:04:   messageType: 'confirmation',
2025-09-20T19:45:04:   result: 'CONDITIONS_FAILED',
2025-09-20T19:45:04:   details: {
2025-09-20T19:45:04:     conditionResult: {
2025-09-20T19:45:04:       allowed: false,
2025-09-20T19:45:04:       reason: 'WELCOME_NOT_SENT_FIRST',
2025-09-20T19:45:04:       message: 'Welcome message must be sent before confirmation for order TOF19092511'
2025-09-20T19:45:04:     },
2025-09-20T19:45:04:     ruleCondition: 'phone + orderId unique AND Confirmation Notified = No AND Welcome already sent'
2025-09-20T19:45:04:   },
2025-09-20T19:45:04:   timestamp: 1758377704697
2025-09-20T19:45:04: }
2025-09-20T19:45:04: â„¹ï¸ [7:45:04 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:45:04:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:45:04:   phone: '918****811',
2025-09-20T19:45:04:   orderId: 'TOF19092511',
2025-09-20T19:45:04:   messageType: 'confirmation',
2025-09-20T19:45:04:   result: 'BLOCKED',
2025-09-20T19:45:04:   details: {
2025-09-20T19:45:04:     checkId: '918890134811_TOF19092511_confirmation_1758377704690',
2025-09-20T19:45:04:     ruleViolation: 'WELCOME_NOT_SENT_FIRST',
2025-09-20T19:45:04:     details: 'Welcome message must be sent before confirmation for order TOF19092511'
2025-09-20T19:45:04:   },
2025-09-20T19:45:04:   timestamp: 1758377704698
2025-09-20T19:45:04: }
2025-09-20T19:45:04: âŒ [918890134811_TOF19092511_confirmation_1758377704690] Welcome message must be sent before confirmation for order TOF19092511
2025-09-20T19:45:04: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Welcome message must be sent before confirmation for order TOF19092511
2025-09-20T19:45:04: ğŸ“ Message recorded: 918890134811 | TOF19092511 | confirmation | Success: false
2025-09-20T19:45:04: â„¹ï¸ [7:45:04 pm] INFO: Message ALLOWED: confirmation for TOF19092511 {
2025-09-20T19:45:04:   phone: '918****811',
2025-09-20T19:45:04:   orderId: 'TOF19092511',
2025-09-20T19:45:04:   messageType: 'confirmation',
2025-09-20T19:45:04:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:45:04:   reason: {
2025-09-20T19:45:04:     contentHash: '388fbe812e19f1de',
2025-09-20T19:45:04:     timestamp: 1758377704702,
2025-09-20T19:45:04:     messageLength: 473,
2025-09-20T19:45:04:     errorMessage: 'Welcome message must be sent before confirmation for order TOF19092511',
2025-09-20T19:45:04:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_confirmation.json'
2025-09-20T19:45:04:   },
2025-09-20T19:45:04:   duration: 0,
2025-09-20T19:45:04:   timestamp: 1758377704712
2025-09-20T19:45:04: }
2025-09-20T19:45:18: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:45:18: ğŸ“ Loaded 11 template types
2025-09-20T19:45:18: ğŸ”§ WhatsApp Bot initialized
2025-09-20T19:45:18: ğŸ“Š Configuration status: undefined
2025-09-20T19:45:18: âœ… Atomic State Manager initialized
2025-09-20T19:45:18: ğŸ“ Enhanced Logger initialized
2025-09-20T19:45:18: âœ… Google credentials loaded from service-account.json file
2025-09-20T19:45:18: ğŸ“± WhatsApp auth status: âœ… credentials, 4 session files
2025-09-20T19:45:18: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-20T19:45:18:    Auth Mode: both
2025-09-20T19:45:18:    QR Enabled: true
2025-09-20T19:45:18:    Phone Enabled: true
2025-09-20T19:45:18:    Session Persistence: true
2025-09-20T19:45:18:    Max Reconnect Attempts: 10
2025-09-20T19:45:18:    Default Phone: None
2025-09-20T19:45:18: ğŸ”’ Session validation enabled (check every 300s)
2025-09-20T19:45:18: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-20T19:45:18: ğŸ”§ Developer Configuration initialized
2025-09-20T19:45:18: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T19:45:18: â„¹ï¸ [7:45:18 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T19:45:18:   startupTime: 1758377718259,
2025-09-20T19:45:18:   gracePeriodMs: 240000,
2025-09-20T19:45:18:   dataDir: './safety-data',
2025-09-20T19:45:18:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T19:45:18:   processId: 21028,
2025-09-20T19:45:18:   nodeVersion: 'v22.19.0'
2025-09-20T19:45:18: }
2025-09-20T19:45:18: ğŸ”§ Developer Configuration initialized
2025-09-20T19:45:18: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-20T19:45:18: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-20T19:45:18: â° 4-minute startup delay active
2025-09-20T19:45:18: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-20T19:45:18: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-20T19:45:18: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T19:45:18: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T19:45:18: âœ… Google Sheets API initialized
2025-09-20T19:45:18: âœ… Google Sheets API initialized
2025-09-20T19:45:18: â„¹ï¸ [7:45:18 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T19:45:18:   startupTime: 1758377718259,
2025-09-20T19:45:18:   gracePeriodMs: 240000,
2025-09-20T19:45:18:   dataDir: './safety-data',
2025-09-20T19:45:18:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T19:45:18:   processId: 21028,
2025-09-20T19:45:18:   nodeVersion: 'v22.19.0'
2025-09-20T19:45:18: }
2025-09-20T19:45:18: ğŸ“ Loaded 0 sent messages from file
2025-09-20T19:45:18: â„¹ï¸ [7:45:18 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T19:45:18: â„¹ï¸ [7:45:18 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T19:45:18: ğŸ“ Loaded 0 customer histories from file
2025-09-20T19:45:18: ğŸ“ Loaded 0 message hashes from file
2025-09-20T19:45:18: ğŸ“ Loaded statistics from file
2025-09-20T19:45:18: âœ… Duplicate Prevention Manager initialized
2025-09-20T19:45:18: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T19:45:18: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T11-53-07-695Z.log
2025-09-20T19:45:18: ğŸ“ Enhanced Logger initialized
2025-09-20T19:45:18: â„¹ï¸ [7:45:18 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T19:45:18: â„¹ï¸ [7:45:18 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T19:45:18: ğŸ§¹ Removed stale process lock
2025-09-20T19:45:18: ğŸ§¹ Removed stale process lock
2025-09-20T19:45:18: ğŸ”’ Process lock acquired (PID: 21028)
2025-09-20T19:45:18: ğŸ”’ Process lock acquired (PID: 21028)
2025-09-20T19:45:18: â„¹ï¸ [7:45:18 pm] INFO: Process isolation enforced {
2025-09-20T19:45:18:   lockFile: 'safety-data\\process.lock',
2025-09-20T19:45:18:   pidFile: 'safety-data\\process.pid',
2025-09-20T19:45:18:   processId: 21028
2025-09-20T19:45:18: }
2025-09-20T19:45:18: â° Starting 240 second startup grace period...
2025-09-20T19:45:18: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T19:45:18: â„¹ï¸ [7:45:18 pm] INFO: Process isolation enforced {
2025-09-20T19:45:18:   lockFile: 'safety-data\\process.lock',
2025-09-20T19:45:18:   pidFile: 'safety-data\\process.pid',
2025-09-20T19:45:18:   processId: 21028
2025-09-20T19:45:18: }
2025-09-20T19:45:18: â° Starting 240 second startup grace period...
2025-09-20T19:45:18: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T19:45:18: â„¹ï¸ [7:45:18 pm] INFO: Grace Period: STARTED {
2025-09-20T19:45:18:   action: 'STARTED',
2025-09-20T19:45:18:   remainingMs: 240000,
2025-09-20T19:45:18:   remainingSeconds: 240,
2025-09-20T19:45:18:   details: { startupTime: 1758377718259, processId: 21028 },
2025-09-20T19:45:18:   timestamp: 1758377718424
2025-09-20T19:45:18: }
2025-09-20T19:45:18: â„¹ï¸ [7:45:18 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T19:45:18:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T19:45:18:   remainingMs: 240000,
2025-09-20T19:45:18:   remainingSeconds: 240,
2025-09-20T19:45:18:   details: { startupTime: 1758377718259, willExpireAt: 1758377958259 },
2025-09-20T19:45:18:   timestamp: 1758377718425
2025-09-20T19:45:18: }
2025-09-20T19:45:18: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T19:45:18: â° Startup grace period: 240 seconds
2025-09-20T19:45:18: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T19:45:18: â„¹ï¸ [7:45:18 pm] INFO: Grace Period: STARTED {
2025-09-20T19:45:18:   action: 'STARTED',
2025-09-20T19:45:18:   remainingMs: 240000,
2025-09-20T19:45:18:   remainingSeconds: 240,
2025-09-20T19:45:18:   details: { startupTime: 1758377718259, processId: 21028 },
2025-09-20T19:45:18:   timestamp: 1758377718427
2025-09-20T19:45:18: }
2025-09-20T19:45:18: â„¹ï¸ [7:45:18 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T19:45:18:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T19:45:18:   remainingMs: 240000,
2025-09-20T19:45:18:   remainingSeconds: 240,
2025-09-20T19:45:18:   details: { startupTime: 1758377718259, willExpireAt: 1758377958259 },
2025-09-20T19:45:18:   timestamp: 1758377718428
2025-09-20T19:45:18: }
2025-09-20T19:45:18: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T19:45:18: â° Startup grace period: 240 seconds
2025-09-20T19:45:18: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T19:45:18: â„¹ï¸ [7:45:18 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T19:45:18:   initializationDuration: 172,
2025-09-20T19:45:18:   gracePeriodActive: true,
2025-09-20T19:45:18:   messageRulesCount: 8,
2025-09-20T19:45:18:   messageTypes: [
2025-09-20T19:45:18:     'welcome',
2025-09-20T19:45:18:     'confirmation',
2025-09-20T19:45:18:     'ready',
2025-09-20T19:45:18:     'delivery',
2025-09-20T19:45:18:     'pickup_reminder',
2025-09-20T19:45:18:     'payment_reminder',
2025-09-20T19:45:18:     'fabric_welcome',
2025-09-20T19:45:18:     'fabric_purchase'
2025-09-20T19:45:18:   ],
2025-09-20T19:45:18:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T19:45:18:   databaseReady: true,
2025-09-20T19:45:18:   loggerReady: true,
2025-09-20T19:45:18:   processIsolationActive: true
2025-09-20T19:45:18: }
2025-09-20T19:45:18: âœ… Safety Manager initialized
2025-09-20T19:45:18: â„¹ï¸ [7:45:18 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T19:45:18:   initializationDuration: 178,
2025-09-20T19:45:18:   gracePeriodActive: true,
2025-09-20T19:45:18:   messageRulesCount: 8,
2025-09-20T19:45:18:   messageTypes: [
2025-09-20T19:45:18:     'welcome',
2025-09-20T19:45:18:     'confirmation',
2025-09-20T19:45:18:     'ready',
2025-09-20T19:45:18:     'delivery',
2025-09-20T19:45:18:     'pickup_reminder',
2025-09-20T19:45:18:     'payment_reminder',
2025-09-20T19:45:18:     'fabric_welcome',
2025-09-20T19:45:18:     'fabric_purchase'
2025-09-20T19:45:18:   ],
2025-09-20T19:45:18:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T19:45:18:   databaseReady: true,
2025-09-20T19:45:18:   loggerReady: true,
2025-09-20T19:45:18:   processIsolationActive: true
2025-09-20T19:45:18: }
2025-09-20T19:45:18: ğŸ“ Loaded 0 sent messages from file
2025-09-20T19:45:18: ğŸ“ Loaded 0 customer histories from file
2025-09-20T19:45:18: ğŸ“ Loaded 0 message hashes from file
2025-09-20T19:45:18: ğŸ“ Loaded statistics from file
2025-09-20T19:45:18: âœ… Duplicate Prevention Manager initialized
2025-09-20T19:45:18: ğŸ“Š Loaded: 0 sent messages, 0 customer histories, 0 content hashes
2025-09-20T19:45:18: âœ… Duplicate Prevention Manager initialized
2025-09-20T19:45:18: ğŸ”„ Starting WhatsApp connection...
2025-09-20T19:45:18: ğŸ”„ Initializing WhatsApp client...
2025-09-20T19:45:18: âœ… WhatsApp connection started
2025-09-20T19:45:18: ğŸ”§ Initializing admin commands...
2025-09-20T19:45:18: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T19:45:18: âœ… Admin commands system initialized
2025-09-20T19:45:18: ğŸ”„ Initializing polling functionality...
2025-09-20T19:45:18: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T19:45:18: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T19:45:18: ğŸ“ Attempting to request pairing code...
2025-09-20T19:45:18: ğŸ’¡ To use phone authentication:
2025-09-20T19:45:18:    1. Use the dashboard at http://localhost:3001
2025-09-20T19:45:18:    2. Select "Phone Number Authentication"
2025-09-20T19:45:18:    3. Enter your phone number
2025-09-20T19:45:18:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T19:45:18: ğŸ”„ Connecting to WhatsApp...
2025-09-20T19:45:20: âœ… WhatsApp connected successfully!
2025-09-20T19:45:20: ğŸ”„ Enhanced client: Connected event received, forwarding...
2025-09-20T19:45:20: ğŸ“± Session established successfully
2025-09-20T19:45:20: ğŸ”’ Session will be monitored for stability
2025-09-20T19:45:26: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:45:26: ğŸ“ Loaded 11 template types
2025-09-20T19:45:26: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T19:45:26: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: welcome
2025-09-20T19:45:26: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T19:45:26: ğŸ›¡ï¸ [919953020706_TJJ19092511_welcome_1758377726448] Starting comprehensive safety check...
2025-09-20T19:45:26: ğŸ“‹ [919953020706_TJJ19092511_welcome_1758377726448] Phone: 919953020706, Order: TJJ19092511, Type: welcome
2025-09-20T19:45:26: â„¹ï¸ [7:45:26 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:45:26:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:45:26:   phone: '919****706',
2025-09-20T19:45:26:   orderId: 'TJJ19092511',
2025-09-20T19:45:26:   messageType: 'welcome',
2025-09-20T19:45:26:   result: 'STARTED',
2025-09-20T19:45:26:   details: {
2025-09-20T19:45:26:     checkId: '919953020706_TJJ19092511_welcome_1758377726448',
2025-09-20T19:45:26:     hasOrderData: true,
2025-09-20T19:45:26:     hasSheetData: false,
2025-09-20T19:45:26:     messageLength: 580
2025-09-20T19:45:26:   },
2025-09-20T19:45:26:   timestamp: 1758377726450
2025-09-20T19:45:26: }
2025-09-20T19:45:26: ğŸ” [919953020706_TJJ19092511_welcome_1758377726448] Step 1: Kill Switch Check
2025-09-20T19:45:26: ğŸ” [919953020706_TJJ19092511_welcome_1758377726448] Step 1.5: Developer Phone Check
2025-09-20T19:45:26: ğŸ” [919953020706_TJJ19092511_welcome_1758377726448] Step 2: Grace Period Check
2025-09-20T19:45:26: â„¹ï¸ [7:45:26 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:45:26:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:45:26:   remainingMs: 231801,
2025-09-20T19:45:26:   remainingSeconds: 232,
2025-09-20T19:45:26:   details: {
2025-09-20T19:45:26:     checkId: '919953020706_TJJ19092511_welcome_1758377726448',
2025-09-20T19:45:26:     phone: '919953020706',
2025-09-20T19:45:26:     orderId: 'TJJ19092511',
2025-09-20T19:45:26:     messageType: 'welcome'
2025-09-20T19:45:26:   },
2025-09-20T19:45:26:   timestamp: 1758377726458
2025-09-20T19:45:26: }
2025-09-20T19:45:26: âŒ [919953020706_TJJ19092511_welcome_1758377726448] Startup grace period active (232s remaining)
2025-09-20T19:45:26: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T19:45:26: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | welcome | Success: false
2025-09-20T19:45:26: â„¹ï¸ [7:45:26 pm] INFO: Message ALLOWED: welcome for TJJ19092511 {
2025-09-20T19:45:26:   phone: '919****706',
2025-09-20T19:45:26:   orderId: 'TJJ19092511',
2025-09-20T19:45:26:   messageType: 'welcome',
2025-09-20T19:45:26:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:45:26:   reason: {
2025-09-20T19:45:26:     contentHash: 'a689ceabb5afc485',
2025-09-20T19:45:26:     timestamp: 1758377726465,
2025-09-20T19:45:26:     messageLength: 580,
2025-09-20T19:45:26:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T19:45:26:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_welcome.json'
2025-09-20T19:45:26:   },
2025-09-20T19:45:26:   duration: 0,
2025-09-20T19:45:26:   timestamp: 1758377726484
2025-09-20T19:45:26: }
2025-09-20T19:45:26: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:45:26: ğŸ“ Loaded 11 template types
2025-09-20T19:45:26: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T19:45:26: ğŸ“‹ [919358537488] Order: TWM19092511, Type: welcome
2025-09-20T19:45:26: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T19:45:26: ğŸ›¡ï¸ [919358537488_TWM19092511_welcome_1758377726491] Starting comprehensive safety check...
2025-09-20T19:45:26: ğŸ“‹ [919358537488_TWM19092511_welcome_1758377726491] Phone: 919358537488, Order: TWM19092511, Type: welcome
2025-09-20T19:45:26: â„¹ï¸ [7:45:26 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:45:26:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:45:26:   phone: '919****488',
2025-09-20T19:45:26:   orderId: 'TWM19092511',
2025-09-20T19:45:26:   messageType: 'welcome',
2025-09-20T19:45:26:   result: 'STARTED',
2025-09-20T19:45:26:   details: {
2025-09-20T19:45:26:     checkId: '919358537488_TWM19092511_welcome_1758377726491',
2025-09-20T19:45:26:     hasOrderData: true,
2025-09-20T19:45:26:     hasSheetData: false,
2025-09-20T19:45:26:     messageLength: 586
2025-09-20T19:45:26:   },
2025-09-20T19:45:26:   timestamp: 1758377726492
2025-09-20T19:45:26: }
2025-09-20T19:45:26: ğŸ” [919358537488_TWM19092511_welcome_1758377726491] Step 1: Kill Switch Check
2025-09-20T19:45:26: ğŸ” [919358537488_TWM19092511_welcome_1758377726491] Step 1.5: Developer Phone Check
2025-09-20T19:45:26: ğŸ” [919358537488_TWM19092511_welcome_1758377726491] Step 2: Grace Period Check
2025-09-20T19:45:26: â„¹ï¸ [7:45:26 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:45:26:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:45:26:   remainingMs: 231764,
2025-09-20T19:45:26:   remainingSeconds: 232,
2025-09-20T19:45:26:   details: {
2025-09-20T19:45:26:     checkId: '919358537488_TWM19092511_welcome_1758377726491',
2025-09-20T19:45:26:     phone: '919358537488',
2025-09-20T19:45:26:     orderId: 'TWM19092511',
2025-09-20T19:45:26:     messageType: 'welcome'
2025-09-20T19:45:26:   },
2025-09-20T19:45:26:   timestamp: 1758377726495
2025-09-20T19:45:26: }
2025-09-20T19:45:26: âŒ [919358537488_TWM19092511_welcome_1758377726491] Startup grace period active (232s remaining)
2025-09-20T19:45:26: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T19:45:26: ğŸ“ Message recorded: 919358537488 | TWM19092511 | welcome | Success: false
2025-09-20T19:45:26: â„¹ï¸ [7:45:26 pm] INFO: Message ALLOWED: welcome for TWM19092511 {
2025-09-20T19:45:26:   phone: '919****488',
2025-09-20T19:45:26:   orderId: 'TWM19092511',
2025-09-20T19:45:26:   messageType: 'welcome',
2025-09-20T19:45:26:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:45:26:   reason: {
2025-09-20T19:45:26:     contentHash: 'e7a4959b8bb7b3be',
2025-09-20T19:45:26:     timestamp: 1758377726499,
2025-09-20T19:45:26:     messageLength: 586,
2025-09-20T19:45:26:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T19:45:26:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_welcome.json'
2025-09-20T19:45:26:   },
2025-09-20T19:45:26:   duration: 0,
2025-09-20T19:45:26:   timestamp: 1758377726508
2025-09-20T19:45:26: }
2025-09-20T19:45:26: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:45:26: ğŸ“ Loaded 11 template types
2025-09-20T19:45:26: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T19:45:26: ğŸ“‹ [918890134811] Order: TOF19092511, Type: welcome
2025-09-20T19:45:26: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T19:45:26: ğŸ›¡ï¸ [918890134811_TOF19092511_welcome_1758377726510] Starting comprehensive safety check...
2025-09-20T19:45:26: ğŸ“‹ [918890134811_TOF19092511_welcome_1758377726510] Phone: 918890134811, Order: TOF19092511, Type: welcome
2025-09-20T19:45:26: â„¹ï¸ [7:45:26 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:45:26:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:45:26:   phone: '918****811',
2025-09-20T19:45:26:   orderId: 'TOF19092511',
2025-09-20T19:45:26:   messageType: 'welcome',
2025-09-20T19:45:26:   result: 'STARTED',
2025-09-20T19:45:26:   details: {
2025-09-20T19:45:26:     checkId: '918890134811_TOF19092511_welcome_1758377726510',
2025-09-20T19:45:26:     hasOrderData: true,
2025-09-20T19:45:26:     hasSheetData: false,
2025-09-20T19:45:26:     messageLength: 584
2025-09-20T19:45:26:   },
2025-09-20T19:45:26:   timestamp: 1758377726510
2025-09-20T19:45:26: }
2025-09-20T19:45:26: ğŸ” [918890134811_TOF19092511_welcome_1758377726510] Step 1: Kill Switch Check
2025-09-20T19:45:26: ğŸ” [918890134811_TOF19092511_welcome_1758377726510] Step 1.5: Developer Phone Check
2025-09-20T19:45:26: ğŸ” [918890134811_TOF19092511_welcome_1758377726510] Step 2: Grace Period Check
2025-09-20T19:45:26: â„¹ï¸ [7:45:26 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:45:26:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:45:26:   remainingMs: 231745,
2025-09-20T19:45:26:   remainingSeconds: 232,
2025-09-20T19:45:26:   details: {
2025-09-20T19:45:26:     checkId: '918890134811_TOF19092511_welcome_1758377726510',
2025-09-20T19:45:26:     phone: '918890134811',
2025-09-20T19:45:26:     orderId: 'TOF19092511',
2025-09-20T19:45:26:     messageType: 'welcome'
2025-09-20T19:45:26:   },
2025-09-20T19:45:26:   timestamp: 1758377726514
2025-09-20T19:45:26: }
2025-09-20T19:45:26: âŒ [918890134811_TOF19092511_welcome_1758377726510] Startup grace period active (232s remaining)
2025-09-20T19:45:26: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (232s remaining)
2025-09-20T19:45:26: ğŸ“ Message recorded: 918890134811 | TOF19092511 | welcome | Success: false
2025-09-20T19:45:26: â„¹ï¸ [7:45:26 pm] INFO: Message ALLOWED: welcome for TOF19092511 {
2025-09-20T19:45:26:   phone: '918****811',
2025-09-20T19:45:26:   orderId: 'TOF19092511',
2025-09-20T19:45:26:   messageType: 'welcome',
2025-09-20T19:45:26:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:45:26:   reason: {
2025-09-20T19:45:26:     contentHash: '5e51815157495c67',
2025-09-20T19:45:26:     timestamp: 1758377726519,
2025-09-20T19:45:26:     messageLength: 584,
2025-09-20T19:45:26:     errorMessage: 'Startup grace period active (232s remaining)',
2025-09-20T19:45:26:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_welcome.json'
2025-09-20T19:45:26:   },
2025-09-20T19:45:26:   duration: 0,
2025-09-20T19:45:26:   timestamp: 1758377726526
2025-09-20T19:45:26: }
2025-09-20T19:45:48: ğŸ’¾ Data synced to files successfully
2025-09-20T19:46:18: ğŸ’¾ Data synced to files successfully
2025-09-20T19:46:48: ğŸ’¾ Data synced to files successfully
2025-09-20T19:47:18: ğŸ’¾ Data synced to files successfully
2025-09-20T19:47:48: ğŸ’¾ Data synced to files successfully
2025-09-20T19:48:18: ğŸ’¾ Data synced to files successfully
2025-09-20T19:48:26: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:48:26: ğŸ“ Loaded 11 template types
2025-09-20T19:48:26: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T19:48:26: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: welcome
2025-09-20T19:48:26: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T19:48:26: ğŸ›¡ï¸ [919953020706_TJJ19092511_welcome_1758377906501] Starting comprehensive safety check...
2025-09-20T19:48:26: ğŸ“‹ [919953020706_TJJ19092511_welcome_1758377906501] Phone: 919953020706, Order: TJJ19092511, Type: welcome
2025-09-20T19:48:26: â„¹ï¸ [7:48:26 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:48:26:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:48:26:   phone: '919****706',
2025-09-20T19:48:26:   orderId: 'TJJ19092511',
2025-09-20T19:48:26:   messageType: 'welcome',
2025-09-20T19:48:26:   result: 'STARTED',
2025-09-20T19:48:26:   details: {
2025-09-20T19:48:26:     checkId: '919953020706_TJJ19092511_welcome_1758377906501',
2025-09-20T19:48:26:     hasOrderData: true,
2025-09-20T19:48:26:     hasSheetData: false,
2025-09-20T19:48:26:     messageLength: 580
2025-09-20T19:48:26:   },
2025-09-20T19:48:26:   timestamp: 1758377906501
2025-09-20T19:48:26: }
2025-09-20T19:48:26: ğŸ” [919953020706_TJJ19092511_welcome_1758377906501] Step 1: Kill Switch Check
2025-09-20T19:48:26: ğŸ” [919953020706_TJJ19092511_welcome_1758377906501] Step 1.5: Developer Phone Check
2025-09-20T19:48:26: ğŸ” [919953020706_TJJ19092511_welcome_1758377906501] Step 2: Grace Period Check
2025-09-20T19:48:26: â„¹ï¸ [7:48:26 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:48:26:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:48:26:   remainingMs: 51754,
2025-09-20T19:48:26:   remainingSeconds: 52,
2025-09-20T19:48:26:   details: {
2025-09-20T19:48:26:     checkId: '919953020706_TJJ19092511_welcome_1758377906501',
2025-09-20T19:48:26:     phone: '919953020706',
2025-09-20T19:48:26:     orderId: 'TJJ19092511',
2025-09-20T19:48:26:     messageType: 'welcome'
2025-09-20T19:48:26:   },
2025-09-20T19:48:26:   timestamp: 1758377906505
2025-09-20T19:48:26: }
2025-09-20T19:48:26: âŒ [919953020706_TJJ19092511_welcome_1758377906501] Startup grace period active (52s remaining)
2025-09-20T19:48:26: ğŸš« [919953020706] PRIMARY SAFETY CHECK FAILED: Startup grace period active (52s remaining)
2025-09-20T19:48:26: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | welcome | Success: false
2025-09-20T19:48:26: â„¹ï¸ [7:48:26 pm] INFO: Message ALLOWED: welcome for TJJ19092511 {
2025-09-20T19:48:26:   phone: '919****706',
2025-09-20T19:48:26:   orderId: 'TJJ19092511',
2025-09-20T19:48:26:   messageType: 'welcome',
2025-09-20T19:48:26:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:48:26:   reason: {
2025-09-20T19:48:26:     contentHash: 'a689ceabb5afc485',
2025-09-20T19:48:26:     timestamp: 1758377906508,
2025-09-20T19:48:26:     messageLength: 580,
2025-09-20T19:48:26:     errorMessage: 'Startup grace period active (52s remaining)',
2025-09-20T19:48:26:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_welcome.json'
2025-09-20T19:48:26:   },
2025-09-20T19:48:26:   duration: 0,
2025-09-20T19:48:26:   timestamp: 1758377906518
2025-09-20T19:48:26: }
2025-09-20T19:48:26: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:48:26: ğŸ“ Loaded 11 template types
2025-09-20T19:48:26: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T19:48:26: ğŸ“‹ [919358537488] Order: TWM19092511, Type: welcome
2025-09-20T19:48:26: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T19:48:26: ğŸ›¡ï¸ [919358537488_TWM19092511_welcome_1758377906519] Starting comprehensive safety check...
2025-09-20T19:48:26: ğŸ“‹ [919358537488_TWM19092511_welcome_1758377906519] Phone: 919358537488, Order: TWM19092511, Type: welcome
2025-09-20T19:48:26: â„¹ï¸ [7:48:26 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:48:26:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:48:26:   phone: '919****488',
2025-09-20T19:48:26:   orderId: 'TWM19092511',
2025-09-20T19:48:26:   messageType: 'welcome',
2025-09-20T19:48:26:   result: 'STARTED',
2025-09-20T19:48:26:   details: {
2025-09-20T19:48:26:     checkId: '919358537488_TWM19092511_welcome_1758377906519',
2025-09-20T19:48:26:     hasOrderData: true,
2025-09-20T19:48:26:     hasSheetData: false,
2025-09-20T19:48:26:     messageLength: 586
2025-09-20T19:48:26:   },
2025-09-20T19:48:26:   timestamp: 1758377906519
2025-09-20T19:48:26: }
2025-09-20T19:48:26: ğŸ” [919358537488_TWM19092511_welcome_1758377906519] Step 1: Kill Switch Check
2025-09-20T19:48:26: ğŸ” [919358537488_TWM19092511_welcome_1758377906519] Step 1.5: Developer Phone Check
2025-09-20T19:48:26: ğŸ” [919358537488_TWM19092511_welcome_1758377906519] Step 2: Grace Period Check
2025-09-20T19:48:26: â„¹ï¸ [7:48:26 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:48:26:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:48:26:   remainingMs: 51738,
2025-09-20T19:48:26:   remainingSeconds: 52,
2025-09-20T19:48:26:   details: {
2025-09-20T19:48:26:     checkId: '919358537488_TWM19092511_welcome_1758377906519',
2025-09-20T19:48:26:     phone: '919358537488',
2025-09-20T19:48:26:     orderId: 'TWM19092511',
2025-09-20T19:48:26:     messageType: 'welcome'
2025-09-20T19:48:26:   },
2025-09-20T19:48:26:   timestamp: 1758377906521
2025-09-20T19:48:26: }
2025-09-20T19:48:26: âŒ [919358537488_TWM19092511_welcome_1758377906519] Startup grace period active (52s remaining)
2025-09-20T19:48:26: ğŸš« [919358537488] PRIMARY SAFETY CHECK FAILED: Startup grace period active (52s remaining)
2025-09-20T19:48:26: ğŸ“ Message recorded: 919358537488 | TWM19092511 | welcome | Success: false
2025-09-20T19:48:26: â„¹ï¸ [7:48:26 pm] INFO: Message ALLOWED: welcome for TWM19092511 {
2025-09-20T19:48:26:   phone: '919****488',
2025-09-20T19:48:26:   orderId: 'TWM19092511',
2025-09-20T19:48:26:   messageType: 'welcome',
2025-09-20T19:48:26:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:48:26:   reason: {
2025-09-20T19:48:26:     contentHash: 'e7a4959b8bb7b3be',
2025-09-20T19:48:26:     timestamp: 1758377906523,
2025-09-20T19:48:26:     messageLength: 586,
2025-09-20T19:48:26:     errorMessage: 'Startup grace period active (52s remaining)',
2025-09-20T19:48:26:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_welcome.json'
2025-09-20T19:48:26:   },
2025-09-20T19:48:26:   duration: 0,
2025-09-20T19:48:26:   timestamp: 1758377906534
2025-09-20T19:48:26: }
2025-09-20T19:48:26: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:48:26: ğŸ“ Loaded 11 template types
2025-09-20T19:48:26: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T19:48:26: ğŸ“‹ [918890134811] Order: TOF19092511, Type: welcome
2025-09-20T19:48:26: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T19:48:26: ğŸ›¡ï¸ [918890134811_TOF19092511_welcome_1758377906535] Starting comprehensive safety check...
2025-09-20T19:48:26: ğŸ“‹ [918890134811_TOF19092511_welcome_1758377906535] Phone: 918890134811, Order: TOF19092511, Type: welcome
2025-09-20T19:48:26: â„¹ï¸ [7:48:26 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:48:26:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:48:26:   phone: '918****811',
2025-09-20T19:48:26:   orderId: 'TOF19092511',
2025-09-20T19:48:26:   messageType: 'welcome',
2025-09-20T19:48:26:   result: 'STARTED',
2025-09-20T19:48:26:   details: {
2025-09-20T19:48:26:     checkId: '918890134811_TOF19092511_welcome_1758377906535',
2025-09-20T19:48:26:     hasOrderData: true,
2025-09-20T19:48:26:     hasSheetData: false,
2025-09-20T19:48:26:     messageLength: 584
2025-09-20T19:48:26:   },
2025-09-20T19:48:26:   timestamp: 1758377906535
2025-09-20T19:48:26: }
2025-09-20T19:48:26: ğŸ” [918890134811_TOF19092511_welcome_1758377906535] Step 1: Kill Switch Check
2025-09-20T19:48:26: ğŸ” [918890134811_TOF19092511_welcome_1758377906535] Step 1.5: Developer Phone Check
2025-09-20T19:48:26: ğŸ” [918890134811_TOF19092511_welcome_1758377906535] Step 2: Grace Period Check
2025-09-20T19:48:26: â„¹ï¸ [7:48:26 pm] INFO: Grace Period: MESSAGE_BLOCKED_GRACE_PERIOD {
2025-09-20T19:48:26:   action: 'MESSAGE_BLOCKED_GRACE_PERIOD',
2025-09-20T19:48:26:   remainingMs: 51723,
2025-09-20T19:48:26:   remainingSeconds: 52,
2025-09-20T19:48:26:   details: {
2025-09-20T19:48:26:     checkId: '918890134811_TOF19092511_welcome_1758377906535',
2025-09-20T19:48:26:     phone: '918890134811',
2025-09-20T19:48:26:     orderId: 'TOF19092511',
2025-09-20T19:48:26:     messageType: 'welcome'
2025-09-20T19:48:26:   },
2025-09-20T19:48:26:   timestamp: 1758377906536
2025-09-20T19:48:26: }
2025-09-20T19:48:26: âŒ [918890134811_TOF19092511_welcome_1758377906535] Startup grace period active (52s remaining)
2025-09-20T19:48:26: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Startup grace period active (52s remaining)
2025-09-20T19:48:26: ğŸ“ Message recorded: 918890134811 | TOF19092511 | welcome | Success: false
2025-09-20T19:48:26: â„¹ï¸ [7:48:26 pm] INFO: Message ALLOWED: welcome for TOF19092511 {
2025-09-20T19:48:26:   phone: '918****811',
2025-09-20T19:48:26:   orderId: 'TOF19092511',
2025-09-20T19:48:26:   messageType: 'welcome',
2025-09-20T19:48:26:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:48:26:   reason: {
2025-09-20T19:48:26:     contentHash: '5e51815157495c67',
2025-09-20T19:48:26:     timestamp: 1758377906538,
2025-09-20T19:48:26:     messageLength: 584,
2025-09-20T19:48:26:     errorMessage: 'Startup grace period active (52s remaining)',
2025-09-20T19:48:26:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_welcome.json'
2025-09-20T19:48:26:   },
2025-09-20T19:48:26:   duration: 0,
2025-09-20T19:48:26:   timestamp: 1758377906549
2025-09-20T19:48:26: }
2025-09-20T19:48:48: ğŸ’¾ Data synced to files successfully
2025-09-20T19:49:18: âœ… Startup grace period ended - message sending now allowed
2025-09-20T19:49:18: âœ… Startup grace period ended - message sending now allowed
2025-09-20T19:49:18: â„¹ï¸ [7:49:18 pm] INFO: Grace Period: ENDED {
2025-09-20T19:49:18:   action: 'ENDED',
2025-09-20T19:49:18:   remainingMs: 0,
2025-09-20T19:49:18:   remainingSeconds: 0,
2025-09-20T19:49:18:   details: { totalDuration: 240000, processId: 21028 },
2025-09-20T19:49:18:   timestamp: 1758377958437
2025-09-20T19:49:18: }
2025-09-20T19:49:18: â„¹ï¸ [7:49:18 pm] INFO: Grace Period: ENDED {
2025-09-20T19:49:18:   action: 'ENDED',
2025-09-20T19:49:18:   remainingMs: 0,
2025-09-20T19:49:18:   remainingSeconds: 0,
2025-09-20T19:49:18:   details: { totalDuration: 240000, processId: 21028 },
2025-09-20T19:49:18:   timestamp: 1758377958439
2025-09-20T19:49:18: }
2025-09-20T19:49:18: ğŸ’¾ Data synced to files successfully
2025-09-20T19:49:18: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T19:49:18: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-20T19:49:48: ğŸ’¾ Data synced to files successfully
2025-09-20T19:50:18: ğŸ’¾ Data synced to files successfully
2025-09-20T19:50:48: ğŸ’¾ Data synced to files successfully
2025-09-20T19:51:18: ğŸ’¾ Data synced to files successfully
2025-09-20T19:51:26: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:51:26: ğŸ“ Loaded 11 template types
2025-09-20T19:51:26: ğŸ” [919953020706] Starting comprehensive message safety check...
2025-09-20T19:51:26: ğŸ“‹ [919953020706] Order: TJJ19092511, Type: welcome
2025-09-20T19:51:26: ğŸ›¡ï¸ [919953020706] Running primary safety check...
2025-09-20T19:51:26: ğŸ›¡ï¸ [919953020706_TJJ19092511_welcome_1758378086273] Starting comprehensive safety check...
2025-09-20T19:51:26: ğŸ“‹ [919953020706_TJJ19092511_welcome_1758378086273] Phone: 919953020706, Order: TJJ19092511, Type: welcome
2025-09-20T19:51:26: â„¹ï¸ [7:51:26 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:51:26:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:51:26:   phone: '919****706',
2025-09-20T19:51:26:   orderId: 'TJJ19092511',
2025-09-20T19:51:26:   messageType: 'welcome',
2025-09-20T19:51:26:   result: 'STARTED',
2025-09-20T19:51:26:   details: {
2025-09-20T19:51:26:     checkId: '919953020706_TJJ19092511_welcome_1758378086273',
2025-09-20T19:51:26:     hasOrderData: true,
2025-09-20T19:51:26:     hasSheetData: false,
2025-09-20T19:51:26:     messageLength: 580
2025-09-20T19:51:26:   },
2025-09-20T19:51:26:   timestamp: 1758378086273
2025-09-20T19:51:26: }
2025-09-20T19:51:26: ğŸ” [919953020706_TJJ19092511_welcome_1758378086273] Step 1: Kill Switch Check
2025-09-20T19:51:26: ğŸ” [919953020706_TJJ19092511_welcome_1758378086273] Step 1.5: Developer Phone Check
2025-09-20T19:51:26: ğŸ” [919953020706_TJJ19092511_welcome_1758378086273] Step 2: Grace Period Check
2025-09-20T19:51:26: ğŸ” [919953020706_TJJ19092511_welcome_1758378086273] Step 3: Business Hours Check
2025-09-20T19:51:26: ğŸ” [919953020706_TJJ19092511_welcome_1758378086273] Step 4: Message Type Rules Check
2025-09-20T19:51:26: ğŸ“‹ Checking rules for welcome: phone + orderId unique AND Welcome Notified = No
2025-09-20T19:51:26: â„¹ï¸ [7:51:26 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:51:26:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:51:26:   phone: '919****706',
2025-09-20T19:51:26:   orderId: 'TJJ19092511',
2025-09-20T19:51:26:   messageType: 'welcome',
2025-09-20T19:51:26:   result: 'STARTED',
2025-09-20T19:51:26:   details: {
2025-09-20T19:51:26:     ruleCondition: 'phone + orderId unique AND Welcome Notified = No',
2025-09-20T19:51:26:     requiredFields: [ 'customer_name', 'order_id', 'phone' ],
2025-09-20T19:51:26:     orderDataFields: [
2025-09-20T19:51:26:       'customer_name',
2025-09-20T19:51:26:       'order_id',
2025-09-20T19:51:26:       'phone',
2025-09-20T19:51:26:       'garment_type',
2025-09-20T19:51:26:       'total_amount',
2025-09-20T19:51:26:       'advance_amount',
2025-09-20T19:51:26:       'remaining_amount',
2025-09-20T19:51:26:       'ready_date',
2025-09-20T19:51:26:       'delivery_date',
2025-09-20T19:51:26:       'shop_name',
2025-09-20T19:51:26:       'shop_phone',
2025-09-20T19:51:26:       'business_hours'
2025-09-20T19:51:26:     ],
2025-09-20T19:51:26:     sheetDataFields: []
2025-09-20T19:51:26:   },
2025-09-20T19:51:26:   timestamp: 1758378086282
2025-09-20T19:51:26: }
2025-09-20T19:51:26: â„¹ï¸ [7:51:26 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:51:26:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:51:26:   phone: '919****706',
2025-09-20T19:51:26:   orderId: 'TJJ19092511',
2025-09-20T19:51:26:   messageType: 'welcome',
2025-09-20T19:51:26:   result: 'CONDITIONS_PASSED',
2025-09-20T19:51:26:   details: {
2025-09-20T19:51:26:     conditionResult: { allowed: true },
2025-09-20T19:51:26:     ruleCondition: 'phone + orderId unique AND Welcome Notified = No'
2025-09-20T19:51:26:   },
2025-09-20T19:51:26:   timestamp: 1758378086297
2025-09-20T19:51:26: }
2025-09-20T19:51:26: ğŸ” [919953020706_TJJ19092511_welcome_1758378086273] Step 5: Triple Layer Duplicate Check
2025-09-20T19:51:26: ğŸ” [919953020706_TJJ19092511_welcome_1758378086273] Step 6: Circuit Breaker Limits Check
2025-09-20T19:51:26: ğŸ” [919953020706_TJJ19092511_welcome_1758378086273] Step 7: Content Similarity Check
2025-09-20T19:51:26: âœ… [919953020706_TJJ19092511_welcome_1758378086273] All safety checks passed - message approved (86ms)
2025-09-20T19:51:26: â„¹ï¸ [7:51:26 pm] INFO: Safety Event: SAFETY_CHECK_COMPLETED {
2025-09-20T19:51:26:   eventType: 'SAFETY_CHECK_COMPLETED',
2025-09-20T19:51:26:   phone: '919****706',
2025-09-20T19:51:26:   orderId: 'TJJ19092511',
2025-09-20T19:51:26:   messageType: 'welcome',
2025-09-20T19:51:26:   result: 'APPROVED',
2025-09-20T19:51:26:   details: {
2025-09-20T19:51:26:     checkId: '919953020706_TJJ19092511_welcome_1758378086273',
2025-09-20T19:51:26:     duration: 86,
2025-09-20T19:51:26:     allChecksCount: 7,
2025-09-20T19:51:26:     checksDetails: {
2025-09-20T19:51:26:       killSwitch: 'PASSED',
2025-09-20T19:51:26:       gracePeriod: 'PASSED',
2025-09-20T19:51:26:       businessHours: 'PASSED',
2025-09-20T19:51:26:       messageRules: 'PASSED',
2025-09-20T19:51:26:       duplicateCheck: 'PASSED',
2025-09-20T19:51:26:       circuitBreaker: 'PASSED',
2025-09-20T19:51:26:       contentSimilarity: 'PASSED'
2025-09-20T19:51:26:     }
2025-09-20T19:51:26:   },
2025-09-20T19:51:26:   timestamp: 1758378086360
2025-09-20T19:51:26: }
2025-09-20T19:51:26: âœ… [919953020706_TJJ19092511_welcome_1758378086273] All safety checks passed
2025-09-20T19:51:26: âœ… [919953020706] Primary safety check passed
2025-09-20T19:51:26: ğŸ›¡ï¸ [919953020706] Running secondary duplicate check...
2025-09-20T19:51:26: ğŸ” Checking duplicate for: a42e15f83f87bb16b85cf4ea0e1bc70b97e4bbfe3b3c2d4bf2acd30f7a7d3c5f
2025-09-20T19:51:26: âœ… Message allowed: a42e15f83f87bb16b85cf4ea0e1bc70b97e4bbfe3b3c2d4bf2acd30f7a7d3c5f
2025-09-20T19:51:26: âœ… [919953020706] Secondary duplicate check passed
2025-09-20T19:51:26: ğŸ“¤ [919953020706] All safety checks passed - sending message...
2025-09-20T19:51:27: âœ… Message sent to 919953020706@s.whatsapp.net
2025-09-20T19:51:27: ğŸ“ Message recorded: 919953020706 | TJJ19092511 | welcome | Success: true
2025-09-20T19:51:27: â„¹ï¸ [7:51:27 pm] INFO: Message ALLOWED: welcome for TJJ19092511 {
2025-09-20T19:51:27:   phone: '919****706',
2025-09-20T19:51:27:   orderId: 'TJJ19092511',
2025-09-20T19:51:27:   messageType: 'welcome',
2025-09-20T19:51:27:   allowed: 'RECORDED_SUCCESS',
2025-09-20T19:51:27:   reason: {
2025-09-20T19:51:27:     contentHash: 'a689ceabb5afc485',
2025-09-20T19:51:27:     timestamp: 1758378087877,
2025-09-20T19:51:27:     messageLength: 580,
2025-09-20T19:51:27:     errorMessage: null,
2025-09-20T19:51:27:     backupFile: 'safety-data\\backup_919953020706_TJJ19092511_welcome.json'
2025-09-20T19:51:27:   },
2025-09-20T19:51:27:   duration: 0,
2025-09-20T19:51:27:   timestamp: 1758378087901
2025-09-20T19:51:27: }
2025-09-20T19:51:27: ğŸ“ Recorded message sent: a42e15f83f87bb16b85cf4ea0e1bc70b97e4bbfe3b3c2d4bf2acd30f7a7d3c5f
2025-09-20T19:51:27: âœ… [919953020706] Message sent successfully (1633ms)
2025-09-20T19:51:27: ğŸ“§ [919953020706] Message ID: 3EB0ECEA6AF54484FD62D4
2025-09-20T19:51:27: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:51:27: ğŸ“ Loaded 11 template types
2025-09-20T19:51:27: ğŸ” [919358537488] Starting comprehensive message safety check...
2025-09-20T19:51:27: ğŸ“‹ [919358537488] Order: TWM19092511, Type: welcome
2025-09-20T19:51:27: ğŸ›¡ï¸ [919358537488] Running primary safety check...
2025-09-20T19:51:27: ğŸ›¡ï¸ [919358537488_TWM19092511_welcome_1758378087907] Starting comprehensive safety check...
2025-09-20T19:51:27: ğŸ“‹ [919358537488_TWM19092511_welcome_1758378087907] Phone: 919358537488, Order: TWM19092511, Type: welcome
2025-09-20T19:51:27: ğŸ’¾ Data synced to files successfully
2025-09-20T19:51:27: â„¹ï¸ [7:51:27 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:51:27:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:51:27:   phone: '919****488',
2025-09-20T19:51:27:   orderId: 'TWM19092511',
2025-09-20T19:51:27:   messageType: 'welcome',
2025-09-20T19:51:27:   result: 'STARTED',
2025-09-20T19:51:27:   details: {
2025-09-20T19:51:27:     checkId: '919358537488_TWM19092511_welcome_1758378087907',
2025-09-20T19:51:27:     hasOrderData: true,
2025-09-20T19:51:27:     hasSheetData: false,
2025-09-20T19:51:27:     messageLength: 586
2025-09-20T19:51:27:   },
2025-09-20T19:51:27:   timestamp: 1758378087907
2025-09-20T19:51:27: }
2025-09-20T19:51:27: ğŸ” [919358537488_TWM19092511_welcome_1758378087907] Step 1: Kill Switch Check
2025-09-20T19:51:27: ğŸ” [919358537488_TWM19092511_welcome_1758378087907] Step 1.5: Developer Phone Check
2025-09-20T19:51:27: ğŸ” [919358537488_TWM19092511_welcome_1758378087907] Step 2: Grace Period Check
2025-09-20T19:51:27: ğŸ” [919358537488_TWM19092511_welcome_1758378087907] Step 3: Business Hours Check
2025-09-20T19:51:27: ğŸ” [919358537488_TWM19092511_welcome_1758378087907] Step 4: Message Type Rules Check
2025-09-20T19:51:27: ğŸ“‹ Checking rules for welcome: phone + orderId unique AND Welcome Notified = No
2025-09-20T19:51:27: â„¹ï¸ [7:51:27 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:51:27:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:51:27:   phone: '919****488',
2025-09-20T19:51:27:   orderId: 'TWM19092511',
2025-09-20T19:51:27:   messageType: 'welcome',
2025-09-20T19:51:27:   result: 'STARTED',
2025-09-20T19:51:27:   details: {
2025-09-20T19:51:27:     ruleCondition: 'phone + orderId unique AND Welcome Notified = No',
2025-09-20T19:51:27:     requiredFields: [ 'customer_name', 'order_id', 'phone' ],
2025-09-20T19:51:27:     orderDataFields: [
2025-09-20T19:51:27:       'customer_name',
2025-09-20T19:51:27:       'order_id',
2025-09-20T19:51:27:       'phone',
2025-09-20T19:51:27:       'garment_type',
2025-09-20T19:51:27:       'total_amount',
2025-09-20T19:51:27:       'advance_amount',
2025-09-20T19:51:27:       'remaining_amount',
2025-09-20T19:51:27:       'ready_date',
2025-09-20T19:51:27:       'delivery_date',
2025-09-20T19:51:27:       'shop_name',
2025-09-20T19:51:27:       'shop_phone',
2025-09-20T19:51:27:       'business_hours'
2025-09-20T19:51:27:     ],
2025-09-20T19:51:27:     sheetDataFields: []
2025-09-20T19:51:27:   },
2025-09-20T19:51:27:   timestamp: 1758378087912
2025-09-20T19:51:27: }
2025-09-20T19:51:27: â„¹ï¸ [7:51:27 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:51:27:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:51:27:   phone: '919****488',
2025-09-20T19:51:27:   orderId: 'TWM19092511',
2025-09-20T19:51:27:   messageType: 'welcome',
2025-09-20T19:51:27:   result: 'CONDITIONS_PASSED',
2025-09-20T19:51:27:   details: {
2025-09-20T19:51:27:     conditionResult: { allowed: true },
2025-09-20T19:51:27:     ruleCondition: 'phone + orderId unique AND Welcome Notified = No'
2025-09-20T19:51:27:   },
2025-09-20T19:51:27:   timestamp: 1758378087914
2025-09-20T19:51:27: }
2025-09-20T19:51:27: ğŸ” [919358537488_TWM19092511_welcome_1758378087907] Step 5: Triple Layer Duplicate Check
2025-09-20T19:51:27: ğŸ” [919358537488_TWM19092511_welcome_1758378087907] Step 6: Circuit Breaker Limits Check
2025-09-20T19:51:27: ğŸ” [919358537488_TWM19092511_welcome_1758378087907] Step 7: Content Similarity Check
2025-09-20T19:51:27: âœ… [919358537488_TWM19092511_welcome_1758378087907] All safety checks passed - message approved (39ms)
2025-09-20T19:51:27: â„¹ï¸ [7:51:27 pm] INFO: Safety Event: SAFETY_CHECK_COMPLETED {
2025-09-20T19:51:27:   eventType: 'SAFETY_CHECK_COMPLETED',
2025-09-20T19:51:27:   phone: '919****488',
2025-09-20T19:51:27:   orderId: 'TWM19092511',
2025-09-20T19:51:27:   messageType: 'welcome',
2025-09-20T19:51:27:   result: 'APPROVED',
2025-09-20T19:51:27:   details: {
2025-09-20T19:51:27:     checkId: '919358537488_TWM19092511_welcome_1758378087907',
2025-09-20T19:51:27:     duration: 39,
2025-09-20T19:51:27:     allChecksCount: 7,
2025-09-20T19:51:27:     checksDetails: {
2025-09-20T19:51:27:       killSwitch: 'PASSED',
2025-09-20T19:51:27:       gracePeriod: 'PASSED',
2025-09-20T19:51:27:       businessHours: 'PASSED',
2025-09-20T19:51:27:       messageRules: 'PASSED',
2025-09-20T19:51:27:       duplicateCheck: 'PASSED',
2025-09-20T19:51:27:       circuitBreaker: 'PASSED',
2025-09-20T19:51:27:       contentSimilarity: 'PASSED'
2025-09-20T19:51:27:     }
2025-09-20T19:51:27:   },
2025-09-20T19:51:27:   timestamp: 1758378087946
2025-09-20T19:51:27: }
2025-09-20T19:51:27: âœ… [919358537488_TWM19092511_welcome_1758378087907] All safety checks passed
2025-09-20T19:51:27: âœ… [919358537488] Primary safety check passed
2025-09-20T19:51:27: ğŸ›¡ï¸ [919358537488] Running secondary duplicate check...
2025-09-20T19:51:27: ğŸ” Checking duplicate for: 6f806e822f778a1f2d537a8849273ca24458378d54d4a17086b4b69723d416f8
2025-09-20T19:51:27: âœ… Message allowed: 6f806e822f778a1f2d537a8849273ca24458378d54d4a17086b4b69723d416f8
2025-09-20T19:51:27: âœ… [919358537488] Secondary duplicate check passed
2025-09-20T19:51:27: ğŸ“¤ [919358537488] All safety checks passed - sending message...
2025-09-20T19:51:29: âœ… Message sent to 919358537488@s.whatsapp.net
2025-09-20T19:51:29: ğŸ“ Message recorded: 919358537488 | TWM19092511 | welcome | Success: true
2025-09-20T19:51:29: â„¹ï¸ [7:51:29 pm] INFO: Message ALLOWED: welcome for TWM19092511 {
2025-09-20T19:51:29:   phone: '919****488',
2025-09-20T19:51:29:   orderId: 'TWM19092511',
2025-09-20T19:51:29:   messageType: 'welcome',
2025-09-20T19:51:29:   allowed: 'RECORDED_SUCCESS',
2025-09-20T19:51:29:   reason: {
2025-09-20T19:51:29:     contentHash: 'e7a4959b8bb7b3be',
2025-09-20T19:51:29:     timestamp: 1758378089123,
2025-09-20T19:51:29:     messageLength: 586,
2025-09-20T19:51:29:     errorMessage: null,
2025-09-20T19:51:29:     backupFile: 'safety-data\\backup_919358537488_TWM19092511_welcome.json'
2025-09-20T19:51:29:   },
2025-09-20T19:51:29:   duration: 0,
2025-09-20T19:51:29:   timestamp: 1758378089135
2025-09-20T19:51:29: }
2025-09-20T19:51:29: ğŸ“ Recorded message sent: 6f806e822f778a1f2d537a8849273ca24458378d54d4a17086b4b69723d416f8
2025-09-20T19:51:29: âœ… [919358537488] Message sent successfully (1230ms)
2025-09-20T19:51:29: ğŸ“§ [919358537488] Message ID: 3EB01519B8A8BD2128A166
2025-09-20T19:51:29: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:51:29: ğŸ“ Loaded 11 template types
2025-09-20T19:51:29: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T19:51:29: ğŸ“‹ [918890134811] Order: TOF19092511, Type: welcome
2025-09-20T19:51:29: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T19:51:29: ğŸ›¡ï¸ [918890134811_TOF19092511_welcome_1758378089138] Starting comprehensive safety check...
2025-09-20T19:51:29: ğŸ“‹ [918890134811_TOF19092511_welcome_1758378089138] Phone: 918890134811, Order: TOF19092511, Type: welcome
2025-09-20T19:51:29: â„¹ï¸ [7:51:29 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:51:29:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:51:29:   phone: '918****811',
2025-09-20T19:51:29:   orderId: 'TOF19092511',
2025-09-20T19:51:29:   messageType: 'welcome',
2025-09-20T19:51:29:   result: 'STARTED',
2025-09-20T19:51:29:   details: {
2025-09-20T19:51:29:     checkId: '918890134811_TOF19092511_welcome_1758378089138',
2025-09-20T19:51:29:     hasOrderData: true,
2025-09-20T19:51:29:     hasSheetData: false,
2025-09-20T19:51:29:     messageLength: 584
2025-09-20T19:51:29:   },
2025-09-20T19:51:29:   timestamp: 1758378089138
2025-09-20T19:51:29: }
2025-09-20T19:51:29: ğŸ” [918890134811_TOF19092511_welcome_1758378089138] Step 1: Kill Switch Check
2025-09-20T19:51:29: ğŸ” [918890134811_TOF19092511_welcome_1758378089138] Step 1.5: Developer Phone Check
2025-09-20T19:51:29: ğŸ” [918890134811_TOF19092511_welcome_1758378089138] Step 2: Grace Period Check
2025-09-20T19:51:29: ğŸ” [918890134811_TOF19092511_welcome_1758378089138] Step 3: Business Hours Check
2025-09-20T19:51:29: ğŸ” [918890134811_TOF19092511_welcome_1758378089138] Step 4: Message Type Rules Check
2025-09-20T19:51:29: ğŸ“‹ Checking rules for welcome: phone + orderId unique AND Welcome Notified = No
2025-09-20T19:51:29: ğŸ’¾ Data synced to files successfully
2025-09-20T19:51:29: â„¹ï¸ [7:51:29 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:51:29:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:51:29:   phone: '918****811',
2025-09-20T19:51:29:   orderId: 'TOF19092511',
2025-09-20T19:51:29:   messageType: 'welcome',
2025-09-20T19:51:29:   result: 'STARTED',
2025-09-20T19:51:29:   details: {
2025-09-20T19:51:29:     ruleCondition: 'phone + orderId unique AND Welcome Notified = No',
2025-09-20T19:51:29:     requiredFields: [ 'customer_name', 'order_id', 'phone' ],
2025-09-20T19:51:29:     orderDataFields: [
2025-09-20T19:51:29:       'customer_name',
2025-09-20T19:51:29:       'order_id',
2025-09-20T19:51:29:       'phone',
2025-09-20T19:51:29:       'garment_type',
2025-09-20T19:51:29:       'total_amount',
2025-09-20T19:51:29:       'advance_amount',
2025-09-20T19:51:29:       'remaining_amount',
2025-09-20T19:51:29:       'ready_date',
2025-09-20T19:51:29:       'delivery_date',
2025-09-20T19:51:29:       'shop_name',
2025-09-20T19:51:29:       'shop_phone',
2025-09-20T19:51:29:       'business_hours'
2025-09-20T19:51:29:     ],
2025-09-20T19:51:29:     sheetDataFields: []
2025-09-20T19:51:29:   },
2025-09-20T19:51:29:   timestamp: 1758378089142
2025-09-20T19:51:29: }
2025-09-20T19:51:29: â„¹ï¸ [7:51:29 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:51:29:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:51:29:   phone: '918****811',
2025-09-20T19:51:29:   orderId: 'TOF19092511',
2025-09-20T19:51:29:   messageType: 'welcome',
2025-09-20T19:51:29:   result: 'CONDITIONS_PASSED',
2025-09-20T19:51:29:   details: {
2025-09-20T19:51:29:     conditionResult: { allowed: true },
2025-09-20T19:51:29:     ruleCondition: 'phone + orderId unique AND Welcome Notified = No'
2025-09-20T19:51:29:   },
2025-09-20T19:51:29:   timestamp: 1758378089145
2025-09-20T19:51:29: }
2025-09-20T19:51:29: ğŸ” [918890134811_TOF19092511_welcome_1758378089138] Step 5: Triple Layer Duplicate Check
2025-09-20T19:51:29: ğŸ” [918890134811_TOF19092511_welcome_1758378089138] Step 6: Circuit Breaker Limits Check
2025-09-20T19:51:29: ğŸ” [918890134811_TOF19092511_welcome_1758378089138] Step 7: Content Similarity Check
2025-09-20T19:51:29: âœ… [918890134811_TOF19092511_welcome_1758378089138] All safety checks passed - message approved (30ms)
2025-09-20T19:51:29: â„¹ï¸ [7:51:29 pm] INFO: Safety Event: SAFETY_CHECK_COMPLETED {
2025-09-20T19:51:29:   eventType: 'SAFETY_CHECK_COMPLETED',
2025-09-20T19:51:29:   phone: '918****811',
2025-09-20T19:51:29:   orderId: 'TOF19092511',
2025-09-20T19:51:29:   messageType: 'welcome',
2025-09-20T19:51:29:   result: 'APPROVED',
2025-09-20T19:51:29:   details: {
2025-09-20T19:51:29:     checkId: '918890134811_TOF19092511_welcome_1758378089138',
2025-09-20T19:51:29:     duration: 30,
2025-09-20T19:51:29:     allChecksCount: 7,
2025-09-20T19:51:29:     checksDetails: {
2025-09-20T19:51:29:       killSwitch: 'PASSED',
2025-09-20T19:51:29:       gracePeriod: 'PASSED',
2025-09-20T19:51:29:       businessHours: 'PASSED',
2025-09-20T19:51:29:       messageRules: 'PASSED',
2025-09-20T19:51:29:       duplicateCheck: 'PASSED',
2025-09-20T19:51:29:       circuitBreaker: 'PASSED',
2025-09-20T19:51:29:       contentSimilarity: 'PASSED'
2025-09-20T19:51:29:     }
2025-09-20T19:51:29:   },
2025-09-20T19:51:29:   timestamp: 1758378089168
2025-09-20T19:51:29: }
2025-09-20T19:51:29: âœ… [918890134811_TOF19092511_welcome_1758378089138] All safety checks passed
2025-09-20T19:51:29: âœ… [918890134811] Primary safety check passed
2025-09-20T19:51:29: ğŸ›¡ï¸ [918890134811] Running secondary duplicate check...
2025-09-20T19:51:29: ğŸ” Checking duplicate for: d7e7f2a934392af4dcf48380974f0dcd276e53ac59b329402902551b3823e11c
2025-09-20T19:51:29: âœ… Message allowed: d7e7f2a934392af4dcf48380974f0dcd276e53ac59b329402902551b3823e11c
2025-09-20T19:51:29: âœ… [918890134811] Secondary duplicate check passed
2025-09-20T19:51:29: ğŸ“¤ [918890134811] All safety checks passed - sending message...
2025-09-20T19:51:30: âœ… Message sent to 918890134811@s.whatsapp.net
2025-09-20T19:51:30: ğŸ“ Message recorded: 918890134811 | TOF19092511 | welcome | Success: true
2025-09-20T19:51:30: â„¹ï¸ [7:51:30 pm] INFO: Message ALLOWED: welcome for TOF19092511 {
2025-09-20T19:51:30:   phone: '918****811',
2025-09-20T19:51:30:   orderId: 'TOF19092511',
2025-09-20T19:51:30:   messageType: 'welcome',
2025-09-20T19:51:30:   allowed: 'RECORDED_SUCCESS',
2025-09-20T19:51:30:   reason: {
2025-09-20T19:51:30:     contentHash: '5e51815157495c67',
2025-09-20T19:51:30:     timestamp: 1758378090374,
2025-09-20T19:51:30:     messageLength: 584,
2025-09-20T19:51:30:     errorMessage: null,
2025-09-20T19:51:30:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_welcome.json'
2025-09-20T19:51:30:   },
2025-09-20T19:51:30:   duration: 0,
2025-09-20T19:51:30:   timestamp: 1758378090386
2025-09-20T19:51:30: }
2025-09-20T19:51:30: ğŸ“ Recorded message sent: d7e7f2a934392af4dcf48380974f0dcd276e53ac59b329402902551b3823e11c
2025-09-20T19:51:30: âœ… [918890134811] Message sent successfully (1249ms)
2025-09-20T19:51:30: ğŸ“§ [918890134811] Message ID: 3EB032615FF783981BCC31
2025-09-20T19:51:30: ğŸ’¾ Data synced to files successfully
2025-09-20T19:51:48: ğŸ’¾ Data synced to files successfully
2025-09-20T19:52:18: ğŸ’¾ Data synced to files successfully
2025-09-20T19:52:48: ğŸ’¾ Data synced to files successfully
2025-09-20T19:53:18: ğŸ’¾ Data synced to files successfully
2025-09-20T19:53:48: ğŸ’¾ Data synced to files successfully
2025-09-20T19:54:18: ğŸ’¾ Data synced to files successfully
2025-09-20T19:54:26: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:54:26: ğŸ“ Loaded 11 template types
2025-09-20T19:54:26: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T19:54:26: ğŸ“‹ [918890134811] Order: TOF19092511, Type: welcome
2025-09-20T19:54:26: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T19:54:26: ğŸ›¡ï¸ [918890134811_TOF19092511_welcome_1758378266440] Starting comprehensive safety check...
2025-09-20T19:54:26: ğŸ“‹ [918890134811_TOF19092511_welcome_1758378266440] Phone: 918890134811, Order: TOF19092511, Type: welcome
2025-09-20T19:54:26: â„¹ï¸ [7:54:26 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:54:26:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:54:26:   phone: '918****811',
2025-09-20T19:54:26:   orderId: 'TOF19092511',
2025-09-20T19:54:26:   messageType: 'welcome',
2025-09-20T19:54:26:   result: 'STARTED',
2025-09-20T19:54:26:   details: {
2025-09-20T19:54:26:     checkId: '918890134811_TOF19092511_welcome_1758378266440',
2025-09-20T19:54:26:     hasOrderData: true,
2025-09-20T19:54:26:     hasSheetData: false,
2025-09-20T19:54:26:     messageLength: 584
2025-09-20T19:54:26:   },
2025-09-20T19:54:26:   timestamp: 1758378266440
2025-09-20T19:54:26: }
2025-09-20T19:54:26: ğŸ” [918890134811_TOF19092511_welcome_1758378266440] Step 1: Kill Switch Check
2025-09-20T19:54:26: ğŸ” [918890134811_TOF19092511_welcome_1758378266440] Step 1.5: Developer Phone Check
2025-09-20T19:54:26: ğŸ” [918890134811_TOF19092511_welcome_1758378266440] Step 2: Grace Period Check
2025-09-20T19:54:26: ğŸ” [918890134811_TOF19092511_welcome_1758378266440] Step 3: Business Hours Check
2025-09-20T19:54:26: ğŸ” [918890134811_TOF19092511_welcome_1758378266440] Step 4: Message Type Rules Check
2025-09-20T19:54:26: ğŸ“‹ Checking rules for welcome: phone + orderId unique AND Welcome Notified = No
2025-09-20T19:54:26: â„¹ï¸ [7:54:26 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:54:26:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:54:26:   phone: '918****811',
2025-09-20T19:54:26:   orderId: 'TOF19092511',
2025-09-20T19:54:26:   messageType: 'welcome',
2025-09-20T19:54:26:   result: 'STARTED',
2025-09-20T19:54:26:   details: {
2025-09-20T19:54:26:     ruleCondition: 'phone + orderId unique AND Welcome Notified = No',
2025-09-20T19:54:26:     requiredFields: [ 'customer_name', 'order_id', 'phone' ],
2025-09-20T19:54:26:     orderDataFields: [
2025-09-20T19:54:26:       'customer_name',
2025-09-20T19:54:26:       'order_id',
2025-09-20T19:54:26:       'phone',
2025-09-20T19:54:26:       'garment_type',
2025-09-20T19:54:26:       'total_amount',
2025-09-20T19:54:26:       'advance_amount',
2025-09-20T19:54:26:       'remaining_amount',
2025-09-20T19:54:26:       'ready_date',
2025-09-20T19:54:26:       'delivery_date',
2025-09-20T19:54:26:       'shop_name',
2025-09-20T19:54:26:       'shop_phone',
2025-09-20T19:54:26:       'business_hours'
2025-09-20T19:54:26:     ],
2025-09-20T19:54:26:     sheetDataFields: []
2025-09-20T19:54:26:   },
2025-09-20T19:54:26:   timestamp: 1758378266450
2025-09-20T19:54:26: }
2025-09-20T19:54:26: â„¹ï¸ [7:54:26 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:54:26:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:54:26:   phone: '918****811',
2025-09-20T19:54:26:   orderId: 'TOF19092511',
2025-09-20T19:54:26:   messageType: 'welcome',
2025-09-20T19:54:26:   result: 'CONDITIONS_FAILED',
2025-09-20T19:54:26:   details: {
2025-09-20T19:54:26:     conditionResult: {
2025-09-20T19:54:26:       allowed: false,
2025-09-20T19:54:26:       reason: 'WELCOME_ALREADY_SENT',
2025-09-20T19:54:26:       message: 'Welcome message already sent for phone 918890134811 and order TOF19092511'
2025-09-20T19:54:26:     },
2025-09-20T19:54:26:     ruleCondition: 'phone + orderId unique AND Welcome Notified = No'
2025-09-20T19:54:26:   },
2025-09-20T19:54:26:   timestamp: 1758378266453
2025-09-20T19:54:26: }
2025-09-20T19:54:26: â„¹ï¸ [7:54:26 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:54:26:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:54:26:   phone: '918****811',
2025-09-20T19:54:26:   orderId: 'TOF19092511',
2025-09-20T19:54:26:   messageType: 'welcome',
2025-09-20T19:54:26:   result: 'BLOCKED',
2025-09-20T19:54:26:   details: {
2025-09-20T19:54:26:     checkId: '918890134811_TOF19092511_welcome_1758378266440',
2025-09-20T19:54:26:     ruleViolation: 'WELCOME_ALREADY_SENT',
2025-09-20T19:54:26:     details: 'Welcome message already sent for phone 918890134811 and order TOF19092511'
2025-09-20T19:54:26:   },
2025-09-20T19:54:26:   timestamp: 1758378266456
2025-09-20T19:54:26: }
2025-09-20T19:54:26: âŒ [918890134811_TOF19092511_welcome_1758378266440] Welcome message already sent for phone 918890134811 and order TOF19092511
2025-09-20T19:54:26: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Welcome message already sent for phone 918890134811 and order TOF19092511
2025-09-20T19:54:26: ğŸ“ Message recorded: 918890134811 | TOF19092511 | welcome | Success: false
2025-09-20T19:54:26: â„¹ï¸ [7:54:26 pm] INFO: Message ALLOWED: welcome for TOF19092511 {
2025-09-20T19:54:26:   phone: '918****811',
2025-09-20T19:54:26:   orderId: 'TOF19092511',
2025-09-20T19:54:26:   messageType: 'welcome',
2025-09-20T19:54:26:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:54:26:   reason: {
2025-09-20T19:54:26:     contentHash: '5e51815157495c67',
2025-09-20T19:54:26:     timestamp: 1758378266461,
2025-09-20T19:54:26:     messageLength: 584,
2025-09-20T19:54:26:     errorMessage: 'Welcome message already sent for phone 918890134811 and order TOF19092511',
2025-09-20T19:54:26:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_welcome.json'
2025-09-20T19:54:26:   },
2025-09-20T19:54:26:   duration: 0,
2025-09-20T19:54:26:   timestamp: 1758378266489
2025-09-20T19:54:26: }
2025-09-20T19:54:48: ğŸ’¾ Data synced to files successfully
2025-09-20T19:55:18: ğŸ’¾ Data synced to files successfully
2025-09-20T19:55:48: ğŸ’¾ Data synced to files successfully
2025-09-20T19:56:18: ğŸ’¾ Data synced to files successfully
2025-09-20T19:56:48: ğŸ’¾ Data synced to files successfully
2025-09-20T19:57:18: ğŸ’¾ Data synced to files successfully
2025-09-20T19:57:26: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T19:57:26: ğŸ“ Loaded 11 template types
2025-09-20T19:57:26: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T19:57:26: ğŸ“‹ [918890134811] Order: TOF19092511, Type: welcome
2025-09-20T19:57:26: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T19:57:26: ğŸ›¡ï¸ [918890134811_TOF19092511_welcome_1758378446493] Starting comprehensive safety check...
2025-09-20T19:57:26: ğŸ“‹ [918890134811_TOF19092511_welcome_1758378446493] Phone: 918890134811, Order: TOF19092511, Type: welcome
2025-09-20T19:57:26: â„¹ï¸ [7:57:26 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T19:57:26:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T19:57:26:   phone: '918****811',
2025-09-20T19:57:26:   orderId: 'TOF19092511',
2025-09-20T19:57:26:   messageType: 'welcome',
2025-09-20T19:57:26:   result: 'STARTED',
2025-09-20T19:57:26:   details: {
2025-09-20T19:57:26:     checkId: '918890134811_TOF19092511_welcome_1758378446493',
2025-09-20T19:57:26:     hasOrderData: true,
2025-09-20T19:57:26:     hasSheetData: false,
2025-09-20T19:57:26:     messageLength: 584
2025-09-20T19:57:26:   },
2025-09-20T19:57:26:   timestamp: 1758378446493
2025-09-20T19:57:26: }
2025-09-20T19:57:26: ğŸ” [918890134811_TOF19092511_welcome_1758378446493] Step 1: Kill Switch Check
2025-09-20T19:57:26: ğŸ” [918890134811_TOF19092511_welcome_1758378446493] Step 1.5: Developer Phone Check
2025-09-20T19:57:26: ğŸ” [918890134811_TOF19092511_welcome_1758378446493] Step 2: Grace Period Check
2025-09-20T19:57:26: ğŸ” [918890134811_TOF19092511_welcome_1758378446493] Step 3: Business Hours Check
2025-09-20T19:57:26: ğŸ” [918890134811_TOF19092511_welcome_1758378446493] Step 4: Message Type Rules Check
2025-09-20T19:57:26: ğŸ“‹ Checking rules for welcome: phone + orderId unique AND Welcome Notified = No
2025-09-20T19:57:26: â„¹ï¸ [7:57:26 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:57:26:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:57:26:   phone: '918****811',
2025-09-20T19:57:26:   orderId: 'TOF19092511',
2025-09-20T19:57:26:   messageType: 'welcome',
2025-09-20T19:57:26:   result: 'STARTED',
2025-09-20T19:57:26:   details: {
2025-09-20T19:57:26:     ruleCondition: 'phone + orderId unique AND Welcome Notified = No',
2025-09-20T19:57:26:     requiredFields: [ 'customer_name', 'order_id', 'phone' ],
2025-09-20T19:57:26:     orderDataFields: [
2025-09-20T19:57:26:       'customer_name',
2025-09-20T19:57:26:       'order_id',
2025-09-20T19:57:26:       'phone',
2025-09-20T19:57:26:       'garment_type',
2025-09-20T19:57:26:       'total_amount',
2025-09-20T19:57:26:       'advance_amount',
2025-09-20T19:57:26:       'remaining_amount',
2025-09-20T19:57:26:       'ready_date',
2025-09-20T19:57:26:       'delivery_date',
2025-09-20T19:57:26:       'shop_name',
2025-09-20T19:57:26:       'shop_phone',
2025-09-20T19:57:26:       'business_hours'
2025-09-20T19:57:26:     ],
2025-09-20T19:57:26:     sheetDataFields: []
2025-09-20T19:57:26:   },
2025-09-20T19:57:26:   timestamp: 1758378446510
2025-09-20T19:57:26: }
2025-09-20T19:57:26: â„¹ï¸ [7:57:26 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:57:26:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:57:26:   phone: '918****811',
2025-09-20T19:57:26:   orderId: 'TOF19092511',
2025-09-20T19:57:26:   messageType: 'welcome',
2025-09-20T19:57:26:   result: 'CONDITIONS_FAILED',
2025-09-20T19:57:26:   details: {
2025-09-20T19:57:26:     conditionResult: {
2025-09-20T19:57:26:       allowed: false,
2025-09-20T19:57:26:       reason: 'WELCOME_ALREADY_SENT',
2025-09-20T19:57:26:       message: 'Welcome message already sent for phone 918890134811 and order TOF19092511'
2025-09-20T19:57:26:     },
2025-09-20T19:57:26:     ruleCondition: 'phone + orderId unique AND Welcome Notified = No'
2025-09-20T19:57:26:   },
2025-09-20T19:57:26:   timestamp: 1758378446552
2025-09-20T19:57:26: }
2025-09-20T19:57:26: â„¹ï¸ [7:57:26 pm] INFO: Safety Event: MESSAGE_RULES_CHECK {
2025-09-20T19:57:26:   eventType: 'MESSAGE_RULES_CHECK',
2025-09-20T19:57:26:   phone: '918****811',
2025-09-20T19:57:26:   orderId: 'TOF19092511',
2025-09-20T19:57:26:   messageType: 'welcome',
2025-09-20T19:57:26:   result: 'BLOCKED',
2025-09-20T19:57:26:   details: {
2025-09-20T19:57:26:     checkId: '918890134811_TOF19092511_welcome_1758378446493',
2025-09-20T19:57:26:     ruleViolation: 'WELCOME_ALREADY_SENT',
2025-09-20T19:57:26:     details: 'Welcome message already sent for phone 918890134811 and order TOF19092511'
2025-09-20T19:57:26:   },
2025-09-20T19:57:26:   timestamp: 1758378446556
2025-09-20T19:57:26: }
2025-09-20T19:57:26: âŒ [918890134811_TOF19092511_welcome_1758378446493] Welcome message already sent for phone 918890134811 and order TOF19092511
2025-09-20T19:57:26: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Welcome message already sent for phone 918890134811 and order TOF19092511
2025-09-20T19:57:26: ğŸ“ Message recorded: 918890134811 | TOF19092511 | welcome | Success: false
2025-09-20T19:57:26: â„¹ï¸ [7:57:26 pm] INFO: Message ALLOWED: welcome for TOF19092511 {
2025-09-20T19:57:26:   phone: '918****811',
2025-09-20T19:57:26:   orderId: 'TOF19092511',
2025-09-20T19:57:26:   messageType: 'welcome',
2025-09-20T19:57:26:   allowed: 'RECORDED_FAILURE',
2025-09-20T19:57:26:   reason: {
2025-09-20T19:57:26:     contentHash: '5e51815157495c67',
2025-09-20T19:57:26:     timestamp: 1758378446567,
2025-09-20T19:57:26:     messageLength: 584,
2025-09-20T19:57:26:     errorMessage: 'Welcome message already sent for phone 918890134811 and order TOF19092511',
2025-09-20T19:57:26:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_welcome.json'
2025-09-20T19:57:26:   },
2025-09-20T19:57:26:   duration: 0,
2025-09-20T19:57:26:   timestamp: 1758378446600
2025-09-20T19:57:26: }
2025-09-20T19:57:48: ğŸ’¾ Data synced to files successfully
2025-09-20T19:58:12: {"level":50,"time":1758378492646,"pid":21028,"hostname":"SAURABH","node":{"tag":"stream:error","attrs":{},"content":[{"tag":"conflict","attrs":{"type":"replaced"}}]},"msg":"stream errored out"}
2025-09-20T19:58:12: ğŸ”Œ Connection closed. Reason: undefined
2025-09-20T19:58:12: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-20T19:58:12: ğŸ”„ Reconnecting in 1s... (Attempt 1/10)
2025-09-20T19:58:13: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-20T19:58:13: ğŸ”‘ Initializing Google Sheets API...
2025-09-20T19:58:13: âœ… Google Sheets API initialized
2025-09-20T19:58:13: âœ… Google Sheets API initialized
2025-09-20T19:58:13: â„¹ï¸ [7:58:13 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-20T19:58:13:   startupTime: 1758377718259,
2025-09-20T19:58:13:   gracePeriodMs: 240000,
2025-09-20T19:58:13:   dataDir: './safety-data',
2025-09-20T19:58:13:   dbPath: 'safety-data\\safety-database.db',
2025-09-20T19:58:13:   processId: 21028,
2025-09-20T19:58:13:   nodeVersion: 'v22.19.0'
2025-09-20T19:58:13: }
2025-09-20T19:58:13: â„¹ï¸ [7:58:13 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-20T19:58:13: â„¹ï¸ [7:58:13 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-20T19:58:13: ğŸ”’ Process lock acquired (PID: 21028)
2025-09-20T19:58:13: â„¹ï¸ [7:58:13 pm] INFO: Process isolation enforced {
2025-09-20T19:58:13:   lockFile: 'safety-data\\process.lock',
2025-09-20T19:58:13:   pidFile: 'safety-data\\process.pid',
2025-09-20T19:58:13:   processId: 21028
2025-09-20T19:58:13: }
2025-09-20T19:58:13: â° Starting 240 second startup grace period...
2025-09-20T19:58:13: ğŸš« All message sending is BLOCKED during grace period
2025-09-20T19:58:13: â„¹ï¸ [7:58:13 pm] INFO: Grace Period: STARTED {
2025-09-20T19:58:13:   action: 'STARTED',
2025-09-20T19:58:13:   remainingMs: 240000,
2025-09-20T19:58:13:   remainingSeconds: 240,
2025-09-20T19:58:13:   details: { startupTime: 1758377718259, processId: 21028 },
2025-09-20T19:58:13:   timestamp: 1758378493789
2025-09-20T19:58:13: }
2025-09-20T19:58:13: â„¹ï¸ [7:58:13 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-20T19:58:13:   action: 'GRACE_PERIOD_STARTED',
2025-09-20T19:58:13:   remainingMs: 240000,
2025-09-20T19:58:13:   remainingSeconds: 240,
2025-09-20T19:58:13:   details: { startupTime: 1758377718259, willExpireAt: 1758377958259 },
2025-09-20T19:58:13:   timestamp: 1758378493790
2025-09-20T19:58:13: }
2025-09-20T19:58:13: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-20T19:58:13: â° Startup grace period: 240 seconds
2025-09-20T19:58:13: ğŸ“‹ Message rules loaded: 8 types
2025-09-20T19:58:13: â„¹ï¸ [7:58:13 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-20T19:58:13:   initializationDuration: 775534,
2025-09-20T19:58:13:   gracePeriodActive: false,
2025-09-20T19:58:13:   messageRulesCount: 8,
2025-09-20T19:58:13:   messageTypes: [
2025-09-20T19:58:13:     'welcome',
2025-09-20T19:58:13:     'confirmation',
2025-09-20T19:58:13:     'ready',
2025-09-20T19:58:13:     'delivery',
2025-09-20T19:58:13:     'pickup_reminder',
2025-09-20T19:58:13:     'payment_reminder',
2025-09-20T19:58:13:     'fabric_welcome',
2025-09-20T19:58:13:     'fabric_purchase'
2025-09-20T19:58:13:   ],
2025-09-20T19:58:13:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-20T19:58:13:   databaseReady: true,
2025-09-20T19:58:13:   loggerReady: true,
2025-09-20T19:58:13:   processIsolationActive: true
2025-09-20T19:58:13: }
2025-09-20T19:58:13: âœ… Safety Manager initialized
2025-09-20T19:58:13: ğŸ“ Loaded 3 sent messages from file
2025-09-20T19:58:13: ğŸ“ Loaded 3 customer histories from file
2025-09-20T19:58:13: ğŸ“ Loaded 3 message hashes from file
2025-09-20T19:58:13: ğŸ“ Loaded statistics from file
2025-09-20T19:58:13: âœ… Duplicate Prevention Manager initialized
2025-09-20T19:58:13: ğŸ“Š Loaded: 3 sent messages, 3 customer histories, 3 content hashes
2025-09-20T19:58:13: âœ… Duplicate Prevention Manager initialized
2025-09-20T19:58:13: ğŸ”„ Starting WhatsApp connection...
2025-09-20T19:58:13: ğŸ”„ Initializing WhatsApp client...
2025-09-20T19:58:13: âœ… WhatsApp connection started
2025-09-20T19:58:13: ğŸ”§ Initializing admin commands...
2025-09-20T19:58:13: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-20T19:58:13: âœ… Admin commands system initialized
2025-09-20T19:58:13: ğŸ”„ Initializing polling functionality...
2025-09-20T19:58:13: âœ… WhatsApp connected. Polling will be controlled by bot instance.
2025-09-20T19:58:13: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-20T19:58:13: ğŸ“ Attempting to request pairing code...
2025-09-20T19:58:13: ğŸ’¡ To use phone authentication:
2025-09-20T19:58:13:    1. Use the dashboard at http://localhost:3001
2025-09-20T19:58:13:    2. Select "Phone Number Authentication"
2025-09-20T19:58:13:    3. Enter your phone number
2025-09-20T19:58:13:    4. Get the pairing code and enter it in WhatsApp
2025-09-20T19:58:13: ğŸ”„ Connecting to WhatsApp...
2025-09-20T19:58:17: âœ… WhatsApp connected successfully!
2025-09-20T19:58:17: ğŸ”„ Enhanced client: Connected event received, forwarding...
2025-09-20T19:58:17: ğŸ“± Session established successfully
2025-09-20T19:58:17: ğŸ”’ Session will be monitored for stability
2025-09-20T19:58:18: ğŸ’¾ Data synced to files successfully
2025-09-20T19:58:48: ğŸ’¾ Data synced to files successfully
2025-09-20T19:59:18: ğŸ’¾ Data synced to files successfully
2025-09-20T19:59:48: ğŸ’¾ Data synced to files successfully
2025-09-20T20:00:18: ğŸ’¾ Data synced to files successfully
2025-09-20T20:00:26: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-20T20:00:26: ğŸ“ Loaded 11 template types
2025-09-20T20:00:26: ğŸ” [918890134811] Starting comprehensive message safety check...
2025-09-20T20:00:26: ğŸ“‹ [918890134811] Order: TOF19092511, Type: welcome
2025-09-20T20:00:26: ğŸ›¡ï¸ [918890134811] Running primary safety check...
2025-09-20T20:00:26: ğŸ›¡ï¸ [918890134811_TOF19092511_welcome_1758378626351] Starting comprehensive safety check...
2025-09-20T20:00:26: ğŸ“‹ [918890134811_TOF19092511_welcome_1758378626351] Phone: 918890134811, Order: TOF19092511, Type: welcome
2025-09-20T20:00:26: â„¹ï¸ [8:00:26 pm] INFO: Safety Event: SAFETY_CHECK_STARTED {
2025-09-20T20:00:26:   eventType: 'SAFETY_CHECK_STARTED',
2025-09-20T20:00:26:   phone: '918****811',
2025-09-20T20:00:26:   orderId: 'TOF19092511',
2025-09-20T20:00:26:   messageType: 'welcome',
2025-09-20T20:00:26:   result: 'STARTED',
2025-09-20T20:00:26:   details: {
2025-09-20T20:00:26:     checkId: '918890134811_TOF19092511_welcome_1758378626351',
2025-09-20T20:00:26:     hasOrderData: true,
2025-09-20T20:00:26:     hasSheetData: false,
2025-09-20T20:00:26:     messageLength: 584
2025-09-20T20:00:26:   },
2025-09-20T20:00:26:   timestamp: 1758378626354
2025-09-20T20:00:26: }
2025-09-20T20:00:26: ğŸ” [918890134811_TOF19092511_welcome_1758378626351] Step 1: Kill Switch Check
2025-09-20T20:00:26: ğŸ” [918890134811_TOF19092511_welcome_1758378626351] Step 1.5: Developer Phone Check
2025-09-20T20:00:26: ğŸ” [918890134811_TOF19092511_welcome_1758378626351] Step 2: Grace Period Check
2025-09-20T20:00:26: ğŸ” [918890134811_TOF19092511_welcome_1758378626351] Step 3: Business Hours Check
2025-09-20T20:00:26: â„¹ï¸ [8:00:26 pm] INFO: Safety Event: BUSINESS_HOURS_CHECK {
2025-09-20T20:00:26:   eventType: 'BUSINESS_HOURS_CHECK',
2025-09-20T20:00:26:   phone: '918****811',
2025-09-20T20:00:26:   orderId: 'TOF19092511',
2025-09-20T20:00:26:   messageType: 'welcome',
2025-09-20T20:00:26:   result: 'BLOCKED',
2025-09-20T20:00:26:   details: {
2025-09-20T20:00:26:     checkId: '918890134811_TOF19092511_welcome_1758378626351',
2025-09-20T20:00:26:     currentHour: 20,
2025-09-20T20:00:26:     businessHours: '9 AM - 8 PM'
2025-09-20T20:00:26:   },
2025-09-20T20:00:26:   timestamp: 1758378626371
2025-09-20T20:00:26: }
2025-09-20T20:00:26: âŒ [918890134811_TOF19092511_welcome_1758378626351] Messages not allowed outside business hours (9 AM - 8 PM)
2025-09-20T20:00:26: ğŸš« [918890134811] PRIMARY SAFETY CHECK FAILED: Messages not allowed outside business hours (9 AM - 8 PM)
2025-09-20T20:00:26: ğŸ“ Message recorded: 918890134811 | TOF19092511 | welcome | Success: false
2025-09-20T20:00:26: â„¹ï¸ [8:00:26 pm] INFO: Message ALLOWED: welcome for TOF19092511 {
2025-09-20T20:00:26:   phone: '918****811',
2025-09-20T20:00:26:   orderId: 'TOF19092511',
2025-09-20T20:00:26:   messageType: 'welcome',
2025-09-20T20:00:26:   allowed: 'RECORDED_FAILURE',
2025-09-20T20:00:26:   reason: {
2025-09-20T20:00:26:     contentHash: '5e51815157495c67',
2025-09-20T20:00:26:     timestamp: 1758378626380,
2025-09-20T20:00:26:     messageLength: 584,
2025-09-20T20:00:26:     errorMessage: 'Messages not allowed outside business hours (9 AM - 8 PM)',
2025-09-20T20:00:26:     backupFile: 'safety-data\\backup_918890134811_TOF19092511_welcome.json'
2025-09-20T20:00:26:   },
2025-09-20T20:00:26:   duration: 0,
2025-09-20T20:00:26:   timestamp: 1758378626415
2025-09-20T20:00:26: }
2025-09-20T20:00:48: ğŸ’¾ Data synced to files successfully
2025-09-21T18:16:19: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-21T18:16:19: ğŸ“ Loaded 11 template types
2025-09-21T18:16:19: ğŸ”§ WhatsApp Bot initialized
2025-09-21T18:16:19: ğŸ“Š Configuration status: undefined
2025-09-21T18:16:19: âœ… Atomic State Manager initialized
2025-09-21T18:16:19: ğŸ“ Enhanced Logger initialized
2025-09-21T18:16:19: âœ… Google credentials loaded from service-account.json file
2025-09-21T18:16:19: ğŸ“± WhatsApp auth status: âœ… credentials, 8 session files
2025-09-21T18:16:19: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-21T18:16:19:    Auth Mode: both
2025-09-21T18:16:19:    QR Enabled: true
2025-09-21T18:16:19:    Phone Enabled: true
2025-09-21T18:16:19:    Session Persistence: true
2025-09-21T18:16:19:    Max Reconnect Attempts: 10
2025-09-21T18:16:19:    Default Phone: None
2025-09-21T18:16:19: ğŸ”’ Session validation enabled (check every 300s)
2025-09-21T18:16:19: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-21T18:16:19: ğŸ”§ Developer Configuration initialized
2025-09-21T18:16:19: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-21T18:16:19: â„¹ï¸ [6:16:19 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-21T18:16:19:   startupTime: 1758458779875,
2025-09-21T18:16:19:   gracePeriodMs: 240000,
2025-09-21T18:16:19:   dataDir: './safety-data',
2025-09-21T18:16:19:   dbPath: 'safety-data\\safety-database.db',
2025-09-21T18:16:19:   processId: 19588,
2025-09-21T18:16:19:   nodeVersion: 'v22.19.0'
2025-09-21T18:16:19: }
2025-09-21T18:16:19: ğŸ”§ Developer Configuration initialized
2025-09-21T18:16:19: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-21T18:16:19: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-21T18:16:19: â° 4-minute startup delay active
2025-09-21T18:16:19: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-21T18:16:19: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-21T18:16:19: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-21T18:16:19: â„¹ï¸ [6:16:19 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-21T18:16:19:   startupTime: 1758458779875,
2025-09-21T18:16:19:   gracePeriodMs: 240000,
2025-09-21T18:16:19:   dataDir: './safety-data',
2025-09-21T18:16:19:   dbPath: 'safety-data\\safety-database.db',
2025-09-21T18:16:19:   processId: 19588,
2025-09-21T18:16:19:   nodeVersion: 'v22.19.0'
2025-09-21T18:16:19: }
2025-09-21T18:16:19: ğŸ“ Loaded 3 sent messages from file
2025-09-21T18:16:19: ğŸ“ Loaded 3 customer histories from file
2025-09-21T18:16:19: â„¹ï¸ [6:16:19 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-21T18:16:19: â„¹ï¸ [6:16:19 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-21T18:16:19: ğŸ“ Loaded 3 message hashes from file
2025-09-21T18:16:19: ğŸ“ Loaded statistics from file
2025-09-21T18:16:19: âœ… Duplicate Prevention Manager initialized
2025-09-21T18:16:19: ğŸ“Š Loaded: 3 sent messages, 3 customer histories, 3 content hashes
2025-09-21T18:16:19: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T11-56-54-064Z.log
2025-09-21T18:16:19: ğŸ“ Enhanced Logger initialized
2025-09-21T18:16:19: â„¹ï¸ [6:16:19 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-21T18:16:19: â„¹ï¸ [6:16:19 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-21T18:16:19: ğŸ§¹ Removed stale process lock
2025-09-21T18:16:19: ğŸ§¹ Removed stale process lock
2025-09-21T18:16:19: ğŸ”’ Process lock acquired (PID: 19588)
2025-09-21T18:16:19: ğŸ”’ Process lock acquired (PID: 19588)
2025-09-21T18:16:19: â„¹ï¸ [6:16:19 pm] INFO: Process isolation enforced {
2025-09-21T18:16:19:   lockFile: 'safety-data\\process.lock',
2025-09-21T18:16:19:   pidFile: 'safety-data\\process.pid',
2025-09-21T18:16:19:   processId: 19588
2025-09-21T18:16:19: }
2025-09-21T18:16:20: â° Starting 240 second startup grace period...
2025-09-21T18:16:20: ğŸš« All message sending is BLOCKED during grace period
2025-09-21T18:16:20: â„¹ï¸ [6:16:19 pm] INFO: Process isolation enforced {
2025-09-21T18:16:20:   lockFile: 'safety-data\\process.lock',
2025-09-21T18:16:20:   pidFile: 'safety-data\\process.pid',
2025-09-21T18:16:20:   processId: 19588
2025-09-21T18:16:20: }
2025-09-21T18:16:20: â° Starting 240 second startup grace period...
2025-09-21T18:16:20: ğŸš« All message sending is BLOCKED during grace period
2025-09-21T18:16:20: â„¹ï¸ [6:16:19 pm] INFO: Grace Period: STARTED {
2025-09-21T18:16:20:   action: 'STARTED',
2025-09-21T18:16:20:   remainingMs: 240000,
2025-09-21T18:16:20:   remainingSeconds: 240,
2025-09-21T18:16:20:   details: { startupTime: 1758458779875, processId: 19588 },
2025-09-21T18:16:20:   timestamp: 1758458779993
2025-09-21T18:16:20: }
2025-09-21T18:16:20: â„¹ï¸ [6:16:20 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-21T18:16:20:   action: 'GRACE_PERIOD_STARTED',
2025-09-21T18:16:20:   remainingMs: 240000,
2025-09-21T18:16:20:   remainingSeconds: 240,
2025-09-21T18:16:20:   details: { startupTime: 1758458779875, willExpireAt: 1758459019875 },
2025-09-21T18:16:20:   timestamp: 1758458779994
2025-09-21T18:16:20: }
2025-09-21T18:16:20: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-21T18:16:20: â° Startup grace period: 240 seconds
2025-09-21T18:16:20: ğŸ“‹ Message rules loaded: 8 types
2025-09-21T18:16:20: â„¹ï¸ [6:16:20 pm] INFO: Grace Period: STARTED {
2025-09-21T18:16:20:   action: 'STARTED',
2025-09-21T18:16:20:   remainingMs: 240000,
2025-09-21T18:16:20:   remainingSeconds: 240,
2025-09-21T18:16:20:   details: { startupTime: 1758458779875, processId: 19588 },
2025-09-21T18:16:20:   timestamp: 1758458779997
2025-09-21T18:16:20: }
2025-09-21T18:16:20: â„¹ï¸ [6:16:20 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-21T18:16:20:   action: 'GRACE_PERIOD_STARTED',
2025-09-21T18:16:20:   remainingMs: 240000,
2025-09-21T18:16:20:   remainingSeconds: 240,
2025-09-21T18:16:20:   details: { startupTime: 1758458779875, willExpireAt: 1758459019875 },
2025-09-21T18:16:20:   timestamp: 1758458779998
2025-09-21T18:16:20: }
2025-09-21T18:16:20: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-21T18:16:20: â° Startup grace period: 240 seconds
2025-09-21T18:16:20: ğŸ“‹ Message rules loaded: 8 types
2025-09-21T18:16:20: â„¹ï¸ [6:16:20 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-21T18:16:20:   initializationDuration: 126,
2025-09-21T18:16:20:   gracePeriodActive: true,
2025-09-21T18:16:20:   messageRulesCount: 8,
2025-09-21T18:16:20:   messageTypes: [
2025-09-21T18:16:20:     'welcome',
2025-09-21T18:16:20:     'confirmation',
2025-09-21T18:16:20:     'ready',
2025-09-21T18:16:20:     'delivery',
2025-09-21T18:16:20:     'pickup_reminder',
2025-09-21T18:16:20:     'payment_reminder',
2025-09-21T18:16:20:     'fabric_welcome',
2025-09-21T18:16:20:     'fabric_purchase'
2025-09-21T18:16:20:   ],
2025-09-21T18:16:20:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-21T18:16:20:   databaseReady: true,
2025-09-21T18:16:20:   loggerReady: true,
2025-09-21T18:16:20:   processIsolationActive: true
2025-09-21T18:16:20: }
2025-09-21T18:16:20: â„¹ï¸ [6:16:20 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-21T18:16:20:   initializationDuration: 130,
2025-09-21T18:16:20:   gracePeriodActive: true,
2025-09-21T18:16:20:   messageRulesCount: 8,
2025-09-21T18:16:20:   messageTypes: [
2025-09-21T18:16:20:     'welcome',
2025-09-21T18:16:20:     'confirmation',
2025-09-21T18:16:20:     'ready',
2025-09-21T18:16:20:     'delivery',
2025-09-21T18:16:20:     'pickup_reminder',
2025-09-21T18:16:20:     'payment_reminder',
2025-09-21T18:16:20:     'fabric_welcome',
2025-09-21T18:16:20:     'fabric_purchase'
2025-09-21T18:16:20:   ],
2025-09-21T18:16:20:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-21T18:16:20:   databaseReady: true,
2025-09-21T18:16:20:   loggerReady: true,
2025-09-21T18:16:20:   processIsolationActive: true
2025-09-21T18:16:20: }
2025-09-21T18:16:20: âœ… Safety Manager initialized
2025-09-21T18:16:20: ğŸ“ Loaded 3 sent messages from file
2025-09-21T18:16:20: ğŸ“ Loaded 3 customer histories from file
2025-09-21T18:16:20: ğŸ“ Loaded 3 message hashes from file
2025-09-21T18:16:20: ğŸ“ Loaded statistics from file
2025-09-21T18:16:20: âœ… Duplicate Prevention Manager initialized
2025-09-21T18:16:20: ğŸ“Š Loaded: 3 sent messages, 3 customer histories, 3 content hashes
2025-09-21T18:16:20: âœ… Duplicate Prevention Manager initialized
2025-09-21T18:16:20: ğŸ”„ Starting WhatsApp connection...
2025-09-21T18:16:20: ğŸ”„ Initializing WhatsApp client...
2025-09-21T18:16:20: âœ… WhatsApp connection started
2025-09-21T18:16:20: ğŸ”§ Initializing admin commands...
2025-09-21T18:16:20: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-21T18:16:20: âœ… Admin commands system initialized
2025-09-21T18:16:20: ğŸ”— Initializing webhook functionality...
2025-09-21T18:16:20: âœ… WhatsApp connected. Webhook system ready for real-time notifications.
2025-09-21T18:16:20: ğŸ’¡ Configure Google Apps Script webhook for instant sheet change notifications.
2025-09-21T18:16:20: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-21T18:16:20: ğŸ“ Attempting to request pairing code...
2025-09-21T18:16:20: ğŸ’¡ To use phone authentication:
2025-09-21T18:16:20:    1. Use the dashboard at http://localhost:3001
2025-09-21T18:16:20:    2. Select "Phone Number Authentication"
2025-09-21T18:16:20:    3. Enter your phone number
2025-09-21T18:16:20:    4. Get the pairing code and enter it in WhatsApp
2025-09-21T18:16:20: ğŸ”„ Connecting to WhatsApp...
2025-09-21T18:16:22: âœ… WhatsApp connected successfully!
2025-09-21T18:16:22: ğŸ”„ Enhanced client: Connected event received, forwarding...
2025-09-21T18:16:22: ğŸ“± Session established successfully
2025-09-21T18:16:22: ğŸ”’ Session will be monitored for stability
2025-09-21T18:16:49: ğŸ’¾ Data synced to files successfully
2025-09-21T18:17:19: ğŸ’¾ Data synced to files successfully
2025-09-21T18:17:49: ğŸ’¾ Data synced to files successfully
2025-09-21T18:18:19: ğŸ’¾ Data synced to files successfully
2025-09-21T18:18:50: ğŸ’¾ Data synced to files successfully
2025-09-21T18:19:20: ğŸ’¾ Data synced to files successfully
2025-09-21T18:19:50: ğŸ’¾ Data synced to files successfully
2025-09-21T18:20:20: âœ… Startup grace period ended - message sending now allowed
2025-09-21T18:20:20: âœ… Startup grace period ended - message sending now allowed
2025-09-21T18:20:20: â„¹ï¸ [6:20:20 pm] INFO: Grace Period: ENDED {
2025-09-21T18:20:20:   action: 'ENDED',
2025-09-21T18:20:20:   remainingMs: 0,
2025-09-21T18:20:20:   remainingSeconds: 0,
2025-09-21T18:20:20:   details: { totalDuration: 240000, processId: 19588 },
2025-09-21T18:20:20:   timestamp: 1758459020010
2025-09-21T18:20:20: }
2025-09-21T18:20:20: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-21T18:20:20: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-21T18:20:20: â„¹ï¸ [6:20:20 pm] INFO: Grace Period: ENDED {
2025-09-21T18:20:20:   action: 'ENDED',
2025-09-21T18:20:20:   remainingMs: 0,
2025-09-21T18:20:20:   remainingSeconds: 0,
2025-09-21T18:20:20:   details: { totalDuration: 240000, processId: 19588 },
2025-09-21T18:20:20:   timestamp: 1758459020040
2025-09-21T18:20:20: }
2025-09-21T18:20:20: ğŸ’¾ Data synced to files successfully
2025-09-21T18:20:50: ğŸ’¾ Data synced to files successfully
2025-09-21T18:21:20: ğŸ’¾ Data synced to files successfully
2025-09-21T18:21:50: ğŸ’¾ Data synced to files successfully
2025-09-21T18:22:20: ğŸ’¾ Data synced to files successfully
2025-09-21T18:22:50: ğŸ’¾ Data synced to files successfully
2025-09-21T18:23:20: ğŸ’¾ Data synced to files successfully
2025-09-21T18:23:50: ğŸ’¾ Data synced to files successfully
2025-09-21T18:24:20: ğŸ’¾ Data synced to files successfully
2025-09-21T18:24:50: ğŸ’¾ Data synced to files successfully
2025-09-21T18:25:20: ğŸ’¾ Data synced to files successfully
2025-09-21T18:25:50: ğŸ’¾ Data synced to files successfully
2025-09-21T18:26:20: ğŸ’¾ Data synced to files successfully
2025-09-21T18:26:50: ğŸ’¾ Data synced to files successfully
2025-09-21T18:27:20: ğŸ’¾ Data synced to files successfully
2025-09-21T18:27:50: ğŸ’¾ Data synced to files successfully
2025-09-21T18:28:20: ğŸ’¾ Data synced to files successfully
2025-09-21T18:28:32: ğŸ” [917375938371] Starting comprehensive message safety check...
2025-09-21T18:28:32: ğŸ“‹ [917375938371] Order: TEST-1758459512922, Type: test
2025-09-21T18:28:32: âš ï¸ ALL SAFETY CHECKS DISABLED - SENDING MESSAGE DIRECTLY (EMERGENCY MODE)
2025-09-21T18:28:33: âœ… Message sent to 917375938371@s.whatsapp.net
2025-09-21T18:28:50: ğŸ’¾ Data synced to files successfully
2025-09-21T18:29:20: ğŸ’¾ Data synced to files successfully
2025-09-21T18:29:45: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-21T18:29:45: ğŸ“ Loaded 11 template types
2025-09-21T18:29:45: ğŸ”§ WhatsApp Bot initialized
2025-09-21T18:29:45: ğŸ“Š Configuration status: undefined
2025-09-21T18:29:45: âœ… Atomic State Manager initialized
2025-09-21T18:29:45: ğŸ“ Enhanced Logger initialized
2025-09-21T18:29:45: âœ… Google credentials loaded from service-account.json file
2025-09-21T18:29:45: ğŸ“± WhatsApp auth status: âœ… credentials, 8 session files
2025-09-21T18:29:45: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-21T18:29:45:    Auth Mode: both
2025-09-21T18:29:45:    QR Enabled: true
2025-09-21T18:29:45:    Phone Enabled: true
2025-09-21T18:29:45:    Session Persistence: true
2025-09-21T18:29:45:    Max Reconnect Attempts: 10
2025-09-21T18:29:45:    Default Phone: None
2025-09-21T18:29:45: ğŸ”’ Session validation enabled (check every 300s)
2025-09-21T18:29:45: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-21T18:29:45: ğŸ”§ Developer Configuration initialized
2025-09-21T18:29:45: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-21T18:29:45: â„¹ï¸ [6:29:45 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-21T18:29:45:   startupTime: 1758459585309,
2025-09-21T18:29:45:   gracePeriodMs: 240000,
2025-09-21T18:29:45:   dataDir: './safety-data',
2025-09-21T18:29:45:   dbPath: 'safety-data\\safety-database.db',
2025-09-21T18:29:45:   processId: 24800,
2025-09-21T18:29:45:   nodeVersion: 'v22.19.0'
2025-09-21T18:29:45: }
2025-09-21T18:29:45: ğŸ”§ Developer Configuration initialized
2025-09-21T18:29:45: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-21T18:29:45: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-21T18:29:45: â° 4-minute startup delay active
2025-09-21T18:29:45: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-21T18:29:45: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-21T18:29:45: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-21T18:29:45: â„¹ï¸ [6:29:45 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-21T18:29:45:   startupTime: 1758459585309,
2025-09-21T18:29:45:   gracePeriodMs: 240000,
2025-09-21T18:29:45:   dataDir: './safety-data',
2025-09-21T18:29:45:   dbPath: 'safety-data\\safety-database.db',
2025-09-21T18:29:45:   processId: 24800,
2025-09-21T18:29:45:   nodeVersion: 'v22.19.0'
2025-09-21T18:29:45: }
2025-09-21T18:29:45: ğŸ“ Loaded 3 sent messages from file
2025-09-21T18:29:45: ğŸ“ Loaded 3 customer histories from file
2025-09-21T18:29:45: â„¹ï¸ [6:29:45 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-21T18:29:45: â„¹ï¸ [6:29:45 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-21T18:29:45: ğŸ“ Loaded 3 message hashes from file
2025-09-21T18:29:45: ğŸ“ Loaded statistics from file
2025-09-21T18:29:45: âœ… Duplicate Prevention Manager initialized
2025-09-21T18:29:45: ğŸ“Š Loaded: 3 sent messages, 3 customer histories, 3 content hashes
2025-09-21T18:29:45: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T11-58-13-080Z.log
2025-09-21T18:29:45: ğŸ“ Enhanced Logger initialized
2025-09-21T18:29:45: â„¹ï¸ [6:29:45 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-21T18:29:45: â„¹ï¸ [6:29:45 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-21T18:29:45: âš ï¸ Warning: Could not remove lock file: EPERM: operation not permitted, unlink 'C:\Users\gssai\OneDrive\Desktop\Whatsapp-Moblie-Bot\safety-data\process.lock'
2025-09-21T18:29:45: ğŸ§¹ Removed stale process lock
2025-09-21T18:29:45: ğŸ”’ Process lock acquired (PID: 24800)
2025-09-21T18:29:45: ğŸ”’ Process lock acquired (PID: 24800)
2025-09-21T18:29:45: â„¹ï¸ [6:29:45 pm] INFO: Process isolation enforced {
2025-09-21T18:29:45:   lockFile: 'safety-data\\process.lock',
2025-09-21T18:29:45:   pidFile: 'safety-data\\process.pid',
2025-09-21T18:29:45:   processId: 24800
2025-09-21T18:29:45: }
2025-09-21T18:29:45: â° Starting 240 second startup grace period...
2025-09-21T18:29:45: ğŸš« All message sending is BLOCKED during grace period
2025-09-21T18:29:45: â„¹ï¸ [6:29:45 pm] INFO: Process isolation enforced {
2025-09-21T18:29:45:   lockFile: 'safety-data\\process.lock',
2025-09-21T18:29:45:   pidFile: 'safety-data\\process.pid',
2025-09-21T18:29:45:   processId: 24800
2025-09-21T18:29:45: }
2025-09-21T18:29:45: â° Starting 240 second startup grace period...
2025-09-21T18:29:45: ğŸš« All message sending is BLOCKED during grace period
2025-09-21T18:29:45: â„¹ï¸ [6:29:45 pm] INFO: Grace Period: STARTED {
2025-09-21T18:29:45:   action: 'STARTED',
2025-09-21T18:29:45:   remainingMs: 240000,
2025-09-21T18:29:45:   remainingSeconds: 240,
2025-09-21T18:29:45:   details: { startupTime: 1758459585309, processId: 24800 },
2025-09-21T18:29:45:   timestamp: 1758459585451
2025-09-21T18:29:45: }
2025-09-21T18:29:45: â„¹ï¸ [6:29:45 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-21T18:29:45:   action: 'GRACE_PERIOD_STARTED',
2025-09-21T18:29:45:   remainingMs: 240000,
2025-09-21T18:29:45:   remainingSeconds: 240,
2025-09-21T18:29:45:   details: { startupTime: 1758459585309, willExpireAt: 1758459825309 },
2025-09-21T18:29:45:   timestamp: 1758459585452
2025-09-21T18:29:45: }
2025-09-21T18:29:45: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-21T18:29:45: â° Startup grace period: 240 seconds
2025-09-21T18:29:45: ğŸ“‹ Message rules loaded: 8 types
2025-09-21T18:29:45: â„¹ï¸ [6:29:45 pm] INFO: Grace Period: STARTED {
2025-09-21T18:29:45:   action: 'STARTED',
2025-09-21T18:29:45:   remainingMs: 240000,
2025-09-21T18:29:45:   remainingSeconds: 240,
2025-09-21T18:29:45:   details: { startupTime: 1758459585309, processId: 24800 },
2025-09-21T18:29:45:   timestamp: 1758459585454
2025-09-21T18:29:45: }
2025-09-21T18:29:45: â„¹ï¸ [6:29:45 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-21T18:29:45:   action: 'GRACE_PERIOD_STARTED',
2025-09-21T18:29:45:   remainingMs: 240000,
2025-09-21T18:29:45:   remainingSeconds: 240,
2025-09-21T18:29:45:   details: { startupTime: 1758459585309, willExpireAt: 1758459825309 },
2025-09-21T18:29:45:   timestamp: 1758459585454
2025-09-21T18:29:45: }
2025-09-21T18:29:45: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-21T18:29:45: â° Startup grace period: 240 seconds
2025-09-21T18:29:45: ğŸ“‹ Message rules loaded: 8 types
2025-09-21T18:29:45: â„¹ï¸ [6:29:45 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-21T18:29:45:   initializationDuration: 146,
2025-09-21T18:29:45:   gracePeriodActive: true,
2025-09-21T18:29:45:   messageRulesCount: 8,
2025-09-21T18:29:45:   messageTypes: [
2025-09-21T18:29:45:     'welcome',
2025-09-21T18:29:45:     'confirmation',
2025-09-21T18:29:45:     'ready',
2025-09-21T18:29:45:     'delivery',
2025-09-21T18:29:45:     'pickup_reminder',
2025-09-21T18:29:45:     'payment_reminder',
2025-09-21T18:29:45:     'fabric_welcome',
2025-09-21T18:29:45:     'fabric_purchase'
2025-09-21T18:29:45:   ],
2025-09-21T18:29:45:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-21T18:29:45:   databaseReady: true,
2025-09-21T18:29:45:   loggerReady: true,
2025-09-21T18:29:45:   processIsolationActive: true
2025-09-21T18:29:45: }
2025-09-21T18:29:45: âœ… Safety Manager initialized
2025-09-21T18:29:45: â„¹ï¸ [6:29:45 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-21T18:29:45:   initializationDuration: 147,
2025-09-21T18:29:45:   gracePeriodActive: true,
2025-09-21T18:29:45:   messageRulesCount: 8,
2025-09-21T18:29:45:   messageTypes: [
2025-09-21T18:29:45:     'welcome',
2025-09-21T18:29:45:     'confirmation',
2025-09-21T18:29:45:     'ready',
2025-09-21T18:29:45:     'delivery',
2025-09-21T18:29:45:     'pickup_reminder',
2025-09-21T18:29:45:     'payment_reminder',
2025-09-21T18:29:45:     'fabric_welcome',
2025-09-21T18:29:45:     'fabric_purchase'
2025-09-21T18:29:45:   ],
2025-09-21T18:29:45:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-21T18:29:45:   databaseReady: true,
2025-09-21T18:29:45:   loggerReady: true,
2025-09-21T18:29:45:   processIsolationActive: true
2025-09-21T18:29:45: }
2025-09-21T18:29:45: ğŸ“ Loaded 3 sent messages from file
2025-09-21T18:29:45: ğŸ“ Loaded 3 customer histories from file
2025-09-21T18:29:45: ğŸ“ Loaded 3 message hashes from file
2025-09-21T18:29:45: ğŸ“ Loaded statistics from file
2025-09-21T18:29:45: âœ… Duplicate Prevention Manager initialized
2025-09-21T18:29:45: ğŸ“Š Loaded: 3 sent messages, 3 customer histories, 3 content hashes
2025-09-21T18:29:45: âœ… Duplicate Prevention Manager initialized
2025-09-21T18:29:45: ğŸ”„ Starting WhatsApp connection...
2025-09-21T18:29:45: ğŸ”„ Initializing WhatsApp client...
2025-09-21T18:29:45: âœ… WhatsApp connection started
2025-09-21T18:29:45: ğŸ”§ Initializing admin commands...
2025-09-21T18:29:45: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-21T18:29:45: âœ… Admin commands system initialized
2025-09-21T18:29:45: ğŸ”— Initializing webhook functionality...
2025-09-21T18:29:45: âœ… WhatsApp connected. Webhook system ready for real-time notifications.
2025-09-21T18:29:45: ğŸ’¡ Configure Google Apps Script webhook for instant sheet change notifications.
2025-09-21T18:29:45: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-21T18:29:45: ğŸ“ Attempting to request pairing code...
2025-09-21T18:29:45: ğŸ’¡ To use phone authentication:
2025-09-21T18:29:45:    1. Use the dashboard at http://localhost:3001
2025-09-21T18:29:45:    2. Select "Phone Number Authentication"
2025-09-21T18:29:45:    3. Enter your phone number
2025-09-21T18:29:45:    4. Get the pairing code and enter it in WhatsApp
2025-09-21T18:29:45: ğŸ”„ Connecting to WhatsApp...
2025-09-21T18:29:48: âœ… WhatsApp connected successfully!
2025-09-21T18:29:48: ğŸ”„ Enhanced client: Connected event received, forwarding...
2025-09-21T18:29:48: ğŸ“± Session established successfully
2025-09-21T18:29:48: ğŸ”’ Session will be monitored for stability
2025-09-21T18:30:15: ğŸ’¾ Data synced to files successfully
2025-09-21T18:30:45: ğŸ’¾ Data synced to files successfully
2025-09-21T18:31:15: ğŸ’¾ Data synced to files successfully
2025-09-21T18:31:45: ğŸ’¾ Data synced to files successfully
2025-09-21T18:32:15: ğŸ’¾ Data synced to files successfully
2025-09-21T18:32:36: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-21T18:32:36: ğŸ“ Loaded 11 template types
2025-09-21T18:32:36: ğŸ”§ WhatsApp Bot initialized
2025-09-21T18:32:36: ğŸ“Š Configuration status: undefined
2025-09-21T18:32:36: âœ… Atomic State Manager initialized
2025-09-21T18:32:36: ğŸ“ Enhanced Logger initialized
2025-09-21T18:32:36: âœ… Google credentials loaded from service-account.json file
2025-09-21T18:32:36: ğŸ“± WhatsApp auth status: âœ… credentials, 8 session files
2025-09-21T18:32:36: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-21T18:32:36:    Auth Mode: both
2025-09-21T18:32:36:    QR Enabled: true
2025-09-21T18:32:36:    Phone Enabled: true
2025-09-21T18:32:36:    Session Persistence: true
2025-09-21T18:32:36:    Max Reconnect Attempts: 10
2025-09-21T18:32:36:    Default Phone: None
2025-09-21T18:32:36: ğŸ”’ Session validation enabled (check every 300s)
2025-09-21T18:32:36: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-21T18:32:36: ğŸ”§ Developer Configuration initialized
2025-09-21T18:32:36: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-21T18:32:36: â„¹ï¸ [6:32:36 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-21T18:32:36:   startupTime: 1758459756780,
2025-09-21T18:32:36:   gracePeriodMs: 240000,
2025-09-21T18:32:36:   dataDir: './safety-data',
2025-09-21T18:32:36:   dbPath: 'safety-data\\safety-database.db',
2025-09-21T18:32:36:   processId: 12324,
2025-09-21T18:32:36:   nodeVersion: 'v22.19.0'
2025-09-21T18:32:36: }
2025-09-21T18:32:36: ğŸ”§ Developer Configuration initialized
2025-09-21T18:32:36: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-21T18:32:36: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-21T18:32:36: â° 4-minute startup delay active
2025-09-21T18:32:36: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-21T18:32:36: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-21T18:32:36: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-21T18:32:36: â„¹ï¸ [6:32:36 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-21T18:32:36:   startupTime: 1758459756780,
2025-09-21T18:32:36:   gracePeriodMs: 240000,
2025-09-21T18:32:36:   dataDir: './safety-data',
2025-09-21T18:32:36:   dbPath: 'safety-data\\safety-database.db',
2025-09-21T18:32:36:   processId: 12324,
2025-09-21T18:32:36:   nodeVersion: 'v22.19.0'
2025-09-21T18:32:36: }
2025-09-21T18:32:36: ğŸ“ Loaded 3 sent messages from file
2025-09-21T18:32:36: â„¹ï¸ [6:32:36 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-21T18:32:36: â„¹ï¸ [6:32:36 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-21T18:32:36: ğŸ“ Loaded 3 customer histories from file
2025-09-21T18:32:36: ğŸ“ Loaded 3 message hashes from file
2025-09-21T18:32:36: ğŸ“ Loaded statistics from file
2025-09-21T18:32:36: âœ… Duplicate Prevention Manager initialized
2025-09-21T18:32:36: ğŸ“Š Loaded: 3 sent messages, 3 customer histories, 3 content hashes
2025-09-21T18:32:36: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T11-59-46-346Z.log
2025-09-21T18:32:36: ğŸ“ Enhanced Logger initialized
2025-09-21T18:32:36: â„¹ï¸ [6:32:36 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-21T18:32:36: â„¹ï¸ [6:32:36 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-21T18:32:36: ğŸ§¹ Removed stale process lock
2025-09-21T18:32:36: âš ï¸ Warning: Could not remove lock file: EPERM: operation not permitted, unlink 'C:\Users\gssai\OneDrive\Desktop\Whatsapp-Moblie-Bot\safety-data\process.lock'
2025-09-21T18:32:36: ğŸ”’ Process lock acquired (PID: 12324)
2025-09-21T18:32:36: ğŸ”’ Process lock acquired (PID: 12324)
2025-09-21T18:32:36: â„¹ï¸ [6:32:36 pm] INFO: Process isolation enforced {
2025-09-21T18:32:36:   lockFile: 'safety-data\\process.lock',
2025-09-21T18:32:36:   pidFile: 'safety-data\\process.pid',
2025-09-21T18:32:36:   processId: 12324
2025-09-21T18:32:36: }
2025-09-21T18:32:36: â° Starting 240 second startup grace period...
2025-09-21T18:32:36: ğŸš« All message sending is BLOCKED during grace period
2025-09-21T18:32:36: â„¹ï¸ [6:32:36 pm] INFO: Process isolation enforced {
2025-09-21T18:32:36:   lockFile: 'safety-data\\process.lock',
2025-09-21T18:32:36:   pidFile: 'safety-data\\process.pid',
2025-09-21T18:32:36:   processId: 12324
2025-09-21T18:32:36: }
2025-09-21T18:32:36: â° Starting 240 second startup grace period...
2025-09-21T18:32:36: ğŸš« All message sending is BLOCKED during grace period
2025-09-21T18:32:36: â„¹ï¸ [6:32:36 pm] INFO: Grace Period: STARTED {
2025-09-21T18:32:36:   action: 'STARTED',
2025-09-21T18:32:36:   remainingMs: 240000,
2025-09-21T18:32:36:   remainingSeconds: 240,
2025-09-21T18:32:36:   details: { startupTime: 1758459756780, processId: 12324 },
2025-09-21T18:32:36:   timestamp: 1758459756894
2025-09-21T18:32:36: }
2025-09-21T18:32:36: â„¹ï¸ [6:32:36 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-21T18:32:36:   action: 'GRACE_PERIOD_STARTED',
2025-09-21T18:32:36:   remainingMs: 240000,
2025-09-21T18:32:36:   remainingSeconds: 240,
2025-09-21T18:32:36:   details: { startupTime: 1758459756780, willExpireAt: 1758459996780 },
2025-09-21T18:32:36:   timestamp: 1758459756894
2025-09-21T18:32:36: }
2025-09-21T18:32:36: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-21T18:32:36: â° Startup grace period: 240 seconds
2025-09-21T18:32:36: ğŸ“‹ Message rules loaded: 8 types
2025-09-21T18:32:36: â„¹ï¸ [6:32:36 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-21T18:32:36:   action: 'GRACE_PERIOD_STARTED',
2025-09-21T18:32:36:   remainingMs: 240000,
2025-09-21T18:32:36:   remainingSeconds: 240,
2025-09-21T18:32:36:   details: { startupTime: 1758459756780, willExpireAt: 1758459996780 },
2025-09-21T18:32:36:   timestamp: 1758459756897
2025-09-21T18:32:36: }
2025-09-21T18:32:36: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-21T18:32:36: â° Startup grace period: 240 seconds
2025-09-21T18:32:36: ğŸ“‹ Message rules loaded: 8 types
2025-09-21T18:32:36: â„¹ï¸ [6:32:36 pm] INFO: Grace Period: STARTED {
2025-09-21T18:32:36:   action: 'STARTED',
2025-09-21T18:32:36:   remainingMs: 240000,
2025-09-21T18:32:36:   remainingSeconds: 240,
2025-09-21T18:32:36:   details: { startupTime: 1758459756780, processId: 12324 },
2025-09-21T18:32:36:   timestamp: 1758459756896
2025-09-21T18:32:36: }
2025-09-21T18:32:36: â„¹ï¸ [6:32:36 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-21T18:32:36:   initializationDuration: 118,
2025-09-21T18:32:36:   gracePeriodActive: true,
2025-09-21T18:32:36:   messageRulesCount: 8,
2025-09-21T18:32:36:   messageTypes: [
2025-09-21T18:32:36:     'welcome',
2025-09-21T18:32:36:     'confirmation',
2025-09-21T18:32:36:     'ready',
2025-09-21T18:32:36:     'delivery',
2025-09-21T18:32:36:     'pickup_reminder',
2025-09-21T18:32:36:     'payment_reminder',
2025-09-21T18:32:36:     'fabric_welcome',
2025-09-21T18:32:36:     'fabric_purchase'
2025-09-21T18:32:36:   ],
2025-09-21T18:32:36:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-21T18:32:36:   databaseReady: true,
2025-09-21T18:32:36:   loggerReady: true,
2025-09-21T18:32:36:   processIsolationActive: true
2025-09-21T18:32:36: }
2025-09-21T18:32:36: âœ… Safety Manager initialized
2025-09-21T18:32:36: â„¹ï¸ [6:32:36 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-21T18:32:36:   initializationDuration: 120,
2025-09-21T18:32:36:   gracePeriodActive: true,
2025-09-21T18:32:36:   messageRulesCount: 8,
2025-09-21T18:32:36:   messageTypes: [
2025-09-21T18:32:36:     'welcome',
2025-09-21T18:32:36:     'confirmation',
2025-09-21T18:32:36:     'ready',
2025-09-21T18:32:36:     'delivery',
2025-09-21T18:32:36:     'pickup_reminder',
2025-09-21T18:32:36:     'payment_reminder',
2025-09-21T18:32:36:     'fabric_welcome',
2025-09-21T18:32:36:     'fabric_purchase'
2025-09-21T18:32:36:   ],
2025-09-21T18:32:36:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-21T18:32:36:   databaseReady: true,
2025-09-21T18:32:36:   loggerReady: true,
2025-09-21T18:32:36:   processIsolationActive: true
2025-09-21T18:32:36: }
2025-09-21T18:32:36: ğŸ“ Loaded 3 sent messages from file
2025-09-21T18:32:36: ğŸ“ Loaded 3 customer histories from file
2025-09-21T18:32:36: ğŸ“ Loaded 3 message hashes from file
2025-09-21T18:32:36: ğŸ“ Loaded statistics from file
2025-09-21T18:32:36: âœ… Duplicate Prevention Manager initialized
2025-09-21T18:32:36: ğŸ“Š Loaded: 3 sent messages, 3 customer histories, 3 content hashes
2025-09-21T18:32:36: âœ… Duplicate Prevention Manager initialized
2025-09-21T18:32:36: ğŸ”„ Starting WhatsApp connection...
2025-09-21T18:32:36: ğŸ”„ Initializing WhatsApp client...
2025-09-21T18:32:36: âœ… WhatsApp connection started
2025-09-21T18:32:36: ğŸ”§ Initializing admin commands...
2025-09-21T18:32:36: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-21T18:32:36: âœ… Admin commands system initialized
2025-09-21T18:32:36: ğŸ”— Initializing webhook functionality...
2025-09-21T18:32:36: âœ… WhatsApp connected. Webhook system ready for real-time notifications.
2025-09-21T18:32:36: ğŸ’¡ Configure Google Apps Script webhook for instant sheet change notifications.
2025-09-21T18:32:36: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-21T18:32:36: ğŸ“ Attempting to request pairing code...
2025-09-21T18:32:36: ğŸ’¡ To use phone authentication:
2025-09-21T18:32:36:    1. Use the dashboard at http://localhost:3001
2025-09-21T18:32:36:    2. Select "Phone Number Authentication"
2025-09-21T18:32:36:    3. Enter your phone number
2025-09-21T18:32:36:    4. Get the pairing code and enter it in WhatsApp
2025-09-21T18:32:36: ğŸ”„ Connecting to WhatsApp...
2025-09-21T18:33:06: ğŸ’¾ Data synced to files successfully
2025-09-21T18:33:18: âœ… WhatsApp connected successfully!
2025-09-21T18:33:18: ğŸ”„ Enhanced client: Connected event received, forwarding...
2025-09-21T18:33:18: ğŸ“± Session established successfully
2025-09-21T18:33:18: ğŸ”’ Session will be monitored for stability
2025-09-21T18:33:36: ğŸ’¾ Data synced to files successfully
2025-09-21T18:34:06: ğŸ’¾ Data synced to files successfully
2025-09-21T18:34:36: ğŸ’¾ Data synced to files successfully
2025-09-21T18:35:06: ğŸ’¾ Data synced to files successfully
2025-09-21T18:35:36: ğŸ’¾ Data synced to files successfully
2025-09-21T18:36:06: ğŸ’¾ Data synced to files successfully
2025-09-21T18:36:36: âœ… Startup grace period ended - message sending now allowed
2025-09-21T18:36:36: âœ… Startup grace period ended - message sending now allowed
2025-09-21T18:36:36: ğŸ’¾ Data synced to files successfully
2025-09-21T18:36:37: â„¹ï¸ [6:36:36 pm] INFO: Grace Period: ENDED {
2025-09-21T18:36:37:   action: 'ENDED',
2025-09-21T18:36:37:   remainingMs: 0,
2025-09-21T18:36:37:   remainingSeconds: 0,
2025-09-21T18:36:37:   details: { totalDuration: 240000, processId: 12324 },
2025-09-21T18:36:37:   timestamp: 1758459996950
2025-09-21T18:36:37: }
2025-09-21T18:36:37: â„¹ï¸ [6:36:37 pm] INFO: Grace Period: ENDED {
2025-09-21T18:36:37:   action: 'ENDED',
2025-09-21T18:36:37:   remainingMs: 0,
2025-09-21T18:36:37:   remainingSeconds: 0,
2025-09-21T18:36:37:   details: { totalDuration: 240000, processId: 12324 },
2025-09-21T18:36:37:   timestamp: 1758459996982
2025-09-21T18:36:37: }
2025-09-21T18:36:37: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-21T18:36:37: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-21T18:37:06: ğŸ’¾ Data synced to files successfully
2025-09-21T18:37:36: ğŸ’¾ Data synced to files successfully
2025-09-21T18:37:46: ğŸ” [917375938371] Starting comprehensive message safety check...
2025-09-21T18:37:46: ğŸ“‹ [917375938371] Order: TEST-1758460066400, Type: test
2025-09-21T18:37:46: âš ï¸ ALL SAFETY CHECKS DISABLED - SENDING MESSAGE DIRECTLY (EMERGENCY MODE)
2025-09-21T18:38:04: âœ… Message sent to 917375938371@s.whatsapp.net
2025-09-21T18:38:06: ğŸ’¾ Data synced to files successfully
2025-09-21T18:38:36: ğŸ’¾ Data synced to files successfully
2025-09-21T18:39:06: ğŸ’¾ Data synced to files successfully
2025-09-21T18:39:36: ğŸ’¾ Data synced to files successfully
2025-09-21T18:40:06: ğŸ’¾ Data synced to files successfully
2025-09-21T18:40:10: ğŸ”Œ Connection closed. Reason: undefined
2025-09-21T18:40:10: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-21T18:40:10: ğŸ”„ Reconnecting in 1s... (Attempt 1/10)
2025-09-21T18:40:10: {"level":50,"time":1758460210040,"pid":12324,"hostname":"SAURABH","msg":"error in sending keep alive"}
2025-09-21T18:40:11: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-21T18:40:11: â„¹ï¸ [6:40:11 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-21T18:40:11:   startupTime: 1758459756780,
2025-09-21T18:40:11:   gracePeriodMs: 240000,
2025-09-21T18:40:11:   dataDir: './safety-data',
2025-09-21T18:40:11:   dbPath: 'safety-data\\safety-database.db',
2025-09-21T18:40:11:   processId: 12324,
2025-09-21T18:40:11:   nodeVersion: 'v22.19.0'
2025-09-21T18:40:11: }
2025-09-21T18:40:11: â„¹ï¸ [6:40:11 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-21T18:40:11: â„¹ï¸ [6:40:11 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-21T18:40:11: ğŸ§¹ Removed stale process lock
2025-09-21T18:40:11: ğŸ”’ Process lock acquired (PID: 12324)
2025-09-21T18:40:11: â„¹ï¸ [6:40:11 pm] INFO: Process isolation enforced {
2025-09-21T18:40:11:   lockFile: 'safety-data\\process.lock',
2025-09-21T18:40:11:   pidFile: 'safety-data\\process.pid',
2025-09-21T18:40:11:   processId: 12324
2025-09-21T18:40:11: }
2025-09-21T18:40:11: â° Starting 240 second startup grace period...
2025-09-21T18:40:11: ğŸš« All message sending is BLOCKED during grace period
2025-09-21T18:40:11: â„¹ï¸ [6:40:11 pm] INFO: Grace Period: STARTED {
2025-09-21T18:40:11:   action: 'STARTED',
2025-09-21T18:40:11:   remainingMs: 240000,
2025-09-21T18:40:11:   remainingSeconds: 240,
2025-09-21T18:40:11:   details: { startupTime: 1758459756780, processId: 12324 },
2025-09-21T18:40:11:   timestamp: 1758460211116
2025-09-21T18:40:11: }
2025-09-21T18:40:11: â„¹ï¸ [6:40:11 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-21T18:40:11:   action: 'GRACE_PERIOD_STARTED',
2025-09-21T18:40:11:   remainingMs: 240000,
2025-09-21T18:40:11:   remainingSeconds: 240,
2025-09-21T18:40:11:   details: { startupTime: 1758459756780, willExpireAt: 1758459996780 },
2025-09-21T18:40:11:   timestamp: 1758460211116
2025-09-21T18:40:11: }
2025-09-21T18:40:11: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-21T18:40:11: â° Startup grace period: 240 seconds
2025-09-21T18:40:11: ğŸ“‹ Message rules loaded: 8 types
2025-09-21T18:40:11: â„¹ï¸ [6:40:11 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-21T18:40:11:   initializationDuration: 454344,
2025-09-21T18:40:11:   gracePeriodActive: false,
2025-09-21T18:40:11:   messageRulesCount: 8,
2025-09-21T18:40:11:   messageTypes: [
2025-09-21T18:40:11:     'welcome',
2025-09-21T18:40:11:     'confirmation',
2025-09-21T18:40:11:     'ready',
2025-09-21T18:40:11:     'delivery',
2025-09-21T18:40:11:     'pickup_reminder',
2025-09-21T18:40:11:     'payment_reminder',
2025-09-21T18:40:11:     'fabric_welcome',
2025-09-21T18:40:11:     'fabric_purchase'
2025-09-21T18:40:11:   ],
2025-09-21T18:40:11:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-21T18:40:11:   databaseReady: true,
2025-09-21T18:40:11:   loggerReady: true,
2025-09-21T18:40:11:   processIsolationActive: true
2025-09-21T18:40:11: }
2025-09-21T18:40:11: âœ… Safety Manager initialized
2025-09-21T18:40:11: ğŸ“ Loaded 3 sent messages from file
2025-09-21T18:40:11: ğŸ“ Loaded 3 customer histories from file
2025-09-21T18:40:11: ğŸ“ Loaded 3 message hashes from file
2025-09-21T18:40:11: ğŸ“ Loaded statistics from file
2025-09-21T18:40:11: âœ… Duplicate Prevention Manager initialized
2025-09-21T18:40:11: ğŸ“Š Loaded: 3 sent messages, 3 customer histories, 3 content hashes
2025-09-21T18:40:11: âœ… Duplicate Prevention Manager initialized
2025-09-21T18:40:11: ğŸ”„ Starting WhatsApp connection...
2025-09-21T18:40:11: ğŸ”„ Initializing WhatsApp client...
2025-09-21T18:40:11: âœ… WhatsApp connection started
2025-09-21T18:40:11: ğŸ”§ Initializing admin commands...
2025-09-21T18:40:11: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-21T18:40:11: âœ… Admin commands system initialized
2025-09-21T18:40:11: ğŸ”— Initializing webhook functionality...
2025-09-21T18:40:11: âœ… WhatsApp connected. Webhook system ready for real-time notifications.
2025-09-21T18:40:11: ğŸ’¡ Configure Google Apps Script webhook for instant sheet change notifications.
2025-09-21T18:40:11: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-21T18:40:11: ğŸ“ Attempting to request pairing code...
2025-09-21T18:40:11: ğŸ’¡ To use phone authentication:
2025-09-21T18:40:11:    1. Use the dashboard at http://localhost:3001
2025-09-21T18:40:11:    2. Select "Phone Number Authentication"
2025-09-21T18:40:11:    3. Enter your phone number
2025-09-21T18:40:11:    4. Get the pairing code and enter it in WhatsApp
2025-09-21T18:40:11: ğŸ”„ Connecting to WhatsApp...
2025-09-21T18:40:18: ğŸ”Œ Connection closed. Reason: undefined
2025-09-21T18:40:18: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-21T18:40:18: ğŸ”„ Reconnecting in 2s... (Attempt 2/10)
2025-09-21T18:40:20: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-21T18:40:20: â„¹ï¸ [6:40:20 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-21T18:40:20:   startupTime: 1758459756780,
2025-09-21T18:40:20:   gracePeriodMs: 240000,
2025-09-21T18:40:20:   dataDir: './safety-data',
2025-09-21T18:40:20:   dbPath: 'safety-data\\safety-database.db',
2025-09-21T18:40:20:   processId: 12324,
2025-09-21T18:40:20:   nodeVersion: 'v22.19.0'
2025-09-21T18:40:20: }
2025-09-21T18:40:20: â„¹ï¸ [6:40:20 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-21T18:40:20: â„¹ï¸ [6:40:20 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-21T18:40:20: ğŸ§¹ Removed stale process lock
2025-09-21T18:40:20: ğŸ”’ Process lock acquired (PID: 12324)
2025-09-21T18:40:20: â„¹ï¸ [6:40:20 pm] INFO: Process isolation enforced {
2025-09-21T18:40:20:   lockFile: 'safety-data\\process.lock',
2025-09-21T18:40:20:   pidFile: 'safety-data\\process.pid',
2025-09-21T18:40:20:   processId: 12324
2025-09-21T18:40:20: }
2025-09-21T18:40:20: â° Starting 240 second startup grace period...
2025-09-21T18:40:20: ğŸš« All message sending is BLOCKED during grace period
2025-09-21T18:40:20: â„¹ï¸ [6:40:20 pm] INFO: Grace Period: STARTED {
2025-09-21T18:40:20:   action: 'STARTED',
2025-09-21T18:40:20:   remainingMs: 240000,
2025-09-21T18:40:20:   remainingSeconds: 240,
2025-09-21T18:40:20:   details: { startupTime: 1758459756780, processId: 12324 },
2025-09-21T18:40:20:   timestamp: 1758460220371
2025-09-21T18:40:20: }
2025-09-21T18:40:20: â„¹ï¸ [6:40:20 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-21T18:40:20:   action: 'GRACE_PERIOD_STARTED',
2025-09-21T18:40:20:   remainingMs: 240000,
2025-09-21T18:40:20:   remainingSeconds: 240,
2025-09-21T18:40:20:   details: { startupTime: 1758459756780, willExpireAt: 1758459996780 },
2025-09-21T18:40:20:   timestamp: 1758460220372
2025-09-21T18:40:20: }
2025-09-21T18:40:20: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-21T18:40:20: â° Startup grace period: 240 seconds
2025-09-21T18:40:20: ğŸ“‹ Message rules loaded: 8 types
2025-09-21T18:40:20: â„¹ï¸ [6:40:20 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-21T18:40:20:   initializationDuration: 463594,
2025-09-21T18:40:20:   gracePeriodActive: false,
2025-09-21T18:40:20:   messageRulesCount: 8,
2025-09-21T18:40:20:   messageTypes: [
2025-09-21T18:40:20:     'welcome',
2025-09-21T18:40:20:     'confirmation',
2025-09-21T18:40:20:     'ready',
2025-09-21T18:40:20:     'delivery',
2025-09-21T18:40:20:     'pickup_reminder',
2025-09-21T18:40:20:     'payment_reminder',
2025-09-21T18:40:20:     'fabric_welcome',
2025-09-21T18:40:20:     'fabric_purchase'
2025-09-21T18:40:20:   ],
2025-09-21T18:40:20:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-21T18:40:20:   databaseReady: true,
2025-09-21T18:40:20:   loggerReady: true,
2025-09-21T18:40:20:   processIsolationActive: true
2025-09-21T18:40:20: }
2025-09-21T18:40:20: âœ… Safety Manager initialized
2025-09-21T18:40:20: ğŸ“ Loaded 3 sent messages from file
2025-09-21T18:40:20: ğŸ“ Loaded 3 customer histories from file
2025-09-21T18:40:20: ğŸ“ Loaded 3 message hashes from file
2025-09-21T18:40:20: ğŸ“ Loaded statistics from file
2025-09-21T18:40:20: âœ… Duplicate Prevention Manager initialized
2025-09-21T18:40:20: ğŸ“Š Loaded: 3 sent messages, 3 customer histories, 3 content hashes
2025-09-21T18:40:20: âœ… Duplicate Prevention Manager initialized
2025-09-21T18:40:20: ğŸ”„ Starting WhatsApp connection...
2025-09-21T18:40:20: ğŸ”„ Initializing WhatsApp client...
2025-09-21T18:40:20: âœ… WhatsApp connection started
2025-09-21T18:40:20: ğŸ”§ Initializing admin commands...
2025-09-21T18:40:20: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-21T18:40:20: âœ… Admin commands system initialized
2025-09-21T18:40:20: ğŸ”— Initializing webhook functionality...
2025-09-21T18:40:20: âœ… WhatsApp connected. Webhook system ready for real-time notifications.
2025-09-21T18:40:20: ğŸ’¡ Configure Google Apps Script webhook for instant sheet change notifications.
2025-09-21T18:40:20: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-21T18:40:20: ğŸ“ Attempting to request pairing code...
2025-09-21T18:40:20: ğŸ’¡ To use phone authentication:
2025-09-21T18:40:20:    1. Use the dashboard at http://localhost:3001
2025-09-21T18:40:20:    2. Select "Phone Number Authentication"
2025-09-21T18:40:20:    3. Enter your phone number
2025-09-21T18:40:20:    4. Get the pairing code and enter it in WhatsApp
2025-09-21T18:40:20: ğŸ”„ Connecting to WhatsApp...
2025-09-21T18:40:25: âœ… WhatsApp connected successfully!
2025-09-21T18:40:25: ğŸ”„ Enhanced client: Connected event received, forwarding...
2025-09-21T18:40:25: ğŸ“± Session established successfully
2025-09-21T18:40:25: ğŸ”’ Session will be monitored for stability
2025-09-21T18:40:36: ğŸ’¾ Data synced to files successfully
2025-09-21T18:41:06: ğŸ’¾ Data synced to files successfully
2025-09-21T18:41:36: ğŸ’¾ Data synced to files successfully
2025-09-21T18:41:48: âœ… Optimized Message Templates initialized (Hindi only)
2025-09-21T18:41:48: ğŸ“ Loaded 11 template types
2025-09-21T18:41:48: ğŸ”§ WhatsApp Bot initialized
2025-09-21T18:41:48: ğŸ“Š Configuration status: undefined
2025-09-21T18:41:48: âœ… Atomic State Manager initialized
2025-09-21T18:41:48: ğŸ“ Enhanced Logger initialized
2025-09-21T18:41:48: âœ… Google credentials loaded from service-account.json file
2025-09-21T18:41:48: ğŸ“± WhatsApp auth status: âœ… credentials, 8 session files
2025-09-21T18:41:48: ğŸ”§ WhatsApp Authentication Configuration:
2025-09-21T18:41:48:    Auth Mode: both
2025-09-21T18:41:48:    QR Enabled: true
2025-09-21T18:41:48:    Phone Enabled: true
2025-09-21T18:41:48:    Session Persistence: true
2025-09-21T18:41:48:    Max Reconnect Attempts: 10
2025-09-21T18:41:48:    Default Phone: None
2025-09-21T18:41:48: ğŸ”’ Session validation enabled (check every 300s)
2025-09-21T18:41:48: ğŸ”§ WhatsApp client initialized with auth mode: both
2025-09-21T18:41:48: ğŸ”§ Developer Configuration initialized
2025-09-21T18:41:48: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-21T18:41:48: â„¹ï¸ [6:41:48 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-21T18:41:48:   startupTime: 1758460308065,
2025-09-21T18:41:48:   gracePeriodMs: 240000,
2025-09-21T18:41:48:   dataDir: './safety-data',
2025-09-21T18:41:48:   dbPath: 'safety-data\\safety-database.db',
2025-09-21T18:41:48:   processId: 25964,
2025-09-21T18:41:48:   nodeVersion: 'v22.19.0'
2025-09-21T18:41:48: }
2025-09-21T18:41:48: ğŸ”§ Developer Configuration initialized
2025-09-21T18:41:48: ğŸ“± Developer phones whitelisted: 917375938371, 919166758467, 916375623182
2025-09-21T18:41:48: ğŸ›¡ï¸ Enhanced WhatsApp Client with comprehensive safety initialized
2025-09-21T18:41:48: â° 4-minute startup delay active
2025-09-21T18:41:48: ğŸ”’ Triple-layer duplicate prevention enabled
2025-09-21T18:41:48: âš¡ Circuit breaker limits: Daily=10, Hourly=3
2025-09-21T18:41:48: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-21T18:41:48: â„¹ï¸ [6:41:48 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-21T18:41:48:   startupTime: 1758460308065,
2025-09-21T18:41:48:   gracePeriodMs: 240000,
2025-09-21T18:41:48:   dataDir: './safety-data',
2025-09-21T18:41:48:   dbPath: 'safety-data\\safety-database.db',
2025-09-21T18:41:48:   processId: 25964,
2025-09-21T18:41:48:   nodeVersion: 'v22.19.0'
2025-09-21T18:41:48: }
2025-09-21T18:41:48: ğŸ“ Loaded 3 sent messages from file
2025-09-21T18:41:48: â„¹ï¸ [6:41:48 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-21T18:41:48: â„¹ï¸ [6:41:48 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-21T18:41:48: ğŸ“ Loaded 3 customer histories from file
2025-09-21T18:41:48: ğŸ“ Loaded 3 message hashes from file
2025-09-21T18:41:48: ğŸ—‘ï¸ Deleted old log file: bot-2025-09-20T13-33-48-731Z.log
2025-09-21T18:41:48: ğŸ“ Enhanced Logger initialized
2025-09-21T18:41:48: ğŸ“ Loaded statistics from file
2025-09-21T18:41:48: âœ… Duplicate Prevention Manager initialized
2025-09-21T18:41:48: ğŸ“Š Loaded: 3 sent messages, 3 customer histories, 3 content hashes
2025-09-21T18:41:48: â„¹ï¸ [6:41:48 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-21T18:41:48: â„¹ï¸ [6:41:48 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-21T18:41:48: ğŸ§¹ Lock file already cleaned up
2025-09-21T18:41:48: ğŸ§¹ Removed stale process lock
2025-09-21T18:41:48: ğŸ”’ Process lock acquired (PID: 25964)
2025-09-21T18:41:48: ğŸ”’ Process lock acquired (PID: 25964)
2025-09-21T18:41:48: â„¹ï¸ [6:41:48 pm] INFO: Process isolation enforced {
2025-09-21T18:41:48:   lockFile: 'safety-data\\process.lock',
2025-09-21T18:41:48:   pidFile: 'safety-data\\process.pid',
2025-09-21T18:41:48:   processId: 25964
2025-09-21T18:41:48: }
2025-09-21T18:41:48: â° Starting 240 second startup grace period...
2025-09-21T18:41:48: ğŸš« All message sending is BLOCKED during grace period
2025-09-21T18:41:48: â„¹ï¸ [6:41:48 pm] INFO: Process isolation enforced {
2025-09-21T18:41:48:   lockFile: 'safety-data\\process.lock',
2025-09-21T18:41:48:   pidFile: 'safety-data\\process.pid',
2025-09-21T18:41:48:   processId: 25964
2025-09-21T18:41:48: }
2025-09-21T18:41:48: â° Starting 240 second startup grace period...
2025-09-21T18:41:48: ğŸš« All message sending is BLOCKED during grace period
2025-09-21T18:41:48: â„¹ï¸ [6:41:48 pm] INFO: Grace Period: STARTED {
2025-09-21T18:41:48:   action: 'STARTED',
2025-09-21T18:41:48:   remainingMs: 240000,
2025-09-21T18:41:48:   remainingSeconds: 240,
2025-09-21T18:41:48:   details: { startupTime: 1758460308065, processId: 25964 },
2025-09-21T18:41:48:   timestamp: 1758460308184
2025-09-21T18:41:48: }
2025-09-21T18:41:48: â„¹ï¸ [6:41:48 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-21T18:41:48:   action: 'GRACE_PERIOD_STARTED',
2025-09-21T18:41:48:   remainingMs: 240000,
2025-09-21T18:41:48:   remainingSeconds: 240,
2025-09-21T18:41:48:   details: { startupTime: 1758460308065, willExpireAt: 1758460548065 },
2025-09-21T18:41:48:   timestamp: 1758460308184
2025-09-21T18:41:48: }
2025-09-21T18:41:48: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-21T18:41:48: â° Startup grace period: 240 seconds
2025-09-21T18:41:48: ğŸ“‹ Message rules loaded: 8 types
2025-09-21T18:41:48: â„¹ï¸ [6:41:48 pm] INFO: Grace Period: STARTED {
2025-09-21T18:41:48:   action: 'STARTED',
2025-09-21T18:41:48:   remainingMs: 240000,
2025-09-21T18:41:48:   remainingSeconds: 240,
2025-09-21T18:41:48:   details: { startupTime: 1758460308065, processId: 25964 },
2025-09-21T18:41:48:   timestamp: 1758460308186
2025-09-21T18:41:48: }
2025-09-21T18:41:48: â„¹ï¸ [6:41:48 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-21T18:41:48:   action: 'GRACE_PERIOD_STARTED',
2025-09-21T18:41:48:   remainingMs: 240000,
2025-09-21T18:41:48:   remainingSeconds: 240,
2025-09-21T18:41:48:   details: { startupTime: 1758460308065, willExpireAt: 1758460548065 },
2025-09-21T18:41:48:   timestamp: 1758460308186
2025-09-21T18:41:48: }
2025-09-21T18:41:48: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-21T18:41:48: â° Startup grace period: 240 seconds
2025-09-21T18:41:48: ğŸ“‹ Message rules loaded: 8 types
2025-09-21T18:41:48: â„¹ï¸ [6:41:48 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-21T18:41:48:   initializationDuration: 122,
2025-09-21T18:41:48:   gracePeriodActive: true,
2025-09-21T18:41:48:   messageRulesCount: 8,
2025-09-21T18:41:48:   messageTypes: [
2025-09-21T18:41:48:     'welcome',
2025-09-21T18:41:48:     'confirmation',
2025-09-21T18:41:48:     'ready',
2025-09-21T18:41:48:     'delivery',
2025-09-21T18:41:48:     'pickup_reminder',
2025-09-21T18:41:48:     'payment_reminder',
2025-09-21T18:41:48:     'fabric_welcome',
2025-09-21T18:41:48:     'fabric_purchase'
2025-09-21T18:41:48:   ],
2025-09-21T18:41:48:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-21T18:41:48:   databaseReady: true,
2025-09-21T18:41:48:   loggerReady: true,
2025-09-21T18:41:48:   processIsolationActive: true
2025-09-21T18:41:48: }
2025-09-21T18:41:48: âœ… Safety Manager initialized
2025-09-21T18:41:48: â„¹ï¸ [6:41:48 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-21T18:41:48:   initializationDuration: 124,
2025-09-21T18:41:48:   gracePeriodActive: true,
2025-09-21T18:41:48:   messageRulesCount: 8,
2025-09-21T18:41:48:   messageTypes: [
2025-09-21T18:41:48:     'welcome',
2025-09-21T18:41:48:     'confirmation',
2025-09-21T18:41:48:     'ready',
2025-09-21T18:41:48:     'delivery',
2025-09-21T18:41:48:     'pickup_reminder',
2025-09-21T18:41:48:     'payment_reminder',
2025-09-21T18:41:48:     'fabric_welcome',
2025-09-21T18:41:48:     'fabric_purchase'
2025-09-21T18:41:48:   ],
2025-09-21T18:41:48:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-21T18:41:48:   databaseReady: true,
2025-09-21T18:41:48:   loggerReady: true,
2025-09-21T18:41:48:   processIsolationActive: true
2025-09-21T18:41:48: }
2025-09-21T18:41:48: ğŸ“ Loaded 3 sent messages from file
2025-09-21T18:41:48: ğŸ“ Loaded 3 customer histories from file
2025-09-21T18:41:48: ğŸ“ Loaded 3 message hashes from file
2025-09-21T18:41:48: ğŸ“ Loaded statistics from file
2025-09-21T18:41:48: âœ… Duplicate Prevention Manager initialized
2025-09-21T18:41:48: ğŸ“Š Loaded: 3 sent messages, 3 customer histories, 3 content hashes
2025-09-21T18:41:48: âœ… Duplicate Prevention Manager initialized
2025-09-21T18:41:48: ğŸ”„ Starting WhatsApp connection...
2025-09-21T18:41:48: ğŸ”„ Initializing WhatsApp client...
2025-09-21T18:41:48: âœ… WhatsApp connection started
2025-09-21T18:41:48: ğŸ”§ Initializing admin commands...
2025-09-21T18:41:48: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-21T18:41:48: âœ… Admin commands system initialized
2025-09-21T18:41:48: ğŸ”— Initializing webhook functionality...
2025-09-21T18:41:48: âœ… WhatsApp connected. Webhook system ready for real-time notifications.
2025-09-21T18:41:48: ğŸ’¡ Configure Google Apps Script webhook for instant sheet change notifications.
2025-09-21T18:41:48: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-21T18:41:48: ğŸ“ Attempting to request pairing code...
2025-09-21T18:41:48: ğŸ’¡ To use phone authentication:
2025-09-21T18:41:48:    1. Use the dashboard at http://localhost:3001
2025-09-21T18:41:48:    2. Select "Phone Number Authentication"
2025-09-21T18:41:48:    3. Enter your phone number
2025-09-21T18:41:48:    4. Get the pairing code and enter it in WhatsApp
2025-09-21T18:41:48: ğŸ”„ Connecting to WhatsApp...
2025-09-21T18:41:49: âœ… WhatsApp connected successfully!
2025-09-21T18:41:49: ğŸ”„ Enhanced client: Connected event received, forwarding...
2025-09-21T18:41:49: ğŸ“± Session established successfully
2025-09-21T18:41:49: ğŸ”’ Session will be monitored for stability
2025-09-21T18:42:18: ğŸ’¾ Data synced to files successfully
2025-09-21T18:42:48: ğŸ’¾ Data synced to files successfully
2025-09-21T18:43:18: ğŸ’¾ Data synced to files successfully
2025-09-21T18:43:48: ğŸ’¾ Data synced to files successfully
2025-09-21T18:44:18: ğŸ’¾ Data synced to files successfully
2025-09-21T18:44:48: ğŸ’¾ Data synced to files successfully
2025-09-21T18:45:18: ğŸ’¾ Data synced to files successfully
2025-09-21T18:45:48: âœ… Startup grace period ended - message sending now allowed
2025-09-21T18:45:48: âœ… Startup grace period ended - message sending now allowed
2025-09-21T18:45:48: ğŸ’¾ Data synced to files successfully
2025-09-21T18:45:48: â„¹ï¸ [6:45:48 pm] INFO: Grace Period: ENDED {
2025-09-21T18:45:48:   action: 'ENDED',
2025-09-21T18:45:48:   remainingMs: 0,
2025-09-21T18:45:48:   remainingSeconds: 0,
2025-09-21T18:45:48:   details: { totalDuration: 240000, processId: 25964 },
2025-09-21T18:45:48:   timestamp: 1758460548214
2025-09-21T18:45:48: }
2025-09-21T18:45:48: â„¹ï¸ [6:45:48 pm] INFO: Grace Period: ENDED {
2025-09-21T18:45:48:   action: 'ENDED',
2025-09-21T18:45:48:   remainingMs: 0,
2025-09-21T18:45:48:   remainingSeconds: 0,
2025-09-21T18:45:48:   details: { totalDuration: 240000, processId: 25964 },
2025-09-21T18:45:48:   timestamp: 1758460548248
2025-09-21T18:45:48: }
2025-09-21T18:45:48: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-21T18:45:48: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-21T18:46:18: ğŸ’¾ Data synced to files successfully
2025-09-21T18:46:48: ğŸ’¾ Data synced to files successfully
2025-09-21T18:47:18: ğŸ’¾ Data synced to files successfully
2025-09-21T18:47:48: ğŸ’¾ Data synced to files successfully
2025-09-21T18:48:18: ğŸ’¾ Data synced to files successfully
2025-09-21T18:48:48: ğŸ’¾ Data synced to files successfully
2025-09-21T18:49:18: ğŸ’¾ Data synced to files successfully
2025-09-21T18:49:48: ğŸ’¾ Data synced to files successfully
2025-09-21T18:50:18: ğŸ’¾ Data synced to files successfully
2025-09-21T18:50:48: ğŸ’¾ Data synced to files successfully
2025-09-21T18:51:18: ğŸ’¾ Data synced to files successfully
2025-09-21T18:51:48: ğŸ’¾ Data synced to files successfully
2025-09-21T18:52:18: ğŸ’¾ Data synced to files successfully
2025-09-21T18:52:48: ğŸ’¾ Data synced to files successfully
2025-09-21T18:53:18: ğŸ’¾ Data synced to files successfully
2025-09-21T18:53:48: ğŸ’¾ Data synced to files successfully
2025-09-21T18:54:18: ğŸ’¾ Data synced to files successfully
2025-09-21T18:54:48: ğŸ’¾ Data synced to files successfully
2025-09-21T18:55:18: ğŸ’¾ Data synced to files successfully
2025-09-21T18:55:48: ğŸ’¾ Data synced to files successfully
2025-09-21T18:56:18: ğŸ’¾ Data synced to files successfully
2025-09-21T18:56:48: ğŸ’¾ Data synced to files successfully
2025-09-21T18:57:04: ğŸ” [917375938371] Starting comprehensive message safety check...
2025-09-21T18:57:04: ğŸ“‹ [917375938371] Order: TEST-1758461224887, Type: test
2025-09-21T18:57:04: âš ï¸ ALL SAFETY CHECKS DISABLED - SENDING MESSAGE DIRECTLY (EMERGENCY MODE)
2025-09-21T18:57:06: âœ… Message sent to 917375938371@s.whatsapp.net
2025-09-21T18:57:18: ğŸ’¾ Data synced to files successfully
2025-09-21T18:57:48: ğŸ’¾ Data synced to files successfully
2025-09-21T18:58:18: ğŸ’¾ Data synced to files successfully
2025-09-21T18:58:48: ğŸ’¾ Data synced to files successfully
2025-09-21T18:59:18: ğŸ’¾ Data synced to files successfully
2025-09-21T18:59:48: ğŸ’¾ Data synced to files successfully
2025-09-21T19:00:18: ğŸ’¾ Data synced to files successfully
2025-09-21T19:00:48: ğŸ’¾ Data synced to files successfully
2025-09-21T19:01:18: ğŸ’¾ Data synced to files successfully
2025-09-21T19:01:48: ğŸ’¾ Data synced to files successfully
2025-09-21T19:02:18: ğŸ’¾ Data synced to files successfully
2025-09-21T19:02:48: ğŸ’¾ Data synced to files successfully
2025-09-21T19:03:08: ğŸ”Œ Connection closed. Reason: undefined
2025-09-21T19:03:08: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-21T19:03:08: ğŸ”„ Reconnecting in 1s... (Attempt 1/10)
2025-09-21T19:03:08: {"level":50,"time":1758461588645,"pid":25964,"hostname":"SAURABH","msg":"error in sending keep alive"}
2025-09-21T19:03:09: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-21T19:03:09: â„¹ï¸ [7:03:09 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-21T19:03:09:   startupTime: 1758460308065,
2025-09-21T19:03:09:   gracePeriodMs: 240000,
2025-09-21T19:03:09:   dataDir: './safety-data',
2025-09-21T19:03:09:   dbPath: 'safety-data\\safety-database.db',
2025-09-21T19:03:09:   processId: 25964,
2025-09-21T19:03:09:   nodeVersion: 'v22.19.0'
2025-09-21T19:03:09: }
2025-09-21T19:03:09: â„¹ï¸ [7:03:09 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-21T19:03:09: â„¹ï¸ [7:03:09 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-21T19:03:09: ğŸ§¹ Removed stale process lock
2025-09-21T19:03:09: ğŸ”’ Process lock acquired (PID: 25964)
2025-09-21T19:03:09: â„¹ï¸ [7:03:09 pm] INFO: Process isolation enforced {
2025-09-21T19:03:09:   lockFile: 'safety-data\\process.lock',
2025-09-21T19:03:09:   pidFile: 'safety-data\\process.pid',
2025-09-21T19:03:09:   processId: 25964
2025-09-21T19:03:09: }
2025-09-21T19:03:09: â° Starting 240 second startup grace period...
2025-09-21T19:03:09: ğŸš« All message sending is BLOCKED during grace period
2025-09-21T19:03:09: â„¹ï¸ [7:03:09 pm] INFO: Grace Period: STARTED {
2025-09-21T19:03:09:   action: 'STARTED',
2025-09-21T19:03:09:   remainingMs: 240000,
2025-09-21T19:03:09:   remainingSeconds: 240,
2025-09-21T19:03:09:   details: { startupTime: 1758460308065, processId: 25964 },
2025-09-21T19:03:09:   timestamp: 1758461589800
2025-09-21T19:03:09: }
2025-09-21T19:03:09: â„¹ï¸ [7:03:09 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-21T19:03:09:   action: 'GRACE_PERIOD_STARTED',
2025-09-21T19:03:09:   remainingMs: 240000,
2025-09-21T19:03:09:   remainingSeconds: 240,
2025-09-21T19:03:09:   details: { startupTime: 1758460308065, willExpireAt: 1758460548065 },
2025-09-21T19:03:09:   timestamp: 1758461589800
2025-09-21T19:03:09: }
2025-09-21T19:03:09: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-21T19:03:09: â° Startup grace period: 240 seconds
2025-09-21T19:03:09: ğŸ“‹ Message rules loaded: 8 types
2025-09-21T19:03:09: â„¹ï¸ [7:03:09 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-21T19:03:09:   initializationDuration: 1281743,
2025-09-21T19:03:09:   gracePeriodActive: false,
2025-09-21T19:03:09:   messageRulesCount: 8,
2025-09-21T19:03:09:   messageTypes: [
2025-09-21T19:03:09:     'welcome',
2025-09-21T19:03:09:     'confirmation',
2025-09-21T19:03:09:     'ready',
2025-09-21T19:03:09:     'delivery',
2025-09-21T19:03:09:     'pickup_reminder',
2025-09-21T19:03:09:     'payment_reminder',
2025-09-21T19:03:09:     'fabric_welcome',
2025-09-21T19:03:09:     'fabric_purchase'
2025-09-21T19:03:09:   ],
2025-09-21T19:03:09:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-21T19:03:09:   databaseReady: true,
2025-09-21T19:03:09:   loggerReady: true,
2025-09-21T19:03:09:   processIsolationActive: true
2025-09-21T19:03:09: }
2025-09-21T19:03:09: âœ… Safety Manager initialized
2025-09-21T19:03:09: ğŸ“ Loaded 3 sent messages from file
2025-09-21T19:03:09: ğŸ“ Loaded 3 customer histories from file
2025-09-21T19:03:09: ğŸ“ Loaded 3 message hashes from file
2025-09-21T19:03:09: ğŸ“ Loaded statistics from file
2025-09-21T19:03:09: âœ… Duplicate Prevention Manager initialized
2025-09-21T19:03:09: ğŸ“Š Loaded: 3 sent messages, 3 customer histories, 3 content hashes
2025-09-21T19:03:09: âœ… Duplicate Prevention Manager initialized
2025-09-21T19:03:09: ğŸ”„ Starting WhatsApp connection...
2025-09-21T19:03:09: ğŸ”„ Initializing WhatsApp client...
2025-09-21T19:03:09: âœ… WhatsApp connection started
2025-09-21T19:03:09: ğŸ”§ Initializing admin commands...
2025-09-21T19:03:10: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-21T19:03:10: âœ… Admin commands system initialized
2025-09-21T19:03:10: ğŸ”— Initializing webhook functionality...
2025-09-21T19:03:10: âœ… WhatsApp connected. Webhook system ready for real-time notifications.
2025-09-21T19:03:10: ğŸ’¡ Configure Google Apps Script webhook for instant sheet change notifications.
2025-09-21T19:03:10: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-21T19:03:10: ğŸ“ Attempting to request pairing code...
2025-09-21T19:03:10: ğŸ’¡ To use phone authentication:
2025-09-21T19:03:10:    1. Use the dashboard at http://localhost:3001
2025-09-21T19:03:10:    2. Select "Phone Number Authentication"
2025-09-21T19:03:10:    3. Enter your phone number
2025-09-21T19:03:10:    4. Get the pairing code and enter it in WhatsApp
2025-09-21T19:03:10: ğŸ”„ Connecting to WhatsApp...
2025-09-21T19:03:10: ğŸ”Œ Connection closed. Reason: undefined
2025-09-21T19:03:10: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-21T19:03:10: ğŸ”„ Reconnecting in 2s... (Attempt 2/10)
2025-09-21T19:03:12: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-21T19:03:12: â„¹ï¸ [7:03:12 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-21T19:03:12:   startupTime: 1758460308065,
2025-09-21T19:03:12:   gracePeriodMs: 240000,
2025-09-21T19:03:12:   dataDir: './safety-data',
2025-09-21T19:03:12:   dbPath: 'safety-data\\safety-database.db',
2025-09-21T19:03:12:   processId: 25964,
2025-09-21T19:03:12:   nodeVersion: 'v22.19.0'
2025-09-21T19:03:12: }
2025-09-21T19:03:12: â„¹ï¸ [7:03:12 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-21T19:03:12: â„¹ï¸ [7:03:12 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-21T19:03:12: ğŸ§¹ Removed stale process lock
2025-09-21T19:03:12: ğŸ”’ Process lock acquired (PID: 25964)
2025-09-21T19:03:12: â„¹ï¸ [7:03:12 pm] INFO: Process isolation enforced {
2025-09-21T19:03:12:   lockFile: 'safety-data\\process.lock',
2025-09-21T19:03:12:   pidFile: 'safety-data\\process.pid',
2025-09-21T19:03:12:   processId: 25964
2025-09-21T19:03:12: }
2025-09-21T19:03:12: â° Starting 240 second startup grace period...
2025-09-21T19:03:12: ğŸš« All message sending is BLOCKED during grace period
2025-09-21T19:03:12: â„¹ï¸ [7:03:12 pm] INFO: Grace Period: STARTED {
2025-09-21T19:03:12:   action: 'STARTED',
2025-09-21T19:03:12:   remainingMs: 240000,
2025-09-21T19:03:12:   remainingSeconds: 240,
2025-09-21T19:03:12:   details: { startupTime: 1758460308065, processId: 25964 },
2025-09-21T19:03:12:   timestamp: 1758461592066
2025-09-21T19:03:12: }
2025-09-21T19:03:12: â„¹ï¸ [7:03:12 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-21T19:03:12:   action: 'GRACE_PERIOD_STARTED',
2025-09-21T19:03:12:   remainingMs: 240000,
2025-09-21T19:03:12:   remainingSeconds: 240,
2025-09-21T19:03:12:   details: { startupTime: 1758460308065, willExpireAt: 1758460548065 },
2025-09-21T19:03:12:   timestamp: 1758461592067
2025-09-21T19:03:12: }
2025-09-21T19:03:12: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-21T19:03:12: â° Startup grace period: 240 seconds
2025-09-21T19:03:12: ğŸ“‹ Message rules loaded: 8 types
2025-09-21T19:03:12: â„¹ï¸ [7:03:12 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-21T19:03:12:   initializationDuration: 1284014,
2025-09-21T19:03:12:   gracePeriodActive: false,
2025-09-21T19:03:12:   messageRulesCount: 8,
2025-09-21T19:03:12:   messageTypes: [
2025-09-21T19:03:12:     'welcome',
2025-09-21T19:03:12:     'confirmation',
2025-09-21T19:03:12:     'ready',
2025-09-21T19:03:12:     'delivery',
2025-09-21T19:03:12:     'pickup_reminder',
2025-09-21T19:03:12:     'payment_reminder',
2025-09-21T19:03:12:     'fabric_welcome',
2025-09-21T19:03:12:     'fabric_purchase'
2025-09-21T19:03:12:   ],
2025-09-21T19:03:12:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-21T19:03:12:   databaseReady: true,
2025-09-21T19:03:12:   loggerReady: true,
2025-09-21T19:03:12:   processIsolationActive: true
2025-09-21T19:03:12: }
2025-09-21T19:03:12: âœ… Safety Manager initialized
2025-09-21T19:03:12: ğŸ“ Loaded 3 sent messages from file
2025-09-21T19:03:12: ğŸ“ Loaded 3 customer histories from file
2025-09-21T19:03:12: ğŸ“ Loaded 3 message hashes from file
2025-09-21T19:03:12: ğŸ“ Loaded statistics from file
2025-09-21T19:03:12: âœ… Duplicate Prevention Manager initialized
2025-09-21T19:03:12: ğŸ“Š Loaded: 3 sent messages, 3 customer histories, 3 content hashes
2025-09-21T19:03:12: âœ… Duplicate Prevention Manager initialized
2025-09-21T19:03:12: ğŸ”„ Starting WhatsApp connection...
2025-09-21T19:03:12: ğŸ”„ Initializing WhatsApp client...
2025-09-21T19:03:12: âœ… WhatsApp connection started
2025-09-21T19:03:12: ğŸ”§ Initializing admin commands...
2025-09-21T19:03:12: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-21T19:03:12: âœ… Admin commands system initialized
2025-09-21T19:03:12: ğŸ”— Initializing webhook functionality...
2025-09-21T19:03:12: âœ… WhatsApp connected. Webhook system ready for real-time notifications.
2025-09-21T19:03:12: ğŸ’¡ Configure Google Apps Script webhook for instant sheet change notifications.
2025-09-21T19:03:12: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-21T19:03:12: ğŸ“ Attempting to request pairing code...
2025-09-21T19:03:12: ğŸ’¡ To use phone authentication:
2025-09-21T19:03:12:    1. Use the dashboard at http://localhost:3001
2025-09-21T19:03:12:    2. Select "Phone Number Authentication"
2025-09-21T19:03:12:    3. Enter your phone number
2025-09-21T19:03:12:    4. Get the pairing code and enter it in WhatsApp
2025-09-21T19:03:12: ğŸ”„ Connecting to WhatsApp...
2025-09-21T19:03:12: ğŸ”Œ Connection closed. Reason: undefined
2025-09-21T19:03:12: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-21T19:03:12: ğŸ”„ Reconnecting in 4s... (Attempt 3/10)
2025-09-21T19:03:16: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-21T19:03:16: â„¹ï¸ [7:03:16 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-21T19:03:16:   startupTime: 1758460308065,
2025-09-21T19:03:16:   gracePeriodMs: 240000,
2025-09-21T19:03:16:   dataDir: './safety-data',
2025-09-21T19:03:16:   dbPath: 'safety-data\\safety-database.db',
2025-09-21T19:03:16:   processId: 25964,
2025-09-21T19:03:16:   nodeVersion: 'v22.19.0'
2025-09-21T19:03:16: }
2025-09-21T19:03:16: â„¹ï¸ [7:03:16 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-21T19:03:16: â„¹ï¸ [7:03:16 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-21T19:03:16: ğŸ§¹ Removed stale process lock
2025-09-21T19:03:16: ğŸ”’ Process lock acquired (PID: 25964)
2025-09-21T19:03:16: â„¹ï¸ [7:03:16 pm] INFO: Process isolation enforced {
2025-09-21T19:03:16:   lockFile: 'safety-data\\process.lock',
2025-09-21T19:03:16:   pidFile: 'safety-data\\process.pid',
2025-09-21T19:03:16:   processId: 25964
2025-09-21T19:03:16: }
2025-09-21T19:03:16: â° Starting 240 second startup grace period...
2025-09-21T19:03:16: ğŸš« All message sending is BLOCKED during grace period
2025-09-21T19:03:16: â„¹ï¸ [7:03:16 pm] INFO: Grace Period: STARTED {
2025-09-21T19:03:16:   action: 'STARTED',
2025-09-21T19:03:16:   remainingMs: 240000,
2025-09-21T19:03:16:   remainingSeconds: 240,
2025-09-21T19:03:16:   details: { startupTime: 1758460308065, processId: 25964 },
2025-09-21T19:03:16:   timestamp: 1758461596195
2025-09-21T19:03:16: }
2025-09-21T19:03:16: â„¹ï¸ [7:03:16 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-21T19:03:16:   action: 'GRACE_PERIOD_STARTED',
2025-09-21T19:03:16:   remainingMs: 240000,
2025-09-21T19:03:16:   remainingSeconds: 240,
2025-09-21T19:03:16:   details: { startupTime: 1758460308065, willExpireAt: 1758460548065 },
2025-09-21T19:03:16:   timestamp: 1758461596196
2025-09-21T19:03:16: }
2025-09-21T19:03:16: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-21T19:03:16: â° Startup grace period: 240 seconds
2025-09-21T19:03:16: ğŸ“‹ Message rules loaded: 8 types
2025-09-21T19:03:16: â„¹ï¸ [7:03:16 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-21T19:03:16:   initializationDuration: 1288138,
2025-09-21T19:03:16:   gracePeriodActive: false,
2025-09-21T19:03:16:   messageRulesCount: 8,
2025-09-21T19:03:16:   messageTypes: [
2025-09-21T19:03:16:     'welcome',
2025-09-21T19:03:16:     'confirmation',
2025-09-21T19:03:16:     'ready',
2025-09-21T19:03:16:     'delivery',
2025-09-21T19:03:16:     'pickup_reminder',
2025-09-21T19:03:16:     'payment_reminder',
2025-09-21T19:03:16:     'fabric_welcome',
2025-09-21T19:03:16:     'fabric_purchase'
2025-09-21T19:03:16:   ],
2025-09-21T19:03:16:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-21T19:03:16:   databaseReady: true,
2025-09-21T19:03:16:   loggerReady: true,
2025-09-21T19:03:16:   processIsolationActive: true
2025-09-21T19:03:16: }
2025-09-21T19:03:16: âœ… Safety Manager initialized
2025-09-21T19:03:16: ğŸ“ Loaded 3 sent messages from file
2025-09-21T19:03:16: ğŸ“ Loaded 3 customer histories from file
2025-09-21T19:03:16: ğŸ“ Loaded 3 message hashes from file
2025-09-21T19:03:16: ğŸ“ Loaded statistics from file
2025-09-21T19:03:16: âœ… Duplicate Prevention Manager initialized
2025-09-21T19:03:16: ğŸ“Š Loaded: 3 sent messages, 3 customer histories, 3 content hashes
2025-09-21T19:03:16: âœ… Duplicate Prevention Manager initialized
2025-09-21T19:03:16: ğŸ”„ Starting WhatsApp connection...
2025-09-21T19:03:16: ğŸ”„ Initializing WhatsApp client...
2025-09-21T19:03:16: âœ… WhatsApp connection started
2025-09-21T19:03:16: ğŸ”§ Initializing admin commands...
2025-09-21T19:03:16: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-21T19:03:16: âœ… Admin commands system initialized
2025-09-21T19:03:16: ğŸ”— Initializing webhook functionality...
2025-09-21T19:03:16: âœ… WhatsApp connected. Webhook system ready for real-time notifications.
2025-09-21T19:03:16: ğŸ’¡ Configure Google Apps Script webhook for instant sheet change notifications.
2025-09-21T19:03:16: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-21T19:03:16: ğŸ“ Attempting to request pairing code...
2025-09-21T19:03:16: ğŸ’¡ To use phone authentication:
2025-09-21T19:03:16:    1. Use the dashboard at http://localhost:3001
2025-09-21T19:03:16:    2. Select "Phone Number Authentication"
2025-09-21T19:03:16:    3. Enter your phone number
2025-09-21T19:03:16:    4. Get the pairing code and enter it in WhatsApp
2025-09-21T19:03:16: ğŸ”„ Connecting to WhatsApp...
2025-09-21T19:03:16: ğŸ”Œ Connection closed. Reason: undefined
2025-09-21T19:03:16: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-21T19:03:16: ğŸ”„ Reconnecting in 8s... (Attempt 4/10)
2025-09-21T19:03:18: ğŸ’¾ Data synced to files successfully
2025-09-21T19:03:24: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-21T19:03:24: â„¹ï¸ [7:03:24 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-21T19:03:24:   startupTime: 1758460308065,
2025-09-21T19:03:24:   gracePeriodMs: 240000,
2025-09-21T19:03:24:   dataDir: './safety-data',
2025-09-21T19:03:24:   dbPath: 'safety-data\\safety-database.db',
2025-09-21T19:03:24:   processId: 25964,
2025-09-21T19:03:24:   nodeVersion: 'v22.19.0'
2025-09-21T19:03:24: }
2025-09-21T19:03:24: â„¹ï¸ [7:03:24 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-21T19:03:24: â„¹ï¸ [7:03:24 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-21T19:03:24: ğŸ§¹ Removed stale process lock
2025-09-21T19:03:24: ğŸ”’ Process lock acquired (PID: 25964)
2025-09-21T19:03:24: â„¹ï¸ [7:03:24 pm] INFO: Process isolation enforced {
2025-09-21T19:03:24:   lockFile: 'safety-data\\process.lock',
2025-09-21T19:03:24:   pidFile: 'safety-data\\process.pid',
2025-09-21T19:03:24:   processId: 25964
2025-09-21T19:03:24: }
2025-09-21T19:03:24: â° Starting 240 second startup grace period...
2025-09-21T19:03:24: ğŸš« All message sending is BLOCKED during grace period
2025-09-21T19:03:24: â„¹ï¸ [7:03:24 pm] INFO: Grace Period: STARTED {
2025-09-21T19:03:24:   action: 'STARTED',
2025-09-21T19:03:24:   remainingMs: 240000,
2025-09-21T19:03:24:   remainingSeconds: 240,
2025-09-21T19:03:24:   details: { startupTime: 1758460308065, processId: 25964 },
2025-09-21T19:03:24:   timestamp: 1758461604319
2025-09-21T19:03:24: }
2025-09-21T19:03:24: â„¹ï¸ [7:03:24 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-21T19:03:24:   action: 'GRACE_PERIOD_STARTED',
2025-09-21T19:03:24:   remainingMs: 240000,
2025-09-21T19:03:24:   remainingSeconds: 240,
2025-09-21T19:03:24:   details: { startupTime: 1758460308065, willExpireAt: 1758460548065 },
2025-09-21T19:03:24:   timestamp: 1758461604319
2025-09-21T19:03:24: }
2025-09-21T19:03:24: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-21T19:03:24: â° Startup grace period: 240 seconds
2025-09-21T19:03:24: ğŸ“‹ Message rules loaded: 8 types
2025-09-21T19:03:24: â„¹ï¸ [7:03:24 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-21T19:03:24:   initializationDuration: 1296264,
2025-09-21T19:03:24:   gracePeriodActive: false,
2025-09-21T19:03:24:   messageRulesCount: 8,
2025-09-21T19:03:24:   messageTypes: [
2025-09-21T19:03:24:     'welcome',
2025-09-21T19:03:24:     'confirmation',
2025-09-21T19:03:24:     'ready',
2025-09-21T19:03:24:     'delivery',
2025-09-21T19:03:24:     'pickup_reminder',
2025-09-21T19:03:24:     'payment_reminder',
2025-09-21T19:03:24:     'fabric_welcome',
2025-09-21T19:03:24:     'fabric_purchase'
2025-09-21T19:03:24:   ],
2025-09-21T19:03:24:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-21T19:03:24:   databaseReady: true,
2025-09-21T19:03:24:   loggerReady: true,
2025-09-21T19:03:24:   processIsolationActive: true
2025-09-21T19:03:24: }
2025-09-21T19:03:24: âœ… Safety Manager initialized
2025-09-21T19:03:24: ğŸ“ Loaded 3 sent messages from file
2025-09-21T19:03:24: ğŸ“ Loaded 3 customer histories from file
2025-09-21T19:03:24: ğŸ“ Loaded 3 message hashes from file
2025-09-21T19:03:24: ğŸ“ Loaded statistics from file
2025-09-21T19:03:24: âœ… Duplicate Prevention Manager initialized
2025-09-21T19:03:24: ğŸ“Š Loaded: 3 sent messages, 3 customer histories, 3 content hashes
2025-09-21T19:03:24: âœ… Duplicate Prevention Manager initialized
2025-09-21T19:03:24: ğŸ”„ Starting WhatsApp connection...
2025-09-21T19:03:24: ğŸ”„ Initializing WhatsApp client...
2025-09-21T19:03:24: âœ… WhatsApp connection started
2025-09-21T19:03:24: ğŸ”§ Initializing admin commands...
2025-09-21T19:03:24: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-21T19:03:24: âœ… Admin commands system initialized
2025-09-21T19:03:24: ğŸ”— Initializing webhook functionality...
2025-09-21T19:03:24: âœ… WhatsApp connected. Webhook system ready for real-time notifications.
2025-09-21T19:03:24: ğŸ’¡ Configure Google Apps Script webhook for instant sheet change notifications.
2025-09-21T19:03:24: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-21T19:03:24: ğŸ“ Attempting to request pairing code...
2025-09-21T19:03:24: ğŸ’¡ To use phone authentication:
2025-09-21T19:03:24:    1. Use the dashboard at http://localhost:3001
2025-09-21T19:03:24:    2. Select "Phone Number Authentication"
2025-09-21T19:03:24:    3. Enter your phone number
2025-09-21T19:03:24:    4. Get the pairing code and enter it in WhatsApp
2025-09-21T19:03:24: ğŸ”„ Connecting to WhatsApp...
2025-09-21T19:03:24: ğŸ”Œ Connection closed. Reason: undefined
2025-09-21T19:03:24: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-21T19:03:24: ğŸ”„ Reconnecting in 16s... (Attempt 5/10)
2025-09-21T19:03:40: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-21T19:03:40: â„¹ï¸ [7:03:40 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-21T19:03:40:   startupTime: 1758460308065,
2025-09-21T19:03:40:   gracePeriodMs: 240000,
2025-09-21T19:03:40:   dataDir: './safety-data',
2025-09-21T19:03:40:   dbPath: 'safety-data\\safety-database.db',
2025-09-21T19:03:40:   processId: 25964,
2025-09-21T19:03:40:   nodeVersion: 'v22.19.0'
2025-09-21T19:03:40: }
2025-09-21T19:03:40: â„¹ï¸ [7:03:40 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-21T19:03:40: â„¹ï¸ [7:03:40 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-21T19:03:40: ğŸ§¹ Removed stale process lock
2025-09-21T19:03:40: ğŸ”’ Process lock acquired (PID: 25964)
2025-09-21T19:03:40: â„¹ï¸ [7:03:40 pm] INFO: Process isolation enforced {
2025-09-21T19:03:40:   lockFile: 'safety-data\\process.lock',
2025-09-21T19:03:40:   pidFile: 'safety-data\\process.pid',
2025-09-21T19:03:40:   processId: 25964
2025-09-21T19:03:40: }
2025-09-21T19:03:40: â° Starting 240 second startup grace period...
2025-09-21T19:03:40: ğŸš« All message sending is BLOCKED during grace period
2025-09-21T19:03:40: â„¹ï¸ [7:03:40 pm] INFO: Grace Period: STARTED {
2025-09-21T19:03:40:   action: 'STARTED',
2025-09-21T19:03:40:   remainingMs: 240000,
2025-09-21T19:03:40:   remainingSeconds: 240,
2025-09-21T19:03:40:   details: { startupTime: 1758460308065, processId: 25964 },
2025-09-21T19:03:40:   timestamp: 1758461620446
2025-09-21T19:03:40: }
2025-09-21T19:03:40: â„¹ï¸ [7:03:40 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-21T19:03:40:   action: 'GRACE_PERIOD_STARTED',
2025-09-21T19:03:40:   remainingMs: 240000,
2025-09-21T19:03:40:   remainingSeconds: 240,
2025-09-21T19:03:40:   details: { startupTime: 1758460308065, willExpireAt: 1758460548065 },
2025-09-21T19:03:40:   timestamp: 1758461620447
2025-09-21T19:03:40: }
2025-09-21T19:03:40: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-21T19:03:40: â° Startup grace period: 240 seconds
2025-09-21T19:03:40: ğŸ“‹ Message rules loaded: 8 types
2025-09-21T19:03:40: â„¹ï¸ [7:03:40 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-21T19:03:40:   initializationDuration: 1312391,
2025-09-21T19:03:40:   gracePeriodActive: false,
2025-09-21T19:03:40:   messageRulesCount: 8,
2025-09-21T19:03:40:   messageTypes: [
2025-09-21T19:03:40:     'welcome',
2025-09-21T19:03:40:     'confirmation',
2025-09-21T19:03:40:     'ready',
2025-09-21T19:03:40:     'delivery',
2025-09-21T19:03:40:     'pickup_reminder',
2025-09-21T19:03:40:     'payment_reminder',
2025-09-21T19:03:40:     'fabric_welcome',
2025-09-21T19:03:40:     'fabric_purchase'
2025-09-21T19:03:40:   ],
2025-09-21T19:03:40:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-21T19:03:40:   databaseReady: true,
2025-09-21T19:03:40:   loggerReady: true,
2025-09-21T19:03:40:   processIsolationActive: true
2025-09-21T19:03:40: }
2025-09-21T19:03:40: âœ… Safety Manager initialized
2025-09-21T19:03:40: ğŸ“ Loaded 3 sent messages from file
2025-09-21T19:03:40: ğŸ“ Loaded 3 customer histories from file
2025-09-21T19:03:40: ğŸ“ Loaded 3 message hashes from file
2025-09-21T19:03:40: ğŸ“ Loaded statistics from file
2025-09-21T19:03:40: âœ… Duplicate Prevention Manager initialized
2025-09-21T19:03:40: ğŸ“Š Loaded: 3 sent messages, 3 customer histories, 3 content hashes
2025-09-21T19:03:40: âœ… Duplicate Prevention Manager initialized
2025-09-21T19:03:40: ğŸ”„ Starting WhatsApp connection...
2025-09-21T19:03:40: ğŸ”„ Initializing WhatsApp client...
2025-09-21T19:03:40: âœ… WhatsApp connection started
2025-09-21T19:03:40: ğŸ”§ Initializing admin commands...
2025-09-21T19:03:40: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-21T19:03:40: âœ… Admin commands system initialized
2025-09-21T19:03:40: ğŸ”— Initializing webhook functionality...
2025-09-21T19:03:40: âœ… WhatsApp connected. Webhook system ready for real-time notifications.
2025-09-21T19:03:40: ğŸ’¡ Configure Google Apps Script webhook for instant sheet change notifications.
2025-09-21T19:03:40: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-21T19:03:40: ğŸ“ Attempting to request pairing code...
2025-09-21T19:03:40: ğŸ’¡ To use phone authentication:
2025-09-21T19:03:40:    1. Use the dashboard at http://localhost:3001
2025-09-21T19:03:40:    2. Select "Phone Number Authentication"
2025-09-21T19:03:40:    3. Enter your phone number
2025-09-21T19:03:40:    4. Get the pairing code and enter it in WhatsApp
2025-09-21T19:03:40: ğŸ”„ Connecting to WhatsApp...
2025-09-21T19:03:40: ğŸ”Œ Connection closed. Reason: undefined
2025-09-21T19:03:40: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-21T19:03:40: ğŸ”„ Reconnecting in 30s... (Attempt 6/10)
2025-09-21T19:03:48: ğŸ’¾ Data synced to files successfully
2025-09-21T19:04:10: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-21T19:04:10: â„¹ï¸ [7:04:10 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-21T19:04:10:   startupTime: 1758460308065,
2025-09-21T19:04:10:   gracePeriodMs: 240000,
2025-09-21T19:04:10:   dataDir: './safety-data',
2025-09-21T19:04:10:   dbPath: 'safety-data\\safety-database.db',
2025-09-21T19:04:10:   processId: 25964,
2025-09-21T19:04:10:   nodeVersion: 'v22.19.0'
2025-09-21T19:04:10: }
2025-09-21T19:04:10: â„¹ï¸ [7:04:10 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-21T19:04:10: â„¹ï¸ [7:04:10 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-21T19:04:10: ğŸ§¹ Removed stale process lock
2025-09-21T19:04:10: ğŸ”’ Process lock acquired (PID: 25964)
2025-09-21T19:04:10: â„¹ï¸ [7:04:10 pm] INFO: Process isolation enforced {
2025-09-21T19:04:10:   lockFile: 'safety-data\\process.lock',
2025-09-21T19:04:10:   pidFile: 'safety-data\\process.pid',
2025-09-21T19:04:10:   processId: 25964
2025-09-21T19:04:10: }
2025-09-21T19:04:10: â° Starting 240 second startup grace period...
2025-09-21T19:04:10: ğŸš« All message sending is BLOCKED during grace period
2025-09-21T19:04:10: â„¹ï¸ [7:04:10 pm] INFO: Grace Period: STARTED {
2025-09-21T19:04:10:   action: 'STARTED',
2025-09-21T19:04:10:   remainingMs: 240000,
2025-09-21T19:04:10:   remainingSeconds: 240,
2025-09-21T19:04:10:   details: { startupTime: 1758460308065, processId: 25964 },
2025-09-21T19:04:10:   timestamp: 1758461650568
2025-09-21T19:04:10: }
2025-09-21T19:04:10: â„¹ï¸ [7:04:10 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-21T19:04:10:   action: 'GRACE_PERIOD_STARTED',
2025-09-21T19:04:10:   remainingMs: 240000,
2025-09-21T19:04:10:   remainingSeconds: 240,
2025-09-21T19:04:10:   details: { startupTime: 1758460308065, willExpireAt: 1758460548065 },
2025-09-21T19:04:10:   timestamp: 1758461650569
2025-09-21T19:04:10: }
2025-09-21T19:04:10: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-21T19:04:10: â° Startup grace period: 240 seconds
2025-09-21T19:04:10: ğŸ“‹ Message rules loaded: 8 types
2025-09-21T19:04:10: â„¹ï¸ [7:04:10 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-21T19:04:10:   initializationDuration: 1342511,
2025-09-21T19:04:10:   gracePeriodActive: false,
2025-09-21T19:04:10:   messageRulesCount: 8,
2025-09-21T19:04:10:   messageTypes: [
2025-09-21T19:04:10:     'welcome',
2025-09-21T19:04:10:     'confirmation',
2025-09-21T19:04:10:     'ready',
2025-09-21T19:04:10:     'delivery',
2025-09-21T19:04:10:     'pickup_reminder',
2025-09-21T19:04:10:     'payment_reminder',
2025-09-21T19:04:10:     'fabric_welcome',
2025-09-21T19:04:10:     'fabric_purchase'
2025-09-21T19:04:10:   ],
2025-09-21T19:04:10:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-21T19:04:10:   databaseReady: true,
2025-09-21T19:04:10:   loggerReady: true,
2025-09-21T19:04:10:   processIsolationActive: true
2025-09-21T19:04:10: }
2025-09-21T19:04:10: âœ… Safety Manager initialized
2025-09-21T19:04:10: ğŸ“ Loaded 3 sent messages from file
2025-09-21T19:04:10: ğŸ“ Loaded 3 customer histories from file
2025-09-21T19:04:10: ğŸ“ Loaded 3 message hashes from file
2025-09-21T19:04:10: ğŸ“ Loaded statistics from file
2025-09-21T19:04:10: âœ… Duplicate Prevention Manager initialized
2025-09-21T19:04:10: ğŸ“Š Loaded: 3 sent messages, 3 customer histories, 3 content hashes
2025-09-21T19:04:10: âœ… Duplicate Prevention Manager initialized
2025-09-21T19:04:10: ğŸ”„ Starting WhatsApp connection...
2025-09-21T19:04:10: ğŸ”„ Initializing WhatsApp client...
2025-09-21T19:04:10: âœ… WhatsApp connection started
2025-09-21T19:04:10: ğŸ”§ Initializing admin commands...
2025-09-21T19:04:10: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-21T19:04:10: âœ… Admin commands system initialized
2025-09-21T19:04:10: ğŸ”— Initializing webhook functionality...
2025-09-21T19:04:10: âœ… WhatsApp connected. Webhook system ready for real-time notifications.
2025-09-21T19:04:10: ğŸ’¡ Configure Google Apps Script webhook for instant sheet change notifications.
2025-09-21T19:04:10: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-21T19:04:10: ğŸ“ Attempting to request pairing code...
2025-09-21T19:04:10: ğŸ’¡ To use phone authentication:
2025-09-21T19:04:10:    1. Use the dashboard at http://localhost:3001
2025-09-21T19:04:10:    2. Select "Phone Number Authentication"
2025-09-21T19:04:10:    3. Enter your phone number
2025-09-21T19:04:10:    4. Get the pairing code and enter it in WhatsApp
2025-09-21T19:04:10: ğŸ”„ Connecting to WhatsApp...
2025-09-21T19:04:10: ğŸ”Œ Connection closed. Reason: undefined
2025-09-21T19:04:10: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-21T19:04:10: ğŸ”„ Reconnecting in 30s... (Attempt 7/10)
2025-09-21T19:04:18: ğŸ’¾ Data synced to files successfully
2025-09-21T19:12:49: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-21T19:12:49: âœ… Startup grace period ended - message sending now allowed
2025-09-21T19:12:49: âœ… Startup grace period ended - message sending now allowed
2025-09-21T19:12:49: âœ… Startup grace period ended - message sending now allowed
2025-09-21T19:12:49: âœ… Startup grace period ended - message sending now allowed
2025-09-21T19:12:49: âœ… Startup grace period ended - message sending now allowed
2025-09-21T19:12:49: âœ… Startup grace period ended - message sending now allowed
2025-09-21T19:12:50: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-21T19:12:50: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-21T19:12:50: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-21T19:12:50: ğŸ’¾ Data synced to files successfully
2025-09-21T19:12:50: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-21T19:12:50: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-21T19:12:50: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-21T19:12:50: â„¹ï¸ [7:12:50 pm] INFO: Grace Period: ENDED {
2025-09-21T19:12:50:   action: 'ENDED',
2025-09-21T19:12:50:   remainingMs: 0,
2025-09-21T19:12:50:   remainingSeconds: 0,
2025-09-21T19:12:50:   details: { totalDuration: 240000, processId: 25964 },
2025-09-21T19:12:50:   timestamp: 1758462169971
2025-09-21T19:12:50: }
2025-09-21T19:12:50: â„¹ï¸ [7:12:50 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-21T19:12:50:   startupTime: 1758460308065,
2025-09-21T19:12:50:   gracePeriodMs: 240000,
2025-09-21T19:12:50:   dataDir: './safety-data',
2025-09-21T19:12:50:   dbPath: 'safety-data\\safety-database.db',
2025-09-21T19:12:50:   processId: 25964,
2025-09-21T19:12:50:   nodeVersion: 'v22.19.0'
2025-09-21T19:12:50: }
2025-09-21T19:12:50: â„¹ï¸ [7:12:50 pm] INFO: Grace Period: ENDED {
2025-09-21T19:12:50:   action: 'ENDED',
2025-09-21T19:12:50:   remainingMs: 0,
2025-09-21T19:12:50:   remainingSeconds: 0,
2025-09-21T19:12:50:   details: { totalDuration: 240000, processId: 25964 },
2025-09-21T19:12:50:   timestamp: 1758462169973
2025-09-21T19:12:50: }
2025-09-21T19:12:50: â„¹ï¸ [7:12:50 pm] INFO: Grace Period: ENDED {
2025-09-21T19:12:50:   action: 'ENDED',
2025-09-21T19:12:50:   remainingMs: 0,
2025-09-21T19:12:50:   remainingSeconds: 0,
2025-09-21T19:12:50:   details: { totalDuration: 240000, processId: 25964 },
2025-09-21T19:12:50:   timestamp: 1758462169974
2025-09-21T19:12:50: }
2025-09-21T19:12:50: â„¹ï¸ [7:12:50 pm] INFO: Grace Period: ENDED {
2025-09-21T19:12:50:   action: 'ENDED',
2025-09-21T19:12:50:   remainingMs: 0,
2025-09-21T19:12:50:   remainingSeconds: 0,
2025-09-21T19:12:50:   details: { totalDuration: 240000, processId: 25964 },
2025-09-21T19:12:50:   timestamp: 1758462169974
2025-09-21T19:12:50: }
2025-09-21T19:12:50: â„¹ï¸ [7:12:50 pm] INFO: Grace Period: ENDED {
2025-09-21T19:12:50:   action: 'ENDED',
2025-09-21T19:12:50:   remainingMs: 0,
2025-09-21T19:12:50:   remainingSeconds: 0,
2025-09-21T19:12:50:   details: { totalDuration: 240000, processId: 25964 },
2025-09-21T19:12:50:   timestamp: 1758462169975
2025-09-21T19:12:50: }
2025-09-21T19:12:50: â„¹ï¸ [7:12:50 pm] INFO: Grace Period: ENDED {
2025-09-21T19:12:50:   action: 'ENDED',
2025-09-21T19:12:50:   remainingMs: 0,
2025-09-21T19:12:50:   remainingSeconds: 0,
2025-09-21T19:12:50:   details: { totalDuration: 240000, processId: 25964 },
2025-09-21T19:12:50:   timestamp: 1758462169976
2025-09-21T19:12:50: }
2025-09-21T19:12:50: â„¹ï¸ [7:12:50 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-21T19:12:50: â„¹ï¸ [7:12:50 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-21T19:12:50: ğŸ§¹ Removed stale process lock
2025-09-21T19:12:50: ğŸ”’ Process lock acquired (PID: 25964)
2025-09-21T19:12:50: â„¹ï¸ [7:12:50 pm] INFO: Process isolation enforced {
2025-09-21T19:12:50:   lockFile: 'safety-data\\process.lock',
2025-09-21T19:12:50:   pidFile: 'safety-data\\process.pid',
2025-09-21T19:12:50:   processId: 25964
2025-09-21T19:12:50: }
2025-09-21T19:12:50: â° Starting 240 second startup grace period...
2025-09-21T19:12:50: ğŸš« All message sending is BLOCKED during grace period
2025-09-21T19:12:50: â„¹ï¸ [7:12:50 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-21T19:12:50:   action: 'GRACE_PERIOD_STARTED',
2025-09-21T19:12:50:   remainingMs: 240000,
2025-09-21T19:12:50:   remainingSeconds: 240,
2025-09-21T19:12:50:   details: { startupTime: 1758460308065, willExpireAt: 1758460548065 },
2025-09-21T19:12:50:   timestamp: 1758462170050
2025-09-21T19:12:50: }
2025-09-21T19:12:50: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-21T19:12:50: â° Startup grace period: 240 seconds
2025-09-21T19:12:50: ğŸ“‹ Message rules loaded: 8 types
2025-09-21T19:12:50: â„¹ï¸ [7:12:50 pm] INFO: Grace Period: STARTED {
2025-09-21T19:12:50:   action: 'STARTED',
2025-09-21T19:12:50:   remainingMs: 240000,
2025-09-21T19:12:50:   remainingSeconds: 240,
2025-09-21T19:12:50:   details: { startupTime: 1758460308065, processId: 25964 },
2025-09-21T19:12:50:   timestamp: 1758462170050
2025-09-21T19:12:50: }
2025-09-21T19:12:50: â„¹ï¸ [7:12:50 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-21T19:12:50:   initializationDuration: 1861989,
2025-09-21T19:12:50:   gracePeriodActive: false,
2025-09-21T19:12:50:   messageRulesCount: 8,
2025-09-21T19:12:50:   messageTypes: [
2025-09-21T19:12:50:     'welcome',
2025-09-21T19:12:50:     'confirmation',
2025-09-21T19:12:50:     'ready',
2025-09-21T19:12:50:     'delivery',
2025-09-21T19:12:50:     'pickup_reminder',
2025-09-21T19:12:50:     'payment_reminder',
2025-09-21T19:12:50:     'fabric_welcome',
2025-09-21T19:12:50:     'fabric_purchase'
2025-09-21T19:12:50:   ],
2025-09-21T19:12:50:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-21T19:12:50:   databaseReady: true,
2025-09-21T19:12:50:   loggerReady: true,
2025-09-21T19:12:50:   processIsolationActive: true
2025-09-21T19:12:50: }
2025-09-21T19:12:50: âœ… Safety Manager initialized
2025-09-21T19:12:50: ğŸ“ Loaded 3 sent messages from file
2025-09-21T19:12:50: ğŸ“ Loaded 3 customer histories from file
2025-09-21T19:12:50: ğŸ“ Loaded 3 message hashes from file
2025-09-21T19:12:50: ğŸ“ Loaded statistics from file
2025-09-21T19:12:50: âœ… Duplicate Prevention Manager initialized
2025-09-21T19:12:50: ğŸ“Š Loaded: 3 sent messages, 3 customer histories, 3 content hashes
2025-09-21T19:12:50: âœ… Duplicate Prevention Manager initialized
2025-09-21T19:12:50: ğŸ”„ Starting WhatsApp connection...
2025-09-21T19:12:50: ğŸ”„ Initializing WhatsApp client...
2025-09-21T19:12:50: âœ… WhatsApp connection started
2025-09-21T19:12:50: ğŸ”§ Initializing admin commands...
2025-09-21T19:12:50: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-21T19:12:50: âœ… Admin commands system initialized
2025-09-21T19:12:50: ğŸ”— Initializing webhook functionality...
2025-09-21T19:12:50: âœ… WhatsApp connected. Webhook system ready for real-time notifications.
2025-09-21T19:12:50: ğŸ’¡ Configure Google Apps Script webhook for instant sheet change notifications.
2025-09-21T19:12:50: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-21T19:12:50: ğŸ“ Attempting to request pairing code...
2025-09-21T19:12:50: ğŸ’¡ To use phone authentication:
2025-09-21T19:12:50:    1. Use the dashboard at http://localhost:3001
2025-09-21T19:12:50:    2. Select "Phone Number Authentication"
2025-09-21T19:12:50:    3. Enter your phone number
2025-09-21T19:12:50:    4. Get the pairing code and enter it in WhatsApp
2025-09-21T19:12:50: ğŸ”„ Connecting to WhatsApp...
2025-09-21T19:12:50: ğŸ”Œ Connection closed. Reason: undefined
2025-09-21T19:12:50: ğŸ”„ Enhanced client: Disconnected event received, forwarding...
2025-09-21T19:12:50: ğŸ”„ Reconnecting in 30s... (Attempt 8/10)
2025-09-21T19:13:19: ğŸ’¾ Data synced to files successfully
2025-09-21T19:13:20: ğŸ”„ Initializing Enhanced WhatsApp Client...
2025-09-21T19:13:20: â„¹ï¸ [7:13:20 pm] INFO: Enhanced Safety Manager initialization started {
2025-09-21T19:13:20:   startupTime: 1758460308065,
2025-09-21T19:13:20:   gracePeriodMs: 240000,
2025-09-21T19:13:20:   dataDir: './safety-data',
2025-09-21T19:13:20:   dbPath: 'safety-data\\safety-database.db',
2025-09-21T19:13:20:   processId: 25964,
2025-09-21T19:13:20:   nodeVersion: 'v22.19.0'
2025-09-21T19:13:20: }
2025-09-21T19:13:20: â„¹ï¸ [7:13:20 pm] INFO: Data directory created/verified { dataDir: './safety-data' }
2025-09-21T19:13:20: â„¹ï¸ [7:13:20 pm] INFO: SQLite database initialized { dbPath: 'safety-data\\safety-database.db' }
2025-09-21T19:13:20: ğŸ§¹ Removed stale process lock
2025-09-21T19:13:20: ğŸ”’ Process lock acquired (PID: 25964)
2025-09-21T19:13:20: â„¹ï¸ [7:13:20 pm] INFO: Process isolation enforced {
2025-09-21T19:13:20:   lockFile: 'safety-data\\process.lock',
2025-09-21T19:13:20:   pidFile: 'safety-data\\process.pid',
2025-09-21T19:13:20:   processId: 25964
2025-09-21T19:13:20: }
2025-09-21T19:13:20: â° Starting 240 second startup grace period...
2025-09-21T19:13:20: ğŸš« All message sending is BLOCKED during grace period
2025-09-21T19:13:20: â„¹ï¸ [7:13:20 pm] INFO: Grace Period: STARTED {
2025-09-21T19:13:20:   action: 'STARTED',
2025-09-21T19:13:20:   remainingMs: 240000,
2025-09-21T19:13:20:   remainingSeconds: 240,
2025-09-21T19:13:20:   details: { startupTime: 1758460308065, processId: 25964 },
2025-09-21T19:13:20:   timestamp: 1758462200120
2025-09-21T19:13:20: }
2025-09-21T19:13:20: â„¹ï¸ [7:13:20 pm] INFO: Grace Period: GRACE_PERIOD_STARTED {
2025-09-21T19:13:20:   action: 'GRACE_PERIOD_STARTED',
2025-09-21T19:13:20:   remainingMs: 240000,
2025-09-21T19:13:20:   remainingSeconds: 240,
2025-09-21T19:13:20:   details: { startupTime: 1758460308065, willExpireAt: 1758460548065 },
2025-09-21T19:13:20:   timestamp: 1758462200120
2025-09-21T19:13:20: }
2025-09-21T19:13:20: ğŸ›¡ï¸ Enhanced Safety Manager initialized
2025-09-21T19:13:20: â° Startup grace period: 240 seconds
2025-09-21T19:13:20: ğŸ“‹ Message rules loaded: 8 types
2025-09-21T19:13:20: â„¹ï¸ [7:13:20 pm] INFO: Enhanced Safety Manager initialization completed successfully {
2025-09-21T19:13:20:   initializationDuration: 1892063,
2025-09-21T19:13:20:   gracePeriodActive: false,
2025-09-21T19:13:20:   messageRulesCount: 8,
2025-09-21T19:13:20:   messageTypes: [
2025-09-21T19:13:20:     'welcome',
2025-09-21T19:13:20:     'confirmation',
2025-09-21T19:13:20:     'ready',
2025-09-21T19:13:20:     'delivery',
2025-09-21T19:13:20:     'pickup_reminder',
2025-09-21T19:13:20:     'payment_reminder',
2025-09-21T19:13:20:     'fabric_welcome',
2025-09-21T19:13:20:     'fabric_purchase'
2025-09-21T19:13:20:   ],
2025-09-21T19:13:20:   circuitBreakerLimits: { daily: 10, hourly: 3, similarity: 0.8 },
2025-09-21T19:13:20:   databaseReady: true,
2025-09-21T19:13:20:   loggerReady: true,
2025-09-21T19:13:20:   processIsolationActive: true
2025-09-21T19:13:20: }
2025-09-21T19:13:20: âœ… Safety Manager initialized
2025-09-21T19:13:20: ğŸ“ Loaded 3 sent messages from file
2025-09-21T19:13:20: ğŸ“ Loaded 3 customer histories from file
2025-09-21T19:13:20: ğŸ“ Loaded 3 message hashes from file
2025-09-21T19:13:20: ğŸ“ Loaded statistics from file
2025-09-21T19:13:20: âœ… Duplicate Prevention Manager initialized
2025-09-21T19:13:20: ğŸ“Š Loaded: 3 sent messages, 3 customer histories, 3 content hashes
2025-09-21T19:13:20: âœ… Duplicate Prevention Manager initialized
2025-09-21T19:13:20: ğŸ”„ Starting WhatsApp connection...
2025-09-21T19:13:20: ğŸ”„ Initializing WhatsApp client...
2025-09-21T19:13:20: âœ… WhatsApp connection started
2025-09-21T19:13:20: ğŸ”§ Initializing admin commands...
2025-09-21T19:13:20: ğŸ“¨ Message handler attached to WhatsApp socket
2025-09-21T19:13:20: âœ… Admin commands system initialized
2025-09-21T19:13:20: ğŸ”— Initializing webhook functionality...
2025-09-21T19:13:20: âœ… WhatsApp connected. Webhook system ready for real-time notifications.
2025-09-21T19:13:20: ğŸ’¡ Configure Google Apps Script webhook for instant sheet change notifications.
2025-09-21T19:13:20: ğŸ›¡ï¸ Enhanced WhatsApp Client fully initialized
2025-09-21T19:13:20: ğŸ“ Attempting to request pairing code...
2025-09-21T19:13:20: ğŸ’¡ To use phone authentication:
2025-09-21T19:13:20:    1. Use the dashboard at http://localhost:3001
2025-09-21T19:13:20:    2. Select "Phone Number Authentication"
2025-09-21T19:13:20:    3. Enter your phone number
2025-09-21T19:13:20:    4. Get the pairing code and enter it in WhatsApp
2025-09-21T19:13:20: ğŸ”„ Connecting to WhatsApp...
2025-09-21T19:13:22: âœ… WhatsApp connected successfully!
2025-09-21T19:13:22: ğŸ”„ Enhanced client: Connected event received, forwarding...
2025-09-21T19:13:22: ğŸ“± Session established successfully
2025-09-21T19:13:22: ğŸ”’ Session will be monitored for stability
2025-09-21T19:13:49: ğŸ’¾ Data synced to files successfully
2025-09-21T19:14:19: ğŸ’¾ Data synced to files successfully
2025-09-21T19:14:49: ğŸ’¾ Data synced to files successfully
2025-09-21T19:15:20: ğŸ’¾ Data synced to files successfully
2025-09-21T19:15:50: ğŸ’¾ Data synced to files successfully
2025-09-21T19:16:20: ğŸ’¾ Data synced to files successfully
2025-09-21T19:16:50: ğŸ’¾ Data synced to files successfully
2025-09-21T19:16:50: âœ… Startup grace period ended - message sending now allowed
2025-09-21T19:16:50: â„¹ï¸ [7:16:50 pm] INFO: Grace Period: ENDED {
2025-09-21T19:16:50:   action: 'ENDED',
2025-09-21T19:16:50:   remainingMs: 0,
2025-09-21T19:16:50:   remainingSeconds: 0,
2025-09-21T19:16:50:   details: { totalDuration: 240000, processId: 25964 },
2025-09-21T19:16:50:   timestamp: 1758462410066
2025-09-21T19:16:50: }
2025-09-21T19:16:50: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-21T19:17:20: ğŸ’¾ Data synced to files successfully
2025-09-21T19:17:20: âœ… Startup grace period ended - message sending now allowed
2025-09-21T19:17:20: â„¹ï¸ [7:17:20 pm] INFO: Grace Period: ENDED {
2025-09-21T19:17:20:   action: 'ENDED',
2025-09-21T19:17:20:   remainingMs: 0,
2025-09-21T19:17:20:   remainingSeconds: 0,
2025-09-21T19:17:20:   details: { totalDuration: 240000, processId: 25964 },
2025-09-21T19:17:20:   timestamp: 1758462440129
2025-09-21T19:17:20: }
2025-09-21T19:17:20: ğŸ“‹ System Event: grace_period_ended - Startup grace period completed successfully
2025-09-21T19:17:50: ğŸ’¾ Data synced to files successfully
2025-09-21T19:18:14: ğŸ” [917375938371] Starting comprehensive message safety check...
2025-09-21T19:18:14: ğŸ“‹ [917375938371] Order: TEST-1758462494460, Type: test
2025-09-21T19:18:14: âš ï¸ ALL SAFETY CHECKS DISABLED - SENDING MESSAGE DIRECTLY (EMERGENCY MODE)
2025-09-21T19:18:14: âœ… Message sent to 917375938371@s.whatsapp.net
2025-09-21T19:18:20: ğŸ’¾ Data synced to files successfully
